<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JVMç³»åˆ— ä¹‹ æ·±å…¥æ¢ç´¢ç±»åŠ è½½æœºåˆ¶</title>
      <link href="/posts/28357.html"/>
      <url>/posts/28357.html</url>
      
        <content type="html"><![CDATA[<h1>ğŸŒŸ JVMç³»åˆ— ä¹‹ æ·±å…¥æ¢ç´¢ç±»åŠ è½½æœºåˆ¶</h1><h2 id="ğŸ‘¥-èƒŒæ™¯æ•…äº‹">ğŸ‘¥ èƒŒæ™¯æ•…äº‹</h2><p>åœ¨ä¸€æ¬¡å‹äººé—´çš„èšé¤è®¨è®ºä¸­ï¼Œæˆ‘ä»¬æåŠäº†ä¸åŒç¼–ç¨‹è¯­è¨€çš„ä¼˜åŠ¿ä¸å­¦ä¹ æ·±åº¦ã€‚å¯¹äºä¸€ä½ä»¥PHPä¸ºèƒŒæ™¯çš„æœ‹å‹ï¼Œæœ‰äººå»ºè®®å…¶è½¬å‘Javaç”Ÿæ€ï¼Œå› ä¸ºJavaå…·æœ‰æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿå’Œå¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚æœ‹å‹è™½è¡¨ç¤ºå¯¹Javaè¯­æ³•æœ‰æ‰€æŒæ¡ï¼Œä½†ç†è§£ä¼¼ä¹åœç•™åœ¨åˆçº§é˜¶æ®µã€‚</p><h2 id="ğŸ’¡-å­¦ä¹ å±‚æ¬¡å‰–æ">ğŸ’¡ å­¦ä¹ å±‚æ¬¡å‰–æ</h2><p>å­¦ä¹ ç¼–ç¨‹è¯­è¨€å¯åˆ†ä¸ºä¸‰ä¸ªé€’è¿›å±‚æ¬¡ï¼š</p><ol><li>ğŸ“š åŸºç¡€è¯­æ³•æ ¸å¿ƒç±»åº“çš„ç†Ÿæ‚‰ä½¿ç”¨</li><li>ğŸŒ ä¼˜åŠ¿åŠ£åŠ¿åˆ†æä¸ç”Ÿæ€ç³»ç»Ÿäº†è§£</li><li>ğŸ”§ åº•å±‚è¿è¡Œæœºåˆ¶æ¢ç©¶ä¸åº”ç”¨ä¼˜åŒ–</li></ol><h2 id="ğŸ’»-Javaæ ¸å¿ƒ-JVM">ğŸ’» Javaæ ¸å¿ƒ -JVM</h2><p>Javaçš„æ ¸å¿ƒé­…åŠ›åœ¨äºJavaè™šæ‹Ÿæœºï¼ˆ<code>JVM</code>ï¼‰ï¼Œå®ƒæ˜¯è·¨å¹³å°æ‰§è¡ŒJavaå­—èŠ‚ç çš„å…³é”®ã€‚è¯¸å¦‚<code>Kotlin</code>,<code> Groovy</code>ã€<code>Scala</code>ç­‰å…¶ä»–åŸºäº<code>JVM</code>çš„è¯­è¨€ï¼Œé€šè¿‡æ·±å…¥ç†è§£<code>JVM</code>å¯ä»¥æ›´é«˜æ•ˆåœ°æŒæ¡ã€‚</p><h2 id="ğŸ“–-ç±»åŠ è½½æœºåˆ¶è¯¦è§£">ğŸ“– ç±»åŠ è½½æœºåˆ¶è¯¦è§£</h2><ul><li><strong>ç¼–è¯‘ä¸æ‰§è¡Œ</strong>ï¼šJavaæºä»£ç ç»è¿‡<code>javap</code>ç¼–è¯‘è½¬æ¢æˆ.classå­—èŠ‚ç æ–‡ä»¶ï¼Œç”±<code>JVM</code>åŠ è½½å¹¶è§£ææ‰§è¡Œï¼ŒåŒæ—¶å³æ—¶ç¼–è¯‘å™¨ï¼ˆ<code>JIT</code>ï¼‰ä¼šå°†çƒ­ç‚¹ä»£ç è½¬åŒ–ä¸ºé«˜æ•ˆçš„äºŒè¿›åˆ¶ä»£ç , é€šè¿‡è§£é‡Šå™¨å’Œå³æ—¶ç¼–è¯‘å™¨æƒ³ç»“åˆé¢„çƒ­åçš„ä»£ç å¯ä»¥è¾¾åˆ°å¾ˆå¿«çš„æ‰§è¡Œæ•ˆç‡</li></ul><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202401042313773.png" alt="image-20240104231254562"></p><ul><li><p><strong>ç±»åŠ è½½æµç¨‹</strong></p><ul><li><p><strong>åŠ è½½é˜¶æ®µ</strong>ï¼šåŠ è½½é˜¶æ®µçš„ä»»åŠ¡æ˜¯è¯»å–å­—èŠ‚ç èµ„æºä»¥é™æ€ç»“æ„çš„å½¢å¼å­˜å‚¨åœ¨æ–¹æ³•åŒºï¼ŒåŒæ—¶åœ¨å †ä¸­ç”Ÿæˆ<code>java.lang.Class</code>å¯¹è±¡ã€‚</p></li><li><p><strong>éªŒè¯é˜¶æ®µ</strong>ï¼šéªŒè¯é˜¶æ®µç”¨äºéªŒè¯å­—èŠ‚ç çš„åˆæ³•æ€§, ç¡®ä¿ç¨‹åºå®‰å…¨æ€§å’Œå®Œæ•´æ€§(åˆ†å¸ƒåœ¨å¤šä¸ªæ­¥éª¤ä¸­)</p></li><li><p><strong>å‡†å¤‡é˜¶æ®µ</strong>ï¼šå‡†å¤‡é˜¶æ®µä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®é»˜è®¤åˆå§‹å€¼ã€‚è¿™ä¸ºé™æ€å˜é‡çš„åˆå§‹åŒ–æä¾›äº†åŸºç¡€ã€‚</p></li><li><p><strong>è§£æé˜¶æ®µ</strong>ï¼šè§£æé˜¶æ®µå°†ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨(å¯ä»¥å‘ç”Ÿåœ¨åˆå§‹åŒ–é˜¶æ®µçš„å‰å)</p></li><li><p><strong>åˆå§‹åŒ–é˜¶æ®µ</strong>ï¼šåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œä¼šæ‰§è¡Œç±»ä¸­å®šä¹‰çš„é™æ€ä»£ç å—å’Œé™æ€å˜é‡çš„èµ‹å€¼æ“ä½œã€‚è¿™æ˜¯ç¨‹åºå‡†å¤‡è¿è¡Œçš„é‡è¦é˜¶æ®µã€‚</p></li></ul></li></ul><h3 id="ğŸ“¥-åŠ è½½">ğŸ“¥ <strong>åŠ è½½</strong></h3><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202401042339913.png" alt="image-20240104233940085"></p><p>åŠ è½½é˜¶æ®µæ˜¯ç±»åŠ è½½çš„ç¬¬ä¸€ä¸ªé˜¶æ®µ,è¿™ä¸ªé˜¶æ®µçš„ä»»åŠ¡æ˜¯</p><p><strong>è¯»å–<code>Class</code>èµ„æº</strong>, ä»¥<strong>é™æ€æ•°æ®ç»“æ„</strong>çš„å½¢å¼å­˜å‚¨åœ¨<strong>æ–¹æ³•åŒº</strong>ï¼ŒåŒæ—¶åœ¨<strong>å †</strong>ä¸­ç”Ÿæˆ**<code>java.lang.Class</code>å¯¹è±¡**ä¾›ç¨‹åºè°ƒç”¨.</p><p>æ­¤å¤„**<code>Classæ–‡ä»¶</code>**ä¸åªæ˜¯æœ¬åœ°æ–‡ä»¶, æ³›æŒ‡å„ç§äºŒè¿›åˆ¶æµ, ä¸é™äº ç½‘ç»œ, æ•°æ®åº“,ä»¥åŠå³æ—¶ç”Ÿæˆçš„Classæ–‡ä»¶(ä¾‹å¦‚åŠ¨æ€ä»£ç†)</p><h3 id="ğŸ”—-è¿æ¥">ğŸ”— è¿æ¥</h3><h4 id="ğŸ”-éªŒè¯">ğŸ” <strong>éªŒè¯</strong></h4><p>éªŒè¯é˜¶æ®µæ˜¯è¿æ¥é˜¶æ®µçš„ä¸€éƒ¨åˆ†ã€‚</p><p>éªŒè¯é˜¶æ®µå…¶å®åˆ†å¸ƒåœ¨å„ä¸ªé˜¶æ®µä¸­</p><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202401042313773.png" alt="image-20240104231254562"></p><p>å…¶ä¸­, åœ¨åŠ è½½æœŸé—´å°±ä¼šè¿›è¡Œ <strong>Classæ–‡ä»¶æ ¼å¼éªŒè¯</strong></p><p>æ­¤æ—¶ è™½ç„¶æ–¹æ³•åŒºå·²ç»å­˜åœ¨ç±»çš„é™æ€ç»“æ„, å †ä¸­å­˜åœ¨ç±»çš„Classå¯¹è±¡ä½†æ˜¯å¹¶ä¸ä»£è¡¨<code>JVM</code>å®Œå…¨è®¤å¯è¿™ä¸ªç±»</p><p>ç¨‹åºå¦‚æœæƒ³è¦ä½¿ç”¨è¿™ä¸ªç±», å°±å¿…é¡»è¿›è¡Œè¿æ¥, è€Œ<strong>è¿æ¥çš„ç¬¬ä¸€æ­¥</strong>å°±æ˜¯å¯¹ç±»è¿›è¡ŒéªŒè¯, åŒ…æ‹¬</p><ul><li>å…ƒæ•°æ®éªŒè¯</li><li>å­—èŠ‚ç éªŒè¯</li></ul><p>ç®€å•æ¦‚æ‹¬æ¥è¯´å°±æ˜¯å¯¹<strong>classé™æ€ç»“æ„</strong>è¿›è¡Œ<strong>è¯­æ³•å’Œè¯­ä¹‰</strong>ä¸Šçš„åˆ†æä¿è¯å…¶ä¸ä¼šäº§ç”Ÿå±å®³è™šæ‹Ÿæœºçš„</p><p>å¦‚æœä¸¤ä¸ªéªŒè¯ç»“æŸ, é‚£ä¹ˆè™šæ‹Ÿæœºä¼š<strong>å§‘ä¸”</strong>è®¤ä¸ºè¯¥ç±»æ˜¯å®‰å…¨çš„, ä½†æ˜¯è¿™å¹¶ä¸æ„å‘³ç€éªŒè¯çš„ç»“æŸ, åœ¨è§£æé˜¶æ®µ, è¿˜ä¼šè¿›è¡Œ<strong>ç¬¦å·å¼•ç”¨çš„éªŒè¯</strong></p><p>æ‰€ä»¥è¯´éªŒè¯å…¶å®å¯ä»¥åˆ†å¾ˆå¤šä¸ªæ­¥éª¤, åˆ†åˆ«åœ¨ä¸åŒçš„é˜¶æ®µæ‰§è¡Œ, éªŒè¯é˜¶æ®µæ˜¯ä¸æ–­è¿­ä»£çš„, <strong>éšç€<code>JDK</code>çš„è¿­ä»£</strong>, <strong>ä»¥å</strong>è™šæ‹Ÿæœºå¼€å‘äººå‘˜è¿˜ä¼šå†è™šæ‹Ÿæœºä¸­å¼•å…¥<strong>æ›´å¤šæ›´å®Œå–„çš„éªŒè¯ç­–ç•¥</strong></p><h4 id="âš™ï¸-å‡†å¤‡">âš™ï¸ <strong>å‡†å¤‡</strong></h4><p>å‡†å¤‡é˜¶æ®µæ˜¯è¿æ¥é˜¶æ®µçš„å¦ä¸€éƒ¨åˆ†ã€‚</p><p>åœ¨å‡†å¤‡é˜¶æ®µï¼Œ<code>JVM</code>ä¸ºç±»ä¸­çš„<strong>é™æ€å˜é‡</strong>åˆ†é…å†…å­˜å¹¶è®¾ç½®é»˜è®¤åˆå§‹å€¼</p><p>è¿™é‡Œ<strong>åªåŒ…æ‹¬é™æ€å˜é‡</strong>ï¼Œä¸åŒ…æ‹¬æˆå‘˜å˜é‡ã€‚</p><h4 id="ğŸ‘‰-è§£æ">ğŸ‘‰ <strong>è§£æ</strong></h4><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202401050012740.png" alt="image-20240104235310370"></p><p>è§£æé˜¶æ®µæ˜¯è¿æ¥é˜¶æ®µçš„æœ€åä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ã€‚</p><p>é¦–å…ˆè¦æ˜ç¡®åœ¨Javaä¸­ <strong>ç¬¦å·å¼•ç”¨</strong>å’Œ<strong>ç›´æ¥å¼•ç”¨</strong>è¿™ä¸¤ä¸ªç›¸å…³çš„æ¦‚å¿µã€‚</p><p>ç¬¦å·å¼•ç”¨æ˜¯åœ¨<strong>ç¼–è¯‘æœŸé—´</strong>ä½¿ç”¨çš„ä¸€ç§ç¬¦å·è¡¨ç¤ºæ–¹å¼ï¼Œå®ƒç”¨æ¥è¡¨ç¤º<strong>éœ€è¦å¼•ç”¨çš„ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰å®ä½“</strong>ã€‚ç¬¦å·å¼•ç”¨å¹¶<strong>ä¸åŒ…å«å…·ä½“çš„å†…å­˜åœ°å€</strong>ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å…¶ä»–<strong>æ ‡è¯†</strong>æ¥è¡¨ç¤ºã€‚</p><p>ç›´æ¥å¼•ç”¨æ˜¯åœ¨<strong>è¿è¡ŒæœŸé—´</strong>ä½¿ç”¨çš„ä¸€ç§å¼•ç”¨æ–¹å¼ï¼Œå®ƒåŒ…å«<strong>å®é™…çš„å†…å­˜åœ°å€æˆ–åç§»é‡</strong>ï¼Œå¯ä»¥<strong>ç›´æ¥è®¿é—®</strong>å¯¹åº”çš„ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰å®ä½“ã€‚</p><p>åœ¨<strong>ç¼–è¯‘é˜¶æ®µ</strong>ï¼Œå¦‚æœä¸€ä¸ªç±»Aå¼•ç”¨äº†å¦ä¸€ä¸ªç±»Bï¼Œç”±äºBå¯èƒ½è¿˜æœªè¢«ç¼–è¯‘æˆ–åŠ è½½ï¼Œæ‰€ä»¥Aæ— æ³•çŸ¥é“Bçš„å®é™…åœ°å€ã€‚å› æ­¤ï¼Œåœ¨Açš„classæ–‡ä»¶ä¸­ä¼šä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²Sæ¥ä»£è¡¨Bçš„åœ°å€ï¼ŒSå°±è¢«ç§°ä¸ºç¬¦å·å¼•ç”¨ã€‚</p><p>åœ¨è¿è¡Œæ—¶ï¼Œå¦‚æœAè¢«åŠ è½½å¹¶è¿›è¡Œè§£æé˜¶æ®µï¼Œå‘ç°Bè¿˜æœªè¢«åŠ è½½ï¼Œåˆ™ä¼šè§¦å‘Bçš„åŠ è½½è¿‡ç¨‹ï¼Œå°†BåŠ è½½åˆ°è™šæ‹Ÿæœºä¸­ã€‚æ­¤æ—¶ï¼ŒAä¸­Bçš„ç¬¦å·å¼•ç”¨å°†è¢«æ›¿æ¢æˆBçš„å®é™…åœ°å€ï¼Œå³ç›´æ¥å¼•ç”¨ã€‚è¿™æ ·ï¼ŒAå°±èƒ½å¤ŸçœŸæ­£åœ°è°ƒç”¨Bäº†ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºå¤šæ€çš„æƒ…å†µï¼ŒJavaé€šè¿‡åæœŸç»‘å®šæ¥å®ç°ã€‚å¦‚æœAè°ƒç”¨çš„Bæ˜¯ä¸€ä¸ªå…·ä½“çš„å®ç°ç±»ï¼Œè¿™è¢«ç§°ä¸º<strong>é™æ€è§£æ</strong>ï¼Œå› ä¸ºè§£æçš„ç›®æ ‡ç±»å¾ˆæ˜ç¡®ã€‚</p><p>ä½†å¦‚æœBæ˜¯ä¸€ä¸ª<strong>æŠ½è±¡ç±»æˆ–æ¥å£</strong>ï¼Œå®ƒå¯èƒ½æœ‰<strong>å¤šä¸ªå…·ä½“çš„å®ç°ç±»</strong>ã€‚æ­¤æ—¶ï¼ŒBçš„å…·ä½“å®ç°å¹¶ä¸æ˜ç¡®ï¼Œæ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸ªå…·ä½“ç±»çš„ç›´æ¥å¼•ç”¨è¿›è¡Œæ›¿æ¢ã€‚åœ¨<strong>è¿è¡Œè¿‡ç¨‹</strong>ä¸­ï¼Œå½“å‘ç”Ÿäº†è°ƒç”¨æ—¶ï¼Œè™šæ‹Ÿæœºè°ƒç”¨æ ˆä¸­å°†ä¼šå¾—åˆ°å…·ä½“çš„ç±»å‹ä¿¡æ¯ï¼Œæ­¤æ—¶å¯ä»¥è¿›è¡Œè§£æï¼Œä½¿ç”¨æ˜ç¡®çš„ç›´æ¥å¼•ç”¨æ¥æ›¿æ¢ç¬¦å·å¼•ç”¨, è¿™å°±æ˜¯<strong>åŠ¨æ€è§£æ</strong>ã€‚</p><p>å› æ­¤ï¼Œè§£æé˜¶æ®µæœ‰æ—¶ä¼šå‘ç”Ÿåœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒåŠ¨æ€è§£æçš„éœ€è¦</p><h3 id="ğŸš€-åˆå§‹åŒ–">ğŸš€ <strong>åˆå§‹åŒ–</strong></h3><p>åˆå§‹åŒ–é˜¶æ®µæ˜¯ç±»åŠ è½½çš„æœ€åä¸€ä¸ªé˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œä¼šæ‰§è¡Œç±»ä¸­å®šä¹‰çš„<strong>é™æ€ä»£ç å—å’Œæˆå‘˜å˜é‡çš„èµ‹å€¼æ“ä½œ</strong>ï¼Œå³æ‰§è¡Œ<strong>ä¸»åŠ¨èµ„æºåˆå§‹åŒ–åŠ¨ä½œ</strong>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè°ƒç”¨<strong>æ„é€ æ–¹æ³•ä¸åœ¨è¿™ä¸ªé˜¶æ®µ</strong>, è¿™æ˜¯<strong>ç±»é˜¶æ®µ</strong>çš„åˆå§‹åŒ–, åªæœ‰æ˜¾å¼è°ƒç”¨newæŒ‡ä»¤æ‰ä¼šè°ƒç”¨æ„é€ å‡½æ•°è¿›è¡Œå¯¹è±¡å®ä¾‹åŒ–ï¼Œè¿™æ˜¯å¯¹è±¡å±‚é¢çš„åˆå§‹åŒ–ã€‚</p><h2 id="âœ¨-ç»“è®º">âœ¨ ç»“è®º</h2><p>æ·±å…¥ç†è§£Javaç±»åŠ è½½æœºåˆ¶æ˜¯æå‡JavaæŠ€æœ¯æ ˆçš„é‡è¦ä¸€ç¯ã€‚ä»ç¼–å†™ä»£ç åˆ°åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œèµ·æ¥ï¼Œ<code>JVM</code>åœ¨å…¶ä¸­æ‰®æ¼”äº†è‡³å…³é‡è¦çš„è§’è‰²ã€‚</p><p>æ¯ä¸ªé˜¶æ®µéƒ½æœ‰å…¶ç‹¬ç‰¹ç›®çš„å’ŒåŠŸèƒ½ï¼Œè€ŒæŒæ¡è¿™ä¸€è¿‡ç¨‹ä¸ä»…èƒ½åº”å¯¹é¢è¯•è€ƒç‚¹ï¼Œæ›´èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­è§£å†³å¤æ‚é—®é¢˜ï¼Œå……åˆ†åˆ©ç”¨Javaçš„<strong>åŠ¨æ€æ‰©å±•æ€§</strong>å’Œ<strong>æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§</strong>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç±»åŠ è½½æœºåˆ¶ </tag>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹ç¾----èŒè´£é“¾æ¨¡å¼</title>
      <link href="/posts/22915.html"/>
      <url>/posts/22915.html</url>
      
        <content type="html"><![CDATA[<h1>è®¾è®¡æ¨¡å¼ä¹‹ç¾----èŒè´£é“¾æ¨¡å¼</h1><p>æœ¬æ–‡å°†å¯¹è´£ä»»é“¾æ¨¡å¼(èŒè´£é“¾æ¨¡å¼)åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†è¿›è¡Œè®²è§£</p><ul><li>åŸç†</li><li>å®ç°</li><li>åº”ç”¨</li><li>ç»ƒä¹ </li></ul><p>è®©å¤§å®¶ç³»ç»Ÿå…¨é¢çš„å­¦ä¼šä½¿ç”¨è´£ä»»é“¾æ¨¡å¼, å¹¶åº”ç”¨åˆ°å¼€å‘ä¸­å»</p><h2 id="åŸç†ç¯‡">åŸç†ç¯‡</h2><blockquote><p>å¤§éƒ¨åˆ†è®¾è®¡æ¨¡å¼çš„æ ¸å¿ƒæ˜¯åº”å¯¹å·¥ç¨‹ä¸­çš„å¤æ‚æ€§, ä½¿å¾—ä»£ç æ»¡è¶³å¼€é—­åŸåˆ™,  æé«˜ä»£ç æ‰©å±•æ€§</p></blockquote><p>èŒè´£é“¾çš„è‹±æ–‡åä¸º<code>Chain Of Responsibility Design Pattern</code>, åœ¨GoFçš„è®¾è®¡æ¨¡å¼ä¸­çš„å®šä¹‰å¦‚ä¸‹</p><blockquote><p>Avoid coupling the sender of a request to its receiver by giving more than one object a chance to handle the request. Chain the receiving objects and pass the request along the chain until an object handles it.</p></blockquote><p>â€‹â€œå°†è¯·æ±‚çš„å‘é€å’Œæ¥æ”¶è§£è€¦ï¼Œè®©å¤šä¸ªæ¥æ”¶å¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚å°†è¿™äº›æ¥æ”¶å¯¹è±¡ä¸²æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¿™ä¸ªè¯·æ±‚ï¼Œç›´åˆ°é“¾ä¸Šçš„æŸä¸ªæ¥æ”¶å¯¹è±¡èƒ½å¤Ÿå¤„ç†å®ƒä¸ºæ­¢ã€‚â€</p><p>â€‹å®é™…ä¸Šå°±æ˜¯å°†<code>è¯·æ±‚</code>é€šè¿‡ç±»ä¼¼é“¾è¡¨çš„ç»“æ„, é€šè¿‡ç»“ç‚¹å¤„ç†å¹¶çº¿æ€§çš„ä¼ é€’ä¸‹å»,ç›´åˆ°è¯·æ±‚å®Œæˆæˆ–è€…æ²¡æœ‰ä¸‹ä¸€ä¸ªç»“ç‚¹</p><p>â€‹è¿™é‡Œçš„ç»“ç‚¹æ˜¯æŒ‡å•ä¸ªå¤„ç†è¯·æ±‚çš„å¯¹è±¡, æ¥å—ä¸Šä¸€ä¸ªç»“ç‚¹å¤„ç†åçš„ç»“æœå¹¶åœ¨å¤„ç†å, ä¼ é€’ç»™ä¸‹ä¸€ä¸ªç»“ç‚¹æˆ–è€…è¯·æ±‚å®Œæˆç»“æŸå¤„ç†, å› ä¸ºæ¯ä¸ªç»“ç‚¹éƒ½æ‰¿æ‹…ç€ç»†ç²’åº¦çš„èŒè´£, æ‰€ä»¥ç§°ä¸º<code>è´£ä»»é“¾æ¨¡å¼</code></p><h2 id="å®ç°ç¯‡">å®ç°ç¯‡</h2><p>â€‹</p><p>â€‹è®¾è®¡æ¨¡å¼çš„å®ç°å¾€å¾€å¤šç§å¤šæ ·, å¯èƒ½å› ä¸ºè¯­è¨€ç‰¹æ€§(æšä¸¾å•ä¾‹)ä¹Ÿå¯èƒ½å› ä¸ºç®—æ³•(è¿­ä»£æˆ–è€…é€’å½’),ä½¿å¾—ä»£ç ç»“æ„å„å¼‚, ä½†æ ¸å¿ƒæ€æƒ³æ˜¯ä¸ä¼šå˜å¾—, ä¹‹åçš„è®¾è®¡æ¨¡å¼, æˆ‘éƒ½ä¼šä»¥Javaä¸ºä¾‹åšå‡ºå®ç°, å› ä¸ºJavaç®—æ˜¯æ¯”è¾ƒå…¸å‹ä¸”çº¯ç²¹çš„é¢å‘å¯¹è±¡ç¼–ç¨‹, å…¶ä»–è¯­è¨€çš„åŒå­¦å¯ä»¥å€ŸåŠ©chatgptè½¬è¯­è¨€æ¥ç†è§£, æœ¬è´¨æ˜¯ä¸€æ ·çš„</p><p>â€‹èŒè´£é“¾æ¨¡å¼çš„å®ç°åˆ†ä¸ºä¸‰ä¸ªç»“æ„, åˆ†åˆ«æ˜¯æŠ½è±¡å¤„ç†å™¨ç±»(Handler), å¤„ç†å™¨ç±»(XXXHandler), ä»¥åŠå¤„ç†é“¾(HandlerChain)</p><p><strong>æŠ½è±¡å¤„ç†å™¨ç±»(Handler)</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¤„ç†å™¨çš„æŠ½è±¡ç±», å®šä¹‰å¤„ç†å™¨ç»“æ„, æ–¹ä¾¿ååºæ‰©å±•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªå¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">Handler</span> <span class="variable">successor</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æŠ½è±¡å¤„ç†æ–¹æ³•, å…·ä½“å¤„ç†å™¨å®ç°æ­¤æ–¹æ³•,å¤„ç†è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSuccessor</span><span class="params">(Handler successor)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.successor = successor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤„ç†å™¨ç±»(XXXHandler)</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerA</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦åœ¨è¯¥å¤„ç†å™¨å¤„ç†å®Œæˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//.....å¤„ç†é€»è¾‘</span></span><br><span class="line">      </span><br><span class="line">    <span class="comment">//å¦‚æœè¯·æ±‚åœ¨å½“å‰å¤„ç†å™¨å¤„ç†å®Œæˆæˆ–è€…å½“å‰å¤„ç†å™¨æ˜¯è´£ä»»é“¾ä¸Šæœ€åä¸€ä¸ªå¤„ç†å™¨, åœæ­¢ä¼ é€’</span></span><br><span class="line">    <span class="keyword">if</span> (!handled &amp;&amp; successor != <span class="literal">null</span>) &#123;</span><br><span class="line">      successor.handle();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerB</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦åœ¨è¯¥å¤„ç†å™¨å¤„ç†å®Œæˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//.....å¤„ç†é€»è¾‘</span></span><br><span class="line">      </span><br><span class="line">    <span class="comment">//å¦‚æœè¯·æ±‚åœ¨å½“å‰å¤„ç†å™¨å¤„ç†å®Œæˆæˆ–è€…å½“å‰å¤„ç†å™¨æ˜¯è´£ä»»é“¾ä¸Šæœ€åä¸€ä¸ªå¤„ç†å™¨, åœæ­¢ä¼ é€’</span></span><br><span class="line">    <span class="keyword">if</span> (!handled &amp;&amp; successor != <span class="literal">null</span>) &#123;</span><br><span class="line">      successor.handle();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤„ç†é“¾(HandlerChain)</strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerChain</span> &#123;</span><br><span class="line">    <span class="comment">//é€šè¿‡å¤´å°¾ä¸¤ä¸ªåº”ç”¨è®°å½•å¤„ç†é“¾ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">Handler</span> <span class="variable">head</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Handler</span> <span class="variable">tail</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åœ¨å¤„ç†é“¾å°¾éƒ¨å¢åŠ å¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addHandler</span><span class="params">(Handler handler)</span> &#123;</span><br><span class="line">        handler.setSuccessor(<span class="literal">null</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == head) &#123;</span><br><span class="line">            head = handler;</span><br><span class="line">            tail = handler;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¿è¯å°¾éƒ¨æ°¸è¿œæŒ‡å‘æœ€åä¸€ä¸ªå¤„ç†å™¨</span></span><br><span class="line">        tail.setSuccessor(handler);</span><br><span class="line">        tail = handler;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HyuanandlerChain</span> <span class="variable">chain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HandlerChain</span>();</span><br><span class="line">        chain.addHandler(<span class="keyword">new</span> <span class="title class_">HandlerA</span>());</span><br><span class="line">        chain.addHandler(<span class="keyword">new</span> <span class="title class_">HandlerB</span>());</span><br><span class="line">        chain.handle();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»å…¸GoFçš„å®ç°ä¸å¤Ÿä¼˜é›…, å¤„ç†å™¨ç±»ä¸­çš„handle()å‡½æ•°ä¸ä»…åŒ…å«ä¸šåŠ¡é€»è¾‘, è¿˜æœ‰å¯¹ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„è°ƒç”¨, å¯¹äºä¸ç†Ÿæ‚‰ä»£ç ç»“æ„çš„ç¨‹åºå‘˜,åœ¨æ·»åŠ å¤„ç†å™¨è°ƒç”¨æ—¶å¯èƒ½å¿˜è®°è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨, å¯èƒ½ä¼šå¯¼è‡´bug, æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¿›è¡Œé‡æ„(è®©æˆ‘æƒ³èµ·Springæºç ä¸­AbstractBeanFactoryä¸­çš„doGetBean()æ–¹æ³•), å°†ä¸‹ä¸€ä¸ªå¤„ç†å™¨è°ƒç”¨çš„é€»è¾‘æŠ½è±¡åˆ°æ¨¡æ¿ä¸­</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">protected</span> <span class="type">Handler</span> <span class="variable">successor</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSuccessor</span><span class="params">(Handler successor)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.successor = successor;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ¨¡æ¿æ–¹æ³•,å°†å¤„ç†å™¨è°ƒç”¨é€»è¾‘æŠ½è±¡æˆä¸€ä¸ªfinalæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> doHandle();</span><br><span class="line">    <span class="keyword">if</span> (successor != <span class="literal">null</span> &amp;&amp; !handled) &#123;</span><br><span class="line">      successor.handle();</span><br><span class="line">    &#125;   </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ¨¡æ¿æ–¹æ³•çš„æ‰©å±•ç‚¹,è®©å­ç±»å…·ä½“å¤„ç†å™¨å®ç°å¤„ç†è¯·æ±‚çš„é€»è¾‘</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">doHandle</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerA</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">doHandle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerB</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">doHandle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// HandlerChainå’ŒApplicationä»£ç ä¸å˜</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°è´£ä»»é“¾æ¨¡å¼æœ¬è´¨å°±æ˜¯å°†è¯·æ±‚ <code>çº¿æ€§ä¼ é€’</code>åˆ°æ¯ä¸ªå¤„ç†é€»è¾‘ä¸Šè¿›è¡Œå¤„ç†ç›´åˆ°æŸä¸ªç»“ç‚¹å¤„ç†æˆåŠŸæˆ–è€…èŒè´£é“¾åˆ°å¤´</p><p>æ—¢ç„¶æ˜¯çº¿æ€§ç»“æ„,æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨æ•°ç»„æ¥å®ç°è´£ä»»é“¾æ¨¡å¼, è¿™ç§æ–¹å¼æ›´åŠ ç®€å•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ•°ç»„å®ç°çš„è¯,å°†ä¼ é€’çš„é€»è¾‘æ”¾åˆ°äº†HandlerChainä¸­, åªéœ€è¦å®ç°handleé€»è¾‘å³å¯</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IHandler</span> &#123;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">handle</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerA</span> <span class="keyword">implements</span> <span class="title class_">IHandler</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//...å¤„ç†å™¨å¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="comment">//è¿”å›æ˜¯å¦å¤„ç†å®Œæˆ</span></span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerB</span> <span class="keyword">implements</span> <span class="title class_">IHandler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//...å¤„ç†å™¨å¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="comment">//è¿”å›æ˜¯å¦å¤„ç†å®Œæˆ</span></span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerChain</span> &#123;</span><br><span class="line">  <span class="comment">//é€šè¿‡åŠ¨æ€æ•°ç»„å­˜å‚¨æ¯ä¸ªå¤„ç†å™¨</span></span><br><span class="line">  <span class="keyword">private</span> List&lt;IHandler&gt; handlers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">  <span class="comment">//åœ¨æ•°ç»„ä¸­æ·»åŠ å¤„ç†å™¨</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addHandler</span><span class="params">(IHandler handler)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.handlers.add(handler);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//è¿­ä»£è°ƒç”¨å¤„ç†å™¨çš„å¤„ç†æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (IHandler handler : handlers) &#123;</span><br><span class="line">      <span class="type">boolean</span> <span class="variable">handled</span> <span class="operator">=</span> handler.handle();</span><br><span class="line">      <span class="comment">//å¦‚æœåœ¨ä¸­é—´æŸä¸ªå¤„ç†å™¨ä¸­å¤„ç†å®Œæˆ, æå‰ç»“æŸè¿­ä»£, ä¸è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨</span></span><br><span class="line">      <span class="keyword">if</span> (handled) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">HandlerChain</span> <span class="variable">chain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HandlerChain</span>();</span><br><span class="line">    chain.addHandler(<span class="keyword">new</span> <span class="title class_">HandlerA</span>());</span><br><span class="line">    chain.addHandler(<span class="keyword">new</span> <span class="title class_">HandlerB</span>());</span><br><span class="line">    chain.handle();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ GoF ç»™å‡ºçš„å®šä¹‰ä¸­ï¼Œå¦‚æœå¤„ç†å™¨é“¾ä¸Šçš„æŸä¸ªå¤„ç†å™¨èƒ½å¤Ÿå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œé‚£å°±ä¸ä¼šç»§ç»­å¾€ä¸‹ä¼ é€’è¯·æ±‚ã€‚å®é™…ä¸Šï¼ŒèŒè´£é“¾æ¨¡å¼è¿˜æœ‰ä¸€ç§å˜ä½“ï¼Œé‚£å°±æ˜¯è¯·æ±‚ä¼šè¢«æ‰€æœ‰çš„å¤„ç†å™¨éƒ½å¤„ç†ä¸€éï¼Œä¸å­˜åœ¨ä¸­é€”ç»ˆæ­¢çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®ç°ä¸­çœç•¥boolean handled = false;å³å¯</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="type">Handler</span> <span class="variable">successor</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSuccessor</span><span class="params">(Handler successor)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.successor = successor;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ä¸éœ€è¦è¿”å›booleanäº†</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    doHandle();</span><br><span class="line">    <span class="keyword">if</span> (successor != <span class="literal">null</span>) &#123;</span><br><span class="line">      successor.handle();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">doHandle</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">()</span> &#123;</span><br><span class="line">    doHandle();</span><br><span class="line">    <span class="keyword">if</span> (successor != <span class="literal">null</span>) &#123;</span><br><span class="line">      successor.handle();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‚ç…§&lt;&lt;è®¾è®¡æ¨¡å¼ä¹‹ç¾&gt;&gt;ä¸­, çµæ´»æ‰©å±•ç®—æ³•çš„æ•æ„Ÿè¯è¿‡æ»¤æ¡†æ¶æ¥è®²</p><blockquote><p>å¯¹äºæ”¯æŒ UGCï¼ˆUser Generated Contentï¼Œç”¨æˆ·ç”Ÿæˆå†…å®¹ï¼‰çš„åº”ç”¨ï¼ˆæ¯”å¦‚è®ºå›ï¼‰æ¥è¯´ï¼Œç”¨æˆ·ç”Ÿæˆçš„å†…å®¹ï¼ˆæ¯”å¦‚ï¼Œåœ¨è®ºå›ä¸­å‘è¡¨çš„å¸–å­ï¼‰å¯èƒ½ä¼šåŒ…å«ä¸€äº›æ•æ„Ÿè¯ï¼ˆæ¯”å¦‚æ¶‰é»„ã€å¹¿å‘Šã€ååŠ¨ç­‰è¯æ±‡ï¼‰ã€‚é’ˆå¯¹è¿™ä¸ªåº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨èŒè´£é“¾æ¨¡å¼æ¥è¿‡æ»¤è¿™äº›æ•æ„Ÿè¯ã€‚</p><p>å¯¹äºåŒ…å«æ•æ„Ÿè¯çš„å†…å®¹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ç¦æ­¢å‘å¸ƒï¼Œå¦ä¸€ç§æ˜¯ç»™æ•æ„Ÿè¯æ‰“é©¬èµ›å…‹ï¼ˆæ¯”å¦‚ï¼Œç”¨ *** æ›¿æ¢æ•æ„Ÿè¯ï¼‰ä¹‹åå†å‘å¸ƒã€‚ç¬¬ä¸€ç§å¤„ç†æ–¹å¼ç¬¦åˆ GoF ç»™å‡ºçš„èŒè´£é“¾æ¨¡å¼çš„å®šä¹‰ï¼Œç¬¬äºŒç§å¤„ç†æ–¹å¼æ˜¯èŒè´£é“¾æ¨¡å¼çš„å˜ä½“ã€‚</p></blockquote><p>ç¬¬ä¸€ç§</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line">  </span><br><span class="line">   <span class="type">boolean</span> <span class="title function_">doFilter</span><span class="params">(Content content)</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶‰é»„è¯è¿‡æ»¤,  PoliticalWordFilterã€AdsWordFilterç±»ä»£ç ç»“æ„ä¸SexyWordFilterç±»ä¼¼,çœç•¥äº†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SexyWordFilter</span> <span class="keyword">implements</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">doFilter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">legal</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">return</span> legal;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•æ„Ÿè¯è¿‡æ»¤é“¾</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SensitiveWordFilterChain</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">private</span> List&lt;SensitiveWordFilter&gt; filters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFilter</span><span class="params">(SensitiveWordFilter filter)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.filters.add(filter);</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// å¦‚æœä¸åŒ…å«æ•æ„Ÿè¯åˆ™è¿”å›ture</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">filter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">for</span> (SensitiveWordFilter filter : filters) &#123;</span><br><span class="line">        </span><br><span class="line">      <span class="keyword">if</span> (!filter.doFilter(content)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationDemo</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">SensitiveWordFilterChain</span> <span class="variable">filterChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SensitiveWordFilterChain</span>();</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">AdsWordFilter</span>());</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">SexyWordFilter</span>());</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">PoliticalWordFilter</span>());</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">legal</span> <span class="operator">=</span> filterChain.filter(<span class="keyword">new</span> <span class="title class_">Content</span>());</span><br><span class="line">    <span class="keyword">if</span> (!legal) &#123;</span><br><span class="line">      <span class="comment">// ä¸å‘è¡¨</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å‘è¡¨</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(Content content)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶‰é»„è¯è¿‡æ»¤,  PoliticalWordFilterã€AdsWordFilterç±»ä»£ç ç»“æ„ä¸SexyWordFilterç±»ä¼¼,çœç•¥äº†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SexyWordFilter</span> <span class="keyword">implements</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">      </span><br><span class="line">        <span class="comment">//..... æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¶‰é»„æ•æ„Ÿè¯,å­˜åœ¨åˆ™ç”¨***æ›¿æ¢æ•æ„Ÿè¯</span></span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SensitiveWordFilterChain</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">private</span> List&lt;SensitiveWordFilter&gt; filters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFilter</span><span class="params">(SensitiveWordFilter filter)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.filters.add(filter);</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">filter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">for</span> (SensitiveWordFilter filter : filters) &#123;</span><br><span class="line">      <span class="comment">//å¦‚æœè¿”å›ä¸ºtrue,è¯´æ˜ä¸­é—´å¤„ç†å™¨å‘ç°æ•æ„Ÿè¯è¿”å›true,è¿™ç§æƒ…å†µç›´æ¥ç»“æŸååºå¾ªç¯</span></span><br><span class="line">     filter.doFilter(content)</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œæˆ‘åƒä¸‹é¢è¿™æ ·ä¹Ÿå¯ä»¥å®ç°æ•æ„Ÿè¯è¿‡æ»¤åŠŸèƒ½ï¼Œè€Œä¸”ä»£ç æ›´åŠ ç®€å•ï¼Œä¸ºä»€ä¹ˆéè¦ä½¿ç”¨èŒè´£é“¾æ¨¡å¼å‘¢ï¼Ÿè¿™æ˜¯ä¸æ˜¯è¿‡åº¦è®¾è®¡å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line">  <span class="comment">// return true if content doesn&#x27;t contain sensitive words.</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">filter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!filterSexyWord(content)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!filterAdsWord(content)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!filterPoliticalWord(content)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">filterSexyWord</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">filterAdsWord</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">filterPoliticalWord</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹åº”ç”¨è®¾è®¡æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†åº”å¯¹ä»£ç çš„å¤æ‚æ€§ï¼Œè®©å…¶æ»¡è¶³å¼€é—­åŸåˆ™ï¼Œæé«˜ä»£ç çš„æ‰©å±•æ€§ã€‚è¿™é‡Œåº”ç”¨èŒè´£é“¾æ¨¡å¼ä¹Ÿä¸ä¾‹å¤–</p><p><strong>é¦–å…ˆ, æˆ‘ä»¬æ¥çœ‹, èŒè´£é“¾æ¨¡å¼å¦‚ä½•åº”å¯¹ä»£ç çš„å¤æ‚æ€§</strong></p><p>å°†å¤§çš„ä»£ç é€»è¾‘æ‹†åˆ†æˆå‡½æ•°, å°†å¤§ç±»æ‹†åˆ†æˆå°ç±», æ˜¯åº”å¯¹ä»£ç å¤æ‚æ€§çš„å¸¸ç”¨æ–¹æ³•, èŒè´£é“¾æ¨¡å¼ä¸­,æˆ‘ä»¬æŠŠå„ä¸ªæ•æ„Ÿè¯è¿‡æ»¤å‡½æ•°ç»§ç»­æ‹†åˆ†æˆç‹¬ç«‹çš„ç±», è¿›ä¸€æ­¥ç®€åŒ–äº†SensitiveWordFilterç±», è®©SenesitiveWordFilterç±»çš„ä»£ç ä¸ä¼šè¿‡å¤š, è¿‡å¤æ‚.</p><p><strong>å…¶æ¬¡, æˆ‘ä»¬æ¥çœ‹, èŒè´£é“¾æ¨¡å¼å¦‚ä½•è®©ä»£ç æ»¡è¶³å¼€é—­åŸåˆ™, æé«˜ä»£ç çš„æ‰©å±•æ€§</strong></p><p>å½“æˆ‘ä»¬è€ƒè™‘æ‰©å±•æ–°çš„è¿‡æ»¤ç®—æ³•çš„æ—¶å€™, æ¯”å¦‚, æˆ‘ä»¬è¿˜éœ€è¦è¿‡æ»¤ç‰¹æ®Šç¬¦å·, æŒ‰ç…§éèŒè´£é“¾æ¨¡å¼çš„ä»£ç å®ç°,æˆ‘ä»¬éœ€è¦ä¿®æ”¹SensitiveWordFilterçš„ä»£ç , è¿åå¼€é—­åŸåˆ™, ä¸è¿‡, è¿™æ ·çš„ä¿®æ”¹æ¯”è¾ƒé›†ä¸­,è¿˜å¯ä»¥æ¥å—çš„, è€ŒèŒè´£é“¾æ¨¡å¼çš„å®ç°æ–¹æ³•æ›´åŠ ä¼˜é›…, åªéœ€è¦æ–°æ·»åŠ ä¸€ä¸ªFilterç±», å¹¶ä¸”é€šè¿‡addFilter()å‡½æ•°å°†ä»–æ·»åŠ åˆ°FilterChainä¸­å³å¯, å…¶ä»–ä»£ç å®Œå…¨ä¸éœ€è¦ä¿®æ”¹</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œå³ä¾¿ä½¿ç”¨èŒè´£é“¾æ¨¡å¼æ¥å®ç°ï¼Œå½“æ·»åŠ æ–°çš„è¿‡æ»¤ç®—æ³•çš„æ—¶å€™ï¼Œè¿˜æ˜¯è¦ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ï¼ˆApplicationDemoï¼‰ï¼Œè¿™æ ·åšä¹Ÿæ²¡æœ‰å®Œå…¨ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//å®ç°ä¸€ä¸ªæ–°çš„å¤„ç†å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NewWordFilter</span> <span class="keyword">implements</span> <span class="title class_">SensitiveWordFilter</span> &#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">doFilter</span><span class="params">(Content content)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">legal</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">   <span class="keyword">return</span> legal;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationDemo</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">SensitiveWordFilterChain</span> <span class="variable">filterChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SensitiveWordFilterChain</span>();</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">AdsWordFilter</span>());</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">SexyWordFilter</span>());</span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">PoliticalWordFilter</span>());</span><br><span class="line">     <span class="comment">//éœ€è¦æ”¹åŠ¨å®¢æˆ·ç«¯ä»£ç ,åœ¨èŒè´£é“¾ä¸­æ·»åŠ æ–°çš„å¤„ç†å™¨</span></span><br><span class="line">    filterChain.addFilter(<span class="keyword">new</span> <span class="title class_">NewWordFilter</span>());</span><br><span class="line">      </span><br><span class="line">    <span class="type">boolean</span> <span class="variable">legal</span> <span class="operator">=</span> filterChain.filter(<span class="keyword">new</span> <span class="title class_">Content</span>());</span><br><span class="line">    <span class="keyword">if</span> (!legal) &#123;</span><br><span class="line">      <span class="comment">// ä¸å‘è¡¨</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å‘è¡¨</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»†åŒ–ä¸€ä¸‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„ä»£ç åˆ†æˆä¸¤ç±»ï¼šæ¡†æ¶ä»£ç å’Œå®¢æˆ·ç«¯ä»£ç ã€‚å…¶ä¸­ï¼ŒApplicationDemo å±äºå®¢æˆ·ç«¯ä»£ç ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ¡†æ¶çš„ä»£ç ã€‚é™¤ ApplicationDemo ä¹‹å¤–çš„ä»£ç å±äºæ•æ„Ÿè¯è¿‡æ»¤æ¡†æ¶ä»£ç ã€‚</p><p><em>å‡è®¾æ•æ„Ÿè¯è¿‡æ»¤æ¡†æ¶å¹¶ä¸æ˜¯æˆ‘ä»¬å¼€å‘ç»´æŠ¤çš„ï¼Œè€Œæ˜¯æˆ‘ä»¬å¼•å…¥çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œæˆ‘ä»¬è¦æ‰©å±•ä¸€ä¸ªæ–°çš„è¿‡æ»¤ç®—æ³•ï¼Œä¸å¯èƒ½ç›´æ¥å»ä¿®æ”¹æ¡†æ¶çš„æºç ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåˆ©ç”¨èŒè´£é“¾æ¨¡å¼å°±èƒ½è¾¾åˆ°å¼€ç¯‡æ‰€è¯´çš„ï¼Œåœ¨ä¸ä¿®æ”¹æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼ŒåŸºäºèŒè´£é“¾æ¨¡å¼æä¾›çš„æ‰©å±•ç‚¹ï¼Œæ¥æ‰©å±•æ–°çš„åŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åœ¨æ¡†æ¶è¿™ä¸ªä»£ç èŒƒå›´å†…å®ç°äº†å¼€é—­åŸåˆ™ã€‚</em></p><p>é™¤æ­¤ä¹‹å¤–, åˆ©ç”¨èŒè´£é“¾æ¨¡å¼ç›¸å¯¹äºä¸ç”¨èŒè´£é“¾æ¨¡å¼çš„å®ç°æ–¹æ³•, è¿˜æœ‰ä¸€ä¸ªå¥½å¤„, å°±æ˜¯é…ç½®è¿‡æ»¤ç®—æ³•æ›´åŠ çµæ´»äº†, åªéœ€è¦ä½¿ç”¨æŸå‡ ä¸ªè¿‡æ»¤ç®—æ³•</p><h2 id="åº”ç”¨ç¯‡">åº”ç”¨ç¯‡</h2><p>â€‹èŒè´£é“¾æ¨¡å¼å¸¸ç”¨åœ¨æ¡†æ¶çš„å¼€å‘ä¸­ï¼Œä¸ºæ¡†æ¶æä¾›æ‰©å±•ç‚¹ï¼Œè®©æ¡†æ¶çš„ä½¿ç”¨è€…åœ¨ä¸ä¿®æ”¹æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼ŒåŸºäºæ‰©å±•ç‚¹æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚å®é™…ä¸Šï¼Œæ›´å…·ä½“ç‚¹æ¥è¯´ï¼ŒèŒè´£é“¾æ¨¡å¼æœ€å¸¸ç”¨æ¥å¼€å‘æ¡†æ¶çš„<strong>è¿‡æ»¤å™¨</strong>å’Œ<strong>æ‹¦æˆªå™¨</strong></p><p>â€‹</p><h3 id="Servlet-Filter">Servlet Filter</h3><p>â€‹<code>Servlet Filter</code> æ˜¯ Java <code>Servlet è§„èŒƒ</code>ä¸­å®šä¹‰çš„ç»„ä»¶ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯è¿‡æ»¤å™¨ï¼Œå®ƒå¯ä»¥å®ç°å¯¹ HTTP è¯·æ±‚çš„è¿‡æ»¤åŠŸèƒ½ï¼Œæ¯”å¦‚é‰´æƒã€é™æµã€è®°å½•æ—¥å¿—ã€éªŒè¯å‚æ•°ç­‰ç­‰ã€‚</p><p>â€‹åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨<code> Servlet Filter</code> å‘¢ï¼Ÿæˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªå®ç° <code>javax.servlet.Filter </code>æ¥å£çš„è¿‡æ»¤å™¨ç±»ï¼Œå¹¶ä¸”å°†å®ƒé…ç½®åœ¨ <code>web.xml</code> é…ç½®æ–‡ä»¶ä¸­ã€‚Web å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè¯»å– <code>web.xml </code>ä¸­çš„é…ç½®ï¼Œåˆ›å»ºè¿‡æ»¤å™¨å¯¹è±¡ã€‚å½“æœ‰è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼Œä¼šå…ˆç»è¿‡è¿‡æ»¤å™¨ï¼Œç„¶åæ‰ç”±<code> Servlet</code> æ¥å¤„ç†ã€‚</p><p>â€‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="comment">// åœ¨åˆ›å»ºFilteræ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œ</span></span><br><span class="line">    <span class="comment">// å…¶ä¸­filterConfigåŒ…å«è¿™ä¸ªFilterçš„é…ç½®å‚æ•°ï¼Œæ¯”å¦‚nameä¹‹ç±»çš„ï¼ˆä»é…ç½®æ–‡ä»¶ä¸­è¯»å–çš„ï¼‰</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;</span>);</span><br><span class="line">    chain.doFilter(request, response);</span><br><span class="line">    System.out.println(<span class="string">&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨é”€æ¯Filteræ—¶è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨web.xmlé…ç½®æ–‡ä»¶ä¸­å¦‚ä¸‹é…ç½®ï¼š</span></span><br><span class="line">&lt;filter&gt;</span><br><span class="line">  &lt;filter-name&gt;logFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;filter-class&gt;com.xzg.cd.LogFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">    &lt;filter-name&gt;logFilter&lt;/filter-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;<span class="comment">/*&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">&lt;/filter-mapping&gt;</span></span><br></pre></td></tr></table></figure><p>â€‹æˆ‘ä»¬å‘ç°ï¼Œæ·»åŠ è¿‡æ»¤å™¨éå¸¸æ–¹ä¾¿ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œå®šä¹‰ä¸€ä¸ªå®ç° javax.servlet.Filter çš„ç±»ï¼Œå†æ”¹æ”¹é…ç½®å°±æå®šäº†ï¼Œå®Œå…¨ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p><p>â€‹<code>Servlet Filter</code>åˆ©ç”¨çš„æ­£æ˜¯èŒè´£é“¾æ¨¡å¼æ¥ä¿è¯å¦‚æ­¤å¥½çš„æ‰©å±•æ€§</p><p>â€‹<code>Servlet </code>åªæ˜¯ä¸€ä¸ªè§„èŒƒï¼Œå¹¶ä¸åŒ…å«å…·ä½“çš„å®ç°ï¼Œæ‰€ä»¥ï¼Œ<code>Servlet </code>ä¸­çš„ <code>FilterChain </code>åªæ˜¯ä¸€ä¸ªæ¥å£å®šä¹‰ã€‚å…·ä½“çš„å®ç°ç±»ç”±éµä»<code> Servlet</code> è§„èŒƒçš„ Web å®¹å™¨æ¥æä¾›ï¼Œæ¯”å¦‚ï¼Œ<code>ApplicationFilterChain </code>ç±»å°±æ˜¯ Tomcat æä¾›çš„ <code>FilterChain </code>çš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ApplicationFilterChain</span> <span class="keyword">implements</span> <span class="title class_">FilterChain</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="variable">pos</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//å½“å‰æ‰§è¡Œåˆ°äº†å“ªä¸ªfilter</span></span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> n; <span class="comment">//filterçš„ä¸ªæ•°</span></span><br><span class="line">  <span class="keyword">private</span> ApplicationFilterConfig[] filters;</span><br><span class="line">  <span class="keyword">private</span> Servlet servlet;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt; n) &#123;</span><br><span class="line">      <span class="type">ApplicationFilterConfig</span> <span class="variable">filterConfig</span> <span class="operator">=</span> filters[pos++];</span><br><span class="line">      <span class="type">Filter</span> <span class="variable">filter</span> <span class="operator">=</span> filterConfig.getFilter();</span><br><span class="line">      filter.doFilter(request, response, <span class="built_in">this</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// filteréƒ½å¤„ç†å®Œæ¯•åï¼Œæ‰§è¡Œservlet</span></span><br><span class="line">      servlet.service(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFilter</span><span class="params">(ApplicationFilterConfig filterConfig)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (ApplicationFilterConfig filter:filters)</span><br><span class="line">      <span class="keyword">if</span> (filter==filterConfig)</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (n == filters.length) &#123;<span class="comment">//æ‰©å®¹</span></span><br><span class="line">      ApplicationFilterConfig[] newFilters = <span class="keyword">new</span> <span class="title class_">ApplicationFilterConfig</span>[n + INCREMENT];</span><br><span class="line">      System.arraycopy(filters, <span class="number">0</span>, newFilters, <span class="number">0</span>, n);</span><br><span class="line">      filters = newFilters;</span><br><span class="line">    &#125;</span><br><span class="line">    filters[n++] = filterConfig;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ApplicationFilterChain </code>ä¸­çš„ <code>doFilter()</code> å‡½æ•°çš„ä»£ç å®ç°æ¯”è¾ƒæœ‰æŠ€å·§ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ã€‚</p><p>â€‹è¿™æ ·å®ç°ä¸»è¦æ˜¯ä¸ºäº†åœ¨ä¸€ä¸ª <code>doFilter() </code>æ–¹æ³•ä¸­ï¼Œæ”¯æŒåŒå‘æ‹¦æˆªï¼Œæ—¢èƒ½æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚ï¼Œä¹Ÿèƒ½æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”ï¼Œä½ å¯ä»¥ç»“åˆç€ <code>LogFilter</code> é‚£ä¸ªä¾‹å­ï¼Œä»¥åŠå¯¹æ¯”å¾…ä¼šè¦è®²åˆ°çš„ <code>Spring Interceptor</code>.</p><h3 id="Spring-Interceptor">Spring Interceptor</h3><p>â€‹<code>Servlet Filter</code>ï¼Œæœ‰ä¸€ä¸ªåŠŸèƒ½ä¸Šè·Ÿå®ƒéå¸¸ç±»ä¼¼çš„ä¸œè¥¿ï¼Œ<code>Spring Interceptor</code>ï¼Œï¼Œéƒ½ç”¨æ¥å®ç°å¯¹ HTTP è¯·æ±‚è¿›è¡Œæ‹¦æˆªå¤„ç†ã€‚</p><p>â€‹å®ƒä»¬ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>Servlet Filter</code> æ˜¯ <code>Servlet</code> è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå®ç°ä¾èµ–äº Web å®¹å™¨ã€‚<code>Spring Interceptor</code> æ˜¯<code>Spring MVC</code>æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”± <code>Spring MVC</code> æ¡†æ¶æ¥æä¾›å®ç°ã€‚å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ï¼Œä¼šå…ˆç»è¿‡ <code>Servlet Filter</code>ï¼Œç„¶åå†ç»è¿‡ <code>Spring Interceptor</code>ï¼Œæœ€ååˆ°è¾¾å…·ä½“çš„ä¸šåŠ¡ä»£ç ä¸­ã€‚( <code>Filter</code>åœ¨ <code>Request</code> æŠµè¾¾<code>Servlet</code> ä¹‹å‰è¿›è¡Œè¿‡æ»¤ ä»¥åŠ<code>Servlet.service()</code>æ‰§è¡Œå®Œè¿”å›<code>reponse</code>ä¹‹åè¿‡æ»¤; è€Œ<code>Interceptor</code> æ˜¯åœ¨æŠµè¾¾ <code>DispatcherServlet</code> ä¹‹åæ ¹æ®è¯·æ±‚è·¯å¾„æ‰¾åˆ°å¯¹åº”çš„æ˜ å°„å™¨å€™é€‰è€…å<code>å‰ç½®å¤„ç†</code>å€™é€‰è€…, åœ¨å€™é€‰è€…å¤„ç†è¯·æ±‚å¹¶è§†å›¾è§£æå™¨å¤„ç†å®Œæˆå<code>åç½®å¤„ç†</code>)</p><p>â€‹åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨ <code>Spring Interceptor</code> å‘¢ï¼Ÿ</p><ul><li>å£°æ˜æ‹¦æˆªå™¨ç±», å®ç°<code>HandlerInterceptor</code>æ¥å£, å®ç°<code>preHandler()</code>, <code>postHandler()</code>, ,<code>afterCompletion()</code>æ–¹æ³•</li><li>é€šè¿‡é…ç½®æ–‡ä»¶ä¸­æ·»åŠ <code>&lt;mvc:interceptor&gt;</code>, é…ç½®<code>&lt;mvc:mapping path=&quot;æ‹¦æˆªè·¯å¾„&quot;/&gt;</code> , <code>&lt;bean class=&quot;æ‹¦æˆªå™¨å®ç°ç±»å…¨é™å®šå&quot; /&gt;</code>(ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£é…ç½®ç±»)</li></ul><p>â€‹</p><p>â€‹<code>LogInterceptor</code> å®ç°çš„åŠŸèƒ½è·Ÿåˆšæ‰çš„ <code>LogFilter</code> å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å®ç°æ–¹å¼ä¸Šç¨æœ‰åŒºåˆ«ã€‚<code>LogFilter</code> å¯¹è¯·æ±‚å’Œå“åº”çš„æ‹¦æˆªæ˜¯åœ¨ <code>doFilter() </code>ä¸€ä¸ªå‡½æ•°ä¸­å®ç°çš„ï¼Œè€Œ <code>LogInterceptor</code> å¯¹è¯·æ±‚çš„æ‹¦æˆªåœ¨ <code>preHandle()</code> ä¸­å®ç°ï¼Œå¯¹å“åº”çš„æ‹¦æˆªåœ¨ <code>postHandle()</code> ä¸­å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// åœ¨å¤„ç†è¯·æ±‚ä¹‹å‰è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// åœ¨æ­¤å¤„å¯ä»¥æ‰§è¡Œä¸€äº›é¢„å¤„ç†æ“ä½œï¼Œå¦‚è®°å½•æ—¥å¿—</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// ç»§ç»­åç»­çš„å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// åœ¨å¤„ç†è¯·æ±‚åï¼Œè§†å›¾æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// åœ¨æ­¤å¤„å¯ä»¥æ‰§è¡Œä¸€äº›åå¤„ç†æ“ä½œï¼Œå¦‚ä¿®æ”¹å“åº”å†…å®¹æˆ–æ·»åŠ é¢å¤–çš„å“åº”å¤´</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// åœ¨è¯·æ±‚å¤„ç†å®Œæˆåè¢«è°ƒç”¨ï¼Œå³è§†å›¾æ¸²æŸ“å®Œæˆåè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// åœ¨æ­¤å¤„å¯ä»¥æ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œå¦‚é‡Šæ”¾èµ„æºæˆ–è®°å½•è¯·æ±‚å¤„ç†ç»“æœ</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;è¿™é‡Œæ€»æ˜¯è¢«æ‰§è¡Œ.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨Spring MVCé…ç½®æ–‡ä»¶ä¸­é…ç½®interceptors</span></span><br><span class="line">&lt;mvc:interceptors&gt;</span><br><span class="line">   &lt;mvc:interceptor&gt;</span><br><span class="line">       &lt;mvc:mapping path=<span class="string">&quot;/*&quot;</span>/&gt;</span><br><span class="line">       &lt;bean class=<span class="string">&quot;com.xzg.cd.LogInterceptor&quot;</span> /&gt;</span><br><span class="line">   &lt;/mvc:interceptor&gt;</span><br><span class="line">&lt;/mvc:interceptors&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€‹<code>Spring interceptor</code></p><p>â€‹ä¹Ÿæ˜¯åŸºäºèŒè´£é“¾æ¨¡å¼å®ç°çš„ã€‚å…¶ä¸­ï¼Œ<code>HandlerExecutionChain</code> ç±»æ˜¯èŒè´£é“¾æ¨¡å¼ä¸­çš„å¤„ç†å™¨é“¾ã€‚å®ƒçš„å®ç°ç›¸è¾ƒäº Tomcat ä¸­çš„ <code>ApplicationFilterChain</code> æ¥è¯´ï¼Œé€»è¾‘æ›´åŠ æ¸…æ™°ï¼Œä¸éœ€è¦ä½¿ç”¨é€’å½’æ¥å®ç°ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒå°†è¯·æ±‚å’Œå“åº”çš„æ‹¦æˆªå·¥ä½œï¼Œæ‹†åˆ†åˆ°äº†ä¸¤ä¸ªå‡½æ•°ä¸­å®ç°ã€‚</p><p><code>HandlerExecutionChain</code> çš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼ŒåŒæ ·å¯¹ä»£ç ä¹Ÿè¿›è¡Œäº†ä¸€äº›ç®€åŒ–ï¼Œåªä¿ç•™äº†å…³é”®ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * HandlerExecutionChain ç±»å®šä¹‰äº†ä¸€ä¸ªæ‹¦æˆªå™¨çš„æ‰§è¡Œé“¾ï¼Œä¸ºå¤„ç†å™¨æä¾›æ‹¦æˆªåŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerExecutionChain</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object handler; <span class="comment">// å¤„ç†å™¨å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HandlerInterceptor[] interceptors; <span class="comment">// æ‹¦æˆªå™¨æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä¸€ä¸ªæ‹¦æˆªå™¨åˆ°æ‹¦æˆªå™¨æ•°ç»„ä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> interceptor è¦æ·»åŠ çš„æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptor</span><span class="params">(HandlerInterceptor interceptor)</span> &#123;</span><br><span class="line">        initInterceptorList().add(interceptor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨å¤„ç†å™¨æ‰§è¡Œå‰è°ƒç”¨æ‹¦æˆªå™¨çš„é¢„å¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request  HTTP è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response HTTP å“åº”å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦ç»§ç»­æ‰§è¡Œå¤„ç†å™¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">applyPreHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor[] interceptors = getInterceptors();</span><br><span class="line">        <span class="keyword">if</span> (!ObjectUtils.isEmpty(interceptors)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; interceptors.length; i++) &#123;</span><br><span class="line">                <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> interceptors[i];</span><br><span class="line">                <span class="keyword">if</span> (!interceptor.preHandle(request, response, <span class="built_in">this</span>.handler)) &#123;</span><br><span class="line">                    triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨å¤„ç†å™¨æ‰§è¡Œåè°ƒç”¨æ‹¦æˆªå™¨çš„åå¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request  HTTP è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response HTTP å“åº”å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mv       å¤„ç†å™¨è¿”å›çš„ ModelAndView å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">applyPostHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, ModelAndView mv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor[] interceptors = getInterceptors();</span><br><span class="line">        <span class="keyword">if</span> (!ObjectUtils.isEmpty(interceptors)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> interceptors.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> interceptors[i];</span><br><span class="line">                interceptor.postHandle(request, response, <span class="built_in">this</span>.handler, mv);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨è¯·æ±‚å®Œæˆæ—¶è°ƒç”¨æ‹¦æˆªå™¨çš„å®Œæˆå¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request  HTTP è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response HTTP å“åº”å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ex       è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ï¼ˆå¦‚æœæœ‰ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">triggerAfterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Exception ex)</span></span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor[] interceptors = getInterceptors();</span><br><span class="line">        <span class="keyword">if</span> (!ObjectUtils.isEmpty(interceptors)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorIndex; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> interceptors[i];</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    interceptor.afterCompletion(request, response, <span class="built_in">this</span>.handler, ex);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Throwable ex2) &#123;</span><br><span class="line">                    logger.error(<span class="string">&quot;HandlerInterceptor.afterCompletion threw exception&quot;</span>, ex2);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹åœ¨ Spring æ¡†æ¶ä¸­ï¼Œ<code>DispatcherServlet</code> çš„ <code>doDispatch()</code> æ–¹æ³•æ¥åˆ†å‘è¯·æ±‚ï¼Œå®ƒåœ¨çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘æ‰§è¡Œå‰åï¼Œæ‰§è¡Œ <code>HandlerExecutionChain</code> ä¸­çš„ <code>applyPreHandle()</code> å’Œ <code>applyPostHandle()</code> å‡½æ•°ï¼Œç”¨æ¥å®ç°æ‹¦æˆªçš„åŠŸèƒ½ã€‚</p><h2 id="ç»ƒä¹ ç¯‡">ç»ƒä¹ ç¯‡</h2><p>å°è¯•ä¼˜åŒ–ä¸€ä¸‹ä»£ç (æ¡ˆä¾‹æ¥æº)</p><p><strong>åœ¨æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿåœ¨618å¤§ä¿ƒæœŸé—´çš„ä¸šåŠ¡ç³»ç»Ÿä¸Šçº¿å®¡æ‰¹æµç¨‹åœºæ™¯</strong></p><p>åƒæ˜¯è¿™äº›ä¸€çº¿ç”µå•†ç±»çš„äº’è”ç½‘å…¬å¸ï¼Œé˜¿é‡Œã€äº¬ä¸œã€æ‹¼å¤šå¤šç­‰ï¼Œåœ¨618æœŸé—´éƒ½ä¼šåšä¸€äº›è¿è¥æ´»åŠ¨åœºæ™¯ä»¥åŠæä¾›çš„æ‰©å®¹å¤‡æˆ˜ï¼Œå°±åƒè¿‡å¹´æœŸé—´ç™¾åº¦çš„çº¢åŒ…ä¸€æ ·ã€‚ä½†æ˜¯æ‰€æœ‰å¼€å‘çš„è¿™äº›ç³»ç»Ÿéƒ½éœ€è¦é™†ç»­çš„ä¸Šçº¿ï¼Œå› ä¸ºä¸´è¿‘618æœ‰æ—¶å€™ä¹Ÿæœ‰ä¸€äº›ç´§æ€¥çš„è°ƒæ•´çš„éœ€è¦ä¸Šçº¿ï¼Œä½†ä¸ºäº†ä¿éšœçº¿ä¸Šç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯å°½å¯èƒ½çš„å‡å°‘ä¸Šçº¿çš„ï¼Œä¹Ÿä¼šç›¸åº”çš„å¢å¼ºå®¡æ‰¹åŠ›åº¦ã€‚å°±åƒä¸€çº§å“åº”ã€äºŒçº§å“åº”ä¸€æ ·ã€‚</p><p>è€Œè¿™å®¡æ‰¹çš„è¿‡ç¨‹åœ¨éšç€ç‰¹å®šæ—¶é—´ç‚¹ä¼šå¢åŠ ä¸åŒçº§åˆ«çš„è´Ÿè´£äººåŠ å…¥ï¼Œæ¯ä¸ªäººå°±åƒè´£ä»»é“¾æ¨¡å¼ä¸­çš„æ¯ä¸€ä¸ªæ ¸å¿ƒç‚¹ã€‚å¯¹äºç ”å‘å°ä¼™ä¼´å¹¶ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„å®¡æ‰¹æµç¨‹å¤„ç†ç»†èŠ‚ï¼Œåªéœ€è¦çŸ¥é“è¿™ä¸ªä¸Šçº¿æ›´ä¸¥æ ¼ï¼Œçº§åˆ«ä¹Ÿæ›´é«˜ï¼Œä½†å¯¹äºç ”å‘äººå‘˜æ¥è¯´åŒæ ·æ˜¯ç‚¹å‡»ç›¸åŒçš„æå®¡æŒ‰é’®ï¼Œç­‰å¾…å®¡æ ¸ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¨¡æ‹Ÿè¿™æ ·ä¸€ä¸ªä¸šåŠ¡è¯‰æ±‚åœºæ™¯ï¼Œä½¿ç”¨è´£ä»»é“¾çš„è®¾è®¡æ¨¡å¼æ¥å®ç°æ­¤åŠŸèƒ½ã€‚</p><h3 id="åœºæ™¯ç®€è¿°">åœºæ™¯ç®€è¿°</h3><h4 id="æ¨¡æ‹Ÿå®¡æ ¸æœåŠ¡">æ¨¡æ‹Ÿå®¡æ ¸æœåŠ¡</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Date&gt; authMap = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;String, Date&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title function_">queryAuthInfo</span><span class="params">(String uId, String orderId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> authMap.get(uId.concat(orderId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">auth</span><span class="params">(String uId, String orderId)</span> &#123;</span><br><span class="line">        authMap.put(uId.concat(orderId), <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œé¢æä¾›äº†ä¸¤ä¸ªæ¥å£ä¸€ä¸ªæ˜¯æŸ¥è¯¢å®¡æ ¸ç»“æœ(<code>queryAuthInfo</code>)ã€å¦å¤–ä¸€ä¸ªæ˜¯å¤„ç†å®¡æ ¸(<code>auth</code>)ã€‚</li><li>è¿™éƒ¨åˆ†æ˜¯æŠŠç”±è°å®¡æ ¸çš„å’Œå®¡æ ¸çš„å•å­IDä½œä¸ºå”¯ä¸€keyå€¼è®°å½•åˆ°å†…å­˜Mapç»“æ„ä¸­ã€‚</li></ul><h3 id="å¾…ä¼˜åŒ–ä»£ç ">å¾…ä¼˜åŒ–ä»£ç </h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">SimpleDateFormat</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<span class="comment">// æ—¶é—´æ ¼å¼åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> AuthInfo <span class="title function_">doAuth</span><span class="params">(String uId, String orderId, Date authDate)</span> <span class="keyword">throws</span> ParseException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸‰çº§å®¡æ‰¹</span></span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> AuthService.queryAuthInfo(<span class="string">&quot;1000013&quot;</span>, orderId);</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == date) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthInfo</span>(<span class="string">&quot;0001&quot;</span>, <span class="string">&quot;å•å·ï¼š&quot;</span>, orderId, <span class="string">&quot; çŠ¶æ€ï¼šå¾…ä¸‰çº§å®¡æ‰¹è´Ÿè´£äºº &quot;</span>, <span class="string">&quot;ç‹å·¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// äºŒçº§å®¡æ‰¹</span></span><br><span class="line">        <span class="keyword">if</span> (authDate.after(f.parse(<span class="string">&quot;2020-06-01 00:00:00&quot;</span>)) &amp;&amp; authDate.before(f.parse(<span class="string">&quot;2020-06-25 23:59:59&quot;</span>))) &#123;</span><br><span class="line">            date = AuthService.queryAuthInfo(<span class="string">&quot;1000012&quot;</span>, orderId);</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == date) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthInfo</span>(<span class="string">&quot;0001&quot;</span>, <span class="string">&quot;å•å·ï¼š&quot;</span>, orderId, <span class="string">&quot; çŠ¶æ€ï¼šå¾…äºŒçº§å®¡æ‰¹è´Ÿè´£äºº &quot;</span>, <span class="string">&quot;å¼ ç»ç†&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸€çº§å®¡æ‰¹</span></span><br><span class="line">        <span class="keyword">if</span> (authDate.after(f.parse(<span class="string">&quot;2020-06-11 00:00:00&quot;</span>)) &amp;&amp; authDate.before(f.parse(<span class="string">&quot;2020-06-20 23:59:59&quot;</span>))) &#123;</span><br><span class="line">            date = AuthService.queryAuthInfo(<span class="string">&quot;1000011&quot;</span>, orderId);</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> == date) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthInfo</span>(<span class="string">&quot;0001&quot;</span>, <span class="string">&quot;å•å·ï¼š&quot;</span>, orderId, <span class="string">&quot; çŠ¶æ€ï¼šå¾…ä¸€çº§å®¡æ‰¹è´Ÿè´£äºº &quot;</span>, <span class="string">&quot;æ®µæ€»&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthInfo</span>(<span class="string">&quot;0001&quot;</span>, <span class="string">&quot;å•å·ï¼š&quot;</span>, orderId, <span class="string">&quot; çŠ¶æ€ï¼šå®¡æ‰¹å®Œæˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œä»ä¸Šåˆ°ä¸‹åˆ†åˆ«åˆ¤æ–­äº†åœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…ç”±ä¸åŒçš„äººå‘˜è¿›è¡Œå®¡æ‰¹ï¼Œå°±åƒ618ä¸Šçº¿çš„æ—¶å€™éœ€è¦ä¸‰ä¸ªè´Ÿè´£äººéƒ½å®¡æ‰¹æ‰èƒ½è®©ç³»ç»Ÿè¿›è¡Œä¸Šçº¿ã€‚</li><li>åƒæ˜¯è¿™æ ·çš„åŠŸèƒ½çœ‹èµ·æ¥å¾ˆç®€å•çš„ï¼Œä½†æ˜¯å®é™…çš„ä¸šåŠ¡ä¸­ä¼šæœ‰å¾ˆå¤šéƒ¨é—¨ï¼Œä½†å¦‚æœè¿™æ ·å®ç°å°±å¾ˆéš¾è¿›è¡Œæ‰©å±•ï¼Œå¹¶ä¸”åœ¨æ”¹åŠ¨æ‰©å±•è°ƒæ•´ä¹Ÿéå¸¸éº»çƒ¦ã€‚</li></ul><hr><p>å‚è€ƒ:</p><p><a href="https://time.geekbang.org/column/intro/100039001">è®¾è®¡æ¨¡å¼ä¹‹ç¾ (geekbang.org)</a></p><p>[é‡å­¦ Java è®¾è®¡æ¨¡å¼ï¼šå®æˆ˜è´£ä»»é“¾æ¨¡å¼ã€Œæ¨¡æ‹Ÿ618ç”µå•†å¤§ä¿ƒæœŸé—´ï¼Œé¡¹ç›®ä¸Šçº¿æµç¨‹å¤šçº§è´Ÿè´£äººå®¡æ‰¹åœºæ™¯ã€ | å°å‚…å“¥ bugstack è™«æ´æ ˆ](<a href="https://bugstack.cn/md/develop/design-pattern/2020-06-18-%E9%87%8D%E5%AD%A6">https://bugstack.cn/md/develop/design-pattern/2020-06-18-é‡å­¦</a> Java è®¾è®¡æ¨¡å¼ã€Šå®æˆ˜è´£ä»»é“¾æ¨¡å¼ã€‹.html)</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </tag>
            
            <tag> è®¡ç®—æœºåŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ArraysListæºç åˆ†æ</title>
      <link href="/posts/16070.html"/>
      <url>/posts/16070.html</url>
      
        <content type="html"><![CDATA[<h1>ArrayListæºç åˆ†æ</h1>]]></content>
      
      
      <categories>
          
          <category> Javaæºç  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ArrayLists </tag>
            
            <tag> Javaæºç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVA NIO</title>
      <link href="/posts/49656.html"/>
      <url>/posts/49656.html</url>
      
        <content type="html"><![CDATA[<h1>Java NIO</h1><h2 id="Java-NIOæ¦‚è¿°">Java NIOæ¦‚è¿°</h2><h3 id="é˜»å¡IO">é˜»å¡IO</h3><p>åœ¨è¿›è¡Œè¯»å–,å†™å…¥æ—¶,åœ¨æœ‰å¯ä¾›è¯»å†™æ•°æ®åˆ°è¾¾ä¹‹å‰ä¼šé˜»å¡çº¿ç¨‹</p><p>é€šå¸¸, æœåŠ¡å™¨æ¯ä¸ªè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹</p><p>å³ä½¿ä½¿ç”¨çº¿ç¨‹æ± ,ä½†çº¿ç¨‹æ± ä¹Ÿæœ‰ç€ä¸Šé™</p><h3 id="éé˜»å¡IO">éé˜»å¡IO</h3><p>åŸºäºReactorå·¥ä½œæ–¹å¼,Selectorä¸­è·å–SelectionKey,æ‰¾åˆ°å…·ä½“çš„SelectableChannel,ä»¥è·å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®,é¢å‘ç¼“å†²åŒº,</p><h3 id="NIOæ¦‚è¿°">NIOæ¦‚è¿°</h3><p>ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶</p><ul><li>Channel</li><li>Buffer</li><li>Selectors</li></ul><h2 id="Java-NIO-Channel">Java NIO (Channel)</h2><p>é€šé“,å…¨åŒå·¥,å¤šç§æ•°æ®æº,ç”¨äºåœ¨å­—èŠ‚ç¼“å†²åŒºä¸ä½äºé€šé“å¦ä¸€ä¾§åœ°çš„å®ä½“è¿›è¡Œä¼ è¾“</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javaæºç  </tag>
            
            <tag> NIO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MESIç¼“å­˜ä¸€è‡´æ€§åè®®</title>
      <link href="/posts/43255.html"/>
      <url>/posts/43255.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV1fK4y1E7NC/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a2cdc337163157715ec6605c77937a77">ç¼“å­˜ä¸€è‡´æ€§åè®®MESI_å“”å“©å“”å“©_bilibili</a></p><p>ç›®å‰å¤§å¤šæ•°PCçš„CUPéƒ½æ˜¯å¤šæ ¸</p><p>æˆ‘ä»¬çŸ¥é“æ ¹æ®æ‘©å°”å®šå¾‹, CPUæ€§èƒ½æ¯éš”18ä¸ªæœˆå°±ä¼šç¿»ä¸€å€(å³ä½¿åœ¨10å¹´åé€æ¸å¤±æ•ˆ)</p><p>åœ¨ç»å…¸çš„å†¯è¯ºä¾æ›¼ä½“ç³»ä¸­, å­˜å‚¨å™¨å’Œè®¡ç®—å™¨çš„IOå¯¼è‡´çš„æ€§èƒ½ä½ä¸‹å·²ç»è¶Šå‘çš„çªå‡º</p><p>ç”±æ­¤,å¤§å¤šCPUéƒ½ä¼šå­˜åœ¨ç¼“å­˜è¿™ä¸€ä¸­é—´è®¾å¤‡, åˆ©ç”¨å±€éƒ¨æ€§åŸç†, å°†çƒ­ç‚¹æ•°æ®å­˜å‚¨åœ¨ç¼“å­˜ä¸­</p><p>ç›®å‰å¤§å¤šè®¾å¤‡ä¸ºä¸‰çº§ç¼“å­˜</p><p>å…¶ä¸­L1, L2ç¼“å­˜ä¸ºå•ä¸ªCPUç§æœ‰(å¯èƒ½ç”±äºCPUæ¶æ„è€Œä¸åŒ), L3ç¼“å­˜ä¸ºå…±äº«, ä½†è¿™å¹¶ä¸æ˜¯æœ¬èŠ‚è®¨è®ºçš„é‡ç‚¹,æ¥ä¸‹æ¥, æˆ‘ä»¬ç›´æ¥å°†ç¼“å­˜æŠ½è±¡ä¸ºæ¯ä¸ªCPUæ ¸å¿ƒæ‰€ç§æœ‰çš„</p><p>ç¼“å­˜çš„å¼•å…¥,æå¤§çš„é™ä½äº†IOæ•ˆç‡, æå‡äº†CPUæ•´ä½“çš„æ•ˆç‡,ä½†æ˜¯å¤šæ ¸æ¶æ„ä¸‹, å¼•å…¥ç¼“å­˜ä¼šå‡ºç°ä¸€è‡´æ€§é—®é¢˜</p><p>ä»€ä¹ˆæ—¶ä¸€è‡´æ€§é—®é¢˜å‘¢?</p><p>æˆ‘ä»¬ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­</p><p>CPUå…¬æœ‰ä¸¤ä¸ªæ ¸å¿ƒ</p><p>P1  P2</p><p>ç°åœ¨å†…å­˜ä¸­æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ n  = 1, è¢«ä¸¤ä¸ªæ ¸å¿ƒå…±äº«</p><p>ç›®å‰ä¸¤ä¸ªæ ¸å¿ƒç¼“å­˜éƒ½ä¸å­˜åœ¨è¿™ä¸ªå…¨å±€å˜é‡(ç¼“å­˜å¼•å…¥å, CPUåªç›´æ¥æ“ä½œç¼“å­˜, æ“ä½œå†…å­˜éœ€è¦å…ˆè¯»å…¥ç¼“å­˜å†å†™å…¥ç¼“å­˜, ä½†æ˜¯å†™å…¥çš„æ—¶é—´å¹¶ä¸ç¡®å®š)</p><p>å‡è®¾ P1 P2çš„ç›®çš„éƒ½æ˜¯è®©å…¨å±€å˜é‡åŠ 1, é‚£ä¹ˆæˆ‘ä»¬é¢„æœŸçš„ç»“æœæ˜¯  æœ€å n = 3</p><p>ä½†æ˜¯ä¸‹é¢çš„æ‰§è¡Œæµç¨‹ä¼šå¾—å‡ºä¸ä¸€æ ·çš„ç»“æœ</p><p>P1 è¯»å…¥ç¼“å­˜ n = 1. å†ç¼“å­˜ä¸­+1 n = 2</p><p>ä¹‹åP1è¿˜æœªæŠŠç¼“å­˜å†™å…¥å†…å­˜, P2å¼€å§‹äº†æ“ä½œ</p><p>P2 è¯»å…¥ç¼“å­˜ n = 1. å†ç¼“å­˜ä¸­+1 n = 2</p><p>P1 å†™å…¥å†…å­˜ n = 2 è¦†ç›–äº†åŸæœ¬å†…å­˜ä¸­çš„n = 1</p><p>P2 å†™å…¥å†…å­˜ n = 2 è¦†ç›–äº†åŸæœ¬å†…å­˜ä¸­çš„n = 2</p><p>æœ€åå†…å­˜ä¸­çš„å€¼æ˜¯n = 2</p><p>è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä¸€è‡´æ€§é—®é¢˜, å› ä¸ºå‰¯æœ¬çš„æ›´æ–°ä¸èƒ½å³æ—¶çš„åˆ·å…¥å†…å­˜ä¸­å¯¼è‡´çš„(æ“ä½œçš„åŸå­æ€§)</p><p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è®©æ¯ä¸ªæ“ä½œéƒ½åŸå­æ€§ä¸å°±å¥½äº†?</p><p>äºæ˜¯å¼•å…¥äº†ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆ</p><p>é”æ€»çº¿, æ¯æ¬¡æ“ä½œåªèƒ½æœ‰ä¸€ä¸ªæ ¸å¿ƒæ‰§è¡Œ, è¿™æ˜¾ç„¶æ˜¯æå…¶ä½æ•ˆçš„, ç›´æ¥PASS</p><p>æ€»çº¿å—…æ¢æœºåˆ¶(å…¶å®è¿˜æœ‰åŸºäºç›®å½•çš„ç¼“å­˜ä¸€è‡´æ€§åè®®)</p><p>å†™å¤±æ•ˆ(Write Through)</p><p>å†™æ›´æ–°(Write Back)</p><p><a href="https://www.alibabacloud.com/blog/memory-model-and-synchronization-primitive---part-1-memory-barrier_597460">https://www.alibabacloud.com/blog/memory-model-and-synchronization-primitive---part-1-memory-barrier_597460</a></p>]]></content>
      
      
      <categories>
          
          <category> æ“ä½œç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
            <tag> JAVA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨ä»£ç æ¨¡æ¿</title>
      <link href="/posts/45076.html"/>
      <url>/posts/45076.html</url>
      
        <content type="html"><![CDATA[<h1>ã€Javaç‰ˆæœ¬ã€‘å¸¸ç”¨ä»£ç æ¨¡æ¿â€”â€”åŸºç¡€ç®—æ³• + æ¨¡æ¿é¢˜å‚è€ƒå®ç°</h1><h3 id="ä¸€ã€å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿-â€”â€”-æ¨¡æ¿é¢˜-AcWing-785-å¿«é€Ÿæ’åº">ä¸€ã€å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” <a href="https://www.acwing.com/problem/content/description/787/">æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº</a></h3><p>å¿«é€Ÿæ’åºæœ¬è´¨ä¸Šå°±æ˜¯åˆ†æ²»ï¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] quickSort(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right) &#123;</span><br><span class="line">    <span class="comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼Œå¦‚æœå·¦è¾¹ç•Œå¤§äºç­‰äºå³è¾¹ç•Œåˆ™è®¤ä¸ºé€’å½’ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¾å®šä¸€ä¸ªåˆ†ç•Œå€¼ï¼Œè¿™é‡Œæ˜¯ï¼ˆleft + rightï¼‰/ 2</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> arr[left + right &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="comment">// å·¦å³æå‰é¢„ç•™ä¸€ä¸ªä½ç½®</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> right + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="comment">// ç­‰æ•ˆäºdo while</span></span><br><span class="line">        <span class="comment">// å½“æ•°å€¼å°äºåˆ†ç•Œå€¼æ—¶æŒç»­éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºåˆ†ç•Œå€¼çš„ç´¢å¼•</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯é€†åºåˆ™è°ƒæ•´ä¸¤ä¸ªwhileå¾ªç¯</span></span><br><span class="line">        <span class="keyword">while</span> (arr[++i] &lt; p)</span><br><span class="line">            ;</span><br><span class="line">        <span class="keyword">while</span> (arr[--j] &gt; p)</span><br><span class="line">            ;</span><br><span class="line">        <span class="comment">// äº¤æ¢å·¦å³ä¸¤ä¾§ä¸ç¬¦åˆé¢„æœŸçš„æ•°å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">            arr[i] = arr[j];</span><br><span class="line">            arr[j] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç”±äºåˆ†ç•Œå€¼å–çš„æ˜¯left + right &gt;&gt; 1ï¼Œå› æ­¤é€’å½’å–çš„æ˜¯leftï¼Œj j + 1ï¼Œright</span></span><br><span class="line">    quickSort(arr, left, j);</span><br><span class="line">    quickSort(arr, j + <span class="number">1</span>, right);</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/description/787/">æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="comment">// Java8</span></span><br><span class="line">        <span class="comment">// IntStream.rangeç­‰æ•ˆäºforå¾ªç¯</span></span><br><span class="line">        <span class="comment">// toArrayç”Ÿæˆæ•°ç»„</span></span><br><span class="line">        <span class="type">int</span>[] arr = IntStream.range(<span class="number">0</span>, n).map(i -&gt; in.nextInt()).toArray();</span><br><span class="line">        <span class="type">int</span>[] sortedArr = quickSort(arr, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        IntStream.range(<span class="number">0</span>, n).mapToObj(i -&gt; sortedArr[i] + <span class="string">&quot; &quot;</span>).forEach(System.out::print);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        for (int i = 0; i &lt; n; i++) &#123;</span></span><br><span class="line"><span class="comment">            int a = in.nextInt();</span></span><br><span class="line"><span class="comment">            arr[i] = a;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        int[] sortedArr = quickSort(arr, 0, n - 1);</span></span><br><span class="line"><span class="comment">        for (int i = 0; i &lt; n; i++) &#123;</span></span><br><span class="line"><span class="comment">            System.out.print(sortedArr[i] + &quot; &quot;);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] quickSort(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right) &#123;</span><br><span class="line">        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¯å‚è€ƒä¸Šè¿°å®ç°</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒã€å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿-â€”â€”-æ¨¡æ¿é¢˜-AcWing-787-å½’å¹¶æ’åº">äºŒã€å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” <a href="https://www.acwing.com/problem/content/789/">æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº</a></h3><p>å½’å¹¶æ’åºæœ¬è´¨ä¸Šå°±æ˜¯åˆ†æ²»ï¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] mergeSort(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right) &#123;</span><br><span class="line">    <span class="comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼Œå¦‚æœå·¦è¾¹ç•Œå¤§äºç­‰äºå³è¾¹ç•Œåˆ™è®¤ä¸ºé€’å½’ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¾å®šä¸€ä¸ªåˆ†ç•Œå€¼ï¼Œè¿™é‡Œæ˜¯ï¼ˆleft + rightï¼‰/ 2</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + right &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// åˆ‡å‰²</span></span><br><span class="line">    arr = mergeSort(arr, left, mid);</span><br><span class="line">    arr = mergeSort(arr, mid + <span class="number">1</span>, right);/</span><br><span class="line">    <span class="comment">// å½’å¹¶ï¼Œé•¿åº¦åˆšå¥½æ˜¯ left åˆ° right</span></span><br><span class="line">    <span class="type">int</span>[] temp = <span class="keyword">new</span> <span class="title class_">int</span>[right - left + <span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left;</span><br><span class="line">    <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> mid + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// ç”¨æ¥å½’å¹¶çš„ç´¢å¼•</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= right) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯é€†åºåˆ™è°ƒæ•´ifæ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (arr[i] &lt;= arr[j]) &#123;</span><br><span class="line">            temp[k++] = arr[i++];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            temp[k++] = arr[j++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid) &#123;</span><br><span class="line">        temp[k++] = arr[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= right) &#123;</span><br><span class="line">        temp[k++] = arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ ¹æ®å½’å¹¶åçš„æ•°ç»„é‡æ–°èµ‹å€¼æ’åºåçš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (i = left, j = <span class="number">0</span>; i &lt;= right; i++, j++) &#123;</span><br><span class="line">        arr[i] = temp[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/789/">æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="comment">// Java8ï¼Œå¯å‚è€ƒä¸Šé¢æ™®é€šå†™æ³•</span></span><br><span class="line">        <span class="type">int</span>[] arr = IntStream.range(<span class="number">0</span>, n).map(i -&gt; in.nextInt()).toArray();</span><br><span class="line">        <span class="type">int</span>[] sortedArr = mergeSort(arr, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        IntStream.range(<span class="number">0</span>, n).mapToObj(i -&gt; sortedArr[i] + <span class="string">&quot; &quot;</span>).forEach(System.out::print);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] mergeSort(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right) &#123;</span><br><span class="line">        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿-â€”â€”-æ¨¡æ¿é¢˜-AcWing-789-æ•°çš„èŒƒå›´">ä¸‰ã€æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” <a href="https://www.acwing.com/problem/content/791/">æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´</a></h3><p>ä¸¤ç§æ¨¡æ¿ï¼Œåˆ†åˆ«æ˜¯ LBSï¼Œå’Œ RBS</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨  </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span> x)</span> &#123;  </span><br><span class="line">   <span class="comment">/* ... */</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒºé—´[left, right]è¢«åˆ’åˆ†æˆ[left, mid]å’Œ[mid + 1, right]æ—¶ä½¿ç”¨ï¼š </span></span><br><span class="line"><span class="comment">// æˆ–è€…ç§°ä¹‹ä¸ºå·¦äºŒåˆ†æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾å·¦ä¾§ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">leftBinarySearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;  </span><br><span class="line">   <span class="keyword">while</span> (left &lt; right) &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> arr[left + right &gt;&gt; <span class="number">1</span>];  </span><br><span class="line">      <span class="keyword">if</span> (check(mid)) &#123;  </span><br><span class="line">         right = mid;    <span class="comment">// check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨  </span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">         left = mid + <span class="number">1</span>;  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> left;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒºé—´[left, right]è¢«åˆ’åˆ†æˆ[left, mid - 1]å’Œ[mid, right]æ—¶ä½¿ç”¨ï¼š  </span></span><br><span class="line"><span class="comment">// æˆ–è€…ç§°ä¹‹ä¸ºå³äºŒåˆ†æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾å³ä¾§æœ€åä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">rightBinarySearch</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;  </span><br><span class="line">   <span class="keyword">while</span> (left &lt; right) &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> arr[left + right + <span class="number">1</span> &gt;&gt; <span class="number">1</span>];  </span><br><span class="line">      <span class="keyword">if</span> (check(mid)) &#123;  </span><br><span class="line">         left = mid;    <span class="comment">// check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨  </span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">         right = mid - <span class="number">1</span>;  <span class="comment">// æœ‰åŠ å¿…æœ‰å‡</span></span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> left;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/791/">æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">q</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="type">int</span>[] arr = IntStream.range(<span class="number">0</span>, n).map(item -&gt; in.nextInt()).toArray();</span><br><span class="line">        <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">            <span class="type">int</span>[] ans = binarySearch(arr, k);</span><br><span class="line">            IntStream.range(<span class="number">0</span>, <span class="number">2</span>).mapToObj(item -&gt; ans[item] + <span class="string">&quot; &quot;</span>).forEach(System.out::print);</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] binarySearch(<span class="type">int</span>[] arr, <span class="type">int</span> target) &#123;</span><br><span class="line">        <span class="comment">// å°†è¿”å›å€¼æ”¾åˆ°ä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„ä¸­</span></span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> arr.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> n - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å…ˆLBSï¼Œæ‰¾åˆ°å·¦è¾¹ç•Œ</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + right &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (arr[mid] &gt;= target) &#123;</span><br><span class="line">                right = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                left = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™é»˜è®¤-1 -1</span></span><br><span class="line">        <span class="keyword">if</span> (arr[left] != target) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        res[<span class="number">0</span>] = left;</span><br><span class="line">        left = <span class="number">0</span>;</span><br><span class="line">        right = n - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å†RBSï¼Œæ‰¾åˆ°å³è¾¹ç•Œ</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + right + <span class="number">1</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (arr[mid] &lt;= target) &#123;</span><br><span class="line">                left = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right = mid - <span class="number">1</span>; <span class="comment">// æœ‰åŠ å¿…æœ‰å‡</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[<span class="number">1</span>] = left;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å››ã€æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿-â€”â€”-æ¨¡æ¿é¢˜-AcWing-790-æ•°çš„ä¸‰æ¬¡æ–¹æ ¹">å››ã€æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” <a href="https://www.acwing.com/problem/content/792/">æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨  </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">double</span> x)</span> &#123;  </span><br><span class="line">   <span class="comment">/* ... */</span>  a</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚ï¼Œé»˜è®¤è´Ÿå…­æ¬¡æ–¹</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">double</span> <span class="variable">EPS</span> <span class="operator">=</span> <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">floatBinarySearch</span><span class="params">(<span class="type">double</span> left, <span class="type">double</span> right)</span> &#123;  </span><br><span class="line">   <span class="keyword">while</span> (right - left &gt; EPS) &#123;  </span><br><span class="line">      <span class="type">double</span> <span class="variable">mid</span> <span class="operator">=</span> (left + right) / <span class="number">2</span>;  </span><br><span class="line">      <span class="keyword">if</span> (check(mid)) &#123;  </span><br><span class="line">         right = mid;  </span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">         left = mid;  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> left;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/792/">æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import java.util.Scanner;  </span><br><span class="line"></span><br><span class="line">public class Main &#123;  </span><br><span class="line"></span><br><span class="line">   public static void main(String[] args) &#123;  </span><br><span class="line">      Scanner in = new Scanner(System.in);  </span><br><span class="line">      double x = in.nextDouble();  </span><br><span class="line">      Double left = -Double.MAX_VALUE;  </span><br><span class="line">      Double right = Double.MAX_VALUE;  </span><br><span class="line">      // ç”±äºè´Ÿå…­æ¬¡æ–¹ç²¾åº¦ä¸å¤Ÿ</span><br><span class="line">      while (right - left &gt; 1e-8) &#123;  </span><br><span class="line">         Double mid = (left + right) / 2;  </span><br><span class="line">         if (mid * mid * mid &gt;= x) &#123;  </span><br><span class="line">            right = mid;  </span><br><span class="line">         &#125; else &#123;  </span><br><span class="line">            left = mid;  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125; </span><br><span class="line">      // æ³¨æ„æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²</span><br><span class="line">      System.out.printf(&quot;%.6f&quot;, left);  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äº”ã€é«˜ç²¾åº¦åŠ æ³•-â€”â€”-æ¨¡æ¿é¢˜-AcWing-791-é«˜ç²¾åº¦åŠ æ³•">äº”ã€é«˜ç²¾åº¦åŠ æ³• â€”â€” <a href="https://www.acwing.com/problem/content/793/">æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³•</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * å¤§æ•°æ®åŠ æ³•  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">add</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">    <span class="comment">// é»˜è®¤A &gt; Bï¼Œå¦‚æœä¸æ»¡è¶³åˆ™å¯¹è°ƒ</span></span><br><span class="line">   <span class="keyword">if</span> (A.size() &lt; B.size()) &#123;  </span><br><span class="line">      <span class="keyword">return</span> add(B, A);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">   List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; A.size(); i++) &#123;  </span><br><span class="line">      t += A.get(i);  </span><br><span class="line">      <span class="comment">// å¦‚æœåœ¨Bçš„èŒƒå›´å†…ï¼Œåˆ™åŠ B</span></span><br><span class="line">      <span class="keyword">if</span> (i &lt; B.size()) &#123;  </span><br><span class="line">         t += B.get(i);  </span><br><span class="line">      &#125; </span><br><span class="line">      <span class="comment">// Cè®°å½•ä½™æ•°</span></span><br><span class="line">      C.add(t % <span class="number">10</span>);  </span><br><span class="line">      t /= <span class="number">10</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="comment">// è¿›ä½</span></span><br><span class="line">   <span class="keyword">if</span> (t != <span class="number">0</span>) &#123;  </span><br><span class="line">      C.add(t);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="comment">// å»æ‰å¼€å¤´çš„é›¶</span></span><br><span class="line">   <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">      C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> C;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/793/">æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³•</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">       <span class="comment">// ç”±äºæ•°æ®é‡è¾ƒå¤§ï¼Œä½¿ç”¨BufferedReaderè¯»å–æ•°æ®</span></span><br><span class="line">       <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));  </span><br><span class="line">       <span class="type">String</span> <span class="variable">A</span> <span class="operator">=</span> in.readLine();  </span><br><span class="line">       List&lt;Integer&gt; aList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> A.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">          aList.add(A.charAt(i) - <span class="string">&#x27;0&#x27;</span>);  </span><br><span class="line">       &#125;  </span><br><span class="line">       <span class="type">String</span> <span class="variable">B</span> <span class="operator">=</span> in.readLine();  </span><br><span class="line">       List&lt;Integer&gt; bList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> B.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">          bList.add(B.charAt(i) - <span class="string">&#x27;0&#x27;</span>);  </span><br><span class="line">       &#125;  </span><br><span class="line">       List&lt;Integer&gt; cList = add(aList, bList);  </span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> cList.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">          System.out.print(cList.get(i));  </span><br><span class="line">       &#125;  </span><br><span class="line">       <span class="comment">// å…³é—­èµ„æº</span></span><br><span class="line">       in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * å¤§æ•°æ®åŠ æ³•  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">add</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">      ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¯å‚è€ƒä¸Šè¿°å®ç°</span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…­ã€é«˜ç²¾åº¦å‡æ³•-â€”â€”-æ¨¡æ¿é¢˜-AcWing-792-é«˜ç²¾åº¦å‡æ³•">å…­ã€é«˜ç²¾åº¦å‡æ³• â€”â€” <a href="https://www.acwing.com/problem/content/794/">æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³•</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">compare</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">    <span class="comment">// ä¼˜å…ˆæ¯”è¾ƒæ•°ç»„é•¿åº¦ï¼Œé•¿åº¦æ›´å¤§ï¼Œæ•°å€¼æ›´å¤§</span></span><br><span class="line">   <span class="keyword">if</span> (A.size() != B.size()) &#123;  </span><br><span class="line">      <span class="keyword">return</span> A.size() &gt; B.size();  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> A.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">      <span class="keyword">if</span> (A.get(i) == B.get(i)) &#123;  </span><br><span class="line">         <span class="keyword">continue</span>;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> A.get(i) &gt; B.get(i);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">true</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * å¤§æ•°æ®å‡æ³•  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">subtract</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">   <span class="keyword">if</span> (!compare(A, B)) &#123;  </span><br><span class="line">      System.out.print(<span class="string">&quot;-&quot;</span>);  </span><br><span class="line">      <span class="keyword">return</span> subtract(B, A);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">   List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; A.size(); i++) &#123;  </span><br><span class="line">      t = A.get(i) - t;  </span><br><span class="line">      <span class="keyword">if</span> (i &lt; B.size()) &#123;  </span><br><span class="line">         t -= B.get(i);  </span><br><span class="line">      &#125;  </span><br><span class="line">      C.add((t + <span class="number">10</span>) % <span class="number">10</span>);  </span><br><span class="line">      <span class="keyword">if</span> (t &lt; <span class="number">0</span>) &#123;  </span><br><span class="line">         t = <span class="number">1</span>;  </span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">         t = <span class="number">0</span>;  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">      C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> C;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/794/">æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³•</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));  </span><br><span class="line">      <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> in.readLine();  </span><br><span class="line">      List&lt;Integer&gt; A = getIntegerList(s);  </span><br><span class="line">      s = in.readLine();  </span><br><span class="line">      List&lt;Integer&gt; B = getIntegerList(s);  </span><br><span class="line">      List&lt;Integer&gt; C = subtract(A, B);  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> C.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         System.out.print(C.get(i));  </span><br><span class="line">      &#125;  </span><br><span class="line">      in.close();  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * ç”±äºæ˜¯å¤§æ•°æ®ï¼Œå› æ­¤ç”¨BufferedReaderè¯»å– æ ¹æ®è¯»å–çš„å­—ç¬¦ä¸²è½¬æ¢æˆé›†åˆ  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getIntegerList</span><span class="params">(String s)</span> &#123;  </span><br><span class="line">      List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(s.length());  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> s.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         res.add(Character.getNumericValue(s.charAt(i)));  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">compare</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">      <span class="keyword">if</span> (A.size() != B.size()) &#123;  </span><br><span class="line">         <span class="keyword">return</span> A.size() &gt; B.size();  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> A.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         <span class="keyword">if</span> (A.get(i) == B.get(i)) &#123;  </span><br><span class="line">            <span class="keyword">continue</span>;  </span><br><span class="line">         &#125;  </span><br><span class="line">         <span class="keyword">return</span> A.get(i) &gt; B.get(i);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * å¤§æ•°æ®å‡æ³•  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">subtract</span><span class="params">(List&lt;Integer&gt; A, List&lt;Integer&gt; B)</span> &#123;  </span><br><span class="line">      <span class="keyword">if</span> (!compare(A, B)) &#123;  </span><br><span class="line">         System.out.print(<span class="string">&quot;-&quot;</span>);  </span><br><span class="line">         <span class="keyword">return</span> subtract(B, A);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; A.size(); i++) &#123;  </span><br><span class="line">         t = A.get(i) - t;  </span><br><span class="line">         <span class="keyword">if</span> (i &lt; B.size()) &#123;  </span><br><span class="line">            t -= B.get(i);  </span><br><span class="line">         &#125;  </span><br><span class="line">         C.add((t + <span class="number">10</span>) % <span class="number">10</span>);  </span><br><span class="line">         <span class="keyword">if</span> (t &lt; <span class="number">0</span>) &#123;  </span><br><span class="line">            t = <span class="number">1</span>;  </span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            t = <span class="number">0</span>;  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">         C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> C;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸ƒã€é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦-â€”â€”-æ¨¡æ¿é¢˜-AcWing-793-é«˜ç²¾åº¦ä¹˜æ³•">ä¸ƒã€é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” <a href="https://www.acwing.com/problem/content/795/">æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³•</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * å¤§æ•°æ®ä¹˜æ³•  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">subtract</span><span class="params">(List&lt;Integer&gt; A, Integer b)</span> &#123;  </span><br><span class="line">   List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">   <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;  </span><br><span class="line">      C.add(<span class="number">0</span>);  </span><br><span class="line">      <span class="keyword">return</span> C;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; A.size(); i++) &#123;  </span><br><span class="line">      t += A.get(i) * b;  </span><br><span class="line">      C.add(t % <span class="number">10</span>);  </span><br><span class="line">      t /= <span class="number">10</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">if</span> (t != <span class="number">0</span>) &#123;  </span><br><span class="line">      C.add(t);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">      C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> C;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/795/">æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³•</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));  </span><br><span class="line">      <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> in.readLine();  </span><br><span class="line">      List&lt;Integer&gt; A = getIntegerList(s);  </span><br><span class="line">      <span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> Integer.parseInt(in.readLine());  </span><br><span class="line">      List&lt;Integer&gt; C = subtract(A, b);  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> C.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         System.out.print(C.get(i));  </span><br><span class="line">      &#125;  </span><br><span class="line">      in.close();  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * ç”±äºæ˜¯å¤§æ•°æ®ï¼Œå› æ­¤ç”¨BufferedReaderè¯»å– æ ¹æ®è¯»å–çš„å­—ç¬¦ä¸²è½¬æ¢æˆé›†åˆ  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getIntegerList</span><span class="params">(String s)</span> &#123;  </span><br><span class="line">      List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(s.length());  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> s.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         res.add(Character.getNumericValue(s.charAt(i)));  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * å¤§æ•°æ®ä¹˜æ³•  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">subtract</span><span class="params">(List&lt;Integer&gt; A, Integer b)</span> &#123;  </span><br><span class="line">      List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;  </span><br><span class="line">         C.add(<span class="number">0</span>);  </span><br><span class="line">         <span class="keyword">return</span> C;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; A.size(); i++) &#123;  </span><br><span class="line">         t += A.get(i) * b;  </span><br><span class="line">         C.add(t % <span class="number">10</span>);  </span><br><span class="line">         t /= <span class="number">10</span>;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">if</span> (t != <span class="number">0</span>) &#123;  </span><br><span class="line">         C.add(t);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">         C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> C;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…«ã€é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦-â€”â€”-æ¨¡æ¿é¢˜-AcWing-794-é«˜ç²¾åº¦é™¤æ³•">å…«ã€é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” <a href="https://www.acwing.com/problem/content/796/">æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³•</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * å¤§æ•°æ®é™¤æ³•  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">divide</span><span class="params">(List&lt;Integer&gt; A, Integer b)</span> &#123;  </span><br><span class="line">   <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">   List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> A.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">      t = t * <span class="number">10</span> + A.get(i);  </span><br><span class="line">      C.add(t / b);  </span><br><span class="line">      t %= b;  </span><br><span class="line">   &#125;  </span><br><span class="line">   Collections.reverse(C);  </span><br><span class="line">   <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">      C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="comment">// ä¸ºäº†æ–¹ä¾¿ä¼ é€’ï¼Œæ”¾åœ¨äº†æ•°ç»„çš„æœ€åä¸€ä½ï¼Œå› æ­¤è¾“å‡ºæ—¶éœ€è¦ä»å€’æ•°ç¬¬äºŒä½å¼€å§‹  </span></span><br><span class="line">   C.add(t);  </span><br><span class="line">   <span class="keyword">return</span> C;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/796/">æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³•</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.Collections;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));  </span><br><span class="line">      <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> in.readLine();  </span><br><span class="line">      List&lt;Integer&gt; A = getIntegerList(s);  </span><br><span class="line">      <span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> Integer.parseInt(in.readLine());  </span><br><span class="line">      List&lt;Integer&gt; C = divide(A, b);  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> C.size() - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         System.out.print(C.get(i));  </span><br><span class="line">      &#125;  </span><br><span class="line">      System.out.println();  </span><br><span class="line">      System.out.print(C.get(C.size() - <span class="number">1</span>));  </span><br><span class="line">      in.close();  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * ç”±äºæ˜¯å¤§æ•°æ®ï¼Œå› æ­¤ç”¨BufferedReaderè¯»å– æ ¹æ®è¯»å–çš„å­—ç¬¦ä¸²è½¬æ¢æˆé›†åˆ  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getIntegerList</span><span class="params">(String s)</span> &#123;  </span><br><span class="line">      List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(s.length());  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> s.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         res.add(Character.getNumericValue(s.charAt(i)));  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="comment">/**  </span></span><br><span class="line"><span class="comment">    * å¤§æ•°æ®é™¤æ³•  </span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">divide</span><span class="params">(List&lt;Integer&gt; A, Integer b)</span> &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      List&lt;Integer&gt; C = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> A.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;  </span><br><span class="line">         t = t * <span class="number">10</span> + A.get(i);  </span><br><span class="line">         C.add(t / b);  </span><br><span class="line">         t %= b;  </span><br><span class="line">      &#125;  </span><br><span class="line">      Collections.reverse(C);  </span><br><span class="line">      <span class="keyword">while</span> (C.size() &gt; <span class="number">1</span> &amp;&amp; C.get(C.size() - <span class="number">1</span>) == <span class="number">0</span>) &#123;  </span><br><span class="line">         C.remove(C.size() - <span class="number">1</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="comment">// ä¸ºäº†æ–¹ä¾¿ä¼ é€’ï¼Œæ”¾åœ¨äº†æ•°ç»„çš„æœ€åä¸€ä½ï¼Œå› æ­¤è¾“å‡ºæ—¶éœ€è¦ä»å€’æ•°ç¬¬äºŒä½å¼€å§‹  </span></span><br><span class="line">      C.add(t);  </span><br><span class="line">      <span class="keyword">return</span> C;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¹ã€ä¸€ç»´å‰ç¼€å’Œ-â€”â€”-303-åŒºåŸŸå’Œæ£€ç´¢-æ•°ç»„ä¸å¯å˜">ä¹ã€ä¸€ç»´å‰ç¼€å’Œ â€”â€”  <a href="https://leetcode-cn.com/problems/range-sum-query-immutable/">303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NumArray</span> &#123;</span><br><span class="line">    <span class="comment">// å‰ç¼€å’Œæ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] preSum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è¾“å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ„é€ å‰ç¼€å’Œ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NumArray</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="comment">// preSum[0] = 0ï¼Œä¾¿äºè®¡ç®—ç´¯åŠ å’Œ</span></span><br><span class="line">        preSum = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">// è®¡ç®— nums çš„ç´¯åŠ å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; preSum.length; i++) &#123;</span><br><span class="line">            preSum[i] = preSum[i - <span class="number">1</span>] + nums[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* æŸ¥è¯¢é—­åŒºé—´ [left, right] çš„ç´¯åŠ å’Œ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sumRange</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> preSum[right + <span class="number">1</span>] - preSum[left];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åã€äºŒç»´å‰ç¼€å’Œ-â€”â€”-304-äºŒç»´åŒºåŸŸå’Œæ£€ç´¢-çŸ©é˜µä¸å¯å˜ã€‚">åã€äºŒç»´å‰ç¼€å’Œ â€”â€”  <a href="https://leetcode-cn.com/problems/range-sum-query-2d-immutable/">304. äºŒç»´åŒºåŸŸå’Œæ£€ç´¢ - çŸ©é˜µä¸å¯å˜</a>ã€‚</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NumMatrix</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ï¼špreSum[i][j] è®°å½• matrix ä¸­å­çŸ©é˜µ [0, 0, i-1, j-1] çš„å…ƒç´ å’Œ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] preSum;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NumMatrix</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length, n = matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span> || n == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// æ„é€ å‰ç¼€å’ŒçŸ©é˜µ</span></span><br><span class="line">        preSum = <span class="keyword">new</span> <span class="title class_">int</span>[m + <span class="number">1</span>][n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="comment">// è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ</span></span><br><span class="line">                preSum[i][j] = preSum[i-<span class="number">1</span>][j] + preSum[i][j-<span class="number">1</span>] + matrix[i - <span class="number">1</span>][j - <span class="number">1</span>] - preSum[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è®¡ç®—å­çŸ©é˜µ [x1, y1, x2, y2] çš„å…ƒç´ å’Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sumRegion</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span> &#123;</span><br><span class="line">        <span class="comment">// ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—</span></span><br><span class="line">        <span class="keyword">return</span> preSum[x2+<span class="number">1</span>][y2+<span class="number">1</span>] - preSum[x1][y2+<span class="number">1</span>] - preSum[x2+<span class="number">1</span>][y1] + preSum[x1][y1];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åä¸€ã€ä¸€ç»´å·®åˆ†-â€”â€”-1109-èˆªç­é¢„è®¢ç»Ÿè®¡">åä¸€ã€ä¸€ç»´å·®åˆ† â€”â€” <a href="https://leetcode.cn/problems/corporate-flight-bookings/">1109. èˆªç­é¢„è®¢ç»Ÿè®¡</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Difference</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] diff;</span><br><span class="line">    </span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Difference</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        diff = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            diff[i] = nums[i] - nums[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        diff[i] += val;</span><br><span class="line">        <span class="keyword">if</span> (j + <span class="number">1</span> &lt; diff.length) &#123;</span><br><span class="line">            diff[j + <span class="number">1</span>] -= val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] result() &#123;</span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[diff.length];</span><br><span class="line">        res[<span class="number">0</span>] = diff[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; res.length; i++) &#123;</span><br><span class="line">            res[i] = res[i - <span class="number">1</span>] + diff[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åäºŒã€äºŒç»´å·®åˆ†-â€”â€”-æ¨¡æ¿é¢˜-AcWing-798-å·®åˆ†çŸ©é˜µ">åäºŒã€äºŒç»´å·®åˆ† â€”â€” <a href="https://www.acwing.com/problem/content/800/">æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ç»™ä»¥(x1, y1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x2, y2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Š cï¼š</span><br><span class="line">S[x1, y1] += c, S[x2 + <span class="number">1</span>, y1] -= c, S[x1, y2 + <span class="number">1</span>] -= c, S[x2 + <span class="number">1</span>, y2 + <span class="number">1</span>] += c</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">1010</span>;  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] a = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] s = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] b = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">difference</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> c)</span> &#123;  </span><br><span class="line">   b[x1][y1] += c;  </span><br><span class="line">   b[x2 + <span class="number">1</span>][y1] -= c;  </span><br><span class="line">   b[x1][y2 + <span class="number">1</span>] -= c;  </span><br><span class="line">   b[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += c;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sumPrefix</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> &#123;  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= m; j++) &#123;  </span><br><span class="line">         s[i][j] = s[i - <span class="number">1</span>][j] + s[i][j - <span class="number">1</span>] - s[i - <span class="number">1</span>][j - <span class="number">1</span>] + b[i][j];  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/800/">æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">1010</span>;  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] a = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] s = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[][] b = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">5</span>][N + <span class="number">5</span>];  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">q</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;  </span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= m; j++) &#123;  </span><br><span class="line">            a[i][j] = in.nextInt();  </span><br><span class="line">            difference(i, j, i, j, a[i][j]);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">x1</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">y1</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">x2</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">y2</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         difference(x1, y1, x2, y2, c);  </span><br><span class="line">      &#125;  </span><br><span class="line">      sumPrefix(n, m);  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;  </span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= m; j++) &#123;  </span><br><span class="line">            System.out.print(s[i][j] + <span class="string">&quot; &quot;</span>);  </span><br><span class="line">         &#125;  </span><br><span class="line">         System.out.println();  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">difference</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> c)</span> &#123;  </span><br><span class="line">      b[x1][y1] += c;  </span><br><span class="line">      b[x2 + <span class="number">1</span>][y1] -= c;  </span><br><span class="line">      b[x1][y2 + <span class="number">1</span>] -= c;  </span><br><span class="line">      b[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += c;  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sumPrefix</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> &#123;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;  </span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= m; j++) &#123;  </span><br><span class="line">            s[i][j] = s[i - <span class="number">1</span>][j] + s[i][j - <span class="number">1</span>] - s[i - <span class="number">1</span>][j - <span class="number">1</span>] + b[i][j];  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åä¸‰ã€ä½è¿ç®—-â€”â€”-æ¨¡æ¿é¢˜-AcWing-801-äºŒè¿›åˆ¶ä¸­-1-çš„ä¸ªæ•°">åä¸‰ã€ä½è¿ç®— â€”â€” <a href="https://www.acwing.com/problem/content/803/">æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°</a></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private static int countDigitOne(int x) &#123;  </span><br><span class="line">   int count = 0;  </span><br><span class="line">   for (int i = x; i != 0; i -= (i &amp; -i)) &#123;  </span><br><span class="line">      count++;  </span><br><span class="line">   &#125;  </span><br><span class="line">   return count;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/803/">æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">5</span>];  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, n).forEach(i -&gt; a[i] = in.nextInt());  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, n).mapToObj(i -&gt; countDigitOne(a[i]) + <span class="string">&quot; &quot;</span>).forEach(System.out::print);  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">countDigitOne</span><span class="params">(<span class="type">int</span> x)</span> &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> x; i != <span class="number">0</span>; i -= (i &amp; -i)) &#123;  </span><br><span class="line">         count++;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> count;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åå››ã€åŒæŒ‡é’ˆç®—æ³•-â€”â€”-æ¨¡æ¿é¢˜-AcWIng-799-æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—-ï¼Œ-AcWing-800-æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ">åå››ã€åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ <a href="https://www.acwing.com/problem/content/801/">AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—</a> ï¼Œ <a href="https://www.acwing.com/problem/content/802/">AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i ++ ) &#123;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; i &amp;&amp; check(i, j)) &#123;</span><br><span class="line">        j ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å…·ä½“é—®é¢˜çš„é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿é¢˜ <a href="https://www.acwing.com/problem/content/801/">AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;  </span><br><span class="line"><span class="keyword">import</span> java.util.Map;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">5</span>];  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, n).forEach(i -&gt; a[i] = in.nextInt());  </span><br><span class="line">      <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> twoPoints(a, n);  </span><br><span class="line">      System.out.println(res);  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">twoPoints</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> n)</span> &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;  </span><br><span class="line">         map.put(a[i], map.getOrDefault(a[i], <span class="number">0</span>) + <span class="number">1</span>);  </span><br><span class="line">         <span class="keyword">while</span> (j &lt; i &amp;&amp; map.get(a[i]) &gt; <span class="number">1</span>) &#123;  </span><br><span class="line">            map.put(a[j], map.getOrDefault(a[j], <span class="number">0</span>) - <span class="number">1</span>);  </span><br><span class="line">            j++;  </span><br><span class="line">         &#125;  </span><br><span class="line">         res = Math.max(res, i - j + <span class="number">1</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿é¢˜ <a href="https://www.acwing.com/problem/content/802/">AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">5</span>];  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, n).forEach(i -&gt; a[i] = in.nextInt());  </span><br><span class="line">      <span class="type">int</span>[] b = <span class="keyword">new</span> <span class="title class_">int</span>[m + <span class="number">5</span>];  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, m).forEach(i -&gt; b[i] = in.nextInt());  </span><br><span class="line">      List&lt;<span class="type">int</span>[]&gt; res = twoPoints(a, n, b, m, x);  </span><br><span class="line">      res.forEach(item -&gt; System.out.println(item[<span class="number">0</span>] + <span class="string">&quot; &quot;</span> + item[<span class="number">1</span>]));  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> List&lt;<span class="type">int</span>[]&gt; twoPoints(<span class="type">int</span>[] a, <span class="type">int</span> n, <span class="type">int</span>[] b, <span class="type">int</span> m, <span class="type">int</span> x) &#123;  </span><br><span class="line">      List&lt;<span class="type">int</span>[]&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = m - <span class="number">1</span>; i &lt; n; i++) &#123;  </span><br><span class="line">         <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; a[i] + b[j] &gt; x) &#123;  </span><br><span class="line">            j--;  </span><br><span class="line">         &#125;  </span><br><span class="line">         <span class="keyword">if</span> (j &gt;= <span class="number">0</span> &amp;&amp; a[i] + b[j] == x) &#123;  </span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;i, j&#125;);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åäº”ã€ç¦»æ•£åŒ–-â€”â€”-æ¨¡æ¿é¢˜-AcWing-802-åŒºé—´å’Œ">åäº”ã€ç¦»æ•£åŒ– â€”â€” <a href="https://www.acwing.com/problem/content/804/">æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å»é‡ + æ’åº  </span></span><br><span class="line">List&lt;Integer&gt; distinctSorterAlls = alls.stream().distinct().sorted()  </span><br><span class="line">      .collect(Collectors.toList());  </span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¦»æ•£åŒ–æ˜ å°„ï¼ŒæŠŠç¦»æ•£åŒ–çš„ä¸‹æ ‡æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„ä¸‹æ ‡ + 1for (int[] item : add) &#123;  </span></span><br><span class="line">   <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">0</span>]) + <span class="number">1</span>;  </span><br><span class="line">   a[index] += item[<span class="number">1</span>];  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰ç¼€å’Œ  </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= distinctSorterAlls.size(); i++) &#123;  </span><br><span class="line">   s[i] = s[i - <span class="number">1</span>] + a[i];  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¦»æ•£åŒ–æ˜ å°„ï¼ŒæŠŠç¦»æ•£åŒ–çš„ä¸‹æ ‡æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„ä¸‹æ ‡ + 1for (int[] item : query) &#123;  </span></span><br><span class="line">   <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">0</span>]) + <span class="number">1</span>;  </span><br><span class="line">   <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">1</span>]) + <span class="number">1</span>;  </span><br><span class="line">   System.out.println(s[r] - s[l - <span class="number">1</span>]);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/804/">æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.Collections;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">300000</span>;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      List&lt;Integer&gt; alls = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[N];  </span><br><span class="line">      <span class="type">int</span>[] s = <span class="keyword">new</span> <span class="title class_">int</span>[N];  </span><br><span class="line">      List&lt;<span class="type">int</span>[]&gt; add = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      List&lt;<span class="type">int</span>[]&gt; query = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         add.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x, c&#125;);  </span><br><span class="line">         alls.add(x);  </span><br><span class="line">      &#125;  </span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         query.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;l, r&#125;);  </span><br><span class="line">         alls.add(l);  </span><br><span class="line">         alls.add(r);  </span><br><span class="line">      &#125;  </span><br><span class="line"></span><br><span class="line">      <span class="comment">// å»é‡ + æ’åº  </span></span><br><span class="line">      List&lt;Integer&gt; distinctSorterAlls = alls.stream().distinct().sorted()  </span><br><span class="line">            .collect(Collectors.toList());  </span><br><span class="line"></span><br><span class="line">      <span class="comment">// ç¦»æ•£åŒ–æ˜ å°„ï¼ŒæŠŠç¦»æ•£åŒ–çš„ä¸‹æ ‡æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„ä¸‹æ ‡ + 1      for (int[] item : add) &#123;  </span></span><br><span class="line">         <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">0</span>]) + <span class="number">1</span>;  </span><br><span class="line">         a[index] += item[<span class="number">1</span>];  </span><br><span class="line">      &#125;  </span><br><span class="line"></span><br><span class="line">      <span class="comment">// å‰ç¼€å’Œ  </span></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= distinctSorterAlls.size(); i++) &#123;  </span><br><span class="line">         s[i] = s[i - <span class="number">1</span>] + a[i];  </span><br><span class="line">      &#125;  </span><br><span class="line"></span><br><span class="line">      <span class="comment">// ç¦»æ•£åŒ–æ˜ å°„ï¼ŒæŠŠç¦»æ•£åŒ–çš„ä¸‹æ ‡æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„ä¸‹æ ‡ + 1      for (int[] item : query) &#123;  </span></span><br><span class="line">         <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">0</span>]) + <span class="number">1</span>;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> Collections.binarySearch(distinctSorterAlls, item[<span class="number">1</span>]) + <span class="number">1</span>;  </span><br><span class="line">         System.out.println(s[r] - s[l - <span class="number">1</span>]);  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åå…­ã€åŒºé—´åˆå¹¶-â€”â€”-æ¨¡æ¿é¢˜-AcWing-803-åŒºé—´åˆå¹¶">åå…­ã€åŒºé—´åˆå¹¶ â€”â€” <a href="https://www.acwing.com/problem/content/805/">æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶</a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] merge(<span class="type">int</span>[][] a) &#123;  </span><br><span class="line">   <span class="keyword">if</span> (a == <span class="literal">null</span> || a.length == <span class="number">0</span> || a[<span class="number">0</span>].length == <span class="number">0</span>) &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>][<span class="number">2</span>];  </span><br><span class="line">   &#125;  </span><br><span class="line">   Arrays.sort(a, Comparator.comparingInt(item -&gt; item[<span class="number">0</span>]));  </span><br><span class="line">   List&lt;<span class="type">int</span>[]&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span>[] arr : a) &#123;  </span><br><span class="line">      <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> arr[<span class="number">0</span>];  </span><br><span class="line">      <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> arr[<span class="number">1</span>];  </span><br><span class="line">      <span class="keyword">if</span> (res.size() == <span class="number">0</span> || res.get(res.size() - <span class="number">1</span>)[<span class="number">1</span>] &lt; left) &#123;  </span><br><span class="line">         res.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;left, right&#125;);  </span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">newRight</span> <span class="operator">=</span> Math.max(res.get(res.size() - <span class="number">1</span>)[<span class="number">1</span>], left);  </span><br><span class="line">         res.set(res.size() - <span class="number">1</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;res.get(res.size() - <span class="number">1</span>)[<span class="number">0</span>], newRight&#125;);  </span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> res.toArray(<span class="keyword">new</span> <span class="title class_">int</span>[res.size()][<span class="number">2</span>]);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.acwing.com/problem/content/805/">æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶</a></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;  </span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;  </span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;  </span><br><span class="line"><span class="keyword">import</span> java.util.List;  </span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;  </span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;  </span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);  </span><br><span class="line">      <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">      <span class="type">int</span>[][] a = <span class="keyword">new</span> <span class="title class_">int</span>[n][<span class="number">2</span>];  </span><br><span class="line">      IntStream.range(<span class="number">0</span>, n).forEach(i -&gt; &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         a[i][<span class="number">0</span>] = l;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> in.nextInt();  </span><br><span class="line">         a[i][<span class="number">1</span>] = r;  </span><br><span class="line">      &#125;);  </span><br><span class="line">      <span class="type">int</span>[][] res = merge(a);  </span><br><span class="line">      System.out.println(res.length);  </span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] merge(<span class="type">int</span>[][] a) &#123;  </span><br><span class="line">      <span class="keyword">if</span> (a == <span class="literal">null</span> || a.length == <span class="number">0</span> || a[<span class="number">0</span>].length == <span class="number">0</span>) &#123;  </span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>][<span class="number">2</span>];  </span><br><span class="line">      &#125;  </span><br><span class="line">      Arrays.sort(a, Comparator.comparingInt(item -&gt; item[<span class="number">0</span>]));  </span><br><span class="line">      List&lt;<span class="type">int</span>[]&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span>[] arr : a) &#123;  </span><br><span class="line">         <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> arr[<span class="number">0</span>];  </span><br><span class="line">         <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> arr[<span class="number">1</span>];  </span><br><span class="line">         <span class="keyword">if</span> (res.size() == <span class="number">0</span> || res.get(res.size() - <span class="number">1</span>)[<span class="number">1</span>] &lt; left) &#123;  </span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;left, right&#125;);  </span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            <span class="type">int</span> <span class="variable">newRight</span> <span class="operator">=</span> Math.max(res.get(res.size() - <span class="number">1</span>)[<span class="number">1</span>], right);  </span><br><span class="line">            res.set(res.size() - <span class="number">1</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;res.get(res.size() - <span class="number">1</span>)[<span class="number">0</span>], newRight&#125;);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">return</span> res.toArray(<span class="keyword">new</span> <span class="title class_">int</span>[res.size()][<span class="number">2</span>]);  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> ä»£ç æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒæŒ‡é’ˆé—®é¢˜</title>
      <link href="/posts/33830.html"/>
      <url>/posts/33830.html</url>
      
        <content type="html"><![CDATA[<h1>åŒæŒ‡é’ˆ</h1><h4 id="27-ç§»é™¤å…ƒç´ "><a href="https://leetcode.cn/problems/remove-element/">27. ç§»é™¤å…ƒç´ </a></h4><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªå€¼ <code>val</code>ï¼Œä½ éœ€è¦ <strong><a href="https://baike.baidu.com/item/%E5%8E%9F%E5%9C%B0%E7%AE%97%E6%B3%95">åŸåœ°</a></strong> ç§»é™¤æ‰€æœ‰æ•°å€¼ç­‰äº <code>val</code> çš„å…ƒç´ ï¼Œå¹¶è¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»ä»…ä½¿ç”¨ <code>O(1)</code> é¢å¤–ç©ºé—´å¹¶ <strong><a href="https://baike.baidu.com/item/%E5%8E%9F%E5%9C%B0%E7%AE%97%E6%B3%95">åŸåœ° </a>ä¿®æ”¹è¾“å…¥æ•°ç»„</strong>ã€‚</p><p>å…ƒç´ çš„é¡ºåºå¯ä»¥æ”¹å˜ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p><p><strong>è¯´æ˜:</strong></p><p>ä¸ºä»€ä¹ˆè¿”å›æ•°å€¼æ˜¯æ•´æ•°ï¼Œä½†è¾“å‡ºçš„ç­”æ¡ˆæ˜¯æ•°ç»„å‘¢?</p><p>è¯·æ³¨æ„ï¼Œè¾“å…¥æ•°ç»„æ˜¯ä»¥**ã€Œå¼•ç”¨ã€**æ–¹å¼ä¼ é€’çš„ï¼Œè¿™æ„å‘³ç€åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚</p><p>ä½ å¯ä»¥æƒ³è±¡å†…éƒ¨æ“ä½œå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// nums æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯¹å®å‚ä½œä»»ä½•æ‹·è´</span><br><span class="line">int len = removeElement(nums, val);</span><br><span class="line"></span><br><span class="line">// åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚</span><br><span class="line">// æ ¹æ®ä½ çš„å‡½æ•°è¿”å›çš„é•¿åº¦, å®ƒä¼šæ‰“å°å‡ºæ•°ç»„ä¸­ è¯¥é•¿åº¦èŒƒå›´å†… çš„æ‰€æœ‰å…ƒç´ ã€‚</span><br><span class="line">for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">    print(nums[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [3,2,2,3], val = 3</span><br><span class="line">è¾“å‡ºï¼š2, nums = [2,2]</span><br><span class="line">è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°è¿”å›çš„æ–°é•¿åº¦ä¸º 2 ï¼Œè€Œ nums = [2,2,3,3] æˆ– nums = [2,2,0,0]ï¼Œä¹Ÿä¼šè¢«è§†ä½œæ­£ç¡®ç­”æ¡ˆã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [0,1,2,2,3,0,4,2], val = 2</span><br><span class="line">è¾“å‡ºï¼š5, nums = [0,1,4,0,3]</span><br><span class="line">è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º 0, 1, 3, 0, 4ã€‚æ³¨æ„è¿™äº”ä¸ªå…ƒç´ å¯ä¸ºä»»æ„é¡ºåºã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= nums.length &lt;= 100</code></li><li><code>0 &lt;= nums[i] &lt;= 50</code></li><li><code>0 &lt;= val &lt;= 100</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeElement</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="comment">//å¿«æŒ‡é’ˆå¯»æ‰¾æ–°æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œæ…¢æŒ‡é’ˆg</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">fast</span> <span class="operator">=</span> <span class="number">0</span>, slow = <span class="number">0</span>;</span><br><span class="line">       <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">       <span class="keyword">while</span> (fast != nums.length) &#123;</span><br><span class="line">           <span class="keyword">if</span> (nums[fast] != val) &#123;</span><br><span class="line">               nums[slow++] = nums[fast]; </span><br><span class="line">           &#125;</span><br><span class="line">           fast++;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="977-æœ‰åºæ•°ç»„çš„å¹³æ–¹"><a href="https://leetcode.cn/problems/squares-of-a-sorted-array/">977. æœ‰åºæ•°ç»„çš„å¹³æ–¹</a></h4><p><a href="https://leetcode.cn/problems/squares-of-a-sorted-array/#">æ€è·¯</a></p><p>éš¾åº¦ç®€å•733</p><p>ç»™ä½ ä¸€ä¸ªæŒ‰ <strong>éé€’å‡é¡ºåº</strong> æ’åºçš„æ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œè¿”å› <strong>æ¯ä¸ªæ•°å­—çš„å¹³æ–¹</strong> ç»„æˆçš„æ–°æ•°ç»„ï¼Œè¦æ±‚ä¹ŸæŒ‰ <strong>éé€’å‡é¡ºåº</strong> æ’åºã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [-4,-1,0,3,10]</span><br><span class="line">è¾“å‡ºï¼š[0,1,9,16,100]</span><br><span class="line">è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [16,1,0,9,100]</span><br><span class="line">æ’åºåï¼Œæ•°ç»„å˜ä¸º [0,1,9,16,100]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [-7,-3,2,3,11]</span><br><span class="line">è¾“å‡ºï¼š[4,9,9,49,121]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 104</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li><li><code>nums</code> å·²æŒ‰ <strong>éé€’å‡é¡ºåº</strong> æ’åº</li></ul><p><strong>è¿›é˜¶ï¼š</strong></p><ul><li>è¯·ä½ è®¾è®¡æ—¶é—´å¤æ‚åº¦ä¸º <code>O(n)</code> çš„ç®—æ³•è§£å†³æœ¬é—®é¢˜</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortedSquares(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> , j = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> result[] = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">        <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= j &amp;&amp; cur &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] * nums[i] &gt;= nums[j] * nums[j]) &#123;</span><br><span class="line">                result[cur--] = nums[i] * nums[i];</span><br><span class="line">                i++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                result[cur--] = nums[j] * nums[j];</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] generateMatrix(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">line</span> <span class="operator">=</span> <span class="number">0</span>, column = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">boundary</span> <span class="operator">=</span> n;</span><br><span class="line">        <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stopValue</span> <span class="operator">=</span> n * n;</span><br><span class="line">        <span class="type">int</span>[][] matrix = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];  </span><br><span class="line">        <span class="keyword">while</span> (value &lt; stopValue) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; column &lt; boundary - <span class="number">1</span>; column++) &#123;</span><br><span class="line">                matrix[line][column] = value;</span><br><span class="line">                value++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (; line &lt; boundary - <span class="number">1</span>; line++) &#123;</span><br><span class="line">                matrix[line][column] = value;</span><br><span class="line">                value++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (; column &gt; n - boundary; column--) &#123;</span><br><span class="line">                matrix[line][column] = value;</span><br><span class="line">                value++; </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (; line &gt; n - boundary; line--) &#123;</span><br><span class="line">                matrix[line][column] = value;</span><br><span class="line">                value++;</span><br><span class="line">            &#125;</span><br><span class="line">            column++;</span><br><span class="line">            line++;</span><br><span class="line">            boundary--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n % <span class="number">2</span> != <span class="number">0</span>) matrix[line][column] = value;</span><br><span class="line">        <span class="keyword">return</span> matrix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="203-ç§»é™¤é“¾è¡¨å…ƒç´ "><a href="https://leetcode.cn/problems/remove-linked-list-elements/">203. ç§»é™¤é“¾è¡¨å…ƒç´ </a></h4><p>éš¾åº¦ç®€å•1174</p><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> å’Œä¸€ä¸ªæ•´æ•° <code>val</code> ï¼Œè¯·ä½ åˆ é™¤é“¾è¡¨ä¸­æ‰€æœ‰æ»¡è¶³ <code>Node.val == val</code> çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å› <strong>æ–°çš„å¤´èŠ‚ç‚¹</strong> ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/03/06/removelinked-list.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2,6,3,4,5,6], val = 6</span><br><span class="line">è¾“å‡ºï¼š[1,2,3,4,5]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [], val = 1</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [7,7,7,7], val = 7</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>åˆ—è¡¨ä¸­çš„èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ <code>[0, 104]</code> å†…</li><li><code>1 &lt;= Node.val &lt;= 50</code></li><li><code>0 &lt;= val &lt;= 50</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">removeElements</span><span class="params">(ListNode head, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == head) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>,head);</span><br><span class="line">        <span class="type">ListNode</span>  <span class="variable">cur</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">while</span> (cur.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.next.val == val) &#123;</span><br><span class="line"></span><br><span class="line">                cur.next = cur.next.next;</span><br><span class="line">            &#125;<span class="keyword">else</span> cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dummy.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹"><a href="https://leetcode.cn/problems/swap-nodes-in-pairs/">24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹</a></h4><p><a href="https://leetcode.cn/problems/swap-nodes-in-pairs/#">æ€è·¯</a></p><p>éš¾åº¦ä¸­ç­‰1733</p><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œä¸¤ä¸¤äº¤æ¢å…¶ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›äº¤æ¢åé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚ä½ å¿…é¡»åœ¨ä¸ä¿®æ”¹èŠ‚ç‚¹å†…éƒ¨çš„å€¼çš„æƒ…å†µä¸‹å®Œæˆæœ¬é¢˜ï¼ˆå³ï¼Œåªèƒ½è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2020/10/03/swap_ex1.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2,3,4]</span><br><span class="line">è¾“å‡ºï¼š[2,1,4,3]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = []</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1]</span><br><span class="line">è¾“å‡ºï¼š[1]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ <code>[0, 100]</code> å†…</li><li><code>0 &lt;= Node.val &lt;= 100</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">swapPairs</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyHead</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> dummyHead;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">null</span> != cur.next &amp;&amp; <span class="literal">null</span> != cur.next.next) &#123;</span><br><span class="line">            slow = cur.next;</span><br><span class="line">            fast = slow.next;</span><br><span class="line">            slow.next = fast.next;</span><br><span class="line">            fast.next = slow;</span><br><span class="line">            cur.next = fast;</span><br><span class="line">            cur = cur.next.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummyHead.next;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›æº¯æš´æœ-æ’åˆ—ç»„åˆé—®é¢˜å…¨è§£</title>
      <link href="/posts/53015.html"/>
      <url>/posts/53015.html</url>
      
        <content type="html"><![CDATA[<h2 id="å›æº¯ç®—æ³•æ¨¡æ¿">å›æº¯ç®—æ³•æ¨¡æ¿</h2><p>å›æº¯ç®—æ³•å’ŒDFSå¾ˆåƒ, æœ¬è´¨éƒ½æ˜¯æ˜¯ä¸€ç§æš´åŠ›æšä¸¾ç®—æ³•, ä¸è¿‡å›æº¯ç®—æ³•æ˜¯éå†æ ‘æ, DFSæ˜¯åœ¨éå†ç»“ç‚¹</p><p>å›æº¯é—®é¢˜éœ€è¦æ€è€ƒä¸‰ä¸ªé—®é¢˜</p><ul><li>è·¯å¾„: åšå‡ºçš„é€‰æ‹©</li><li>é€‰æ‹©åˆ—è¡¨: å½“å‰å¯ä»¥åšçš„é€‰æ‹©</li><li>ç»“æŸæ¡ä»¶: åˆ°è¾¾å†³ç­–åº•å±‚æ— éœ€æˆ–è€…æ— æ³•è¿›ä¸€æ­¥é€‰æ‹©</li></ul><p>ä¼ªä»£ç æ¨¡æ¿(python)</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backtrack</span>(<span class="params">è·¯å¾„, é€‰æ‹©åˆ—è¡¨</span>):</span><br><span class="line">    <span class="keyword">if</span> æ»¡è¶³ç»“æŸæ¡ä»¶:</span><br><span class="line">        result.add(è·¯å¾„)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> é€‰æ‹© <span class="keyword">in</span> é€‰æ‹©åˆ—è¡¨:</span><br><span class="line">        åšé€‰æ‹©</span><br><span class="line">        backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)</span><br><span class="line">        æ’¤é”€é€‰æ‹©</span><br></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Šå°±æ˜¯å¯¹ä¸€æ£µé€’å½’æ ‘è¿›è¡Œé€‰æ‹©å’Œæ’¤å›,åœ¨åˆé€‚çš„ä½ç½®(å‰åºå’Œåç»­)è¿›è¡Œé€‰æ‹©å’Œè®°å½•</p><p>ä»¥ä¸‹æ˜¯å…¨æ’åˆ—ä»£ç </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permute</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="comment">// è®°å½•ã€Œè·¯å¾„ã€</span></span><br><span class="line">        LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// ã€Œè·¯å¾„ã€ä¸­çš„å…ƒç´ ä¼šè¢«æ ‡è®°ä¸º trueï¼Œé¿å…é‡å¤ä½¿ç”¨</span></span><br><span class="line">        <span class="type">boolean</span>[] used = <span class="keyword">new</span> <span class="title class_">boolean</span>[nums.length];</span><br><span class="line">        </span><br><span class="line">        backtrack(nums, track, used);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·¯å¾„ï¼šè®°å½•åœ¨ track ä¸­</span></span><br><span class="line">    <span class="comment">// é€‰æ‹©åˆ—è¡¨ï¼šnums ä¸­ä¸å­˜åœ¨äº track çš„é‚£äº›å…ƒç´ ï¼ˆused[i] ä¸º falseï¼‰</span></span><br><span class="line">    <span class="comment">// ç»“æŸæ¡ä»¶ï¼šnums ä¸­çš„å…ƒç´ å…¨éƒ½åœ¨ track ä¸­å‡ºç°</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums, LinkedList&lt;Integer&gt; track, <span class="type">boolean</span>[] used)</span> &#123;</span><br><span class="line">        <span class="comment">// è§¦å‘ç»“æŸæ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (track.size() == nums.length) &#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>(track));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="comment">// æ’é™¤ä¸åˆæ³•çš„é€‰æ‹©</span></span><br><span class="line">            <span class="keyword">if</span> (used[i]) &#123;</span><br><span class="line">                <span class="comment">// nums[i] å·²ç»åœ¨ track ä¸­ï¼Œè·³è¿‡</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åšé€‰æ‹©</span></span><br><span class="line">            track.add(nums[i]);</span><br><span class="line">            used[i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// è¿›å…¥ä¸‹ä¸€å±‚å†³ç­–æ ‘</span></span><br><span class="line">            backtrack(nums, track, used);</span><br><span class="line">            <span class="comment">// å–æ¶ˆé€‰æ‹©</span></span><br><span class="line">            track.removeLast();</span><br><span class="line">            used[i] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ’åˆ—ç»„åˆçš„åŸºæœ¬æƒ…å†µ">æ’åˆ—ç»„åˆçš„åŸºæœ¬æƒ…å†µ</h2><p>å…³é”®æ˜¯å¦‚ä½•åœ¨åˆé€‚ä½ç½®æ€æ ·çš„è¿›è¡Œå‰ªæå’Œè®°å½•</p><p>ç±»ä¼¼æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜åˆ†ç±»æˆä¸‰ç±»</p><ul><li><p>å­é›†</p></li><li><p>ç»„åˆ</p></li><li><p>æ’åˆ—</p></li></ul><p>æŒ‰ç…§ç»™å‡ºæ•°ç»„æ˜¯å¦å¯é€‰å…ƒç´ æ˜¯å¦å¯ä»¥å¤é€‰åˆå¯ä»¥åˆ†ä¸ºä¸‰ç±»</p><ul><li>å…ƒç´ æ— é‡ä¸å¯å¤é€‰</li><li>å…ƒç´ å¯é‡ä¸å¯å¤é€‰</li><li>å…ƒç´ æ— é‡å¯å¤é€‰</li></ul><p>å…ƒç´ å¯é‡å¤å¯é€‰å…¶å®å°±æ˜¯æ— é‡å¯å¤é€‰</p><p>æ¯”å¦‚è¾“å…¥ <code>nums = [1,2,3]</code>ï¼Œç®—æ³•åº”è¯¥è¿”å›å¦‚ä¸‹å­é›†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ [],[1],[2],[3],[1,2],[1,3],[2,3],[1,2,3] ]</span><br></pre></td></tr></table></figure><p>å­é›†é—®é¢˜æ˜¯å¯¹æ¯æ¬¡é€‰æ‹©è¿›è¡Œè®°å½•æ‰€ä»¥åœ¨éå†å†³ç­–æ ‘çš„å‰åºä½ç½®å°†è·¯å¾„æ·»åŠ åˆ°ç»“æœé›†ä¸­</p><p><strong>æˆ‘ä»¬é€šè¿‡ä¿è¯å…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåºä¸å˜æ¥é˜²æ­¢å‡ºç°é‡å¤çš„å­é›†</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// è®°å½•å›æº¯ç®—æ³•çš„é€’å½’è·¯å¾„</span></span><br><span class="line">    LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsets</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        backtrack(nums, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›æº¯ç®—æ³•æ ¸å¿ƒå‡½æ•°ï¼Œéå†å­é›†é—®é¢˜çš„å›æº¯æ ‘</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‰åºä½ç½®ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ä¸€ä¸ªå­é›†</span></span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;(track));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å›æº¯ç®—æ³•æ ‡å‡†æ¡†æ¶</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="comment">// åšé€‰æ‹©</span></span><br><span class="line">            track.addLast(nums[i]);</span><br><span class="line">            <span class="comment">// é€šè¿‡ start å‚æ•°æ§åˆ¶æ ‘æçš„éå†ï¼Œé¿å…äº§ç”Ÿé‡å¤çš„å­é›†</span></span><br><span class="line">            backtrack(nums, i + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// æ’¤é”€é€‰æ‹©</span></span><br><span class="line">            track.removeLast();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»„åˆé—®é¢˜</p><p><strong>ç»„åˆå°±æ˜¯å¯¹åº”é•¿åº¦çš„å­é›†</strong></p><p>å®é™…ä¸Šå°±æ˜¯åœ¨å­é›†é—®é¢˜çš„åŸºç¡€ä¸ŠåŠ ä¸€å±‚åˆ¤æ–­,åªæœ‰å½“å­é›†ä¸­å…ƒç´ çš„ä¸ªæ•°ç­‰äºç»„åˆæ•°çš„é•¿åº¦æ—¶æ‰è®°å½•</p><p>æ¯”å¦‚æˆ‘ä»¬è¦ç»„åˆ <code>nums = [1,2,3]</code>ä¸­çš„ä¸¤ä¸ªæ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ [1,2],[1,3],[2,3] ]</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// è®°å½•å›æº¯ç®—æ³•çš„é€’å½’è·¯å¾„</span></span><br><span class="line">    LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">combine</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        backtrack(<span class="number">1</span>, n, k);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span> start, <span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="comment">// base case</span></span><br><span class="line">        <span class="keyword">if</span> (k == track.size()) &#123;</span><br><span class="line">            <span class="comment">// éå†åˆ°äº†ç¬¬ k å±‚ï¼Œæ”¶é›†å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;(track));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å›æº¯ç®—æ³•æ ‡å‡†æ¡†æ¶</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="comment">// é€‰æ‹©</span></span><br><span class="line">            track.addLast(i);</span><br><span class="line">            <span class="comment">// é€šè¿‡ start å‚æ•°æ§åˆ¶æ ‘æçš„éå†ï¼Œé¿å…äº§ç”Ÿé‡å¤çš„å­é›†</span></span><br><span class="line">            backtrack(i + <span class="number">1</span>, n, k);</span><br><span class="line">            <span class="comment">// æ’¤é”€é€‰æ‹©</span></span><br><span class="line">            track.removeLast();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»æœ€ç®€å•çš„å­é›†é—®é¢˜æ¨å¹¿åˆ°éœ€è¦åŠ åˆ¤æ–­æ¡ä»¶å’Œstartçš„ç»„åˆé—®é¢˜ä»¥åŠåŠ åˆ¤æ–­æ¡ä»¶å’Œusedæ•°ç»„çš„æ’åˆ—é—®é¢˜</p><h2 id="æ’åˆ—ç»„åˆå¤æ‚æƒ…å†µ">æ’åˆ—ç»„åˆå¤æ‚æƒ…å†µ</h2><p>å¯¹äºå›æº¯çš„æ’åˆ—ç»„åˆé—®é¢˜ä¸Šè¿°å…ƒç´ å‡ä¸ºæ— é‡å¤ä¸”ä¸å¯å¤é€‰çš„æƒ…å†µ</p><p>å®é™…å¯ä»¥åˆ†ä¸ºä¸‰ç±»</p><ul><li>æ— é‡å¤ä¸å¯å¤é€‰</li><li>æœ‰é‡å¤ä¸å¯å¤é€‰</li><li>æ— é‡å¤å¯å¤é€‰</li></ul><p>æœ‰é‡å¤å¯å¤é€‰çš„æƒ…å†µæœ¬è´¨å’Œæ— é‡å¤å¯å¤é€‰ä¸€æ ·(æ—¢ç„¶å¯å¤é€‰,å…ƒç´ é‡ä¸é‡å¤éƒ½ä¸€æ ·,ç­‰ä»·äºæ— é‡å¤å¯å¤é€‰)</p><p>æ— é‡å¤ä¸å¯å¤é€‰å°±æ˜¯æœ€åŸºæœ¬çš„æƒ…å†µ,ä¸Šé¢å·²ç»è®²è¿‡äº†</p><p>ä¸‹é¢è°ˆè°ˆæœ‰é‡å¤ä¸å¯å¤é€‰çš„æƒ…å†µ</p><p>å­é›†é—®é¢˜</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsetsWithDup</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆæ’åºï¼Œè®©ç›¸åŒçš„å…ƒç´ é åœ¨ä¸€èµ·</span></span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        backtrack(nums, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start)</span> &#123;</span><br><span class="line">        <span class="comment">// å‰åºä½ç½®ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ä¸€ä¸ªå­é›†</span></span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;(track));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="comment">// å‰ªæé€»è¾‘ï¼Œå€¼ç›¸åŒçš„ç›¸é‚»æ ‘æï¼Œåªéå†ç¬¬ä¸€æ¡</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; start &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            track.addLast(nums[i]);</span><br><span class="line">            backtrack(nums, i + <span class="number">1</span>);</span><br><span class="line">            track.removeLast();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»„åˆ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsetsWithDup</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆæ’åºï¼Œè®©ç›¸åŒçš„å…ƒç´ é åœ¨ä¸€èµ·</span></span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        backtrack(nums, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start)</span> &#123;</span><br><span class="line">         <span class="comment">// base case</span></span><br><span class="line">        <span class="keyword">if</span> (nums.length == track.size()) &#123;</span><br><span class="line">            <span class="comment">// éå†åˆ°äº†ç¬¬ k å±‚ï¼Œæ”¶é›†å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;(track));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="comment">// å‰ªæé€»è¾‘ï¼Œå€¼ç›¸åŒçš„ç›¸é‚»æ ‘æï¼Œåªéå†ç¬¬ä¸€æ¡</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; start &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            track.addLast(nums[i]);</span><br><span class="line">            backtrack(nums, i + <span class="number">1</span>);</span><br><span class="line">            track.removeLast();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’åˆ—</p><p>å‡è®¾è¾“å…¥ä¸º <code>nums = [1,2,2']</code>ï¼Œæ ‡å‡†çš„å…¨æ’åˆ—ç®—æ³•ä¼šå¾—å‡ºå¦‚ä¸‹ç­”æ¡ˆï¼š</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    [1,2,2&#x27;],[1,2&#x27;,2],</span><br><span class="line">    [2,1,2&#x27;],[2,2&#x27;,1],</span><br><span class="line">    [2&#x27;,1,2],[2&#x27;,2,1]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œè¿™ä¸ªç»“æœå­˜åœ¨é‡å¤ï¼Œæ¯”å¦‚ <code>[1,2,2']</code> å’Œ <code>[1,2',2]</code> åº”è¯¥åªè¢«ç®—ä½œåŒä¸€ä¸ªæ’åˆ—ï¼Œä½†è¢«ç®—ä½œäº†ä¸¤ä¸ªä¸åŒçš„æ’åˆ—ã€‚</p><p>æ‰€ä»¥ç°åœ¨çš„å…³é”®åœ¨äºï¼Œå¦‚ä½•è®¾è®¡å‰ªæé€»è¾‘ï¼ŒæŠŠè¿™ç§é‡å¤å»é™¤æ‰ï¼Ÿ</p><p><strong>ç­”æ¡ˆæ˜¯ï¼Œä¿è¯ç›¸åŒå…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ä¿æŒä¸å˜</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    LinkedList&lt;Integer&gt; track = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">boolean</span>[] used;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permuteUnique</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆæ’åºï¼Œè®©ç›¸åŒçš„å…ƒç´ é åœ¨ä¸€èµ·</span></span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        used = <span class="keyword">new</span> <span class="title class_">boolean</span>[nums.length];</span><br><span class="line">        backtrack(nums);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (track.size() == nums.length) &#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>(track));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (used[i]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ–°æ·»åŠ çš„å‰ªæé€»è¾‘ï¼Œå›ºå®šç›¸åŒçš„å…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®,ä¿è¯åŒä¸€å±‚ä¸å‡ºç°ç›¸åŒçš„å€¼</span></span><br><span class="line">           <span class="comment">//å½“å‡ºç°é‡å¤å…ƒç´ æ—¶ï¼Œæ¯”å¦‚è¾“å…¥ nums = [1,2,2&#x27;,2&#x27;&#x27;]ï¼Œ2&#x27; åªæœ‰åœ¨ 2 å·²ç»è¢«ä½¿ç”¨çš„æƒ…å†µä¸‹æ‰ä¼šè¢«é€‰æ‹©ï¼ŒåŒç†ï¼Œ`2&#x27;&#x27;` åªæœ‰åœ¨ 2&#x27; å·²ç»è¢«ä½¿ç”¨çš„æƒ…å†µä¸‹æ‰ä¼šè¢«é€‰æ‹©ï¼Œè¿™å°±ä¿è¯äº†ç›¸åŒå…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ä¿è¯å›ºå®š</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i - <span class="number">1</span>] &amp;&amp; !used[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœå‰é¢çš„ç›¸é‚»ç›¸ç­‰å…ƒç´ æ²¡æœ‰ç”¨è¿‡ï¼Œåˆ™è·³è¿‡</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            track.add(nums[i]);</span><br><span class="line">            used[i] = <span class="literal">true</span>;</span><br><span class="line">            backtrack(nums);</span><br><span class="line">            track.removeLast();</span><br><span class="line">            used[i] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å½“å‡ºç°é‡å¤å…ƒç´ æ—¶ï¼Œæ¯”å¦‚è¾“å…¥ <code>nums = [1,2,2',2'']</code>ï¼Œ<code>2'</code> åªæœ‰åœ¨ <code>2</code> å·²ç»è¢«ä½¿ç”¨çš„æƒ…å†µä¸‹æ‰ä¼šè¢«é€‰æ‹©ï¼ŒåŒç†ï¼Œ<code>2''</code> åªæœ‰åœ¨ <code>2'</code> å·²ç»è¢«ä½¿ç”¨çš„æƒ…å†µä¸‹æ‰ä¼šè¢«é€‰æ‹©ï¼Œè¿™å°±ä¿è¯äº†ç›¸åŒå…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ä¿è¯å›ºå®š</strong>ã€‚</p><p>è¿™æ ·çš„å†™æ³•ä¹Ÿå¯ä»¥,ä¿è¯åŒä¸€å±‚ä¸å‡ºç°ç›¸åŒçš„å€¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span>[] nums, LinkedList&lt;Integer&gt; track)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (track.size() == nums.length) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">LinkedList</span>(track));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•ä¹‹å‰æ ‘æä¸Šå…ƒç´ çš„å€¼</span></span><br><span class="line">    <span class="comment">// é¢˜ç›®è¯´ -10 &lt;= nums[i] &lt;= 10ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸ºç‰¹æ®Šå€¼</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">prevNum</span> <span class="operator">=</span> -<span class="number">666</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="comment">// æ’é™¤ä¸åˆæ³•çš„é€‰æ‹©</span></span><br><span class="line">        <span class="keyword">if</span> (used[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] == prevNum) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        track.add(nums[i]);</span><br><span class="line">        used[i] = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// è®°å½•è¿™æ¡æ ‘æä¸Šçš„å€¼</span></span><br><span class="line">        prevNum = nums[i];</span><br><span class="line"></span><br><span class="line">        backtrack(nums, track);</span><br><span class="line"></span><br><span class="line">        track.removeLast();</span><br><span class="line">        used[i] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢è“äºŒåˆ†æ³•ï¼Œè¾¹ç•Œåˆ¤å®šä¸ç”¨æ„</title>
      <link href="/posts/28847.html"/>
      <url>/posts/28847.html</url>
      
        <content type="html"><![CDATA[<h1>ğŸ“•ğŸ“˜çº¢è“äºŒåˆ†æ³• è§£é¢˜</h1><p>â€‹</p><h2 id="ğŸ”çº¢è“äºŒåˆ†æ³•è®²è§£ï¼š">ğŸ”çº¢è“äºŒåˆ†æ³•è®²è§£ï¼š</h2><p><strong>ç‰¹æ­¤å£°æ˜ï¼šæœ¬æ–‡æ¨¡æ¿éåŸåˆ›ï¼Œæ ¸å¿ƒå†…å®¹å‡è½¬è‡ªBç«™ äº”ç‚¹ä¸ƒè¾¹ ï¼Œæœ¬äººä¸»è¦è¿›è¡Œç®€è¦ä»‹ç»ï¼Œç›¸åº”é¢˜ç›®ä»£ç å±•ç¤ºï¼ŒæŒç»­æ›´æ–°ä¸­â€¦â€¦</strong></p><p>å…³äºçº¢è“äºŒåˆ†æ³•ï¼Œäº”ç‚¹ä¸ƒè¾¹ä»¥ç»™å‡ºå¾ˆä¸é”™çš„è®²è§£ï¼š</p><p><a href="https://www.bilibili.com/video/BV1d54y1q7k7/?spm_id_from=333.999.0.0&amp;vd_source=a2cdc337163157715ec6605c77937a77">äºŒåˆ†æŸ¥æ‰¾ä¸ºä»€ä¹ˆæ€»æ˜¯å†™é”™ï¼Ÿ_å“”å“©å“”å“©_bilibili</a></p><p><code>leetcode</code> å¤§ä½¬è®²è§£çº¢è“äºŒåˆ†æ³•</p><p><a href="https://leetcode.cn/problems/find-first-and-last-position-of-element-in-sorted-array/solution/lan-hong-hua-fen-fa-dan-mo-ban-miao-sha-e7r40/">è“çº¢äºŒåˆ†æ³•å•æ¨¡æ¿ç§’æ€äºŒåˆ†æŸ¥æ‰¾</a></p><h2 id="ğŸŒŸäºŒåˆ†çš„æœ¬è´¨ï¼š">ğŸŒŸäºŒåˆ†çš„æœ¬è´¨ï¼š</h2><p>â€‹å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æŸç§æ–¹å¼å°†ä¸€ä¸ªåŒºé—´<strong>åˆ’åˆ†æˆä¸¤ä¸ªåŒºé—´ï¼Œå·¦è¾¹åŒºé—´æ»¡è¶³æŸç§ç‰¹æ€§ï¼›å³è¾¹åŒºé—´ä¸æ»¡è¶³æŸç§ç‰¹æ€§</strong>ã€‚<br>â€‹é‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡äºŒåˆ†æ³•æ¥å¯»æ‰¾å·¦åŒºé—´çš„å³è¾¹ç«¯ç‚¹æˆ–è€…å³åŒºé—´çš„å·¦è¾¹ç«¯ç‚¹</p><p>â€‹<strong>æœ‰å•è°ƒæ€§ä¸€å®šå¯ä»¥äºŒåˆ†ï¼Œä½†æ˜¯äºŒåˆ†ä¸ä¸€å®šè¦æœ‰å•è°ƒæ€§</strong></p><p>â€‹é€šå¸¸äºŒåˆ†æ³•çš„æ€è·¯æ˜¯é€šè¿‡äºŒåˆ†<strong>ä¸æ–­ç¼©å°ç»“æœèŒƒå›´</strong>ç›´åˆ°ç¡®è®¤ç»“æœæˆ–è€…åŒºé—´ä¸å­˜åœ¨</p><p>â€‹è€Œçº¢è“äºŒåˆ†æ³•åˆ™æ˜¯<strong>é€†å‘æ€è·¯</strong>ï¼Œé€šè¿‡<strong>ä¸æ–­æ‰©å¤§éç»“æœåŒºé—´çš„èŒƒå›´</strong>ç›´åˆ°ç›´åˆ°ç¡®è®¤ç»“æœæˆ–è€…åŒºé—´ä¸å­˜åœ¨</p><p>â€‹</p><p>â€‹é€šå¸¸äºŒåˆ†æ³•çš„æ€è·¯å¯¹åº”çš„å„ç§å·¦é—­å³é—­æˆ–è€…å·¦é—­å³å¼€å¾€å¾€é¢ä¸´ç¹ççš„è¾¹ç•Œé—®é¢˜ï¼Œè™½ç„¶é€šè¿‡å¤§é‡ç»ƒä¹ ä¹Ÿèƒ½ç†Ÿèƒ½ç”Ÿå·§ï¼Œä½†çº¢è“äºŒåˆ†æä¾›çš„ç®€æ˜“æ€è·¯å¯ä»¥æ‘’å¼ƒå¤æ‚çš„è¾¹ç•Œé—®é¢˜ï¼Œæ›´åŠ è´´è¿‘äºŒåˆ†çš„æœ¬è´¨â€”â€”<strong>å¾ªç¯ä¸å˜é‡</strong></p><p>â€‹å¤§å®¶å†™äºŒåˆ†æ³•ç»å¸¸å†™ä¹±ï¼Œä¸»è¦æ˜¯å› ä¸º<strong>å¯¹åŒºé—´çš„å®šä¹‰æ²¡æœ‰æƒ³æ¸…æ¥šï¼ŒåŒºé—´çš„å®šä¹‰å°±æ˜¯ä¸å˜é‡</strong>ã€‚è¦åœ¨äºŒåˆ†æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œä¿æŒä¸å˜é‡ï¼Œå°±æ˜¯åœ¨whileå¯»æ‰¾ä¸­æ¯ä¸€æ¬¡è¾¹ç•Œçš„å¤„ç†éƒ½è¦åšæŒæ ¹æ®åŒºé—´çš„å®šä¹‰æ¥æ“ä½œï¼Œè¿™å°±æ˜¯<strong>å¾ªç¯ä¸å˜é‡</strong>è§„åˆ™ã€‚</p><p>çº¢è“äºŒåˆ†æ¨¡æ¿ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">l = -<span class="number">1</span>, r = N;<span class="comment">//åˆå§‹åŒ–ï¼Œä¿è¯lå’Œrä¸åœ¨æœç´¢åŒºé—´å†…éƒ¨ï¼Œä¿è¯å¾ªç¯ä¸å˜é‡</span></span><br><span class="line"><span class="keyword">while</span> l + <span class="number">1</span> != <span class="type">r</span></span><br><span class="line">    <span class="variable">m</span> <span class="operator">=</span> l + (r - l) / <span class="number">2</span>           <span class="comment">//æ­¤å¤„é¢„é˜²è¶Šç•Œï¼Œåªæ˜¯å’Œ(l + r) / 2å†™æ³•ä¸åŒ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="title function_">isBlue</span><span class="params">(m)</span>  <span class="comment">// isBlue()æ˜¯æŠ½è±¡å‡ºæ¥çš„ç”¨æ¥åˆ¤æ–­ç‰¹æ€§çš„æ–¹æ³•</span></span><br><span class="line">        l = m</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r = m</span><br><span class="line"><span class="keyword">return</span> l or r<span class="comment">//å› é¢˜è€Œå¼‚        </span></span><br><span class="line">    </span><br></pre></td></tr></table></figure><h2 id="â”äºŒåˆ†é¢˜ç›®æ€»ç»“">â”äºŒåˆ†é¢˜ç›®æ€»ç»“</h2><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202302282125488.png" alt="image-20230228210901759"></p><h3 id="å®Œå…¨æœ‰åº">å®Œå…¨æœ‰åº</h3><ul><li><em>æ¢¦å¼€å§‹çš„åœ°æ–¹ï¼ŒåŸºç¡€çš„äºŒåˆ†æŸ¥æ‰¾</em></li></ul><h4 id="â­-704-äºŒåˆ†æŸ¥æ‰¾">â­ 704.<a href="https://leetcode.cn/problems/binary-search/">äºŒåˆ†æŸ¥æ‰¾</a></h4><p><a href="https://leetcode.cn/problems/binary-search/">åŠ›æ‰£é¢˜ç›®é“¾æ¥(opens new window)</a></p><p>ç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target  ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚</p><p>ç¤ºä¾‹ 1:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 9     </span><br><span class="line">è¾“å‡º: 4       </span><br><span class="line">è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4     </span><br></pre></td></tr></table></figure><p>1<br>2<br>3</p><p>ç¤ºä¾‹ 2:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 2     </span><br><span class="line">è¾“å‡º: -1        </span><br><span class="line">è§£é‡Š: 2 ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -1        </span><br></pre></td></tr></table></figure><p>1<br>2<br>3</p><p>æç¤ºï¼š</p><ul><li>ä½ å¯ä»¥å‡è®¾ nums ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯ä¸é‡å¤çš„ã€‚</li><li>n å°†åœ¨ [1, 10000]ä¹‹é—´ã€‚</li><li>nums çš„æ¯ä¸ªå…ƒç´ éƒ½å°†åœ¨ [-9999, 9999]ä¹‹é—´ã€‚</li></ul><p>çº¢è“äºŒåˆ†æ³•è§£æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="keyword">while</span>(l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[m] == target) <span class="keyword">return</span> m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="35-æœç´¢æ’å…¥ä½ç½®">35.<a href="https://leetcode.cn/problems/search-insert-position/">æœç´¢æ’å…¥ä½ç½®</a></h4><ul><li><em>äºŒåˆ†æŸ¥æ‰¾çš„å˜å¼ï¼Œæ„Ÿå—æŸ¥æ‰¾è¾¹ç•Œ</em></li></ul><p>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1:</p><ul><li>è¾“å…¥: [1,3,5,6], 5</li><li>è¾“å‡º: 2</li></ul><p>ç¤ºä¾‹ 2:</p><ul><li>è¾“å…¥: [1,3,5,6], 2</li><li>è¾“å‡º: 1</li></ul><p>ç¤ºä¾‹ 3:</p><ul><li>è¾“å…¥: [1,3,5,6], 7</li><li>è¾“å‡º: 4</li></ul><p>ç¤ºä¾‹ 4:</p><ul><li>è¾“å…¥: [1,3,5,6], 0</li><li>è¾“å‡º: 0</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">searchInsert</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[m] &gt;= target) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="â­34-åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®">â­<a href="https://leetcode.cn/problems/find-first-and-last-position-of-element-in-sorted-array/">34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®</a></h4><ul><li>äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œçš„å¤åˆï¼Œè¿›ä¸€æ­¥æ„Ÿå—è¾¹ç•Œ</li></ul><p>ç»™ä½ ä¸€ä¸ªæŒ‰ç…§éé€’å‡é¡ºåºæ’åˆ—çš„æ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ <code>target</code>ã€‚è¯·ä½ æ‰¾å‡ºç»™å®šç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p><p>å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨ç›®æ ‡å€¼ <code>target</code>ï¼Œè¿”å› <code>[-1, -1]</code>ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º <code>O(log n)</code> çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [5,7,7,8,8,10], target = 8</span><br><span class="line">è¾“å‡ºï¼š[3,4]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [5,7,7,8,8,10], target = 6</span><br><span class="line">è¾“å‡ºï¼š[-1,-1]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [], target = 0</span><br><span class="line">è¾“å‡ºï¼š[-1,-1]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= nums.length &lt;= 105</code></li><li><code>-109 &lt;= nums[i] &lt;= 109</code></li><li><code>nums</code> æ˜¯ä¸€ä¸ªéé€’å‡æ•°ç»„</li><li><code>-109 &lt;= target &lt;= 109</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] searchRange(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line">        <span class="type">int</span> result[] = &#123;getLeft(nums,target),getRight(nums,target)&#125;;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getLeft</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (nums[m] &gt;= target) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (r == nums.length || nums[r] != target  ) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getRight</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (nums[m] &lt;= target) l = m;</span><br><span class="line">            <span class="keyword">else</span> r = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l == -<span class="number">1</span> || nums[l] != target) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸å®Œå…¨æœ‰åº">ä¸å®Œå…¨æœ‰åº</h3><p>(æ—‹è½¬æ’åºæ•°ç»„ç³»åˆ—)</p><ul><li>å±€éƒ¨æœ‰åºï¼Œæ³¨æ„å¾ªç¯ä¸å˜é‡</li></ul><h4 id="â­153-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼">â­<a href="https://leetcode.cn/problems/find-minimum-in-rotated-sorted-array/">153. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</a></h4><p>å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„æ•°ç»„ï¼Œé¢„å…ˆæŒ‰ç…§å‡åºæ’åˆ—ï¼Œç»ç”± <code>1</code> åˆ° <code>n</code> æ¬¡ <strong>æ—‹è½¬</strong> åï¼Œå¾—åˆ°è¾“å…¥æ•°ç»„ã€‚ä¾‹å¦‚ï¼ŒåŸæ•°ç»„ <code>nums = [0,1,2,4,5,6,7]</code> åœ¨å˜åŒ–åå¯èƒ½å¾—åˆ°ï¼š</p><ul><li>è‹¥æ—‹è½¬ <code>4</code> æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° <code>[4,5,6,7,0,1,2]</code></li><li>è‹¥æ—‹è½¬ <code>7</code> æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° <code>[0,1,2,4,5,6,7]</code></li></ul><p>æ³¨æ„ï¼Œæ•°ç»„ <code>[a[0], a[1], a[2], ..., a[n-1]]</code> <strong>æ—‹è½¬ä¸€æ¬¡</strong> çš„ç»“æœä¸ºæ•°ç»„ <code>[a[n-1], a[0], a[1], a[2], ..., a[n-2]]</code> ã€‚</p><p>ç»™ä½ ä¸€ä¸ªå…ƒç´ å€¼ <strong>äº’ä¸ç›¸åŒ</strong> çš„æ•°ç»„ <code>nums</code> ï¼Œå®ƒåŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•°ç»„ï¼Œå¹¶æŒ‰ä¸Šè¿°æƒ…å½¢è¿›è¡Œäº†å¤šæ¬¡æ—‹è½¬ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ•°ç»„ä¸­çš„ <strong>æœ€å°å…ƒç´ </strong> ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º <code>O(log n)</code> çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [3,4,5,1,2]</span><br><span class="line">è¾“å‡ºï¼š1</span><br><span class="line">è§£é‡Šï¼šåŸæ•°ç»„ä¸º [1,2,3,4,5] ï¼Œæ—‹è½¬ 3 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2]</span><br><span class="line">è¾“å‡ºï¼š0</span><br><span class="line">è§£é‡Šï¼šåŸæ•°ç»„ä¸º [0,1,2,4,5,6,7] ï¼Œæ—‹è½¬ 4 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [11,13,15,17]</span><br><span class="line">è¾“å‡ºï¼š11</span><br><span class="line">è§£é‡Šï¼šåŸæ•°ç»„ä¸º [11,13,15,17] ï¼Œæ—‹è½¬ 4 æ¬¡å¾—åˆ°è¾“å…¥æ•°ç»„ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>n == nums.length</code></li><li><code>1 &lt;= n &lt;= 5000</code></li><li><code>-5000 &lt;= nums[i] &lt;= 5000</code></li><li><code>nums</code> ä¸­çš„æ‰€æœ‰æ•´æ•° <strong>äº’ä¸ç›¸åŒ</strong></li><li><code>nums</code> åŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åºçš„æ•°ç»„ï¼Œå¹¶è¿›è¡Œäº† <code>1</code> è‡³ <code>n</code> æ¬¡æ—‹è½¬</li></ul><p>è§£æ³•ä¸€</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findMin</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(nums[m] &lt;= nums[r - <span class="number">1</span>]) &#123;</span><br><span class="line">            r = m;</span><br><span class="line">            <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">                m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (nums[m] &lt;= nums[r]) r = m;</span><br><span class="line">                <span class="keyword">else</span> l = m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            l = m;</span><br><span class="line">            <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">                m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (nums[m] &gt;= nums[l]) l = m;</span><br><span class="line">                <span class="keyword">else</span> r = m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[r];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•äºŒã€</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findMin</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span> l=-<span class="number">1</span>, r=n;</span><br><span class="line">        <span class="keyword">while</span> (l+<span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">target</span> <span class="operator">=</span> r == n ? nums[n-<span class="number">1</span>] : nums[r];</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">                l = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[r];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="â­154-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼-II"><a href="https://leetcode.cn/problems/find-minimum-in-rotated-sorted-array-ii/">â­154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ II</a></h4><p>å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„æ•°ç»„ï¼Œé¢„å…ˆæŒ‰ç…§å‡åºæ’åˆ—ï¼Œç»ç”± <code>1</code> åˆ° <code>n</code> æ¬¡ <strong>æ—‹è½¬</strong> åï¼Œå¾—åˆ°è¾“å…¥æ•°ç»„ã€‚ä¾‹å¦‚ï¼ŒåŸæ•°ç»„ <code>nums = [0,1,4,4,5,6,7]</code> åœ¨å˜åŒ–åå¯èƒ½å¾—åˆ°ï¼š</p><ul><li>è‹¥æ—‹è½¬ <code>4</code> æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° <code>[4,5,6,7,0,1,4]</code></li><li>è‹¥æ—‹è½¬ <code>7</code> æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° <code>[0,1,4,4,5,6,7]</code></li></ul><p>æ³¨æ„ï¼Œæ•°ç»„ <code>[a[0], a[1], a[2], ..., a[n-1]]</code> <strong>æ—‹è½¬ä¸€æ¬¡</strong> çš„ç»“æœä¸ºæ•°ç»„ <code>[a[n-1], a[0], a[1], a[2], ..., a[n-2]]</code> ã€‚</p><p>ç»™ä½ ä¸€ä¸ªå¯èƒ½å­˜åœ¨ <strong>é‡å¤</strong> å…ƒç´ å€¼çš„æ•°ç»„ <code>nums</code> ï¼Œå®ƒåŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•°ç»„ï¼Œå¹¶æŒ‰ä¸Šè¿°æƒ…å½¢è¿›è¡Œäº†å¤šæ¬¡æ—‹è½¬ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ•°ç»„ä¸­çš„ <strong>æœ€å°å…ƒç´ </strong> ã€‚</p><p>ä½ å¿…é¡»å°½å¯èƒ½å‡å°‘æ•´ä¸ªè¿‡ç¨‹çš„æ“ä½œæ­¥éª¤ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [1,3,5]</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,2,2,0,1]</span><br><span class="line">è¾“å‡ºï¼š0</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>n == nums.length</code></li><li><code>1 &lt;= n &lt;= 5000</code></li><li><code>-5000 &lt;= nums[i] &lt;= 5000</code></li><li><code>nums</code> åŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åºçš„æ•°ç»„ï¼Œå¹¶è¿›è¡Œäº† <code>1</code> è‡³ <code>n</code> æ¬¡æ—‹è½¬</li></ul><p>**è¿›é˜¶ï¼š**è¿™é“é¢˜ä¸ <a href="https://leetcode-cn.com/problems/find-minimum-in-rotated-sorted-array/description/">å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</a> ç±»ä¼¼ï¼Œä½† <code>nums</code> å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ã€‚å…è®¸é‡å¤ä¼šå½±å“ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å—ï¼Ÿä¼šå¦‚ä½•å½±å“ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findMin</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (nums[r] == nums[<span class="number">0</span>] &amp;&amp; r &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            r--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">last</span> <span class="operator">=</span> nums[r];</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        ++r;</span><br><span class="line">        n = r;</span><br><span class="line">        <span class="keyword">while</span> (l+<span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">target</span> <span class="operator">=</span> r == n ? last : nums[r];</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">                l = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[r];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="â­33-æœç´¢æ—‹è½¬æ’åºæ•°ç»„">â­<a href="https://leetcode.cn/problems/search-in-rotated-sorted-array/">33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„</a></h4><p>æ•´æ•°æ•°ç»„ <code>nums</code> æŒ‰å‡åºæ’åˆ—ï¼Œæ•°ç»„ä¸­çš„å€¼ <strong>äº’ä¸ç›¸åŒ</strong> ã€‚</p><p>åœ¨ä¼ é€’ç»™å‡½æ•°ä¹‹å‰ï¼Œ<code>nums</code> åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡ <code>k</code>ï¼ˆ<code>0 &lt;= k &lt; nums.length</code>ï¼‰ä¸Šè¿›è¡Œäº† <strong>æ—‹è½¬</strong>ï¼Œä½¿æ•°ç»„å˜ä¸º <code>[nums[k], nums[k+1], ..., nums[n-1], nums[0], nums[1], ..., nums[k-1]]</code>ï¼ˆä¸‹æ ‡ <strong>ä» 0 å¼€å§‹</strong> è®¡æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œ <code>[0,1,2,4,5,6,7]</code> åœ¨ä¸‹æ ‡ <code>3</code> å¤„ç»æ—‹è½¬åå¯èƒ½å˜ä¸º <code>[4,5,6,7,0,1,2]</code> ã€‚</p><p>ç»™ä½  <strong>æ—‹è½¬å</strong> çš„æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•° <code>target</code> ï¼Œå¦‚æœ <code>nums</code> ä¸­å­˜åœ¨è¿™ä¸ªç›®æ ‡å€¼ <code>target</code> ï¼Œåˆ™è¿”å›å®ƒçš„ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› <code>-1</code> ã€‚</p><p>ä½ å¿…é¡»è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º <code>O(log n)</code> çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2], target = 0</span><br><span class="line">è¾“å‡ºï¼š4</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2], target = 3</span><br><span class="line">è¾“å‡ºï¼š-1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [1], target = 0</span><br><span class="line">è¾“å‡ºï¼š-1</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 5000</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li><li><code>nums</code> ä¸­çš„æ¯ä¸ªå€¼éƒ½ <strong>ç‹¬ä¸€æ— äºŒ</strong></li><li>é¢˜ç›®æ•°æ®ä¿è¯ <code>nums</code> åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡ä¸Šè¿›è¡Œäº†æ—‹è½¬</li><li><code>-104 &lt;= target &lt;= 104</code></li></ul><h4 id="â­81-æœç´¢æ—‹è½¬æ’åºæ•°ç»„-II">â­<a href="https://leetcode.cn/problems/search-in-rotated-sorted-array-ii/">81. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ II</a></h4><p>å·²çŸ¥å­˜åœ¨ä¸€ä¸ªæŒ‰éé™åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œæ•°ç»„ä¸­çš„å€¼ä¸å¿…äº’ä¸ç›¸åŒã€‚</p><p>åœ¨ä¼ é€’ç»™å‡½æ•°ä¹‹å‰ï¼Œ<code>nums</code> åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡ <code>k</code>ï¼ˆ<code>0 &lt;= k &lt; nums.length</code>ï¼‰ä¸Šè¿›è¡Œäº† <strong>æ—‹è½¬</strong> ï¼Œä½¿æ•°ç»„å˜ä¸º <code>[nums[k], nums[k+1], ..., nums[n-1], nums[0], nums[1], ..., nums[k-1]]</code>ï¼ˆä¸‹æ ‡ <strong>ä» 0 å¼€å§‹</strong> è®¡æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œ <code>[0,1,2,4,4,4,5,6,6,7]</code> åœ¨ä¸‹æ ‡ <code>5</code> å¤„ç»æ—‹è½¬åå¯èƒ½å˜ä¸º <code>[4,5,6,6,7,0,1,2,4,4]</code> ã€‚</p><p>ç»™ä½  <strong>æ—‹è½¬å</strong> çš„æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•° <code>target</code> ï¼Œè¯·ä½ ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­ç»™å®šçš„ç›®æ ‡å€¼æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ã€‚å¦‚æœ <code>nums</code> ä¸­å­˜åœ¨è¿™ä¸ªç›®æ ‡å€¼ <code>target</code> ï¼Œåˆ™è¿”å› <code>true</code> ï¼Œå¦åˆ™è¿”å› <code>false</code> ã€‚</p><p>ä½ å¿…é¡»å°½å¯èƒ½å‡å°‘æ•´ä¸ªæ“ä½œæ­¥éª¤ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,5,6,0,0,1,2], target = 0</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,5,6,0,0,1,2], target = 3</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 5000</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li><li>é¢˜ç›®æ•°æ®ä¿è¯ <code>nums</code> åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªä¸‹æ ‡ä¸Šè¿›è¡Œäº†æ—‹è½¬</li><li><code>-104 &lt;= target &lt;= 104</code></li></ul><p><strong>è¿›é˜¶ï¼š</strong></p><ul><li>è¿™æ˜¯ <a href="https://leetcode-cn.com/problems/search-in-rotated-sorted-array/description/">æœç´¢æ—‹è½¬æ’åºæ•°ç»„</a> çš„å»¶ä¼¸é¢˜ç›®ï¼Œæœ¬é¢˜ä¸­çš„ <code>nums</code> å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ã€‚</li><li>è¿™ä¼šå½±å“åˆ°ç¨‹åºçš„æ—¶é—´å¤æ‚åº¦å—ï¼Ÿä¼šæœ‰æ€æ ·çš„å½±å“ï¼Œä¸ºä»€ä¹ˆ</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> findMin(nums);</span><br><span class="line">        System.out.println(t);</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = n;</span><br><span class="line">        <span class="keyword">if</span> (nums[t] &lt;= target &amp;&amp; target &lt;= nums[n - <span class="number">1</span>]) &#123;</span><br><span class="line">            l = t - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r = t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> (r + l) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[m] == target) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findMin</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        n = nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (nums[r] == nums[<span class="number">0</span>] &amp;&amp; r &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            r--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">last</span> <span class="operator">=</span> nums[r];</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        ++r;</span><br><span class="line">        n = r;</span><br><span class="line">        <span class="keyword">while</span> (l+<span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">target</span> <span class="operator">=</span> r == n ? last : nums[r];</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">                l = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="â­162-å¯»æ‰¾å³°å€¼">â­<a href="https://leetcode.cn/problems/find-peak-element/">162. å¯»æ‰¾å³°å€¼</a></h4><p>å³°å€¼å…ƒç´ æ˜¯æŒ‡å…¶å€¼ä¸¥æ ¼å¤§äºå·¦å³ç›¸é‚»å€¼çš„å…ƒç´ ã€‚</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œæ‰¾åˆ°å³°å€¼å…ƒç´ å¹¶è¿”å›å…¶ç´¢å¼•ã€‚æ•°ç»„å¯èƒ½åŒ…å«å¤šä¸ªå³°å€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿”å› <strong>ä»»ä½•ä¸€ä¸ªå³°å€¼</strong> æ‰€åœ¨ä½ç½®å³å¯ã€‚</p><p>ä½ å¯ä»¥å‡è®¾ <code>nums[-1] = nums[n] = -âˆ</code> ã€‚</p><p>ä½ å¿…é¡»å®ç°æ—¶é—´å¤æ‚åº¦ä¸º <code>O(log n)</code> çš„ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [1,2,3,1]</span><br><span class="line">è¾“å‡ºï¼š2</span><br><span class="line">è§£é‡Šï¼š3 æ˜¯å³°å€¼å…ƒç´ ï¼Œä½ çš„å‡½æ•°åº”è¯¥è¿”å›å…¶ç´¢å¼• 2ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [1,2,1,3,5,6,4]</span><br><span class="line">è¾“å‡ºï¼š1 æˆ– 5 </span><br><span class="line">è§£é‡Šï¼šä½ çš„å‡½æ•°å¯ä»¥è¿”å›ç´¢å¼• 1ï¼Œå…¶å³°å€¼å…ƒç´ ä¸º 2ï¼›</span><br><span class="line">     æˆ–è€…è¿”å›ç´¢å¼• 5ï¼Œ å…¶å³°å€¼å…ƒç´ ä¸º 6ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 1000</code></li><li><code>-231 &lt;= nums[i] &lt;= 231 - 1</code></li><li>å¯¹äºæ‰€æœ‰æœ‰æ•ˆçš„ <code>i</code> éƒ½æœ‰ <code>nums[i] != nums[i + 1]</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findPeakElement</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">           m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">           <span class="keyword">if</span> (m &gt;= nums.length - <span class="number">1</span>) r = m;  </span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> ( nums[m] &gt; nums[m+<span class="number">1</span>]) r = m;</span><br><span class="line">           <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒç»´æ•°ç»„">äºŒç»´æ•°ç»„</h3><h4 id="â­74-æœç´¢äºŒç»´çŸ©é˜µ">â­<a href="https://leetcode.cn/problems/search-a-2d-matrix/">74. æœç´¢äºŒç»´çŸ©é˜µ</a></h4><p>éš¾åº¦ä¸­ç­‰</p><p>ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥åˆ¤æ–­ <code>m x n</code> çŸ©é˜µä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªç›®æ ‡å€¼ã€‚è¯¥çŸ©é˜µå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><ul><li>æ¯è¡Œä¸­çš„æ•´æ•°ä»å·¦åˆ°å³æŒ‰å‡åºæ’åˆ—ã€‚</li><li>æ¯è¡Œçš„ç¬¬ä¸€ä¸ªæ•´æ•°å¤§äºå‰ä¸€è¡Œçš„æœ€åä¸€ä¸ªæ•´æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="%E7%BA%A2%E8%93%9D%E4%BA%8C%E5%88%86%E6%B3%95%E2%80%94%E2%80%94%E4%B8%80%E7%A7%8D%E4%BA%8C%E5%88%86%E6%B3%95%E7%9A%84%E9%80%9A%E7%94%A8%E6%A8%A1%E6%9D%BF.assets/mat.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šmatrix = [[1,3,5,7],[10,11,16,20],[23,30,34,60]], target = 3</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="%E7%BA%A2%E8%93%9D%E4%BA%8C%E5%88%86%E6%B3%95%E2%80%94%E2%80%94%E4%B8%80%E7%A7%8D%E4%BA%8C%E5%88%86%E6%B3%95%E7%9A%84%E9%80%9A%E7%94%A8%E6%A8%A1%E6%9D%BF.assets/mat2.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šmatrix = [[1,3,5,7],[10,11,16,20],[23,30,34,60]], target = 13</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>m == matrix.length</code></li><li><code>n == matrix[i].length</code></li><li><code>1 &lt;= m, n &lt;= 100</code></li><li><code>-104 &lt;= matrix[i][j], target &lt;= 104</code></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">searchMatrix</span><span class="params">(<span class="type">int</span>[][] matrix, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span>, r = matrix.length * matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> get(matrix,m);</span><br><span class="line">            <span class="keyword">if</span> (value == target) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (value &gt; target) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span>[][] matrix, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length, n = matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index / n, j = index % n;</span><br><span class="line">        <span class="keyword">return</span> matrix[i][j]; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–">å…¶ä»–</h3><h4 id="367-æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°"><a href="https://leetcode.cn/problems/valid-perfect-square/">367. æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°</a></h4><p>ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° num ã€‚å¦‚æœ num æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚</p><p>å®Œå…¨å¹³æ–¹æ•° æ˜¯ä¸€ä¸ªå¯ä»¥å†™æˆæŸä¸ªæ•´æ•°çš„å¹³æ–¹çš„æ•´æ•°ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å†™æˆæŸä¸ªæ•´æ•°å’Œè‡ªèº«çš„ä¹˜ç§¯ã€‚</p><p>ä¸èƒ½ä½¿ç”¨ä»»ä½•å†…ç½®çš„åº“å‡½æ•°ï¼Œå¦‚  sqrt ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šnum = 16<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šè¿”å› true ï¼Œå› ä¸º 4 * 4 = 16 ä¸” 4 æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šnum = 14<br>è¾“å‡ºï¼šfalse<br>è§£é‡Šï¼šè¿”å› false ï¼Œå› ä¸º 3.742 * 3.742 = 14 ä½† 3.742 ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</p><p>æç¤ºï¼š</p><p>1 &lt;= num &lt;= 231 - 1</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç›´æ¥æš´åŠ›ç”¨å¤§æ•°äº†</span></span><br><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPerfectSquare</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">l</span> <span class="operator">=</span>BigInteger.valueOf(-<span class="number">1</span>);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">r</span> <span class="operator">=</span>BigInteger.valueOf((num &gt;&gt; <span class="number">1</span>) + <span class="number">2</span>);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">x</span> <span class="operator">=</span> BigInteger.valueOf(num);</span><br><span class="line">        BigInteger m;</span><br><span class="line">        <span class="keyword">while</span> (!l.add(BigInteger.ONE).equals(r)) &#123;</span><br><span class="line">            m = l.add(r).divide(BigInteger.TWO);</span><br><span class="line">            <span class="keyword">if</span> (m.multiply(m).equals(x)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (m.multiply(m).compareTo(x) == -<span class="number">1</span>) l = m;</span><br><span class="line">            <span class="keyword">else</span> r = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="69-x-çš„å¹³æ–¹æ ¹"><a href="https://leetcode.cn/problems/sqrtx/">69. x çš„å¹³æ–¹æ ¹ </a></h4><p>ç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•° x ï¼Œè®¡ç®—å¹¶è¿”å› x çš„ ç®—æœ¯å¹³æ–¹æ ¹ ã€‚</p><p>ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™ æ•´æ•°éƒ¨åˆ† ï¼Œå°æ•°éƒ¨åˆ†å°†è¢« èˆå» ã€‚</p><p>æ³¨æ„ï¼šä¸å…è®¸ä½¿ç”¨ä»»ä½•å†…ç½®æŒ‡æ•°å‡½æ•°å’Œç®—ç¬¦ï¼Œä¾‹å¦‚ pow(x, 0.5) æˆ–è€… x ** 0.5 ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šx = 4<br>è¾“å‡ºï¼š2<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šx = 8<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼š8 çš„ç®—æœ¯å¹³æ–¹æ ¹æ˜¯ 2.82842â€¦, ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚</p><p>æç¤ºï¼š</p><p>0 &lt;= x &lt;= 231 - 1</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æš´åŠ›å¤§æ•°</span></span><br><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">l</span> <span class="operator">=</span> BigInteger.valueOf(-<span class="number">1</span>);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">r</span> <span class="operator">=</span> BigInteger.valueOf((x &gt;&gt; <span class="number">1</span>) + <span class="number">2</span>);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">num</span> <span class="operator">=</span> BigInteger.valueOf(x); </span><br><span class="line">        <span class="keyword">while</span> (!l.add(BigInteger.ONE).equals(r)) &#123;</span><br><span class="line">            <span class="type">BigInteger</span> <span class="variable">m</span> <span class="operator">=</span> l.add(r).divide(BigInteger.TWO);</span><br><span class="line">            <span class="keyword">if</span> (m.multiply(m).compareTo(num) == <span class="number">1</span>) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l.intValue(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">2</span> || x == <span class="number">3</span> || x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//ä¸Šé¢ä¸¤è¡Œå‡æ˜¯ä¸ºäº†é˜²æ­¢ m == 0çš„æƒ…å†µï¼Œè€Œåé¢ä¸ºä»€ä¹ˆè¦ç”¨x/m&lt;m è€Œä¸æ˜¯ m*m&gt;xåˆ™æ˜¯ä¸ºäº†é˜²æ­¢è¶Šç•Œé”™è¯¯</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> -<span class="number">1</span> , r = (x &gt;&gt; <span class="number">1</span>) + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span> (l + <span class="number">1</span> != r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + ((r - l)&gt;&gt;<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (x / m &lt; m) r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡åŸåˆ™ä¸æ€æƒ³</title>
      <link href="/posts/65361.html"/>
      <url>/posts/65361.html</url>
      
        <content type="html"><![CDATA[<h1>è®¾è®¡åŸåˆ™ä¸æ€æƒ³: é¢å‘å¯¹è±¡</h1><h1>æˆ‘ä»¬åœ¨è®¨è®ºé¢å‘å¯¹è±¡çš„æ—¶å€™,æˆ‘ä»¬åˆ°åº•åœ¨è°ˆè®ºä»€ä¹ˆ?</h1><h2 id="ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€">ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€?</h2><ul><li>é¢å‘å¯¹è±¡ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼æˆ–ç¼–ç¨‹é£æ ¼, å®ƒä»¥ç±»æˆ–å¯¹è±¡ä½œä¸ºç»„ç»‡ä»£ç çš„åŸºæœ¬å•å…ƒ, å¹¶å°†å°è£…, æŠ½è±¡, ç»§æ‰¿, å¤šæ€å››ä¸ªç‰¹æ€§,ä½œä¸ºä»£ç è®¾è®¡å’Œå®ç°çš„åŸºçŸ³</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€æ˜¯æ”¯æŒç±»æˆ–å¯¹è±¡çš„è¯­æ³•æœºåˆ¶, å¹¶ç”±ç°æˆçš„è¯­æ³•æœºåˆ¶,èƒ½æ–¹ä¾¿åœ°å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹å››å¤§ç‰¹æ€§(å°è£…, æŠ½è±¡, ç»§æ‰¿, å¤šæ€)çš„ç¼–ç¨‹è¯­è¨€</li></ul><h2 id="é¢å‘å¯¹è±¡è¯­è¨€å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¹‹é—´åœ°å…³ç³»">é¢å‘å¯¹è±¡è¯­è¨€å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¹‹é—´åœ°å…³ç³»</h2><ul><li><p>é¢å‘è¿‡ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹</p></li><li><p>é¢å‘å¯¹è±¡è¯­è¨€ä¹Ÿä¼šå†™å‡ºé¢å‘è¿‡ç¨‹ç¼–ç¨‹</p></li></ul><h2 id="å¦‚ä½•åˆ¤å®šä¸€ä¸ªç¼–ç¨‹è¯­è¨€æ˜¯å¦é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€">å¦‚ä½•åˆ¤å®šä¸€ä¸ªç¼–ç¨‹è¯­è¨€æ˜¯å¦é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€</h2><p>å¹¶æ²¡æœ‰ä¸¥æ ¼åœ°å®šä¹‰,é¢å‘å¯¹è±¡è¯­è¨€è¦æ±‚å®½æ³›,å¹¶ä¸ä¸€å®šè¦æ±‚å…·æœ‰æ‰€æœ‰çš„å››å¤§ç‰¹æ€§, åªè¦æŸç§ç¼–ç¨‹è¯­è¨€æ”¯æŒç±», å¯¹è±¡è¯­æ³•æœºåˆ¶,é‚£å‡ æœ¬ä¸Šå°±å¯ä»¥è¯´è¿™ç§ç¼–ç¨‹è¯­è¨€æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€äº†</p><h2 id="ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡åˆ†æå’Œé¢å‘å¯¹è±¡è®¾è®¡">ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡åˆ†æå’Œé¢å‘å¯¹è±¡è®¾è®¡?</h2><p>OOA, OOD, OOP è½¯ä»¶å¼€å‘æµç¨‹</p><p>é¢å‘å¯¹è±¡åˆ†æå°±æ˜¯ææ¸…æ¥šåšä»€ä¹ˆ, é¢å‘å¯¹è±¡è®¾è®¡å°±æ˜¯ææ¸…æ¥šæ€ä¹ˆåš,. ä¸¤ä¸ªé˜¶æ®µåœ°äº§å‡ºå°±æ˜¯ç±»çš„è®¾è®¡,åŒ…æ‹¬ç¨‹åºè¢«æ‹†è§£ä¸ºå“ªäº›ç±», æ¯ä¸ªç±»æœ‰å“ªäº›å±æ€§æ–¹æ³•,ç±»ä¸ç±»ä¹‹é—´å¦‚ä½•äº¤äº’ç­‰ç­‰</p><h1>å°è£…, æŠ½è±¡, ç»§æ‰¿,å¤šæ€å¯ä»¥è§£å†³å“ªäº›ç¼–ç¨‹é—®é¢˜?]</h1><h2 id="å°è£…ç‰¹æ€§">å°è£…ç‰¹æ€§</h2><p>å°è£…ä¹Ÿå«ä¿¡æ¯éšè—æˆ–è€…æ•°æ®è®¿é—®ä¿æŠ¤. ç±»é€šè¿‡æš´éœ²æœ‰é™çš„è®¿é—®æ¥å£,æˆæƒå¤–éƒ¨ä»…èƒ½é€šè¿‡ç±»æä¾›çš„èŒƒå¼æ¥è®¿é—®å†…éƒ¨ä¿¡æ¯æˆ–è€…æ•°æ®.</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wallet</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">long</span> createTime;</span><br><span class="line">  <span class="keyword">private</span> BigDecimal balance;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">long</span> balanceLastModifiedTime;</span><br><span class="line">  <span class="comment">// ...çœç•¥å…¶ä»–å±æ€§...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Wallet</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="built_in">this</span>.id = IdGenerator.getInstance().generate();</span><br><span class="line">     <span class="built_in">this</span>.createTime = System.currentTimeMillis();</span><br><span class="line">     <span class="built_in">this</span>.balance = BigDecimal.ZERO;</span><br><span class="line">     <span class="built_in">this</span>.balanceLastModifiedTime = System.currentTimeMillis();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šä¸‹é¢å¯¹getæ–¹æ³•åšäº†ä»£ç æŠ˜å ï¼Œæ˜¯ä¸ºäº†å‡å°‘ä»£ç æ‰€å æ–‡ç« çš„ç¯‡å¹…</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="built_in">this</span>.id; &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getCreateTime</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="built_in">this</span>.createTime; &#125;</span><br><span class="line">  <span class="keyword">public</span> BigDecimal <span class="title function_">getBalance</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="built_in">this</span>.balance; &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getBalanceLastModifiedTime</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="built_in">this</span>.balanceLastModifiedTime;  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">increaseBalance</span><span class="params">(BigDecimal increasedAmount)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (increasedAmount.compareTo(BigDecimal.ZERO) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidAmountException</span>(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.balance.add(increasedAmount);</span><br><span class="line">    <span class="built_in">this</span>.balanceLastModifiedTime = System.currentTimeMillis();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decreaseBalance</span><span class="params">(BigDecimal decreasedAmount)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (decreasedAmount.compareTo(BigDecimal.ZERO) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidAmountException</span>(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (decreasedAmount.compareTo(<span class="built_in">this</span>.balance) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InsufficientAmountException</span>(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.balance.subtract(decreasedAmount);</span><br><span class="line">    <span class="built_in">this</span>.balanceLastModifiedTime = System.currentTimeMillis();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒéœ€è¦ç¼–ç¨‹è¯­è¨€æä¾›æƒé™è®¿é—®æ§åˆ¶è¯­æ³•æ¥æ”¯æŒ, ä¾‹å¦‚Javaä¸­çš„public protected, public å…³é”®å­—</p><p>å°è£…:</p><ul><li>ä¿æŠ¤æ•°æ®ä¸è¢«éšæ„ä¿®æ”¹ ,æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</li><li>ä»…æš´éœ²æœ‰é™çš„å¿…è¦æ¥å£,æé«˜ç±»çš„æ˜“ç”¨æ€§(ä¸éœ€è¦è°ƒç”¨è€…äº†è§£è¿‡å¤šçš„ç»†èŠ‚) å†°ç®±çš„æŒ‰é’®å¤šå°‘,å‡ºé”™çš„æ¦‚ç‡</li></ul><h2 id="æŠ½è±¡ç‰¹æ€§">æŠ½è±¡ç‰¹æ€§</h2><p>æŠ½è±¡è®²è§£å¦‚ä½•éšè—æ–¹æ³•çš„å…·ä½“å®ç°, è®©ä½¿ç”¨è€…åªéœ€è¦å…³å¿ƒæ–¹æ³•æä¾›äº†å“ªäº›åŠŸèƒ½, ä¸éœ€è¦çŸ¥é“è¿™äº›åŠŸèƒ½å¦‚ä½•å®ç°.</p><p>æŠ½è±¡é€šè¿‡æ¥å£ç±»æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°, ä½†ä¹Ÿä¸éœ€è¦ç‰¹æ®Šçš„è¯­æ³•æœºåˆ¶æ¥æ”¯æŒ,å‘½åæ—¶ä¹Ÿè¦æœ‰æŠ½è±¡æ€ç»´,getAliyunPicture()    ---- &gt;    getPicture()</p><p>æŠ½è±¡å­˜åœ¨çš„æ„ä¹‰:</p><ul><li>æé«˜ä»£ç çš„å¯æ‰©å±•æ€§,ç»´æŠ¤æ€§,ä¿®æ”¹å®ç°ä¸éœ€è¦æ”¹å˜å®šä¹‰,å‡å°‘ä»£ç æ”¹åŠ¨çš„èŒƒå›´</li><li>å¤„ç†å¤æ‚ç³»ç»Ÿçš„æœ‰æ•ˆæ‰‹æ®µ,èƒ½æœ‰æ•ˆè¿‡æ»¤ä¸å¿…å…³æ³¨çš„ä¿¡æ¯</li></ul><h2 id="ç»§æ‰¿ç‰¹æ€§">ç»§æ‰¿ç‰¹æ€§</h2><p>ç»§æ‰¿ç”¨æ¥è¡¨ç¤ºç±»ä¹‹é—´çš„is-aå…³ç³»,åˆ†ä¸ºä¸¤ç§æ¨¡å¼</p><ul><li>å•ç»§æ‰¿</li><li>å¤šç»§æ‰¿</li></ul><p>ä¸ºäº†å®ç°ç»§æ‰¿è¿™ä¸ªç‰¹æ€§,ç¼–ç¨‹è¯­è¨€éœ€è¦æä¾›ç‰¹æ®Šçš„è¯­æ³•æœºåˆ¶æ¥æ”¯æŒ</p><p>ç»§æ‰¿å­˜åœ¨çš„æ„ä¹‰:</p><ul><li>ç»§æ‰¿ä¸»è¦ç”¨æ¥è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜(ä¹Ÿå¯ä»¥ç”¨ç»„åˆæ¥å®ç°),ç‰¹å®šæƒ…å†µä¸‹ç”¨ç»§æ‰¿çš„is-å…³ç³»éå¸¸ç¬¦åˆäººç±»çš„æ€ç»´æ–¹å¼,ä»è®¾è®¡æ¥è¯´ä¹Ÿæœ‰ä¸€ç§è®¾è®¡ç¾æ„Ÿ</li></ul><p>â€‹è¿‡åº¦ä½¿ç”¨ç»§æ‰¿æ—¶é”™è¯¯çš„,ä¾‹å¦‚åœ¨é˜…è¯»ä»£ç æ—¶è¿‡å¤šå±‚æ¬¡ä¼šå¢åŠ ä»£ç é˜…è¯»è´Ÿæ‹…, åŒæ—¶ç»§æ‰¿çš„å¤ç”¨ä¼šå¯¼è‡´å­ç±»å’Œçˆ¶ç±»è€¦åˆè¿‡é«˜,ç»§æ‰¿ç‰¹æ€§å¾ˆå—äº‰è®®</p><h2 id="å¤šæ€ç‰¹æ€§">å¤šæ€ç‰¹æ€§</h2><p>ä¸‰ä¸ªè¯­æ³•æœºåˆ¶å®ç°å¤šæ€</p><ul><li>è¯­æ³•è¦æ”¯æŒçˆ¶ç±»å¼•ç”¨å¯ä»¥å¼•ç”¨å­ç±»å¯¹è±¡</li><li>è¯­æ³•è¦æ”¯æŒç»§æ‰¿</li><li>è¯­æ³•è¦æ”¯æŒå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•</li></ul><p>é™¤äº†&quot;ç»§æ‰¿åŠ æ–¹æ³•é‡å†™&quot;è¿˜æœ‰æ¥å£ç±»è¯­æ³• ,  duck-typingè¯­æ³•(åŠ¨æ€è¯­è¨€æ”¯æŒ)</p><p>æ¥å£ç±»è¯­æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line">  String <span class="title function_">next</span><span class="params">()</span>;</span><br><span class="line">  String <span class="title function_">remove</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Array</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String[] data;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">next</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">remove</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="comment">//...çœç•¥å…¶ä»–æ–¹æ³•...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> LinkedListNode head;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">next</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">remove</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">  <span class="comment">//...çœç•¥å…¶ä»–æ–¹æ³•... </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">(Iterator iterator)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">      System.out.println(iterator.next());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">arrayIterator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    print(arrayIterator);</span><br><span class="line">    </span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">linkedListIterator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line">    print(linkedListIterator);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>duck-typing</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Logger</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">record</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(â€œI write a log into file.â€)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DB</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">record</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(â€œI insert data into db. â€)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">recorder</span>):</span><br><span class="line">    recorder.record()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    logger = Logger()</span><br><span class="line">    db = DB()</span><br><span class="line">    test(logger)</span><br><span class="line">    test(db)</span><br></pre></td></tr></table></figure><p>å¤šæ€çš„æ„ä¹‰:</p><ul><li>æé«˜ä»£ç æ‰©å±•æ€§å’Œå¤ç”¨æ€§,å¾ˆå¤šè®¾è®¡æ¨¡å¼, è®¾è®¡åŸåˆ™, ç¼–ç¨‹æŠ€å·§çš„ä»£ç å®ç°åŸºç¡€</li></ul><h1>é¢å‘å¯¹è±¡ç›¸æ¯”é¢å‘è¿‡ç¨‹æœ‰å“ªäº›ä¼˜åŠ¿? é¢å‘è¿‡ç¨‹çœŸçš„è¿‡æ—¶äº†å—?</h1><p>æ€»æœ‰äººæ‹¿é¢å‘å¯¹è±¡è¯­è¨€å†™é¢å‘è¿‡ç¨‹é£æ ¼çš„ä»£ç </p><h2 id="ä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ç¼–ç¨‹ä¸é¢å‘è¿‡ç¨‹ç¼–ç¨‹è¯­è¨€">ä»€ä¹ˆæ˜¯é¢å‘è¿‡ç¨‹ç¼–ç¨‹ä¸é¢å‘è¿‡ç¨‹ç¼–ç¨‹è¯­è¨€?</h2><p>é¢å‘å¯¹è±¡å®šä¹‰</p><ul><li>é¢å‘å¯¹è±¡è¿‡ç¨‹ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼, æ˜¯ä»¥ç±»å’Œå¯¹è±¡ä½œä¸ºåŸºæœ¬å•å…ƒ, ä»¥å°è£…, æŠ½è±¡, ç»§æ‰¿,å¤šæ€ä¸ºåŸºçŸ³æ¥è®¾è®¡å’Œå®ç°ä»£ç </li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€æ˜¯æ”¯æŒç±»å’Œå¯¹è±¡çš„è¯­æ³•æœºåˆ¶,å¹¶æœ‰ç°æˆçš„è¯­æ³•æœºåˆ¶, èƒ½æ–¹ä¾¿åœ°å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹åœ°å››å¤§ç‰¹æ€§åœ°ç¼–ç¨‹è¯­è¨€</li></ul><p>é¢å‘è¿‡ç¨‹å®šä¹‰</p><ul><li>é¢å‘è¿‡ç¨‹ç¼–ç¨‹ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼,å®ƒä»¥è¿‡ç¨‹(æ–¹æ³•, å‡½æ•°, æ“ä½œ)ä½œä¸ºç»„ç»‡ä»£ç çš„åŸºæœ¬å•å…ƒ, ä»¥æ•°æ®(æˆå‘˜å˜é‡, å±æ€§)ä¸æ–¹æ³•ç›¸åˆ†ç¦»ä¸ºæœ€ä¸»è¦çš„ç‰¹ç‚¹.é¢å‘è¿‡ç¨‹é£æ ¼æ˜¯ä¸€ç§æµç¨‹åŒ–çš„ç¼–ç¨‹é£æ ¼,é€šè¿‡æ‹¼æ¥ä¸€ç»„é¡ºåºæ‰§è¡Œçš„æ–¹æ³•æ¥æ“ä½œæ•°æ®å®Œæˆä¸€é¡¹åŠŸèƒ½</li><li>é¢å‘è¿‡ç¨‹ç¼–ç¨‹è¯­è¨€,æœ€å¤§ç‰¹ç‚¹æ˜¯ä¸æ”¯æŒç±»å’Œå¯¹è±¡ä¸¤ä¸ªè¯­æ³•æ¦‚å¿µ,ä¸æ”¯æŒä¸°å¯Œçš„é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ç‰¹æ€§,ä»…æ”¯æŒé¢å‘è¿‡ç¨‹ç¼–ç¨‹</li></ul><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®°å½•äº†ç”¨æˆ·ä¿¡æ¯çš„æ–‡æœ¬æ–‡ä»¶users.txt,æ¯è¡Œæ–‡æœ¬çš„æ ¼å¼æ˜¯name&amp;age&amp;gender(æ¯”å¦‚ï¼Œå°ç‹&amp;28&amp;ç”·)ã€‚æˆ‘ä»¬å¸Œæœ›å†™ä¸€ä¸ªç¨‹åºï¼Œä»usersâ€¦txtæ–‡ä»¶ä¸­é€è¡Œè¯»å–ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åæ ¼å¼åŒ–æˆ<br>name\tage\tgender(å…¶ä¸­ï¼Œ\tæ˜¯åˆ†éš”ç¬¦)è¿™ç§æ–‡æœ¬æ ¼å¼ï¼Œå¹¶ä¸”æŒ‰ç…§ageä»å°åˆ°å¤§æ’åºä¹‹åï¼Œ<br>é‡æ–°å†™å…¥åˆ°å¦ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶formatted_.usersâ€¦txtä¸­,</p><p>ç”¨é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡ä¸¤ç§ç¼–ç¨‹é£æ ¼ï¼Œç¼–å†™å‡ºæ¥çš„ä»£ç æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>é¢å‘è¿‡ç¨‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">User</span> &#123;</span></span><br><span class="line">  <span class="type">char</span> name[<span class="number">64</span>];</span><br><span class="line">  <span class="type">int</span> age;</span><br><span class="line">  <span class="type">char</span> gender[<span class="number">16</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> User <span class="title function_">parse_to_user</span><span class="params">(<span class="type">char</span>* text)</span> &#123;</span><br><span class="line">  <span class="comment">// å°†text(â€œå°ç‹&amp;28&amp;ç”·â€)è§£ææˆç»“æ„ä½“struct User</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* <span class="title function_">format_to_text</span><span class="params">(<span class="keyword">struct</span> User user)</span> &#123;</span><br><span class="line">  <span class="comment">// å°†ç»“æ„ä½“struct Useræ ¼å¼åŒ–æˆæ–‡æœ¬ï¼ˆ&quot;å°ç‹\t28\tç”·&quot;ï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sort_users_by_age</span><span class="params">(<span class="keyword">struct</span> User users[])</span> &#123;</span><br><span class="line">  <span class="comment">// æŒ‰ç…§å¹´é¾„ä»å°åˆ°å¤§æ’åºusers</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">format_user_file</span><span class="params">(<span class="type">char</span>* origin_file_path, <span class="type">char</span>* new_file_path)</span> &#123;</span><br><span class="line">  <span class="comment">// open files...</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">User</span> <span class="title">users</span>[1024];</span> <span class="comment">// å‡è®¾æœ€å¤§1024ä¸ªç”¨æˆ·</span></span><br><span class="line">  <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123; <span class="comment">// read until the file is empty</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">User</span> <span class="title">user</span> =</span> parse_to_user(line);</span><br><span class="line">    users[count++] = user;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  sort_users_by_age(users);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</span><br><span class="line">    <span class="type">char</span>* formatted_user_text = format_to_text(users[i]);</span><br><span class="line">    <span class="comment">// write to new file...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// close files...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">char</span>** args, <span class="type">int</span> argv)</span> &#123;</span><br><span class="line">  format_user_file(<span class="string">&quot;/home/zheng/user.txt&quot;</span>, <span class="string">&quot;/home/zheng/formatted_users.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢å‘å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> String gender;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age, String gender)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">    <span class="built_in">this</span>.gender = gender;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> User <span class="title function_">praseFrom</span><span class="params">(String userInfoText)</span> &#123;</span><br><span class="line">    <span class="comment">// å°†text(â€œå°ç‹&amp;28&amp;ç”·â€)è§£ææˆç±»User</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">formatToText</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// å°†ç±»Useræ ¼å¼åŒ–æˆæ–‡æœ¬ï¼ˆ&quot;å°ç‹\t28\tç”·&quot;ï¼‰</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserFileFormatter</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">format</span><span class="params">(String userFile, String formattedUserFile)</span> &#123;</span><br><span class="line">    <span class="comment">// Open files...</span></span><br><span class="line">    <span class="type">List</span> <span class="variable">users</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123; <span class="comment">// read until file is empty </span></span><br><span class="line">      <span class="comment">// read from file into userText...</span></span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> User.parseFrom(userText);</span><br><span class="line">      users.add(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// sort users by age...</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; users.size(); ++i) &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">formattedUserText</span> <span class="operator">=</span> user.formatToText();</span><br><span class="line">      <span class="comment">// write to new file...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// close files...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApplication</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">UserFileFormatter</span> <span class="variable">userFileFormatter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserFileFormatter</span>();</span><br><span class="line">    userFileFormatter.format(<span class="string">&quot;/home/zheng/users.txt&quot;</span>, <span class="string">&quot;/home/zheng/formatted_users.txt&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢å‘å¯¹è±¡ç¼–ç¨‹ç›¸æ¯”é¢å‘è¿‡ç¨‹ç¼–ç¨‹æœ‰å“ªäº›ä¼˜åŠ¿">é¢å‘å¯¹è±¡ç¼–ç¨‹ç›¸æ¯”é¢å‘è¿‡ç¨‹ç¼–ç¨‹æœ‰å“ªäº›ä¼˜åŠ¿</h2><ul><li><p>å¯¹äºå¤§è§„æ¨¡ç¨‹åºçš„å¼€å‘,ç¨‹åºçš„å¤„ç†æµç¨‹å¹¶éå•ä¸€ä¸»çº¿, è€Œæ˜¯é”™ç»¼å¤æ‚çš„ç©è½¬ç»“æ„.é¢å‘å¯¹è±¡ç¼–ç¨‹æ¯”èµ·é¢å‘è¿‡ç¨‹ç¼–ç¨‹,æ›´èƒ½åº”å¯¹è¿™ç§å¤æ‚ç±»å‹çš„ç¨‹åºå¼€å‘</p></li><li><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸°å¯Œçš„ç‰¹æ€§.åˆ©ç”¨è¿™äº›ç‰¹æ€§ç¼–å†™å‡ºæ¥çš„ä»£ç ,æ›´æ˜“æ‰©å±•,æ˜“ç»´æŠ¤,æ˜“å¤ç”¨</p></li><li><p>ç¼–ç¨‹è¯­è¨€å’Œæœºå™¨æ‰“äº¤é“çš„æ–¹å¼çš„æ¼”è¿›è§„å¾‹ä¸­,æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡º: é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€æ¯”é¢å‘è¿‡ç¨‹ç¼–ç¨‹è¯­è¨€,æ›´åŠ äººæ€§åŒ–,æ›´åŠ é«˜çº§,æ›´åŠ æ™ºèƒ½</p></li></ul><h1>å“ªäº›ä»£ç è®¾è®¡çœ‹ä¼¼æ˜¯é¢å‘å¯¹è±¡,å®é™…æ˜¯é¢å‘è¿‡ç¨‹çš„?</h1><h2 id="æ»¥ç”¨getter-setteræ–¹æ³•">æ»¥ç”¨<code>getter</code>,<code>setter</code>æ–¹æ³•</h2><p>â€‹è¿åå°è£…ç‰¹æ€§,å°†é¢å‘å¯¹è±¡ç¼–ç¨‹é£æ ¼é€€åŒ–ä¸ºé¢å‘è¿‡ç¨‹ç¼–ç¨‹é£æ ¼</p><p><strong>åœ¨è®¾è®¡ç±»æ—¶å°½é‡ä¸è¦ç»™å±æ€§å®šä¹‰setteræ–¹æ³•, é™¤æ­¤ä¹‹å¤–,å°½ç®¡getteræ–¹æ³•ç›¸å¯¹äºsetteræ–¹æ³•è¦å®‰å…¨,ä½†æ˜¯å¦‚æœè¿”å›çš„æ˜¯é›†åˆå®¹å™¨,ä¹Ÿè¦é˜²èŒƒé›†åˆå†…éƒ¨æ•°æ®è¢«ä¿®æ”¹çš„å±é™©</strong></p><h2 id="æ»¥ç”¨å…¨å±€å˜é‡-Constants-å’Œå…¨å±€æ–¹æ³•-Utils">æ»¥ç”¨å…¨å±€å˜é‡(Constants)å’Œå…¨å±€æ–¹æ³•(Utils)</h2><p>å°†æ•°æ®å’Œæ“ä½œåˆ†ç¦», ä¸æ˜¯é¢å‘å¯¹è±¡,ä½†ä¹Ÿæœ‰ä¸€å®šå¥½å¤„</p><h3 id="Utilsæ”¹è¿›ç­–ç•¥"><code>Utils</code>æ”¹è¿›ç­–ç•¥</h3><p>â€‹åˆ¤å®šè¡¨æ ‡å‡†:  åœ¨å®šä¹‰<code>Utils</code>ç±»ä¹‹å‰, ä½ è¦é—®ä¸€ä¸‹è‡ªå·±,:</p><ul><li><p>**ä½ çœŸçš„éœ€è¦å•ç‹¬å®šä¹‰è¿™æ ·ä¸€ä¸ª<code>Utils</code>ç±»å—? **</p></li><li><p><strong>æ˜¯å¦å¯ä»¥æŠŠ<code>Utils</code>ç±»ä¸­åœ°æŸäº›æ–¹æ³•å®šä¹‰åˆ°å…¶å®ƒç±»ä¸­å‘¢?</strong></p></li></ul><p>â€‹å›ç­”å®Œè¿™äº›é—®é¢˜,ä½ è¿˜æ˜¯è§‰å¾—ç¡®å®æœ‰å¿…è¦å»å®šä¹‰è¿™æ ·ä¸€ä¸ª<code>Utils</code>ç±», é‚£ä¹ˆ<strong>å¤§èƒ†åœ°å»å®šä¹‰å®ƒå§(ä¸è¦ä¸ºäº†é¢å‘å¯¹è±¡, éšæ„æŠ½è±¡ä¸€ä¸ªçˆ¶ç±»)</strong> ,å› ä¸ºåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­, æˆ‘ä»¬ä¹Ÿå¹¶ä¸æ˜¯å®Œå…¨æ’æ–¥é¢å‘è¿‡ç¨‹é£æ ¼çš„ä»£ç .  åªè¦èƒ½ä¸ºæˆ‘ä»¬å†™å¥½ä»£ç ,è´¡çŒ®åŠ›é‡,æˆ‘ä»¬å°±å¯ä»¥é€‚åº¦åœ°å»ä½¿ç”¨</p><h3 id="Constantsæ”¹è¿›ç­–ç•¥">Constantsæ”¹è¿›ç­–ç•¥</h3><p>â€‹å½“<code>Constants</code>ç±»ä¸­åŒ…å«å¾ˆå¤šå¸¸é‡å®šä¹‰çš„æ—¶å€™,ä¾èµ–è¿™ä¸ªç±»çš„ä»£ç å°±ä¼šå¾ˆå¤š, æ¯æ¬¡ä¿®æ”¹Constantsç±»,éƒ½ä¼šå¯¼è‡´ä¾èµ–å®ƒçš„ç±»æ–‡ä»¶é‡æ–°ç¼–è¯‘,å› æ­¤ä¼šæµªè´¹å¾ˆå¤šä¸å¿…è¦çš„ç¼–è¯‘æ—¶é—´, å¯¹äºä¸€ä¸ªéå¸¸å¤§çš„å·¥ç¨‹é¡¹ç›®,ç¼–è¯‘ä¸€æ¬¡æ•‘è¯èŠ±è´¹å‡ åˆ†é’Ÿ,ç”šè‡³å‡ ååˆ†é’Ÿ, æ¯æ¬¡è¿›è¡Œå•å…ƒæµ‹è¯•éƒ½ä¼šå‡ºå‘ä¸€æ¬¡ç¼–è¯‘çš„è¿‡ç¨‹,ç¼–è¯‘è¿‡ç¨‹ä¼šå½±å“æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</p><p>æ”¹è¿›<code>Constants</code>ç±» ä¸¤ç§æ€è·¯:</p><ul><li>å°†<code>Constants</code>æ‹†åˆ†ä¸ºåŠŸèƒ½æ›´åŠ å•ä¸€çš„å¤šä¸ªç±»</li><li>ä¸å•ç‹¬è®¾è®¡<code>Constants</code>å¸¸é‡ç±»,è€Œæ˜¯å“ªä¸ªç±»ç”¨åˆ°äº†æŸä¸ªå¸¸é‡,å°†å¸¸é‡å®šä¹‰åˆ°è¿™ä¸ªç±»ä¸­(è®©æˆ‘æƒ³åˆ°äº†æ³¨è§£)</li></ul><p>â€‹<strong><code>Constants</code>ç±», <code>Utils</code>ç±»çš„è®¾è®¡é—®é¢˜</strong>, å¯¹äºè¿™ä¸¤ç§ç±»çš„è®¾è®¡, æˆ‘ä»¬å°½é‡èƒ½åšåˆ°èŒè´£å•ä¸€,å®šä¹‰ä¸€äº›ç»†åŒ–åˆ°çš„ç±», æ¯”å¦‚æœ‰<code>RedisConstatns</code>, <code>FileUtils</code>, è€Œä¸æ˜¯å®šä¹‰ä¸€ä¸ªå¤§è€Œå…¨çš„<code>Constants</code>ç±», <code>Utils</code>ç±». é™¤æ­¤ä¹‹å¤–,å¦‚æœèƒ½å°†è¿™äº›ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•, åˆ’åˆ†å½’å¹¶åˆ°å…¶ä»–ä¸šåŠ¡ä¸­,  é‚£æ˜¯æœ€å¥½ä¸è¿‡çš„äº†, èƒ½æå¤§åœ°æé«˜ç±»çš„å†…ä¸¾è¡Œå’Œä»£ç åœ°å¯å¤ç”¨æ€§</p><h2 id="å®šä¹‰æ•°æ®å’Œæ–¹æ³•åˆ†ç¦»çš„ç±»">å®šä¹‰æ•°æ®å’Œæ–¹æ³•åˆ†ç¦»çš„ç±»</h2><pre><code>ä¼ ç»Ÿ`MVC`ç»“æ„åˆ†ä¸º`Model`å±‚, `Controller`å±‚, `View`å±‚è¿™ä¸‰å±‚</code></pre><p>â€‹é€»è¾‘ä¸Šåˆ†ä¸º <code>Controller</code>å±‚, <code>Service</code>å±‚, <code>Repository</code>å±‚</p><p>â€‹æ•°æ®ä¸Šå®šä¹‰<code>VO</code>(View Object) <code>BO</code>(Business Object)  <code>Entity</code></p><p>è¿™æ˜¯å…¸å‹çš„é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹é£æ ¼</p><p>â€‹è¿™ç§å¼€å‘æ¨¡å¼å«åšåŸºäº<code>è´«è¡€æ¨¡å‹</code>çš„å¼€å‘æ¨¡å‹, æ˜¯æˆ‘ä»¬ç°åœ¨éå¸¸å¸¸ç”¨çš„ä¸€ç§Webé¡¹ç›®çš„å¼€å‘æ¨¡å¼.(æ—¥åä¼šè®²)</p><p>â€‹é¢å‘å¯¹è±¡ç¼–ç¨‹æ¯”é¢å‘è¿‡ç¨‹ç¼–ç¨‹éš¾ä¸€äº›,ä¸ç»æ„å°±å†™æˆé¢å‘è¿‡ç¨‹äº†</p><p>â€‹æˆ‘ä»¬åœ¨å†™ä¸€äº›å¾®å°ç¨‹åºæ—¶,æˆ–è€…ä¸€ä¸ªæ•°æ®å¤„ç†ç›¸å…³çš„ä»£ç , ä»¥ç®—æ³•ä¸ºä¸», æ•°æ®ä¸ºè¾…, è„šæœ¬æ˜¯çš„é¢å‘è¿‡ç¨‹ç¼–ç é£æ ¼å°±æ›´åŠ é€‚åˆä¸€äº›,è€Œä¸”é¢å‘è¿‡ç¨‹æœ¬èº«å°±æ˜¯é¢å‘å¯¹è±¡çš„åŸºç¡€, é¢å‘å¯¹è±¡ç¼–ç¨‹ç¦»ä¸å¼€åŸºç¡€çš„é¢å‘è¿‡ç¨‹ç¼–ç¨‹.</p><p>â€‹ä¸ç®¡ä½¿ç”¨é¢å‘å¯¹è±¡è¿˜æ˜¯é¢å‘è¿‡ç¨‹å“ªç§é£æ ¼æ¥å†™ä»£ç , æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„è¿˜æ˜¯å†™å‡ºæ˜“ç»´æŠ¤, æ˜“è¯», æ˜“å¤ç”¨, æ˜“æ‰©å±•çš„é«˜è´¨é‡ä»£ç . åªè¦èƒ½æ§åˆ¶é¢å‘è¿‡ç¨‹ç¼–ç¨‹é£æ ¼çš„ä¸€äº›å¼Šç«¯, æ§åˆ¶å¥½å®ƒçš„å‰¯ä½œç”¨, åœ¨æŒæ¡èŒƒå›´å†…ä¸ºæˆ‘ä»¬æ‰€ç”¨, æˆ‘ä»¬å¤§å¯ä¸é¿è®³åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­å†™é¢å‘è¿‡ç¨‹é£æ ¼çš„ä»£ç </p><p>ä¼˜ç§€è¯„è®º(ç¬‘æ­»çœ‹ä¸æ‡‚)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.ç”¨sheå®ç°è‡ªåŠ¨åŒ–è„šæœ¬åšçš„æœåŠ¡ç¼–æ’ï¼Œä¸€èˆ¬éƒ½æ˜¯é¢å‘è¿‡ç¨‹ï¼Œä¸€æ­¥ä¸€æ­¥çš„ã€‚è€Œk8sçš„ç¼–æ’å´æ˜¯</span><br><span class="line">é¢å‘å¯¹è±¡çš„ï¼Œå› ä¸ºå®ƒä¸ºè¿™ä¸ªé¡ºåºæµæŠ½è±¡å‡ºäº†å¾ˆå¤šè§’è‰²ï¼Œå°†åŸæœ¬ä¸€æ­¥ä¸€æ­¥çš„é¡ºåºæ“ä½œè½¬å˜æˆäº†å¤š</span><br><span class="line">ä¸ªè§’è‰²é—´çš„è½®è½¬å’Œäº¤äº’ã€‚</span><br><span class="line">2.ä»æ¥è§¦dddæ‰èµ°å‡ºjavaerä¸¾é¢å‘å¯¹è±¡æ——ï¼Œå¹²é¢å‘è¿‡ç¨‹å‹¾å½“çš„å±€é¢ã€‚æ‰€è°“ä¸ºä»€ä¹ˆâ€œå……è¡€æ¨¡å‹â€ä¸æµ</span><br><span class="line">è¡Œï¼Œæˆ‘è®¤ä¸ºä¸å¤–å‘¼ä¸¤ä¸ªã€‚ä¸€ï¼Œè§„èŒƒçš„é¢†åŸŸæ¨¡å‹å¯¹äºåº•å±‚åŸºç¡€æ¶æ„æ¥è¯´å¹¶ä¸å‹å¥½ï¼ˆç¼ºå°‘stge</span><br><span class="line">t)ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´è§„èŒƒçš„é¢†åŸŸæ¨¡å‹ä¸ç°æœ‰åŸºç¡€æ¶æ„ä¸è´´åˆï¼Œåˆ‡å¾ˆéš¾å¼€å‘å‡ºå®Œå…¨è´´åˆçš„åŸºç¡€æ¶</span><br><span class="line">æ„ï¼Œè¿›è€Œå¼•æ·±å‡ºï¼Œåˆç†çš„ä¸šåŠ¡å°è£…å´é˜»ç¢å…³äºå¤ç”¨é€šç”¨æŠ½è±¡çš„çŸ›ç›¾ã€‚äºŒï¼Œåˆç†çš„ä¸šåŠ¡å°è£…ï¼Œéœ€</span><br><span class="line">è¦åœ¨æˆ˜ç•¥ä¸Šå¯¹ä¸šåŠ¡å…ˆåšåˆç†çš„å½’ç±»åˆ†å‰²å’ŒæŠ½è±¡ã€‚è€Œè¿™ä¸ªå‰ç½®æ¡ä»¶å¾ˆå°‘ä¹Ÿä¸å¥½è¾¾æˆã€‚è¿›è€Œç¼ºå°‘å‰</span><br><span class="line">ç½®è®¾è®¡å°è£…å‡ºæ¥çš„â€œå……è¡€æ¨¡å‹â€ä¼šæœ‰ç§å››ä¸åƒçš„å‘³é“ï¼Œåè€ŒåŠ å‰§äº†ä¸šåŠ¡çš„å¤æ‚æ€§ï¼Œè¿˜ä¸å¦‚â€œè´«è¡€</span><br><span class="line">æ¨¡å‹â€æ¥å¾—å®ç”¨ã€‚äº‹å®ä¸Šå¿«èŠ‚å¥ä¸‹ï¼Œå‰ç½®æˆ˜ç•¥è®¾è®¡å¾€å¾€éƒ½æ˜¯ä¸è¶³çš„ï¼Œæ‰€ä»¥æƒ³æ„å»ºä¼˜ç§€çš„â€œå……è¡€æ¨¡</span><br><span class="line">å‹â€æ¶æ„ï¼Œé™¤äº†è¦å¯¹ä¸šåŠ¡é¢†åŸŸå’Œé¢†åŸŸè®¾è®¡æœ‰è¶³å¤Ÿçš„è®¤çŸ¥ï¼Œåœ¨é‡æ„æ‰‹æ³•å’Œé‡æ„æ„æ„¿ä¸Šè¿˜è¦æœ‰ä¸€å®š</span><br><span class="line">è®²ç©¶å’Œè¿½æ±‚ï¼Œè¿™æ ·æ‰èƒ½è®©é¡¹ç›®ä»¥â€œå……è¡€æ¨¡å‹â€æŒç»­ä¸”è‰¯æ€§çš„è¿­ä»£ã€‚</span><br><span class="line">3.â€œå……è¡€æ¨¡å‹â€ç›¸å¯¹äºâ€œè´«è¡€æ¨¡å‹â€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿä»æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œå¯è¯»æ€§å…¶å®å¯èƒ½â€œè´«è¡€æ¨¡å‹â€è¿˜å¥½</span><br><span class="line">ä¸€ç‚¹ï¼Œè¿™ä¹Ÿå¯èƒ½æœ‰æ€ç»´æƒ¯æ€§çš„åŸå› åœ¨é‡Œé¢ã€‚ä½†ä»çµæ´»å’Œæ‰©å±•æ€§æ¥è¯´â€œå……è¡€æ¨¡å‹â€ä¼šä¼˜ç§€å¾ˆå¤šï¼Œå› </span><br><span class="line">ä¸ºå¥½çš„â€œå……è¡€æ¨¡å‹&quot;â€å¾€å¾€æ„å‘³ç€è¾¹ç•Œæ¸…æ™°ï¼ˆè€¦åˆä½ï¼‰ï¼ŒåŠŸèƒ½å†…æ•›ï¼ˆé«˜å†…èšï¼‰ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>æ¥å£vsæŠ½è±¡ç±»çš„åŒºåˆ«? å¦‚ä½•ç”¨æ™®é€šçš„ç±»æ¨¡æ‹ŸæŠ½è±¡ç±»å’Œæ¥å£?</h1><p>C++ä¸æ”¯æŒæŠ½è±¡ç±», pythonä¸æ”¯æŒæŠ½è±¡ç±»ä¹Ÿä¸æ”¯æŒæ¥å£</p><h3 id="ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»å’Œæ¥å£-åŒºåˆ«åœ¨å“ªé‡Œ">ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»å’Œæ¥å£? åŒºåˆ«åœ¨å“ªé‡Œ?</h3><p>å…¸å‹çš„æŠ½è±¡ç±»çš„ä½¿ç”¨åœºæ™¯(æ¨¡æ¿è®¾è®¡æ¨¡å¼)</p><p>â€‹<code>Logger</code>æ˜¯ä¸€ä¸ªè®°å½•æ—¥å¿—çš„æŠ½è±¡ç±»,<code>FileLogger</code>å’Œ<code>MessageQueueLogger</code>ç»§æ‰¿<code>Logger</code>, åˆ†åˆ«å®ç°ä¸¤ç§ä¸åŒçš„æ—¥å¿—è®°å½•æ–¹å¼:  è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶ä¸­å’Œè®°å½•æ—¥å¿—åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­.</p><p>â€‹<code>FileLogger</code>å’Œ<code>MessageQueueLogger</code>ä¸¤ä¸ªå­ç±»æœç”¨äº†çˆ¶ç±»<code>Logger</code>ä¸­çš„<code>name</code>, <code>enabled</code>, <code>minPermittedLevel</code>å±æ€§å’Œ<code>log()</code>æ–¹æ³•, ä½†å› ä¸ºè¿™ä¸¤ä¸ªå­ç±»å†™æ—¥å¿—çš„æ–¹å¼ä¸åŒ, å®ƒä»¬åˆå„è‡ªé‡å†™äº†çˆ¶ç±»ä¸­çš„<code>doLog()</code>æ–¹æ³•</p><p>æŠ½è±¡ç±»:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŠ½è±¡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> enabled;</span><br><span class="line">  <span class="keyword">private</span> Level minPermittedLevel;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Logger</span><span class="params">(String name, <span class="type">boolean</span> enabled, Level minPermittedLevel)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.enabled = enabled;</span><br><span class="line">    <span class="built_in">this</span>.minPermittedLevel = minPermittedLevel;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String message)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">loggable</span> <span class="operator">=</span> enabled &amp;&amp; (minPermittedLevel.intValue() &lt;= level.intValue());</span><br><span class="line">    <span class="keyword">if</span> (!loggable) <span class="keyword">return</span>;</span><br><span class="line">    doLog(level, message);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">doLog</span><span class="params">(Level level, String message)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»çš„å­ç±»ï¼šè¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> Writer fileWriter;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">FileLogger</span><span class="params">(String name, <span class="type">boolean</span> enabled,</span></span><br><span class="line"><span class="params">    Level minPermittedLevel, String filepath)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(name, enabled, minPermittedLevel);</span><br><span class="line">    <span class="built_in">this</span>.fileWriter = <span class="keyword">new</span> <span class="title class_">FileWriter</span>(filepath); </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doLog</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">    fileWriter.write(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»çš„å­ç±»: è¾“å‡ºæ—¥å¿—åˆ°æ¶ˆæ¯ä¸­é—´ä»¶(æ¯”å¦‚kafka)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageQueueLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> MessageQueueClient msgQueueClient;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">MessageQueueLogger</span><span class="params">(String name, <span class="type">boolean</span> enabled,</span></span><br><span class="line"><span class="params">    Level minPermittedLevel, MessageQueueClient msgQueueClient)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(name, enabled, minPermittedLevel);</span><br><span class="line">    <span class="built_in">this</span>.msgQueueClient = msgQueueClient;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doLog</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ¶ˆæ¯ä¸­é—´ä»¶</span></span><br><span class="line">    msgQueueClient.send(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æ¥å£:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(RpcRequest req)</span> <span class="keyword">throws</span> RpcException;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å£å®ç°ç±»ï¼šé‰´æƒè¿‡æ»¤å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthencationFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(RpcRequest req)</span> <span class="keyword">throws</span> RpcException &#123;</span><br><span class="line">    <span class="comment">//...é‰´æƒé€»è¾‘..</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å£å®ç°ç±»ï¼šé™æµè¿‡æ»¤å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RateLimitFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(RpcRequest req)</span> <span class="keyword">throws</span> RpcException &#123;</span><br><span class="line">    <span class="comment">//...é™æµé€»è¾‘...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿‡æ»¤å™¨ä½¿ç”¨Demo</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">  <span class="comment">// filters.add(new AuthencationFilter());</span></span><br><span class="line">  <span class="comment">// filters.add(new RateLimitFilter());</span></span><br><span class="line">  <span class="keyword">private</span> List&lt;Filter&gt; filters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleRpcRequest</span><span class="params">(RpcRequest req)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (Filter filter : filters) &#123;</span><br><span class="line">        filter.doFilter(req);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(RpcException e) &#123;</span><br><span class="line">      <span class="comment">// ...å¤„ç†è¿‡æ»¤ç»“æœ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...çœç•¥å…¶ä»–å¤„ç†é€»è¾‘...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹æŠ½è±¡ç±»å®é™…å°±æ˜¯ç±», åªä¸è¿‡æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»,è¿™ç§ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–å¯¹è±¡, åªèƒ½è¢«å­ç±»ç»§æ‰¿. ç»§æ‰¿å…³ç³»æ˜¯ä¸€ç§<code>is-a</code>å…³ç³»æ¥è¯´, æ¥å£è¡¨ç¤ºä¸€ç§ <code>has-a</code>å…³ç³», è¡¨ç¤ºå…·æœ‰æŸäº›åŠŸèƒ½, å¯¹äºæ¥å£, æœ‰ä¸€ç§æ›´åŠ æŠ½è±¡çš„å«æ³•,é‚£å°±æ˜¯åè®®(contract).</p><h3 id="æŠ½è±¡ç±»å’Œæ¥å£èƒ½è§£å†³ä»€ä¹ˆç¼–ç¨‹é—®é¢˜">æŠ½è±¡ç±»å’Œæ¥å£èƒ½è§£å†³ä»€ä¹ˆç¼–ç¨‹é—®é¢˜?</h3><p>æŠ½è±¡ç±»æ˜¯ä¸ºäº†ä»£ç å¤ç”¨è€Œç”Ÿçš„</p><p>ä½†æ™®é€šç±»ä¹Ÿå¯ä»¥å®ç°ä»£ç å¤ç”¨, é‚£ä¹ˆæŠ½è±¡ç±»æœ‰ä»€ä¹ˆç‹¬ç‰¹ä½œç”¨å—?</p><p>æŠ½è±¡ç±»æ˜¯ <code>is-a</code></p><p>æ¥å£æ—¶ <code>has-a</code></p><p>æˆ‘ä»¬è¿˜æ˜¯æ‹¿ä¹‹å‰é‚£ä¸ªæ‰“å°æ—¥å¿—çš„ä¾‹å­æ¥è®²è§£ã€‚æˆ‘ä»¬å…ˆå¯¹ä¸Šé¢çš„ä»£ç åšä¸‹æ”¹é€ ã€‚åœ¨æ”¹é€ ä¹‹åçš„ä»£<br>ç ä¸­ï¼Œ<code>Logger</code>ä¸å†æ˜¯æŠ½è±¡ç±»ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šçš„çˆ¶ç±»ï¼Œåˆ é™¤äº†<code>Logger</code>ä¸­<code>log()</code>ã€<code>doLog()</code>æ–¹æ³•ï¼Œ<br>æ–°å¢äº†<code>isLoggablet()</code>æ–¹æ³•ã€‚<code>FileLogger</code>å’Œ<code>MessageQueueLogger</code>è¿˜æ˜¯ç»§æ‰¿<code>Logger</code>çˆ¶ç±»ï¼Œä»¥è¾¾<br>åˆ°ä»£ç å¤ç”¨çš„ç›®çš„ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç±»ï¼šéæŠ½è±¡ç±»ï¼Œå°±æ˜¯æ™®é€šçš„ç±». åˆ é™¤äº†log(),doLog()ï¼Œæ–°å¢äº†isLoggable().</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> enabled;</span><br><span class="line">  <span class="keyword">private</span> Level minPermittedLevel;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Logger</span><span class="params">(String name, <span class="type">boolean</span> enabled, Level minPermittedLevel)</span> &#123;</span><br><span class="line">    <span class="comment">//...æ„é€ å‡½æ•°ä¸å˜ï¼Œä»£ç çœç•¥...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">isLoggable</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">loggable</span> <span class="operator">=</span> enabled &amp;&amp; (minPermittedLevel.intValue() &lt;= level.intValue());</span><br><span class="line">    <span class="keyword">return</span> loggable;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å­ç±»ï¼šè¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> Writer fileWriter;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">FileLogger</span><span class="params">(String name, <span class="type">boolean</span> enabled,</span></span><br><span class="line"><span class="params">    Level minPermittedLevel, String filepath)</span> &#123;</span><br><span class="line">    <span class="comment">//...æ„é€ å‡½æ•°ä¸å˜ï¼Œä»£ç çœç•¥...</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLoggable()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">    fileWriter.write(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å­ç±»: è¾“å‡ºæ—¥å¿—åˆ°æ¶ˆæ¯ä¸­é—´ä»¶(æ¯”å¦‚kafka)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageQueueLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> MessageQueueClient msgQueueClient;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">MessageQueueLogger</span><span class="params">(String name, <span class="type">boolean</span> enabled,</span></span><br><span class="line"><span class="params">    Level minPermittedLevel, MessageQueueClient msgQueueClient)</span> &#123;</span><br><span class="line">    <span class="comment">//...æ„é€ å‡½æ•°ä¸å˜ï¼Œä»£ç çœç•¥...</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLoggable()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ¶ˆæ¯ä¸­é—´ä»¶</span></span><br><span class="line">    msgQueueClient.send(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè®¾è®¡æ€è·¯è™½ç„¶è¾¾åˆ°äº†ä»£ç å¤ç”¨çš„ç›®çš„ï¼Œä½†æ˜¯æ— æ³•ä½¿ç”¨å¤šæ€ç‰¹æ€§äº†ã€‚åƒä¸‹é¢è¿™æ ·ç¼–å†™ä»£ç ï¼Œ<br>å°±ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸º<code>Logger</code>ä¸­å¹¶æ²¡æœ‰å®šä¹‰<code>log()</code>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileLogger</span>(<span class="string">&quot;access-log&quot;</span>, <span class="literal">true</span>, Level.WARN, <span class="string">&quot;/users/wangzheng/access.log&quot;</span>);</span><br><span class="line">logger.log(Level.ERROR, <span class="string">&quot;This is a test log message.&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¸ªé—®é¢˜è§£å†³èµ·æ¥å¾ˆç®€å•å•Šã€‚æˆ‘ä»¬åœ¨Loggerçˆ¶ç±»ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªç©ºçš„<code>Iog()</code>æ–¹æ³•ï¼Œ<br>è®©å­ç±»é‡å†™çˆ¶ç±»çš„<code>1og ()</code>æ–¹æ³•ï¼Œå®ç°è‡ªå·±çš„è®°å½•æ—¥å¿—çš„é€»è¾‘ï¼Œä¸å°±å¯ä»¥äº†å—ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="comment">// ...çœç•¥éƒ¨åˆ†ä»£ç ...</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String mesage)</span> &#123; <span class="comment">// do nothing... &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="comment">// ...çœç•¥éƒ¨åˆ†ä»£ç ...</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLoggable()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">    fileWriter.write(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageQueueLogger</span> <span class="keyword">extends</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">  <span class="comment">// ...çœç•¥éƒ¨åˆ†ä»£ç ...</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(Level level, String mesage)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isLoggable()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ¶ˆæ¯ä¸­é—´ä»¶</span></span><br><span class="line">    msgQueueClient.send(...);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†å®ƒæ˜¾ç„¶æ²¡æœ‰ä¹‹å‰æŠ½è±¡ç±»çš„å®ç°æ€è·¯ä¼˜é›…</p><ul><li>Loggerä¸­å®šä¹‰ä¸€ä¸ªç©ºçš„æ–¹æ³•,å¯è¯»æ€§å·®</li><li>å½“åˆ›å»ºä¸€ä¸ªæ–°çš„å­ç±»ç»§æ‰¿Loggerçˆ¶ç±»çš„æ—¶å€™, æˆ‘ä»¬åˆå¯èƒ½ä¼šå¿˜è®°é‡æ–°å®ç°log()æ–¹æ³•,ä¹‹å‰çš„æŠ½è±¡ç±»ä¼šå¼ºåˆ¶å­ç±»é‡å†™<code>log()</code>æ–¹æ³•</li><li>Loggerå¯ä»¥è¢«å®ä¾‹åŒ–,å¢åŠ ç±»è¢«è¯¯ç”¨çš„é£é™©</li></ul><p>å…¶ä»–è¯­è¨€å³ä½¿ä¸æ”¯æŒæ¥å£ç‰¹æ€§, ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿæ¥å£</p><h1>ä¸ºä»€ä¹ˆåŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹? æœ‰å¿…è¦ä¸ºæ¯ä¸ªç±»éƒ½å®šä¹‰æ¥å£å—?</h1>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ä¹‹ç¾ </tag>
            
            <tag> è®¡ç®—æœºåŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹ç¾å¯¼å­¦</title>
      <link href="/posts/1358.html"/>
      <url>/posts/1358.html</url>
      
        <content type="html"><![CDATA[<h1>ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼?</h1><p><em>è¶Šæ—©å­¦ä¹ è®¾è®¡æ¨¡å¼è¶Šå¥½,æœ‰äº›ä¸œè¥¿æ—©ç‚¹çŸ¥é“,æ‰èƒ½åœ¨æ—¥åä¸€ç›´å‘æŒ¥ä½œç”¨</em></p><p>åœ¨è®¡ç®—æœºåŸºç¡€ä¸­</p><ul><li><p>æ•°æ®ç»“æ„å’Œç®—æ³•ç ”ç©¶å¦‚ä½•é«˜æ•ˆå®ç°</p></li><li><p>è®¾è®¡æ¨¡å¼ç ”ç©¶å¦‚ä½•ä¿è¯ä»£ç çš„å¯ç»´æŠ¤æ€§</p></li></ul><p>æ€»ç»“</p><ul><li>åº”å¯¹é¢è¯•ä¸­çš„è®¾è®¡æ¨¡å¼ç›¸å…³é—®é¢˜</li><li>å‘Šåˆ«è¢«åˆ«äººåæ§½çš„çƒ‚ä»£ç (talk is cheap, show me your code)</li><li>æé«˜å¤æ‚ä»£ç çš„è®¾è®¡å’Œå¼€å‘èƒ½åŠ›</li><li>è®©è¯»æºç ,å­¦æ¡†æ¶äº‹åŠåŠŸå€</li><li>ä¸ºèŒåœºå‘å±•åšé“ºå«</li></ul><p>â€‹</p><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼?</p><p>ä½¿ç”¨ä»£ç†æ¨¡å¼è¿›è¡Œå…±æ€§è¯å¤„ç†,æ¯”å¦‚AOPæ€æƒ³,å°†éä¸šåŠ¡åŠŸèƒ½å’Œä¸šåŠ¡åŠŸèƒ½è§£è€¦</p><ul><li>äº‹åŠ¡çš„å¤„ç† @Translation</li><li>ç³»ç»Ÿé—´ä¸Šä¸‹æ–‡çš„ä¼ é€’ThreadLocal+ restTemplate#interceptç­‰ç­‰</li></ul><p>ä½¿ç”¨å·¥å‚ + ç­–ç•¥</p><ul><li>ä¸åŒä¼˜æƒ ç§ç±»çš„è®¡ç®—</li><li>å®šåˆ¶åŒ–åŠŸèƒ½çš„è§£è€¦</li></ul><p>è§‚å¯Ÿè€…æ¨¡å¼ : è¿™ä¸ªæ¨¡å¼çš„æ€æƒ³åœ¨å¾ˆå¤šä¸­é—´ä»¶(mq, zookeeper, nettyç­‰ç­‰)å¯ä»¥çœ‹åˆ°é“¶å­</p><ul><li>é€šè¿‡é¢†åŸŸäº‹ä»¶è§£è€¦ä¸šåŠ¡</li><li>ç†è§£eventloop, epollç­‰ç­‰</li><li>é€šè¿‡watchå®ç°åŠ¨æ€é…ç½®, HAç­‰ç­‰</li></ul><p>èŒè´£é“¾æ¨¡å¼: pipelineæ€æƒ³</p><ul><li>filter</li><li>ç†è§£nettyä¸­çš„å„ç§handler</li></ul><h1>ä»å“ªäº›ç»´åº¦è¯„ä»·ä»£ç è´¨é‡çš„å¥½å?å¦‚ä½•å…·å¤‡å†™é«˜è´¨é‡ä»£ç çš„èƒ½åŠ›?</h1><h2 id="å¦‚ä½•è¯„ä»·ä»£ç è´¨é‡çš„é«˜ä½">å¦‚ä½•è¯„ä»·ä»£ç è´¨é‡çš„é«˜ä½?</h2><p>ä»£ç è´¨é‡é«˜ä½çš„æŒ‡æ ‡æ˜¯ä»ä¸åŒç»´åº¦è¿›è¡Œè¯„ä»·ä¸”å…·æœ‰å¾ˆå¤§çš„ä¸»è§‚æ€§</p><p>ä¸”æŒ‡æ ‡ä¹‹é—´å¹¶ä¸ç‹¬ç«‹,ç»´åº¦å¯èƒ½é‡åˆ</p><p>è€Œä¸”è¯„ä»·å¾ˆéš¾é‡åŒ–,å¹¶ééé»‘å³ç™½</p><p>æœ€å¸¸ç”¨çš„è¯„ä»·æ ‡å‡†</p><ul><li><strong>å¯ç»´æŠ¤æ€§</strong></li><li><strong>å¯è¯»æ€§</strong></li><li><strong>å¯æ‰©å±•æ€§</strong></li><li>çµæ´»æ€§</li><li>ç®€ä»‹æ€§</li><li>å¯å¤ç”¨æ€§</li><li>å¯æµ‹è¯•æ€§</li></ul><h2 id="å¯ç»´æŠ¤æ€§">å¯ç»´æŠ¤æ€§</h2><p>ç»´æŠ¤ä»£ç äº‹ä»¶è¿œè¿œå¤§äºç¼–ç æ—¶é—´</p><p>ç»´æŠ¤æ— å¤–ä¹ ä¿®æ”¹bug, ä¿®æ”¹è€ä»£ç , æ·»åŠ æ–°ä»£ç </p><p>æ˜“ç»´æŠ¤æ˜¯æŒ‡åœ¨ä¸ç ´ååŸæœ‰ä»£ç è®¾è®¡, ä¸å¼•å…¥æ–°çš„bugçš„æƒ…å†µä¸‹, èƒ½å¿«é€Ÿåœ°ä¿®æ”¹æˆ–è€…æ·»åŠ ä»£ç </p><p>å¯ç»´æŠ¤æ€§ç”±äººè€Œå®š, å¾ˆä¸»è§‚</p><h2 id="å¯è¯»æ€§">å¯è¯»æ€§</h2><p><em>Google å†…éƒ¨ç”šè‡³ä¸“é—¨æœ‰ä¸ªè®¤è¯å°±å«ä½œ Readabilityã€‚åªæœ‰æ‹¿åˆ°è¿™ä¸ªè®¤è¯çš„å·¥ç¨‹å¸ˆï¼Œæ‰æœ‰èµ„æ ¼åœ¨ code review çš„æ—¶å€™ï¼Œæ‰¹å‡†åˆ«äººæäº¤ä»£ç ã€‚</em></p><p>å¯è§ä»£ç çš„å¯è¯»æ€§æœ‰å¤šé‡è¦ï¼Œæ¯•ç«Ÿï¼Œä»£ç è¢«é˜…è¯»çš„æ¬¡æ•°è¿œè¿œè¶…è¿‡è¢«ç¼–å†™å’Œæ‰§è¡Œçš„æ¬¡æ•°ã€‚</p><p>æŸ¥çœ‹ä»£ç æ˜¯å¦ç¬¦åˆç¼–ç è§„èŒƒ, å‘½åæ˜¯å¦è¾¾æ„, æ³¨é‡Šæ˜¯å¦è¯¦å°½, å‡½æ•°æ˜¯å¦é•¿çŸ­åˆé€‚, æ¨¡å—åˆ’åˆ†æ˜¯å¦æ¸…æ™°, æ˜¯å¦ç¬¦åˆé«˜å†…èšä½è€¦åˆç­‰ç­‰</p><p>code reviewæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµ‹éªŒä»£ç å¯è¯»æ€§åœ°æ‰‹æ®µ. å¦‚æœåŒäº‹å¯ä»¥è½»æ¾åœ°è¯»æ‡‚ä½ å†™çš„ä»£ç ,é‚£è¯´æ˜ä½ çš„ä»£ç å¯è¯»æ€§å¾ˆå¥½</p><h2 id="å¯æ‰©å±•æ€§">å¯æ‰©å±•æ€§</h2><p>ä»£ç æ˜¯å¦æ˜“äºæ‰©å±•</p><p>ä»£ç é¢„ç•™ä¸€äº›åŠŸèƒ½æ‰©å±•ç‚¹,ä¸ä¼šå› ä¸ºæ·»åŠ ä¸€ä¸ªåŠŸèƒ½,æ”¹åŠ¨å¤§é‡çš„åŸå§‹ä»£ç </p><p>â€œå¯¹ä¿®æ”¹å…³é—­, å¯¹æ‰©å±•å¼€æ”¾â€</p><h2 id="çµæ´»æ€§">çµæ´»æ€§</h2><p>å¾ˆæŠ½è±¡,ä¸å¥½ä¸‹å®šä¹‰</p><p>ä¸¾ä¾‹åœºæ™¯å¯ä»¥è¢«ç§°ä¸º ä»£ç å†™çš„çµæ´»</p><ul><li>æ·»åŠ æ–°çš„åŠŸèƒ½æ—¶, åŸæœ‰ä»£ç å·²ç»é¢„ç•™å¥½äº†æ‰©å±•ç‚¹, ä¸éœ€è¦ä¿®æ”¹åŸä»£ç ,åªéœ€è¦åœ¨æ‰©å±•ç‚¹æ·»åŠ æ–°çš„ä»£ç å³å¯(æ‰©å±•æ€§)</li><li>å®ç°ä¸€ä¸ªåŠŸèƒ½,å‘ç°åŸæœ‰ä»£ç ä¸­,å·²ç»æŠ½è±¡å‡ºå¾ˆå¤šåº•å±‚å¯å¤ç”¨çš„æ¨¡å—(å¯å¤ç”¨æ€§)</li><li>ä½¿ç”¨æŸç»„æ¥å£æ—¶,è¿™ç»„æ¥å£å¯ä»¥åº”å¯¹å„ç§ä½¿ç”¨åœºæ™¯,æ»¡è¶³ä¸åŒçš„çš„éœ€æ±‚.(æ˜“ç”¨)</li></ul><h2 id="ç®€æ´æ€§">ç®€æ´æ€§</h2><p>KISSåŸåˆ™ â€œKeep it Simple , Stupidâ€</p><p>ç¼–ç¨‹ç»éªŒä¸è¶³çš„ç¨‹åºå‘˜å–œæ¬¢åœ¨é¡¹ç›®ä¸­å¼•å…¥ä¸€äº›å¤æ‚çš„è®¾è®¡æ¨¡å¼,è®¤ä¸ºè¿™æ ·æ‰èƒ½ä½“ç°å‡ºæŠ€æœ¯æ°´å¹³</p><p>çœŸæ­£çš„é«˜æ‰‹èƒ½äº‘æ·¡é£è½»çš„ç”¨æœ€ç®€å•çš„æ–¹å¼è§£å†³æœ€å¤æ‚çš„é—®é¢˜</p><h2 id="å¯å¤ç”¨æ€§">å¯å¤ç”¨æ€§</h2><p>å°½é‡å‡å°‘é‡å¤ä»£ç çš„ç¼–å†™,å¤ç”¨å·²æœ‰çš„ä»£ç </p><p>Donâ€™t Reapeat your self</p><h2 id="å¯æµ‹è¯•æ€§">å¯æµ‹è¯•æ€§</h2><p>ä»£ç å¯æµ‹è¯•æ€§å·®,æ¯”è¾ƒéš¾å†™å•å…ƒæµ‹è¯•,é‚£åŸºæœ¬è¯´æ˜ä»£ç è®¾è®¡æœ‰é—®é¢˜</p><h2 id="å¦‚ä½•å†™å‡ºé«˜è´¨é‡çš„ä»£ç ">å¦‚ä½•å†™å‡ºé«˜è´¨é‡çš„ä»£ç ?</h2><p>å¦‚ä½•å†™å‡ºæ˜“ç»´æŠ¤,æ˜“è¯», æ˜“æ‰©å±•,çµæ´», ç®€æ´, å¯å¤ç”¨, å¯æµ‹è¯•çš„ä»£ç ?</p><p>éœ€è¦æŒæ¡ä¸€äº›æ›´åŠ ç»†åŒ–,æ›´åŠ èƒ½è½åœ°çš„ç¼–ç¨‹æ–¹æ³•è®º</p><p>é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³, è®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼, ç¼–ç è§„èŒƒ, é‡æ„æŠ€å·§</p><h1>é¢å‘å¯¹è±¡,è®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼,ç¼–ç¨‹è§„èŒƒ, é‡æ„,è¿™äº”è€…ä¹‹é—´çš„å…³ç³»?</h1><p><strong>æå®¢æ—¶é—´ è®¾è®¡æ¨¡å¼ä¹‹ç¾ å¤§çº²,å­¦ä¹ æ¡†æ¶</strong></p><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202309160909847.png" alt="image-20230916090931099"></p><h2 id="é¢å‘å¯¹è±¡">é¢å‘å¯¹è±¡</h2><p>ä¸»æµç¼–ç¨‹èŒƒå¼(é¢å‘è¿‡ç¨‹, é¢å‘å¯¹è±¡, å‡½æ•°å¼)ä¸­çš„ä¸»æµ.</p><p>é¢å‘å¯¹è±¡å…·æœ‰ä¸°å¯Œçš„ç‰¹æ€§(ç»§æ‰¿,å°è£….å¤šæ€,æŠ½è±¡),å¯ä»¥å®ç°å¾ˆå¤šå¤æ‚çš„è®¾è®¡æ€è·¯,æ˜¯å¾ˆå¤šè®¾è®¡åŸåˆ™,è®¾è®¡æ¨¡å¼ç¼–ç å®ç°çš„åŸºç¡€</p><p>æ¥ä¸‹æ¥éœ€è¦æŒæ¡</p><ul><li>é¢å‘å¯¹è±¡çš„å››å¤§ç‰¹æ€§ : å°è£…, æŠ½è±¡, ç»§æ‰¿, å¤šæ€</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸é¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„åŒºåˆ«å’Œè”ç³»</li><li>é¢å‘å¯¹è±¡åˆ†æ, é¢å‘å¯¹è±¡è®¾è®¡, é¢å‘å¯¹è±¡ç¼–ç¨‹</li><li>æ¥å£ç±»å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ä»¥åŠå„è‡ªçš„åº”ç”¨åœºæ™¯</li><li>åŸºäºæ¥å£è€Œéå®ç°çš„ç¼–ç¨‹è®¾è®¡æ€æƒ³</li><li>å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿çš„è®¾è®¡æ€æƒ³</li><li>é¢å‘è¿‡ç¨‹çš„è´«è¡€æ¨¡å¼å’Œé¢å‘å¯¹è±¡çš„å……è¡€æ¨¡å‹</li></ul><h2 id="è®¾è®¡åŸåˆ™">è®¾è®¡åŸåˆ™</h2><p>è®¾è®¡åŸåˆ™è¿™é‡Œæ¯”è¾ƒæŠ½è±¡,ä¸èƒ½å•çº¯çš„è®°å¿†,éœ€è¦æŒæ¡å…¶è®¾è®¡åˆè¡·,è§£å†³å“ªäº›ç¼–ç¨‹é—®é¢˜,æœ‰é‚£äº›åº”ç”¨åœºæ™¯</p><ul><li>SOLDåŸåˆ™-SRP å•ä¸€èŒè´£åŸåˆ™</li><li>SOLDåŸåˆ™-OCP å¼€é—­åŸåˆ™</li><li>SOLDåŸåˆ™-LSP é‡Œå¼æ›¿æ¢åŸåˆ™</li><li>SOLDåŸåˆ™-ISPæ¥å£éš”ç¦»åŸåˆ™</li><li>SOLDåŸåˆ™-DIPä¾èµ–å€’ç½®åŸåˆ™</li><li>DRYåŸåˆ™, KISSåŸåˆ™, YAGNIåŸåˆ™, LODæ³•åˆ™</li></ul><h2 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</h2><p>è®¾è®¡æ¨¡å¼ç›¸è¾ƒè®¾è®¡åŸåˆ™æ²¡é‚£ä¹ˆæŠ½è±¡,éš¾ç‚¹åœ¨åŸäº†è§£ä»–ä»¬éƒ½èƒ½è§£å†³å“ªäº›é—®é¢˜, æŒæ¡å…¸å‹çš„åº”ç”¨åœºæ™¯, å†°å†»çš„ä¸è¿‡åº¦åº”ç”¨</p><p>23ç§ç»å…¸è®¾è®¡æ¨¡å¼,éšç€è¯­è¨€çš„ä¸¥è°¨,ä¸€äº›è®¾è®¡æ¨¡å¼(Singleton)éšä¹‹è¿‡æ—¶,ç”šè‡³æˆäº†åæ¨¡å¼,ä¸€äº›å†…ç½®åœ¨ç¼–ç¨‹è¯­è¨€ä¸­(æ¯”å¦‚Iterator), å¦å¤–è¿˜æœ‰ä¸€äº›æ–°æ¨¡å¼çš„è¯ç”Ÿ(Monostate)</p><p>å­¦ä¹ è®¾è®¡æ¨¡å¼è¦æœ‰ä¾§é‡ç‚¹,å¯¹å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼,æˆ‘ä»¬è¦å¤šèŠ±æ—¶é—´ç†è§£æŒæ¡,å¯¹äºä¸å¸¸ç”¨çš„åªéœ€è¦ç¨å¾®äº†è§£å³å¯</p><h3 id="åˆ›å»ºå‹-5">åˆ›å»ºå‹(5)</h3><p><strong>å¸¸ç”¨</strong>: <strong>å•ä¾‹, å·¥å‚æ¨¡å¼(å·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚), å»ºé€ è€…æ¨¡å¼</strong></p><p>ä¸å¸¸ç”¨: åŸå‹æ¨¡å¼</p><h3 id="ç»“æ„å‹-7">ç»“æ„å‹(7)</h3><p>å¸¸ç”¨: ä»£ç†æ¨¡å¼, æ¡¥æ¥æ¨¡å¼, è£…é¥°å™¨æ¨¡å¼, é€‚é…å™¨æ¨¡å¼</p><p>ä¸å¸¸ç”¨: é—¨é¢æ¨¡å¼, ç»„åˆæ¨¡å¼, äº«å…ƒæ¨¡å¼</p><h3 id="è¡Œä¸ºå‹-11">è¡Œä¸ºå‹(11)</h3><p>å¸¸ç”¨: è§‚å¯Ÿè€…æ¨¡å¼, æ¨¡æ¿æ¨¡å¼, ç­–ç•¥æ¨¡å¼, èŒè´£é“¾æ¨¡å¼,è¿­ä»£å™¨æ¨¡å¼, çŠ¶æ€æ¨¡å¼</p><p>ä¸å¸¸ç”¨: è®¿é—®è€…æ¨¡å¼, å¤‡å¿˜å½•æ¨¡å¼, å‘½ä»¤æ¨¡å¼, è§£é‡Šå™¨æ¨¡å¼, ä¸­ä»‹æ¨¡å¼</p><h2 id="ç¼–ç è§„èŒƒ">ç¼–ç è§„èŒƒ</h2><p>ä¸»è¦è§£å†³çš„æ˜¯ä»£ç å¯è¯»æ€§é—®é¢˜,ç›¸å¯¹è®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼, æ›´åŠ å…·ä½“,æ›´åŠ ç‰‡ä¸­ä»£ç ç»†èŠ‚</p><p>æ˜¯æœ€èµ·ç è¦æŒæ¡çš„</p><p>æ¯”å¦‚ : ç»™å˜é‡,ç±»,å‡½æ•°å‘½å, å¦‚ä½•å†™ä»£ç æ³¨é‡Š, å‡½æ•°ä¸å®œè¿‡é•¿, å‚æ•°ä¸èƒ½è¿‡å¤š</p><p>å·²ç»æœ‰å¾ˆå¤šç»å…¸ä¹¦ç±äº†,æ²¡æ—¶é—´,çœ‹20æ¡ä¹Ÿå¤Ÿç”¨</p><p>ç¼–ç è§„èŒƒæ²¡æœ‰å•ç‹¬ä½œä¸ºä¸€ä¸ªæ¨¡å—æ¥è®²è§£,è€Œæ˜¯æ”¾åˆ°é‡æ„ä¸­,é‡æ„åˆ†ä¸ºå¤§é‡æ„å’Œå°é‡æ„,å°é‡æ„åˆ©ç”¨çš„çŸ¥è¯†ç‚¹åŸºæœ¬ä¸Šå°±æ˜¯ç¼–ç è§„èŒƒ</p><h2 id="ä»£ç é‡æ„">ä»£ç é‡æ„</h2><p>è½¯ä»¶å¼€å‘ä¸­,åªè¦è½¯ä»¶åœ¨ä¸åœçš„è¿­ä»£,å°±æ²¡æœ‰ä¸€åŠ³æ°¸é€¸çš„è®¾è®¡,éšç€éœ€æ±‚çš„å˜åŒ–, ä»£ç çš„ä¸æ–­å †ç Œ,åŸæœ‰è®¾è®¡å¿…ç„¶å­˜åœ¨è¿™æ ·é‚£æ ·çš„é—®é¢˜,é’ˆå¯¹è¿™äº›é—®é¢˜,æˆ‘ä»¬éœ€è¦è¿›è¡Œä»£ç é‡æ„,é‡æ„æ˜¯è½¯ä»¶å¼€å‘ä¸­é‡è¦çš„ä¸€ç¯, æŒç»­é‡æ„æ˜¯ä¿è¯ä»£ç è´¨é‡ä¸ä¸‹é™çš„æœ‰æ•ˆæ‰‹æ®µ,èƒ½é¿å…ä»£ç å­µåŒ–åˆ°æ— å¯æ•‘è¯çš„åœ°æ­¥</p><p>æˆ‘ä»¬å‰é¢è®²çš„é¢å‘å¯¹è±¡, è®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼ ä¸€ä¸ªé‡è¦çš„åº”ç”¨åœºæ™¯å°±æ˜¯åœ¨ä»£ç é‡æ„çš„æ—¶å€™, è™½ç„¶è®¾è®¡æ¨¡å¼å¯ä»¥æé«˜ä»£ç çš„å¯æ‰©å±•æ€§,ä½†è¿‡åº¦ä¸æ°å½“åœ°ä½¿ç”¨,ä¹Ÿä¼šå¢åŠ ä»£ç åœ°å¤æ‚åº¦, å½±å“ä»£ç åœ°å¯è¯»æ€§, <strong>å¼€å‘åˆæœŸç‰¹åˆ«å¿…é¡», æˆ‘ä»¬ä¸è¦è¿‡åº¦è®¾è®¡</strong>,åº”ç”¨å¤æ‚åœ°è®¾è®¡æ¨¡å¼.è€Œæ˜¯å½“ä»£ç å‡ºç°é—®é¢˜æ—¶,åœ¨é’ˆå¯¹é—®é¢˜è¿›è¡Œé‡æ„,é¿å…å‰æœŸåœ°è¿‡åº¦è®¾è®¡</p><ul><li>é‡æ„åœ°ç›®çš„(why), å¯¹è±¡(what), æ—¶æœº(when), æ–¹æ³•(how) ;</li><li>ä¿è¯é‡æ„ä¸å‡ºé”™åœ°æŠ€æœ¯æ‰‹æ®µ, :  å•å…ƒæµ‹è¯•å’Œä»£ç çš„å¯æµ‹è¯•æ€§</li><li>ä¸¤ç§ä¸åŒè§„æ¨¡çš„é‡æ„: å¤§é‡æ„(å¤§è§„æ¨¡é«˜å±‚æ¬¡) å’Œ å°é‡æ„(å°è§„æ¨¡ä½å±‚æ¬¡)</li></ul><h3 id="äº”è€…é—´çš„è”ç³»">äº”è€…é—´çš„è”ç³»</h3><ul><li><p>é¢å‘å¯¹è±¡ä¸°å¯Œçš„ç‰¹æ€§(ç»§æ‰¿, å°è£…, å¤šæ€, æŠ½è±¡)å¯ä»¥å®ç°å¾ˆå¤šå¤æ‚çš„è®¾è®¡æ€è·¯, æ˜¯å¾ˆå¤šè®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼ç­‰ç¼–ç å®ç°çš„åŸºç¡€</p></li><li><p>è®¾è®¡åŸåˆ™æ˜¯æŒ‡å¯¼æˆ‘ä»¬ä»£ç è®¾è®¡çš„ä¸€äº›ç»éªŒæ€»ç»“, å¯¹äºæŸäº›åœºæ™¯ä¸‹,æ˜¯å¦åº”è¯¥åº”ç”¨æŸç§è®¾è®¡æ¨¡å¼,å…·æœ‰æŒ‡å¯¼æ„ä¹‰. æ¯”å¦‚, &quot;å¼€é—­åŸåˆ™&quot;æ˜¯å¾ˆå¤šè®¾è®¡æ¨¡å¼(ç­–ç•¥, æ¨¡æ¿ç­‰)çš„æŒ‡å¯¼åŸåˆ™</p></li><li><p>è®¾è®¡æ¨¡å¼æ˜¯é’ˆå¯¹è½¯ä»¶å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„è®¾è®¡é—®é¢˜,æ€»ç»“å‡ºæ¥çš„ä¸€å¥—è§£å†³æ–¹æ¡ˆæˆ–è€…è®¾è®¡æ€æƒ³, ä¸»è¦ç›®çš„æ˜¯æé«˜ä»£ç çš„å¯æ‰©å±•æ€§. è®¾è®¡åŸåˆ™æ¯”è®¾è®¡æ¨¡å¼æ›´æŠ½è±¡, è®¾è®¡æ¨¡å¼æ›´åŠ å…·ä½“,æ›´åŠ å¯æ‰§è¡Œ</p></li><li><p>ç¼–ç¨‹æ–¹å¼ä¸»è¦è§£å†³çš„æ˜¯ä»£ç çš„å¯è¯»æ€§é—®é¢˜. å®ƒç›¸è¾ƒäºè®¾è®¡åŸåˆ™, è®¾è®¡æ¨¡å¼,æ›´åŠ å…·ä½“,æ›´åŠ åé‡ä»£ç ç»†èŠ‚,æ›´åŠ èƒ½è½åœ°. æŒç»­çš„å°é‡æ„ä¾èµ–çš„ç†è®ºåŸºç¡€ä¸»è¦æ˜¯ç¼–ç¨‹è§„èŒƒ</p></li><li><p>é‡æ„ä½œä¸ºä¿æŒä»£ç è´¨é‡ä¸ä¸‹é™çš„æœ‰æ•ˆæ‰‹æ®µ,åˆ©ç”¨çš„æ¿€ç´ hié¢å‘å¯¹è±¡, è®¾è®¡åŸåˆ™,è®¾è®¡æ¨¡å¼,ç¼–ç è§„èŒƒè¿™äº›ç†è®º</p></li></ul><p>é”è¯„</p><p><em>å†å¥½çš„ç†è®º,åº”ç”¨ä¸åˆ°å®é™…ä¸­ä¹Ÿæ˜¯ç™½è´¹,å¯¹äºæå‡ä»£ç è´¨é‡,æœ€æœ‰æ•ˆçš„æ˜¯ç¼–ç è§„èŒƒ,å…¶æ¬¡æ‰æ˜¯è®¾è®¡åŸåˆ™,å†æ¬¡æ˜¯ä»£ç é‡æ„, æœ€åæ‰æ˜¯é¢å‘å¯¹è±¡å’Œè®¾è®¡æ¨¡å¼</em></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºåŸºç¡€ </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitä½¿ç”¨æŒ‡å—</title>
      <link href="/posts/undefined.html"/>
      <url>/posts/undefined.html</url>
      
        <content type="html"><![CDATA[<h1>Gitä½¿ç”¨</h1><p><strong>Gitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</strong></p><p><strong>å·¥ä½œåŸç† / æµç¨‹</strong></p><p><img src="https://pic2.zhimg.com/80/v2-3bc9d5f2c49a713c776e69676d7d56c5_1440w.webp" alt="gitæµç¨‹å›¾"></p><h2 id="Gitä¸‹è½½ä¸å®‰è£…">Gitä¸‹è½½ä¸å®‰è£…</h2><p>å…·ä½“å®‰è£…æ•™ç¨‹å·²æœ‰è¯¦ç»†åšå®¢ï¼Œä¸å¤šè¯´ï¼Œä¸Šé“¾æ¥</p><p>[Gitä¸‹è½½ä¸å®‰è£…_pingcodeçš„åšå®¢-CSDNåšå®¢_git](<a href="https://blog.csdn.net/qq_41521682/article/details/122764915#:~:text=%E7%AC%AC%E4%B8%80%E6%AD%A5">https://blog.csdn.net/qq_41521682/article/details/122764915#:~:text=ç¬¬ä¸€æ­¥</a> ä¸‹è½½git (æ‰¾åˆ°è‡ªå·±éœ€è¦çš„ç‰ˆæœ¬) ç¬¬äºŒæ­¥ ä¸‹è½½ å®Œç‚¹å‡» å®‰è£… åŒ…è¿›å…¥ä½¿ç”¨è®¸å¯å£°æ˜ç•Œé¢,è¿™é‡Œæˆ‘æ˜¯é€‰æ‹©è£…åœ¨Dç›˜ï¼Œå¤§å®¶å¦‚æœå«Œéº»çƒ¦å°±é»˜è®¤ å®‰è£… åœ¨Cç›˜ ç¬¬å››æ­¥ ç‚¹å‡»Nextè¿›å…¥é€‰æ‹© å®‰è£… ç»„ä»¶ç•Œé¢ ä¸Šå›¾çº¢æ¡†å†…çš„é€‰é¡¹æ˜¯é»˜è®¤å‹¾é€‰çš„ï¼Œå»ºè®®ä¸è¦åŠ¨ã€‚)</p><h2 id="Gitåˆå§‹é…ç½®">Gitåˆå§‹é…ç½®</h2><p>â€‹</p><p>â€‹å®‰è£…å®Œæˆåï¼Œéœ€è¦å¯¹è½¯ä»¶è¿›è¡Œé…ç½®ï¼Œå³é”®ç‚¹Git Bash Here, è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;ä½ çš„ç”¨æˆ·å&quot;</span><br><span class="line">git config --global user.email &quot;ä½ çš„é‚®ç®±&quot;</span><br></pre></td></tr></table></figure><p>â€‹è§£é‡Šä¸€ä¸‹ï¼Œç”¨æˆ·åå’Œé‚®ç®±èµ·æ ‡è¯†ä½œç”¨ï¼Œgitå‘½ä»¤è¡Œå’ŒLinuxæŒ‡ä»¤å¾ˆç›¸ä¼¼ï¼Œ<code>--</code>åé¢åŠ å®Œæ•´åç§°çš„å•è¯åšå‚æ•°ï¼Œ<code>-</code>åé¢åˆ™æ˜¯å•è¯ç®€å†™</p><h3 id="æ‰©å±•-gité…ç½®çš„ä¼˜å…ˆçº§">æ‰©å±• gité…ç½®çš„ä¼˜å…ˆçº§</h3><p>â€‹<code>-- global</code> æ˜¯æŒ‡gité…ç½®çš„ä½ç½®ï¼Œä½ç½®æ‰€ç®¡è¾–çš„èŒƒå›´çº¦å°ï¼Œé…ç½®ç”Ÿæ•ˆçš„ä¼˜å…ˆçº§è¶Šé«˜ï¼Œä¼˜å…ˆçº§è¶Šé«˜çš„é…ç½®ä¼šè¦†ç›–æ‰ä¼˜å…ˆçº§è¾ƒä½çš„é…ç½®ï¼Œä¼˜å…ˆç”Ÿæ•ˆ<img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202301311730216.png" alt="image-20230131170032912"></p><p>â€‹gitçš„é…ç½®åŸºäºé…ç½®æ–‡ä»¶ï¼Œæœ‰å¦‚ä¸‹å››ä¸ªé…ç½®èŒƒå›´</p><p><img src="https://img.panyanbin.com/img/2021/06/30/1624986904-3edb6dce65621f97c0e649eee007e1e5.png" alt="image-20230131164336991"></p><p>â€‹å¸¸ç”¨çš„æœ‰ä¸‰ä¸ªï¼ˆ<code>local</code>ã€<code>global</code>ã€<code>system</code>ï¼‰ï¼ŒworktreeåŸºæœ¬ä¸ä½¿ç”¨æ‰€ä»¥ä¸å¤šè¯´ã€‚</p><ul><li><strong>systemç³»ç»Ÿçº§</strong></li></ul><p>â€‹ç³»ç»Ÿçº§é…ç½®æ–‡ä»¶å«æœ‰ç³»ç»Ÿé‡Œæ¯ä½ç”¨æˆ·åŠä»–ä»¬æ‰€æ‹¥æœ‰çš„ä»“åº“çš„é…ç½®å€¼ã€‚å…¶ä½ç½®ä¸ºgitçš„å®‰è£…ç›®å½•ä¸‹çš„<code>/etc/gitconfig</code>ï¼Œå³å¦‚æœgitçš„å®‰è£…ç›®å½•ä¸º<code>D:\Git</code>ï¼Œåˆ™é…ç½®æ–‡ä»¶åœ°å€ä¸º<code>D:\Git\etc\gitconfig</code>ã€‚</p><p><strong>ä¼˜å…ˆåº¦æœ€ä½ï¼Œå…¶é…ç½®å€¼å¯è¢«å…¨å±€çº§é…ç½®å’Œæœ¬åœ°çº§é…ç½®çš„å€¼è¦†ç›–</strong>ã€‚ä¸€èˆ¬æˆ‘ä»¬å¾ˆå°‘ä¼šä½¿ç”¨ç³»ç»Ÿçº§çš„é…ç½®ã€‚</p><ul><li><strong>globalå…¨å±€çº§</strong></li></ul><p>â€‹å…¨å±€çº§é…ç½®æ–‡ä»¶åŒ…å«å½“å‰ç³»ç»Ÿç”¨æˆ·çš„æ‹¥æœ‰çš„ä»“åº“é…ç½®å€¼ï¼Œæ¯ä¸ªç³»ç»Ÿç”¨æˆ·çš„å…¨å±€çº§é…ç½®ç›¸äº’éš”ç¦»ã€‚å…¨å±€çº§åˆ«çš„é…ç½®é»˜è®¤ä¿å­˜åœ¨å½“å‰ç³»ç»Ÿç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹çš„ .gitconfig æ–‡ä»¶å†…ã€‚Windowsé€šå¸¸ä¿å­˜åœ¨<code>C:\Users\xxxx\.gitconfig</code>ï¼ŒLinuxä¸º<code>/home/xxx/.gitconfig</code>ã€‚</p><p><strong>ä¼˜å…ˆåº¦æ¯”ç³»ç»Ÿçº§é«˜ï¼Œå¯è¦†ç›–ç³»ç»Ÿçº§çš„é…ç½®å€¼</strong>ã€‚å…¨å±€çº§çš„é…ç½®å¹³æ—¶ä½¿ç”¨å¾—æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚è®¾ç½®è´¦å·å’Œé‚®ç®±ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name panyanbin</span><br><span class="line">git config --global user.email me@panyanbin.com</span><br></pre></td></tr></table></figure><ul><li><strong>localæœ¬åœ°çº§</strong></li></ul><p>â€‹æœ¬åœ°çº§åˆ«çš„é…ç½®ä¿å­˜åœ¨å½“å‰ä»“åº“ä¸‹é¢çš„ <code>.git\config</code> æ–‡ä»¶å†…ï¼Œé€šå¸¸ .git æ–‡ä»¶å¤¹æ˜¯éšè—çš„ï¼ŒWindowè¦åœ¨æ–‡ä»¶ç®¡ç†å™¨çš„æ–‡ä»¶å¤¹é€‰é¡¹ä¸­æ‰“å¼€æ˜¾ç¤ºéšè—æ–‡ä»¶å¤¹æ‰å¯ä»¥çœ‹åˆ°ã€‚è¿™é‡Œçš„é…ç½®ä»…å¯¹å½“å‰ä»“åº“æœ‰æ•ˆï¼Œä¸å½±å“å…¶ä»–çš„ä»“åº“ã€‚</p><p><strong>ä¼˜å…ˆçº§åˆ«æœ€é«˜ï¼Œå¦‚æœå…¨å±€çº§åˆ«æˆ–ç³»ç»Ÿçº§åˆ«çš„é…ç½®é‡Œå‡ºç°äº†åŒä¸€é…ç½®é¡¹ï¼Œåˆ™ä»¥æœ¬åœ°çº§åˆ«é…ç½®å†…å®¹ä¸ºå‡†</strong></p><p>â€‹äº†è§£è¿™äº›åï¼Œä½ å°±å¯ä»¥è¿›è¡Œä¸åŒä¼˜å…ˆçº§å’Œç”Ÿæ•ˆèŒƒå›´çš„é…ç½®äº†</p><h2 id="Git-åˆ›å»ºç‰ˆæœ¬åº“">Git åˆ›å»ºç‰ˆæœ¬åº“</h2><p>â€‹<code>ç‰ˆæœ¬åº“ï¼ˆrepositoryï¼‰</code>,ä½ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç›®å½•ï¼Œå®ƒå­˜å‚¨äº†æ‰€æœ‰ä½ åœ¨ä¸åŒæ—¶é—´ä¸Šå¯¹<code>å·¥ä½œç›®å½•</code>ä¸­æ–‡ä»¶çš„æ›´æ”¹ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªæ—¶é—´ç‚¹ä¸Šä½ æ‰€æäº¤çš„<code>å·¥ä½œç›®å½•</code>ä¸­æ–‡ä»¶çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ–‡ä»¶çŠ¶æ€æˆ‘ä»¬ç§°ä¹‹ä¸º<code>ç‰ˆæœ¬</code> ï¼Œ ä»¥ä¾¿ä½ èƒ½ä»»æ„åœ¨å¤šä¸ªç‰ˆæœ¬é—´è·³è½¬ï¼ˆåˆå­¦è€…çœ‹ä¼šæœ‰ç‚¹æŠ½è±¡ï¼‰</p><p>â€‹åˆ›å»ºä¸€ä¸ªä»“åº“å¾ˆç®€å•ï¼Œåªè¦å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯ä½ çš„<code>å·¥ä½œç›®å½•</code>ï¼ˆä¹Ÿç§°<code>å·¥ä½œåŒº</code>ï¼‰ï¼Œç„¶ååœ¨ç›®å½•ä¸­ Git Bash Here,è¾“å…¥æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202301311722914.png" alt="image-20230131172231949"></p><p>æ­¤æ—¶ï¼Œç›®å½•ä¸­ä¼šç”Ÿæˆä¸€ä¸ª<code>.git</code>æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªå°±æ˜¯<code>ç‰ˆæœ¬åº“</code>ï¼Œä¸è¦éšæ„ä¹±åŠ¨ï¼Œä»¥å…æŸå</p><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202301311724121.png" alt="image-20230131172436286"></p><p>â€‹gitè®°å½•ç‰ˆæœ¬æ˜¯é€šè¿‡æäº¤ï¼ˆ<code>commit</code>ï¼‰å®ç°çš„ï¼Œä½†å¹¶ä¸æ˜¯æ¯æ¬¡å¯¹æ–‡ä»¶ä¿®æ”¹å°±ç›´æ¥æäº¤è¿™äº›ä¿®æ”¹ï¼Œå› ä¸ºæäº¤åç‰ˆæœ¬å°±æ— æ³•åˆ é™¤çš„æ°¸è¿œå­˜åœ¨äºç‰ˆæœ¬åº“ä¸­äº†ï¼ˆé™¤éä½ åˆ æ‰ä»“åº“æˆ–è€…æŸå.gitæ–‡ä»¶ï¼‰ï¼Œgitåœ¨å¯¹æ–‡ä»¶ä»ä¿®æ”¹åˆ°æäº¤çš„è¿‡ç¨‹ä¸­å¢åŠ äº†ä¸€ä¸ªå«<code>æš‚å­˜åŒº</code>çš„æ¦‚å¿µï¼Œä¸ºæäº¤çš„æä¾›äº†å®¹é”™çš„ç©ºé—´</p><p>â€‹<img src="https://www.runoob.com/wp-content/uploads/2015/02/1352126739_7909.jpg" alt=""></p><p>â€‹æˆ‘ä»¬æ¥ç†è§£ä¸‹ Git å·¥ä½œåŒºã€æš‚å­˜åŒºå’Œç‰ˆæœ¬åº“æ¦‚å¿µ</p><ul><li>**å·¥ä½œåŒºï¼š**å°±æ˜¯ä½ åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ç›®å½•ã€‚</li><li>**æš‚å­˜åŒºï¼š**è‹±æ–‡å« stage æˆ– indexã€‚ä¸€èˆ¬å­˜æ”¾åœ¨ <strong>.git</strong> ç›®å½•ä¸‹çš„ index æ–‡ä»¶ï¼ˆ.git/indexï¼‰ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæš‚å­˜åŒºæœ‰æ—¶ä¹Ÿå«ä½œç´¢å¼•ï¼ˆindexï¼‰ã€‚</li><li>**ç‰ˆæœ¬åº“ï¼š**å·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½• <strong>.git</strong>ï¼Œè¿™ä¸ªä¸ç®—å·¥ä½œåŒºï¼Œè€Œæ˜¯ Git çš„ç‰ˆæœ¬åº“</li></ul><p>â€‹æäº¤ä¸€ä¸ªç‰ˆæœ¬ï¼Œéœ€è¦é¦–å…ˆåœ¨<code>å·¥ä½œåŒº</code>ä¸­å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œç„¶åå†æ·»åŠ åˆ°<code>æš‚å­˜åŒº</code>ï¼Œæœ€åæäº¤åˆ°<code>ç‰ˆæœ¬åº“</code>,åˆå­¦è€…ç†è§£è¿™ä¸ªæµç¨‹ï¼Œæ–¹ä¾¿è®°å¿†æŒ‡ä»¤ï¼ˆå…¶å®ç”¨å¤šäº†è‡ªç„¶ä¹Ÿå°±è®°ä½äº†ï¼‰</p><p>â€‹ä¸‹é¢æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæµç¨‹å‘¢æ¥å­¦ä¹ gitçš„å¸¸ç”¨æŒ‡ä»¤</p><h2 id="GitåŸºæœ¬æ“ä½œæŒ‡ä»¤">GitåŸºæœ¬æ“ä½œæŒ‡ä»¤</h2><ul><li>å°†å·¥ä½œç›®å½•çš„ä¿®æ”¹æäº¤åˆ°æš‚å­˜åŒºï¼ˆindexï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶åˆ°æš‚å­˜åŒºï¼ˆindexï¼‰</span><br><span class="line"></span><br><span class="line">git add [file1] [file2] .....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ·»åŠ æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line"></span><br><span class="line">git add .</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æš‚å­˜åŒºæƒ…å†µ</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis</title>
      <link href="/posts/27274.html"/>
      <url>/posts/27274.html</url>
      
        <content type="html"><![CDATA[<h1>Redis</h1><h1>RedisåŸºç¡€ç¯‡</h1><h2 id="rediså¿«é€Ÿå…¥é—¨">rediså¿«é€Ÿå…¥é—¨</h2><h3 id="è®¤è¯†NoSQL">è®¤è¯†NoSQL</h3><h4 id="NoSQLç±»å‹">NoSQLç±»å‹</h4><ul><li><p>é”®å€¼å¯¹å‹ (Redis)</p></li><li><p>æ–‡æ¡£å‹ (MongoDB)</p></li><li><p>å›¾ç±»å‹ (HBase)</p></li><li><p>åˆ—ç±»å‹ (Neo4j)</p></li></ul><h4 id="SQL-VS-NoSQL">SQL   VS   NoSQL</h4><p>#1  ç»“æ„åŒ–(Structured)     éç»“æ„åŒ–</p><p>#2  å…³è”çš„(Relational)      éå…³ç³»</p><p>#3 SQLæŸ¥è¯¢                        éSQL (å‘½ä»¤,å‡½æ•°, Restful)</p><p>#4 ACID                              Base</p><p>#5 ç£ç›˜                               å†…å­˜</p><p>#6 å‚ç›´æ‰©å±•                       æ°´å¹³æ‰©å±•</p><p>â€‹</p><table><thead><tr><th>SQL</th><th>NoSQL</th></tr></thead><tbody><tr><td>æ•°æ®ç»“æ„å›ºå®š</td><td>æ•°æ®ç»“æ„ä¸å›ºå®š</td></tr><tr><td>å¯¹æ•°æ®ä¸€è‡´æ€§, å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜</td><td>å¯¹æ•°æ®ä¸€è‡´æ€§,å®‰å…¨æ€§è¦æ±‚ä¸é«˜,å¯¹æ€§èƒ½è¦æ±‚é«˜</td></tr></tbody></table><h3 id="è®¤è¯†Redis">è®¤è¯†Redis</h3><p><strong>Redis</strong> (Remote Dictionary Server)  è¿œç¨‹è¯å…¸æœåŠ¡å™¨  2009å¹´è¯ç”Ÿ</p><p>ç‰¹å¾</p><ul><li><p>é”®å€¼å‹, valueæ”¯æŒä¸åŒç±»å‹</p></li><li><p>å•çº¿ç¨‹, æ¯ä¸ªå‘½ä»¤å…·å¤‡åŸå­æ€§(Redis 6.0 ç½‘ç»œè¯·æ±‚æ”¹ä¸ºå¤šçº¿ç¨‹, æ ¸å¿ƒå‘½ä»¤ä»æ˜¯å•çº¿ç¨‹)</p></li><li><p>ä½å»¶è¿Ÿ, é€Ÿåº¦å¿«(åŸºäºå†…å­˜, åŸºäºIOå¤šè·¯å¤ç”¨, è‰¯å¥½çš„ç¼–ç ( Cè¯­è¨€ ))</p></li><li><p>æ”¯æŒæ•°æ®æŒä¹…åŒ–</p></li><li><p>æ”¯æŒä¸»ä»é›†ç¾¤,  åˆ†ç‰‡é›†ç¾¤</p></li><li><p>å¤šè¯­è¨€å®¢æˆ·ç«¯</p></li></ul><h2 id="redisæ•°æ®ç»“æ„">redisæ•°æ®ç»“æ„</h2><p><img src="redis.assets/image-20231203202716520.png" alt="image-20231203202716520"></p><ul><li>KEYS (ç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ä½¿ç”¨)</li><li>DEL</li><li>EXISTS</li><li>EXPIRE</li><li>TTL</li></ul><h3 id="String">String</h3><p>valueæ˜¯å­—ç¬¦ä¸², ä¸è¿‡æ ¹æ®å­—ç¬¦ä¸²æ ¼å¼ä¸åŒå¯ä»¥åˆ†ä¸ºä¸‰ç±»</p><ul><li>string</li><li>int</li><li>float</li></ul><p>å­—ç¬¦ä¸²ç±»å‹æœ€å¤§ç©ºé—´ä¸èƒ½è¶…è¿‡512m</p><h4 id="Stringå¸¸è§å‘½ä»¤">Stringå¸¸è§å‘½ä»¤</h4><ul><li><p>SET key value</p></li><li><p>GET key</p></li><li><p>MSET key value [key value â€¦]</p></li><li><p>MGET key [key â€¦]</p></li><li><p>INCR key</p></li><li><p>INCRBY key integer</p></li><li><p>INCRBYFLOAT key float</p></li><li><p>SETNX key value (ç­‰ä»·äº set key value nx)</p></li><li><p>SETEX key seconds value (ç­‰ä»·äº set key value         expire key seconds)</p></li></ul><h3 id="Keyçš„å±‚æ¬¡ç»“æ„">Keyçš„å±‚æ¬¡ç»“æ„</h3><p>Redisä¸­æ²¡æœ‰è¡¨çš„æ¦‚å¿µ, å¦‚ä½•åŒºåˆ†ä¸åŒç±»å‹çš„key? (ç”¨æˆ·idæ˜¯1, å•†å“idæ˜¯1)</p><p>æ¯”å¦‚</p><p>é¡¹ç›®å:ä¸šåŠ¡å:ç±»å‹:id</p><p>userç›¸å…³çš„key : zs:user:1</p><p>productç›¸å…³çš„key : zs:product:1</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†å®‰å…¨</title>
      <link href="/posts/26365.html"/>
      <url>/posts/26365.html</url>
      
        <content type="html"><![CDATA[<h1>åŠ å¯†å®‰å…¨</h1><h2 id="Base64ç¼–ç "><code>Base64</code>ç¼–ç </h2><p>å°†<strong>äºŒè¿›åˆ¶å­—èŠ‚</strong>è½¬åŒ–ä¸º<strong>æ–‡æœ¬æ ¼å¼</strong></p><p>å°†ä»»æ„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®è½¬åŒ–ä¸ºåªåŒ…å« <code>A</code>~<code>Z</code>   <code>a</code>~<code>z</code>  <code>0</code>~<code>9</code>  <code>+</code>  <code>/</code>  <code>=</code> è¿™64ä¸ªå­—ç¬¦</p><p>åŸç†æ˜¯å°†3ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰ç…§<code>6bit</code>ä¸€ç»„, ç”¨<code>4ä¸ªintæ•´æ•°</code>è¡¨ç¤º, ç„¶åå°†intæ•´æ•°ç”¨ç´¢å¼•å¯¹åº”åˆ°å­—ç¬¦, å¾—åˆ°ç¼–ç åçš„å­—ç¬¦ä¸²</p><p>3ä¸ªbyteæ•°æ®åˆ†åˆ«æ˜¯<code>e4</code>ã€<code>b8</code>ã€<code>ad</code>ï¼ŒæŒ‰<code>6bit</code>åˆ†ç»„å¾—åˆ°<code>39</code>ã€<code>0b</code>ã€<code>22</code>å’Œ<code>2d</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚      e4       â”‚      b8       â”‚      ad       â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">â”Œâ”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”</span><br><span class="line">â”‚1â”‚1â”‚1â”‚0â”‚0â”‚1â”‚0â”‚0â”‚1â”‚0â”‚1â”‚1â”‚1â”‚0â”‚0â”‚0â”‚1â”‚0â”‚1â”‚0â”‚1â”‚1â”‚0â”‚1â”‚</span><br><span class="line">â””â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”˜</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚    39     â”‚    0b     â”‚    22     â”‚    2d     â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><p>å­—ç¬¦<code>A</code><sub>`Z`å¯¹åº”ç´¢å¼•`0`</sub><code>25</code>ï¼Œå­—ç¬¦<code>a</code><sub>`z`å¯¹åº”ç´¢å¼•`26`</sub><code>51</code>ï¼Œå­—ç¬¦<code>0</code><sub>`9`å¯¹åº”ç´¢å¼•`52`</sub><code>61</code>ï¼Œæœ€åä¸¤ä¸ªç´¢å¼•<code>62</code>ã€<code>63</code>åˆ†åˆ«ç”¨å­—ç¬¦<code>+</code>å’Œ<code>/</code>è¡¨ç¤ºã€‚</p><p>å¦‚æœå­—èŠ‚æ•°ä¸æ˜¯3çš„å€æ•°, ç”¨ <code>=</code> æˆ–è€… <code>==</code> è¡¥åˆ°ä¸‰çš„å€æ•°</p><p>ä¾‹å¦‚  :</p><p>16ä¸ªå­—èŠ‚  è¡¥æˆ 18ä¸ªå­—èŠ‚</p><p>æœ€åä¼šç”Ÿæˆ 24ä¸ªå­—ç¬¦(18 / 3 * 4)</p><h2 id="å“ˆå¸Œç®—æ³•-Digest">å“ˆå¸Œç®—æ³•(Digest)</h2><p>å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•æœ‰ï¼š</p><table><thead><tr><th style="text-align:left">ç®—æ³•</th><th style="text-align:left">è¾“å‡ºé•¿åº¦ï¼ˆä½ï¼‰</th><th style="text-align:left">è¾“å‡ºé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰</th></tr></thead><tbody><tr><td style="text-align:left"><code>MD5</code></td><td style="text-align:left">128 bits</td><td style="text-align:left">16 bytes</td></tr><tr><td style="text-align:left"><code>SHA-1</code></td><td style="text-align:left">160 bits</td><td style="text-align:left">20 bytes</td></tr><tr><td style="text-align:left"><code>RipeMD-160</code></td><td style="text-align:left">160 bits</td><td style="text-align:left">20 bytes</td></tr><tr><td style="text-align:left"><code>SHA-256</code></td><td style="text-align:left">256 bits</td><td style="text-align:left">32 bytes</td></tr><tr><td style="text-align:left"><code>SHA-512</code></td><td style="text-align:left">512 bits</td><td style="text-align:left">64 bytes</td></tr></tbody></table><p>ç”¨å“ˆå¸Œå­˜å‚¨å£ä»¤æ—¶è¦è€ƒè™‘å½©è™¹è¡¨æ”»å‡», é€šå¸¸é€šè¿‡åŠ ç›æ¥åŠ å¤§ç ´è§£éš¾åº¦(å³ä¾¿æœ‰å½©è™¹è¡¨(æ•°æ®é‡ä¸ºm)å’Œsalt(æ•°æ®é‡ä¸ºn) å¤æ‚åº¦ä¹Ÿä¼šæ˜¯O(m * n))</p><p>éå®‰å…¨ä¸“ä¸šä¸è¦å°è¯•è‡ªå·±å†™å“ˆå¸Œç®—æ³•åº“, ç›´æ¥ç”¨å¼€æºå¾—åˆ°å…¬ä¼—è®¤å¯çš„åº“</p><h2 id="æ¶ˆæ¯è®¤è¯ç®—æ³•-MAC">æ¶ˆæ¯è®¤è¯ç®—æ³•(MAC)</h2><p><code>Hmac</code>ç®—æ³•å°±æ˜¯ä¸€ç§åŸºäºå¯†é’¥çš„æ¶ˆæ¯è®¤è¯ç ç®—æ³•</p><p><code>Hmac</code>ç®—æ³•æ€»æ˜¯å’ŒæŸç§å“ˆå¸Œç®—æ³•é…åˆèµ·æ¥ç”¨çš„, æœ¬è´¨ä¸Šå°±æ˜¯æŠŠkeyæ··å…¥æ‘˜è¦çš„ç®—æ³•ã€‚éªŒè¯æ­¤å“ˆå¸Œæ—¶ï¼Œé™¤äº†åŸå§‹çš„è¾“å…¥æ•°æ®ï¼Œè¿˜è¦æä¾›key</p><p>è¿™é‡Œçš„keyå¯ä»¥ç†è§£ä¸ºç›</p><p>å¯ä»¥é…åˆ<code>MD5</code>ã€<code>SHA-1</code>ç­‰å“ˆå¸Œç®—æ³•ï¼Œè®¡ç®—çš„æ‘˜è¦é•¿åº¦å’ŒåŸæ‘˜è¦ç®—æ³•é•¿åº¦ç›¸åŒã€‚</p><h2 id="å¯¹ç§°åŠ å¯†ç®—æ³•">å¯¹ç§°åŠ å¯†ç®—æ³•</h2><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå¸¸ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š</p><table><thead><tr><th style="text-align:left">ç®—æ³•</th><th style="text-align:left">å¯†é’¥é•¿åº¦</th><th style="text-align:left">å·¥ä½œæ¨¡å¼</th><th style="text-align:left">å¡«å……æ¨¡å¼</th></tr></thead><tbody><tr><td style="text-align:left"><code>DES</code></td><td style="text-align:left">56/64</td><td style="text-align:left"><code>ECB/CBC/PCBC/CTR/...</code></td><td style="text-align:left"><code>NoPadding/PKCS5Padding/...</code></td></tr><tr><td style="text-align:left"><code>AES</code></td><td style="text-align:left">128/192/256</td><td style="text-align:left"><code>ECB/CBC/PCBC/CTR/...</code></td><td style="text-align:left"><code>NoPadding/PKCS5Padding/PKCS7Padding/...</code></td></tr><tr><td style="text-align:left"><code>IDEA</code></td><td style="text-align:left">128</td><td style="text-align:left"><code>ECB</code></td><td style="text-align:left"><code>PKCS5Padding/PKCS7Padding/...</code></td></tr></tbody></table><p><a href="https://blog.csdn.net/bandaoyu/article/details/105552003">ã€åŠ å¯†ã€‘DESåŠ å¯†ç®—æ³•ä¸­ï¼ŒECBå’ŒCBCæ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ_ecb cbc-CSDNåšå®¢</a></p><p>å¯¹ç§°åŠ å¯†ç®—æ³•å†³å®šäº†å£ä»¤å¿…é¡»æ˜¯å›ºå®šé•¿åº¦ï¼Œç„¶åå¯¹æ˜æ–‡è¿›è¡Œåˆ†å—åŠ å¯†ã€‚åˆå› ä¸ºå®‰å…¨éœ€æ±‚ï¼Œå£ä»¤é•¿åº¦å¾€å¾€éƒ½æ˜¯128ä½ä»¥ä¸Šï¼Œå³è‡³å°‘16ä¸ªå­—ç¬¦</p><p>DESç®—æ³•ç”±äºå¯†é’¥è¿‡çŸ­ï¼Œå¯ä»¥åœ¨çŸ­æ—¶é—´å†…è¢«æš´åŠ›ç ´è§£ï¼Œæ‰€ä»¥ç°åœ¨å·²ç»ä¸å®‰å…¨äº†ã€‚</p><p><code>ECB</code>æ¨¡å¼æ˜¯æœ€ç®€å•çš„<code>AES</code>åŠ å¯†æ¨¡å¼ï¼Œå®ƒåªéœ€è¦ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å¯†é’¥ï¼Œå›ºå®šçš„æ˜æ–‡ä¼šç”Ÿæˆå›ºå®šçš„å¯†æ–‡ï¼Œè¿™ç§ä¸€å¯¹ä¸€çš„åŠ å¯†æ–¹å¼ä¼šå¯¼è‡´å®‰å…¨æ€§é™ä½</p><p>æ›´å¥½çš„æ–¹å¼æ˜¯é€šè¿‡<code>CBC</code>æ¨¡å¼ï¼Œå®ƒéœ€è¦ä¸€ä¸ªéšæœºæ•°ä½œä¸ºIVå‚æ•°ï¼Œè¿™æ ·å¯¹äºåŒä¸€ä»½æ˜æ–‡ï¼Œæ¯æ¬¡ç”Ÿæˆçš„å¯†æ–‡éƒ½ä¸åŒ</p><h2 id="å£ä»¤åŠ å¯†ç®—æ³•">å£ä»¤åŠ å¯†ç®—æ³•</h2><p><code>PBE</code>å°±æ˜¯<code>Password Based Encryption</code>, ä½œç”¨å°±æ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„å£ä»¤å’Œä¸€ä¸ªå®‰å…¨éšæœºçš„å£ä»¤é‡‡ç”¨æ‚å‡‘åè®¡ç®—å‡ºçœŸæ­£çš„å¯†é’¥</p><p><code>PBEç®—æ³•</code>å¹¶æ²¡æœ‰çœŸæ­£æ„å»ºæ–°çš„åŠ å¯†/è§£å¯†ç®—æ³•ï¼Œè€Œæ˜¯å¯¹æˆ‘ä»¬å·²ç»çŸ¥é“çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå¦‚DESç®—æ³•ï¼‰åšäº†åŒ…è£…ã€‚ä½¿ç”¨PBEç®—æ³•å¯¹æ•°æ®åšåŠ å¯†/è§£å¯†æ“ä½œçš„æ—¶å€™ï¼Œå…¶å®æ˜¯ä½¿ç”¨äº†<code>DES</code>æˆ–è€…æ˜¯<code>AES</code>ç­‰å…¶å®ƒå¯¹ç§°åŠ å¯†ç®—æ³•åšäº†ç›¸åº”çš„æ“ä½œã€‚</p><h2 id="å¯†é’¥äº¤æ¢ç®—æ³•">å¯†é’¥äº¤æ¢ç®—æ³•</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è§£æ”¾åŒæ‰‹ï¼Œæ¯æ—¥å¼ºå›½</title>
      <link href="/posts/40882.html"/>
      <url>/posts/40882.html</url>
      
        <content type="html"><![CDATA[<h1>è§£æ”¾åŒæ‰‹ï¼Œæ¯æ—¥å¼ºå›½</h1><p>â€‹å­¦ä¹ å¼ºå›½æ˜¯å¥½äº‹,ä½†æœ‰äº›å­¦æ ¡åŠŸåˆ©æ€§çš„ç®—å„ç§å­¦åˆ†,å¤§å¤šæ•°äººä»¥è¿™ç§åŠ¨æœºçš„å­¦ä¹ æ˜¾ç„¶æ›´åƒæ˜¯ä¸€ç§è´Ÿæ‹…,å…¶å®å¦‚æœå¤§å®¶æœ‰ä½™åŠ›è¿˜æ˜¯æ¨èè‡ªå·±å­¦ä¹ </p><p>â€‹<em>æœ¬æ•™ç¨‹å…¨ç¨‹å‚»ç“œå¼æ“ä½œï¼Œé€‚ç”¨äºæœªä½¿ç”¨è¿‡æ²¹çŒ´å’ŒGitHubçš„å°ç™½ï¼Œè„šæœ¬å†…å®¹æ¬è¿è‡ªï¼š<a href="https://github.com/Xu22Web/tech-study-js/issues%EF%BC%88%E4%BB%A3%E7%A0%81%E6%88%91%E4%BC%9A%E8%B4%B4%E5%9C%A8%E6%96%87%E7%AB%A0%E6%9C%AB%E5%B0%BE%EF%BC%8C%E5%86%8D%E6%AC%A1%E5%BC%BA%E8%B0%83%E6%88%91%E5%8F%AA%E6%98%AF%E6%90%AC%E8%BF%90%E5%B7%A5%EF%BC%8C%E5%A6%82%E6%9C%89%E4%BE%B5%E6%9D%83%E4%BC%9A%E7%AB%8B%E5%8D%B3%E5%88%A0%E9%99%A4%EF%BC%89">https://github.com/Xu22Web/tech-study-js/issuesï¼ˆä»£ç æˆ‘ä¼šè´´åœ¨æ–‡ç« æœ«å°¾ï¼Œå†æ¬¡å¼ºè°ƒæˆ‘åªæ˜¯æ¬è¿å·¥ï¼Œå¦‚æœ‰ä¾µæƒä¼šç«‹å³åˆ é™¤ï¼‰</a></em></p><p>â€‹ä¸€å¹´å‰çš„åšå®¢äº†,ç°åœ¨å­¦ä¹ å¼ºå›½ä¹Ÿåšäº†å¾ˆå¤š&quot;æ”¹è¿›&quot;,äº²æµ‹ç›®å‰åªæœ‰<strong>è‡ªåŠ¨åˆ·è§†é¢‘å’Œæ–‡ç« æ˜¯æ— é£é™©æ”¯æŒ</strong>(***warning !!!***è‡ªåŠ¨åˆ·é¢˜ä¼šè¢«è­¦å‘Š,è­¦å‘Šåˆ°ä¸€å®šæ¬¡æ•°ä¼šè¢«å°ç¦7~30å¤©)</p><h2 id="ä¸€ã€å®‰è£…æ²¹çŒ´">ä¸€ã€å®‰è£…æ²¹çŒ´</h2><p>â€‹<em>å·²ç»å®‰è£…è¿‡çš„å¯ä»¥è·³è¿‡è¿™é‡Œ</em></p><ol><li>æ‰“å¼€ä½ çš„edgeæµè§ˆå™¨ï¼Œç‚¹å‡»æ‰©å±•</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131226862.jpg" alt="img"></p><ol start="2"><li>ç‚¹å‡»è·å–ä¸‹å›¾é€‰é¡¹è·å–æ‰©å±•</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227984.jpg" alt="img"></p><ol start="3"><li>æœç´¢æ¡†è¾“å…¥â€œtempermonkeyâ€ï¼Œæœç´¢è¯¥æ‰©å±•å¹¶è·å–</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227875.jpg" alt="img"></p><ol start="4"><li>ä¹‹åä¼šæœ‰å¼¹çª—ï¼Œç‚¹â€œæ·»åŠ æ‰©å±•â€</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227120.jpg" alt="img"></p><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227430.jpg" alt="img"></p><ol start="5"><li>æŠŠç›®å…‰èšç„¦åˆ°æµè§ˆå™¨çš„å³ä¸Šæ–¹</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227455.jpg" alt="img"></p><ol start="6"><li>è¿™æ—¶å€™å¯èƒ½è¿˜çœ‹ä¸åˆ°å®‰è£…ä¸Šçš„Tempermonkey(ä¹‹åæ­¥éª¤ç®€ç§°æ²¹çŒ´)ï¼Œå› ä¸ºæ·»åŠ æ‰©å±•åï¼Œé»˜è®¤è®¾ç½®æ˜¯ä¸å¯è§†çš„</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227521.jpg" alt="img"></p><ol start="7"><li>æŒ‰ä¸‹å›¾é¡ºåºç‚¹å‡»ï¼Œä¾¿å¯è®¾ç½®ä¸ºå·¥å…·æ å¯è§äº†</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227990.jpg" alt="img"></p><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227805.jpg" alt="img"></p><h2 id="äºŒã€æ·»åŠ è„šæœ¬">äºŒã€æ·»åŠ è„šæœ¬</h2><ol start="8"><li>æŒ‰ä¸‹å›¾æ“ä½œï¼Œä¼šè¿›å…¥ä¸€ä¸ªæ–°çš„ç•Œé¢</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227043.jpg" alt="img"></p><ol start="9"><li>æ–°çš„ç•Œé¢å¦‚ä¸‹</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227747.png" alt="img"></p><ol start="10"><li>åº•ä¸‹è¿™äº›å†…å®¹æ˜¯å¯ä»¥ç¼–è¾‘çš„ï¼Œé¦–å…ˆæŠŠåŸæœ¬çš„å†…å®¹åˆ æ‰</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227861.png" alt="img"></p><ol start="11"><li>ç„¶åæŠŠä»<a href="https://github.com/Xu22Web/tech-study-js/issues">https://github.com/Xu22Web/tech-study-js/issues</a> (æ–‡ç« æœ«å°¾çš„ä»£ç )Ctrl+A(å…¨é€‰)ï¼Œç„¶åCtrl+Cï¼ˆå¤åˆ¶ï¼‰ï¼Œæœ€åCtrl+Vï¼ˆç²˜è´´ï¼‰åˆ°è¿™é‡Œ</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131227559.png" alt="img"></p><ol start="12"><li>Ctrl+Sï¼ˆä¿å­˜ï¼‰ï¼Œè„šæœ¬å°±æ–°å»ºæˆåŠŸäº†ï¼Œå¯ç”¨å®ƒ</li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202207131301723.png" alt="img"></p><h2 id="ä¸‰ã€è„šæœ¬ä½¿ç”¨">ä¸‰ã€è„šæœ¬ä½¿ç”¨</h2><ol start="13"><li><p>è¿›å…¥å­¦ä¹ å¼ºå›½ç½‘é¡µç‰ˆï¼Œ<a href="https://www.xuexi.cn/">å­¦ä¹ å¼ºå›½ (xuexi.cn)</a>ï¼Œç„¶åæ‰«ç ç”¨æˆ·ç™»å½•ï¼ˆè¿™é‡Œå°±ä¸æˆªå›¾æ¼”ç¤ºäº†ï¼‰</p></li><li><p>å³ä¸Šè§’çš„æµ®çª—ç‚¹ï¼Œå¼€å§‹å­¦ä¹ ï¼Œä¹‹åä»€ä¹ˆéƒ½ä¸ç”¨ä¸åšï¼Œæ…¢æ…¢ç­‰å¾…å®Œæˆå³å¯ï¼›ä»¥åæ¯å¤©åªéœ€è¦é‡å¤æœ€åä¸¤æ­¥ï¼Œå°±å¯ä»¥æ‡’äººå¼æ–©è·25åˆ†äº†</p></li></ol><p><img src="https://ohtoai-images.oss-cn-beijing.aliyuncs.com/imgs/OhtoAi_Blog/202309042118286.png" alt="image-20230904211513385"></p><p>ä»£ç å¦‚ä¸‹:</p><p>ä»£ç æ¯”è¾ƒé•¿,å¤åˆ¶æ—¶å¯èƒ½ä¼šå¡ä¸€ä¸‹</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name   ä¸å­¦ä¹ ä½•ä»¥å¼ºå›½</span></span><br><span class="line"><span class="comment">// @namespace   http://tampermonkey.net/</span></span><br><span class="line"><span class="comment">// @version   1.7.0</span></span><br><span class="line"><span class="comment">// @description   æœ‰è¶£çš„ `å­¦ä¹ å¼ºå›½` æ²¹çŒ´æ’ä»¶ã€‚è¯»æ–‡ç« ,çœ‹è§†é¢‘ï¼Œåšä¹ é¢˜ã€‚é—®é¢˜åé¦ˆï¼š https://github.com/Xu22Web/tech-study-js/issues ã€‚</span></span><br><span class="line"><span class="comment">// @author   åŸä½œè€…ï¼štechxuexi è·åŒ…è›‹ã€‚ç°ä½œè€…ï¼šXu22Web</span></span><br><span class="line"><span class="comment">// @match   https://www.xuexi.cn/*</span></span><br><span class="line"><span class="comment">// @match   https://pc.xuexi.cn/points/exam-practice.html</span></span><br><span class="line"><span class="comment">// @match   https://pc.xuexi.cn/points/exam-weekly-detail.html?id=*</span></span><br><span class="line"><span class="comment">// @match   https://pc.xuexi.cn/points/exam-paper-detail.html?id=*</span></span><br><span class="line"><span class="comment">// @match   https://login.xuexi.cn/login/xuexiWeb?appid=dingoankubyrfkttorhpou&amp;goto=https%3A%2F%2Foa.xuexi.cn&amp;type=1&amp;state=ffdea2ded23f45ab%2FKQreTlDFe1Id3B7BVdaaYcTMp6lsTBB%2Fs3gGevuMKfvpbABDEl9ymG3bbOgtpSN&amp;check_login=https%3A%2F%2Fpc-api.xuexi.cn</span></span><br><span class="line"><span class="comment">// @require   https://cdn.jsdelivr.net/npm/blueimp-md5@2.9.0</span></span><br><span class="line"><span class="comment">// @run-at   document-start</span></span><br><span class="line"><span class="comment">// @grant   GM_addStyle</span></span><br><span class="line"><span class="comment">// @grant   GM_setValue</span></span><br><span class="line"><span class="comment">// @grant   GM_getValue</span></span><br><span class="line"><span class="comment">// @grant   GM_openInTab</span></span><br><span class="line"><span class="comment">// @grant   unsafeWindow</span></span><br><span class="line"><span class="comment">// @updateURL   https://raw.githubusercontent.com/Xu22Web/tech-study-js/master/tech-study.js</span></span><br><span class="line"><span class="comment">// @downloadURL   https://raw.githubusercontent.com/Xu22Web/tech-study-js/master/tech-study.js</span></span><br><span class="line"><span class="comment">// @supportURL   https://github.com/Xu22Web</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"><span class="keyword">const</span> css = <span class="string">&#x27;* &#123;  -webkit-tap-highlight-color: transparent;&#125;:root &#123;  --themeColor: #fa3333;  --scale: 1;  font-size: calc(10px * var(--scale));&#125;@media (min-height: 678px) and (max-height: 768px) &#123;  :root &#123;    --scale: 0.8;  &#125;&#125;@media (max-height: 667px) &#123;  :root &#123;    --scale: 0.75;  &#125;&#125;@keyframes fade &#123;  from &#123;    opacity: 0.8;  &#125;  to &#123;    opacity: 0.4;    background: #ccc;  &#125;&#125;.egg_icon &#123;  width: 1em;  height: 1em;  fill: currentColor;&#125;.egg_hr_wrap &#123;  position: relative;  display: flex;  justify-content: center;  color: #ccc;&#125;.egg_hr_wrap .egg_hr &#123;  position: absolute;  top: 50%;  transform: translateY(-50%);  background: currentColor;  height: 0.1rem;  width: 30%;&#125;.egg_hr_wrap .egg_hr:nth-of-type(1) &#123;  left: 0;&#125;.egg_hr_wrap .egg_hr:nth-last-of-type(1) &#123;  right: 0;&#125;.egg_hr_title &#123;  font-size: 1.2rem;&#125;.egg_exam_btn &#123;  transition: background-color 80ms;  outline: none;  border: none;  padding: 1.2rem 2rem;  border-radius: 1.2rem;  cursor: pointer;  font-size: 1.8rem;  font-weight: bold;  text-align: center;  color: #ffffff;  background: #666777;&#125;.egg_exam_btn.manual &#123;  background: #e3484b;&#125;.egg_panel_wrap * &#123;  padding: 0;  margin: 0;  box-sizing: border-box;  outline: none;  border: none;&#125;.egg_panel_wrap &#123;  position: fixed;  left: 0;  top: 0;  z-index: 99999;  width: 100%;  height: 100%;  color: #333;  font-size: 1.6rem;  pointer-events: none;&#125;.egg_panel &#123;  position: absolute;  top: 5rem;  left: 1rem;  padding: 1.2rem 2rem;  border-radius: 1rem;  background: #ffffffe6;  backdrop-filter: blur(1rem);  box-shadow: 0 0 0.1rem 0.1rem #f1f1f1;  transition: 80ms ease-out;  pointer-events: all;&#125;.egg_panel.hide &#123;  left: 0;  transform: translateX(-100%);&#125;.egg_panel_wrap.mobile .egg_panel &#123;  top: 1rem;&#125;@media (min-height: 678px) and (max-height: 768px) &#123;  .egg_panel &#123;    top: 2rem;  &#125;&#125;@media (max-height: 667px) &#123;  .egg_panel &#123;    top: 1rem;  &#125;&#125;.egg_panel button &#123;  outline: none;  border: none;  padding: 0;  cursor: pointer;  background: none;&#125;.egg_panel .egg_btns_wrap &#123;  position: absolute;  left: 100%;  top: 50%;  transform: translate(-50%, -50%);  transition: 80ms ease;  z-index: 9;&#125;.egg_panel.hide .egg_btns_wrap &#123;  left: 100%;  transform: translate(0, -50%);&#125;.egg_panel .egg_btns_wrap button &#123;  border-radius: 50%;  width: 3rem;  height: 3rem;  padding: 0;  overflow: hidden;  border: 0.2rem solid currentColor;  color: white;  display: grid;  place-items: center;  font-size: 1.8rem;&#125;.egg_panel.hide .egg_panel_show_btn &#123;  background: var(--themeColor);&#125;.egg_panel .egg_panel_show_btn &#123;  background: #ccc;&#125;.egg_panel .egg_frame_show_btn &#123;  background: var(--themeColor);  margin-bottom: 1rem;&#125;.egg_panel .egg_frame_show_btn.hide &#123;  display: none;&#125;.egg_panel .egg_settings_show_btn &#123;  background: #ccc;  margin-top: 1rem;&#125;.egg_panel .egg_settings_show_btn.active &#123;  background: var(--themeColor);&#125;.egg_panel .egg_settings_reset_btn &#123;  background: #ccc;  margin-top: 1rem;&#125;.egg_panel .egg_settings_reset_btn:active &#123;  background: var(--themeColor);&#125;.egg_login_item &#123;  display: flex;  justify-content: center;  align-items: center;  flex-direction: column;  padding: 0.5rem 0;&#125;.egg_login_item .egg_login_btn &#123;  font-size: 1.4rem;  border-radius: 1rem;  transition: 80ms ease;  color: white;  background: var(--themeColor);  padding: 0.8rem 2.4rem;&#125;.egg_login_item .egg_login_btn:active &#123;  opacity: 0.8;&#125;.egg_login_item .egg_login_img_wrap &#123;  height: 0;  border-radius: 1rem;  transition: height 80ms ease;  overflow: hidden;&#125;.egg_login_item .egg_login_img_wrap.active &#123;  padding: 0.8rem;  margin-top: 0.8rem;  height: auto;  background: white;&#125;.egg_login_img_wrap .egg_login_img &#123;  width: 15rem;  height: 15rem;&#125;.egg_info_item .egg_login_btn &#123;  font-size: 1.4rem;  border-radius: 1rem;  transition: 80ms ease;  color: white;&#125;.egg_info_item .egg_login_btn:active &#123;  opacity: 0.8;&#125;.egg_info_item .egg_login_btn &#123;  background: #ccc;  padding: 0.4rem 0.8rem;&#125;.egg_info_item &#123;  display: flex;  justify-content: space-between;  align-items: center;&#125;.egg_info_item .egg_userinfo &#123;  display: flex;  justify-content: center;  align-items: center;  padding: 0.5rem 0;&#125;.egg_userinfo .egg_avatar .egg_avatar_nick,.egg_userinfo .egg_avatar .egg_avatar_img &#123;  height: 5rem;  width: 5rem;  border-radius: 50%;  background: var(--themeColor);  display: flex;  justify-content: center;  align-items: center;  text-overflow: ellipsis;  overflow: hidden;  white-space: nowrap;  font-size: 2rem;  color: white;&#125;.egg_userinfo .egg_nick &#123;  padding-left: 0.5rem;  text-overflow: ellipsis;  overflow: hidden;  white-space: nowrap;  max-width: 10rem;&#125;.egg_score_item .egg_scoreinfo &#123;  display: flex;  justify-content: space-between;  align-items: center;  padding: 0.5rem 0;&#125;.egg_scoreinfo .egg_totalscore,.egg_scoreinfo .egg_todayscore &#123;  font-size: 1.2rem;  user-select: none;&#125;.egg_scoreinfo .egg_totalscore span,.egg_scoreinfo .egg_todayscore .egg_todayscore_btn span &#123;  padding-left: 0.2rem;&#125;.egg_scoreinfo .egg_totalscore span,.egg_todayscore .egg_todayscore_btn span,.egg_todayscore .egg_score_details span &#123;  color: var(--themeColor);  font-weight: bold;&#125;.egg_scoreinfo .egg_todayscore &#123;  position: relative;&#125;.egg_todayscore .egg_todayscore_btn &#123;  display: flex;  align-items: center;&#125;.egg_todayscore_btn .egg_icon &#123;  opacity: 0.3;&#125;.egg_todayscore .egg_score_details &#123;  position: absolute;  left: calc(100% + 1rem);  top: 0;  background: #fffffff2;  border-radius: 0.5rem;  opacity: 1;  width: 10rem;  box-shadow: 0 0 0.1rem 0.1rem #f1f1f1;  transition: 80ms ease;  z-index: 9;&#125;.egg_todayscore .egg_score_details.hide &#123;  visibility: hidden;  opacity: 0;  left: 100%;&#125;.egg_score_details .egg_score_title &#123;  border-bottom: 0.1rem solid #eee;  padding: 0.5rem 0.8rem;  display: flex;  align-items: center;&#125;.egg_score_details .egg_score_title .egg_icon &#123;  font-size: 1.4rem;&#125;.egg_score_details .egg_score_title .egg_score_title_text &#123;  font-weight: bold;  padding-left: 0.2rem;&#125;.egg_score_details .egg_score_item &#123;  display: flex;  align-items: center;  justify-content: space-between;  padding: 0.5rem 0.8rem;&#125;.egg_task_list &#123;  position: relative;&#125;.egg_task_item &#123;  user-select: none;  min-height: 3rem;  min-width: 18rem;  display: flex;  align-items: center;  justify-content: space-between;  padding: 0.5rem 0;&#125;.egg_task_item .egg_label_wrap &#123;  flex-grow: 1;  padding-right: 0.5rem;&#125;.egg_label_wrap .egg_task_title_wrap &#123;  display: flex;  justify-content: space-between;  align-items: center;&#125;.egg_task_title_wrap .egg_task_progress_wrap &#123;  display: flex;  align-items: center;  font-size: 1.4rem;  width: 3.5rem;&#125;.egg_task_progress_wrap .egg_task_current &#123;  color: var(--themeColor);&#125;.egg_task_progress_wrap .egg_task_max &#123;  color: #999;  font-size: 1.2rem;&#125;.egg_label_wrap .egg_progress &#123;  display: flex;  justify-content: space-between;  align-items: center;  padding-top: 0.8rem;&#125;.egg_progress .egg_track &#123;  background: #ccc;  height: 0.5rem;  border-radius: 1rem;  flex: 1 1 auto;  overflow: hidden;&#125;.egg_progress .egg_track .egg_bar &#123;  height: 0.5rem;  background: var(--themeColor);  border-radius: 1rem;  width: 0;  transition: width 0.5s;&#125;.egg_setting_item &#123;  min-height: 3rem;  min-width: 18rem;  display: flex;  align-items: center;  justify-content: space-between;  box-sizing: border-box;&#125;.egg_setting_item .egg_label_wrap &#123;  flex-grow: 1;&#125;.egg_detail &#123;  background: #ccc;  color: white;  border-radius: 10rem;  font-size: 1.2rem;  width: 1.6rem;  height: 1.6rem;  margin-left: 0.4rem;  display: inline-block;  text-align: center;  line-height: 1.6rem;  cursor: pointer;&#125;.egg_switch &#123;  cursor: pointer;  margin: 0;  outline: 0;  appearance: none;  -webkit-appearance: none;  -moz-appearance: none;  position: relative;  width: 4.2rem;  height: 2.2rem;  background: #ccc;  border-radius: 5rem;  transition: background 0.3s;  --border-padding: 0.5rem;  box-shadow: -0.1rem 0 0.1rem -0.1rem #999 inset,    0.1rem 0 0.1rem -0.1rem #999 inset;&#125;.egg_switch::after &#123;  content: \&#x27;\&#x27;;  display: inline-block;  width: 1.4rem;  height: 1.4rem;  border-radius: 50%;  background: #fff;  box-shadow: 0 0 0.2rem #999;  transition: left 0.4s;  position: absolute;  top: calc(50% - (1.4rem / 2));  position: absolute;  left: var(--border-padding);&#125;.egg_switch:checked &#123;  background: var(--themeColor);&#125;.egg_switch:disabled &#123;  opacity: 0.5;  background: #ccc;&#125;.egg_switch:checked::after &#123;  left: calc(100% - var(--border-padding) - 1.4rem);&#125;.egg_tip_list &#123;  font-size: 1.2rem;  max-width: 18rem;  line-height: 2rem;  color: var(--themeColor);&#125;.egg_tip_list .egg_tip_btn &#123;  padding: 0.2rem 0.4rem;  background: #f1f1f1;  color: #333;&#125;.egg_tip_list .egg_tip_btn:disabled &#123;  opacity: 0.5;  background: #ccc;&#125;.egg_study_item &#123;  display: flex;  justify-content: center;  padding-top: 0.5rem;&#125;.egg_study_item .egg_study_btn &#123;  background: var(--themeColor);  padding: 0.8rem 2.4rem;  font-size: 1.4rem;  border-radius: 1rem;  color: white;  transition: 80ms ease;&#125;.egg_study_item .egg_study_btn:not(.loading):active &#123;  opacity: 0.8;&#125;.egg_study_item .egg_study_btn.loading &#123;  animation: fade 2s ease infinite alternate;&#125;.egg_study_item .egg_study_btn:disabled &#123;  background: #ccc;&#125;.egg_tip_wrap &#123;  position: fixed;  left: 0;  top: 0;  z-index: 999999;  width: 100%;  height: 100%;  pointer-events: none;&#125;.egg_tip_wrap * &#123;  padding: 0;  margin: 0;  box-sizing: border-box;  outline: none;  border: none;&#125;.egg_tip_wrap .egg_tip &#123;  position: absolute;  bottom: 2rem;  left: 2rem;  padding: 1.2rem 1.4rem;  border: none;  border-radius: 1rem;  background: var(--themeColor);  color: white;  font-size: 1.4rem;  transition: 200ms ease;  opacity: 0;  transform: scale(0.9) translateY(1rem);&#125;.egg_tip_wrap .egg_tip.active &#123;  opacity: 1;  transform: scale(1) translateY(0);&#125;.egg_tip_wrap .egg_tip.active.delay &#123;  opacity: 0.5;&#125;.egg_tip_wrap .egg_tip .egg_countdown &#123;  display: inline-block;  color: var(--themeColor);  background: white;  border-radius: 0.5rem;  padding: 0.2rem 0.4rem;  font-weight: bold;  margin-left: 0.4rem;  font-size: 1.2rem;&#125;.egg_frame_wrap &#123;  position: fixed;  left: 0;  top: 0;  z-index: 999;  width: 100%;  height: 100%;  visibility: visible;&#125;.egg_frame_wrap * &#123;  padding: 0;  margin: 0;  box-sizing: border-box;  outline: none;  border: none;&#125;.egg_frame_wrap.hide &#123;  visibility: hidden;&#125;.egg_frame_wrap.hide .egg_frame_mask,.egg_frame_wrap.hide .egg_frame_content_wrap &#123;  opacity: 0;&#125;.egg_frame_wrap.hide .egg_frame_content_wrap &#123;  transform: scale(0);&#125;.egg_frame_mask &#123;  background: #00000030;  width: 100%;  height: 100%;  opacity: 1;  transition: 200ms ease;&#125;.egg_frame_content_wrap &#123;  position: absolute;  width: 80%;  height: 80%;  top: 10%;  left: 10%;  display: flex;  flex-direction: column;  transition: 200ms ease;  border-radius: 1rem;  background: #ffffffe6;  backdrop-filter: blur(1rem);  overflow: hidden;  transform: scale(1);&#125;.egg_frame_content_wrap.max &#123;  top: 0;  left: 0;  width: 100%;  height: 100%;  border-radius: 0;&#125;.egg_frame_content_wrap .egg_frame_controls_wrap &#123;  width: 100%;  display: flex;  justify-content: space-between;  align-items: center;  box-sizing: border-box;&#125;.egg_frame_controls_wrap .egg_frame_title &#123;  padding: 1rem 2rem;  font-size: 1.6rem;&#125;.egg_frame_controls .egg_frame_btn &#123;  outline: none;  border: none;  background: none;  padding: 1rem 2rem;  transition: 80ms ease;  cursor: pointer;  color: #333;  font-size: 1.8rem;&#125;.egg_frame_controls .egg_frame_btn:active &#123;  opacity: 0.8;&#125;.egg_frame_wrap .egg_frame_content &#123;  width: 100%;  flex-grow: 1;  border-top: 0.1rem solid #ccc;  min-height: 40rem;  min-width: 30rem;  background: white;&#125;.egg_frame_content .egg_frame &#123;  width: 100%;  height: 100%;  outline: none;  border: none;&#125;.egg_time_input &#123;  display: inline-flex;  align-items: center;  justify-content: center;&#125;.egg_time_input .egg_hour_wrap,.egg_time_input .egg_minute_wrap &#123;  width: 4rem;&#125;.egg_time_input .egg_separator &#123;  padding: 0 0.5rem;  font-size: 1.5rem;&#125;.egg_settings_item &#123;  position: absolute;  top: 0;  left: 0;  width: 100%;  height: 100%;  pointer-events: none;  overflow: hidden;  border-radius: 1rem;&#125;.egg_settings_item .egg_settings &#123;  display: inline-flex;  flex-direction: column;  font-size: 1.4rem;  background: white;  border-radius: 1rem;  overflow: hidden;  width: 100%;  height: 100%;  pointer-events: all;  transform: translateX(100%);  transition: transform 300ms ease;  padding-top: 1rem;&#125;.egg_settings_item .egg_settings.active &#123;  transform: translateX(0);&#125;.egg_settings .egg_settings_label &#123;  padding-bottom: 1rem;  user-select: none;&#125;.egg_settings_item .egg_settings_version_wrap &#123;  padding: 1rem 2rem 0 2rem;  display: flex;  align-items: center;  justify-content: space-between;&#125;.egg_settings_version_wrap .egg_settings_version &#123;  color: #999;  display: flex;  align-items: center;&#125;.egg_settings_version .egg_settings_version_detail &#123;  color: #24292f;  font-size: 1.6rem;  width: 1.6rem;  height: 1.6rem;  margin-left: 0.4rem;&#125;.egg_settings_item .egg_settings_theme_wrap &#123;  padding: 1rem 2rem 0 2rem;&#125;.egg_settings_theme_wrap .egg_settings_theme_colors &#123;  display: flex;  align-items: center;  justify-content: space-between;&#125;.egg_settings_theme_color_wrap .egg_settings_theme_color &#123;  border-radius: 50%;  width: 1.6rem;  height: 1.6rem;  background: currentColor;&#125;.egg_settings .egg_settings_read_time_wrap,.egg_settings .egg_settings_watch_time_wrap &#123;  padding: 1rem 2rem 0 2rem;  display: flex;  justify-content: space-between;  align-items: center;&#125;.egg_settings_read_time_wrap .egg_settings_label,.egg_settings_watch_time_wrap .egg_settings_label &#123;  padding: 0.5rem 0;&#125;.egg_settings_read_time_wrap .egg_select,.egg_settings_watch_time_wrap .egg_select &#123;  width: 6rem;&#125;.egg_settings .egg_settings_token_wrap &#123;  padding: 1rem 2rem 0 2rem;&#125;.egg_settings_token_wrap .egg_settings_token_input &#123;  outline: none;  border: 0.1rem solid #eee;  padding: 1rem;  background: white;  border-radius: 0.2rem;  width: 100%;  box-sizing: border-box;  color: #ccc;&#125;.egg_settings_token_wrap .egg_settings_token_input.active &#123;  color: #333;&#125;.egg_settings_token_input::placeholder &#123;  color: #ccc;&#125;.egg_settings .egg_settings_submit_btn_wrap &#123;  text-align: right;  padding-top: 1rem;  display: none;&#125;.egg_settings .egg_settings_submit_btn_wrap.active &#123;  display: block;&#125;.egg_settings_submit_btn_wrap .egg_settings_submit_btn &#123;  outline: none;  border: 0.1rem solid #eee;  padding: 0.5rem 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  cursor: pointer;&#125;.egg_settings_submit_btn_wrap .egg_settings_submit_btn:active &#123;  background: #eee;&#125;.egg_schedule &#123;  height: 100%;  display: flex;  flex-direction: column;&#125;.egg_schedule_time_wrap &#123;  padding: 1rem 2rem;  border-bottom: 0.1rem solid #eee;&#125;.egg_schedule_time .egg_schedule_label &#123;  padding-bottom: 1rem;  user-select: none;&#125;.egg_schedule_time .egg_schedule_time_input_wrap &#123;  display: flex;  justify-content: space-between;  align-items: center;&#125;.egg_schedule_time_input_wrap .egg_schedule_add_btn &#123;  outline: none;  border: 0.1rem solid #eee;  padding: 0.5rem 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  cursor: pointer;&#125;.egg_schedule_time_input_wrap .egg_schedule_add_btn:active &#123;  background: #eee;&#125;.egg_schedule_list &#123;  height: 100%;  overflow: auto;&#125;.egg_schedule_list .egg_schedule_item &#123;  display: flex;  justify-content: space-between;  padding: 0.5rem 1.5rem;  font-size: 1.4rem;  border-bottom: 0.1rem solid #eee;&#125;.egg_schedule_list::-webkit-scrollbar &#123;  width: 0.4rem;  background: white;  border-radius: 0.2rem;&#125;.egg_schedule_list::-webkit-scrollbar-thumb &#123;  background: #ccc;  border-radius: 0.2rem;&#125;.egg_schedule_detail_time_wrap &#123;  display: flex;  align-items: center;&#125;.egg_schedule_detail_time_wrap.inactive &#123;  color: #ccc;&#125;.egg_schedule_detail_time_wrap .egg_schedule_detail_icon &#123;  padding-right: 0.4rem;  display: flex;  color: #ccc;&#125;.egg_schedule_detail_del_wrap .egg_schedule_del_btn &#123;  outline: none;  padding: 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  font-size: 1.4rem;  cursor: pointer;  color: #ccc;&#125;.egg_schedule_detail_del_wrap .egg_schedule_del_btn:hover &#123;  color: #333;&#125;.egg_schedule_detail_del_wrap .egg_schedule_del_btn:active &#123;  color: #eee;&#125;.egg_schedule_list .egg_schedule_list_none &#123;  width: 100%;  height: 100%;  display: flex;  flex-direction: column;  justify-content: center;  align-items: center;  color: #ccc;&#125;.egg_schedule_list_none .egg_icon &#123;  font-size: 2.5rem;&#125;.egg_schedule_list_none_text &#123;  padding-top: 1rem;&#125;.egg_select &#123;  position: relative;&#125;.egg_select .egg_select_input &#123;  outline: none;  border: 0.1rem solid #eee;  padding: 0.8rem;  text-align: center;  background: white;  border-radius: 0.2rem;  display: inline-block;  width: 100%;  box-sizing: border-box;&#125;.egg_select .egg_select_input::placeholder &#123;  color: #ccc;&#125;.egg_select_list &#123;  max-height: 12rem;  border-radius: 0 0 0.2rem 0.2rem;  box-shadow: 0 0.1rem 0.1rem 0.1rem #eee;  background: white;  user-select: none;  transition: 100ms ease;  scrollbar-width: thin;  overflow: auto;  opacity: 1;  z-index: 9;  width: 100%;  position: absolute;&#125;.egg_select_list.hide &#123;  opacity: 0;  visibility: hidden;&#125;.egg_select_list::-webkit-scrollbar &#123;  width: 0.4rem;  background: white;  border-radius: 0.2rem;&#125;.egg_select_list::-webkit-scrollbar-thumb &#123;  background: #ccc;  border-radius: 0.2rem;&#125;.egg_select_list .egg_select_item &#123;  padding: 0.6rem 1rem;  border-bottom: 0.1rem solid #eee;  cursor: pointer;  color: #333;  transition: 300ms ease;  text-align: center;&#125;.egg_select_list .egg_select_item.selected &#123;  font-weight: bold;  background: #f6f6f6;&#125;.egg_select_list .egg_select_item.active &#123;  background: #eee;&#125;.egg_select_list .egg_select_item:hover &#123;  background: #eee;&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åµŒå…¥æ ·å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title function_">GM_addStyle</span>(css);</span><br><span class="line"><span class="title function_">load</span>(<span class="function">(<span class="params">href</span>) =&gt;</span> href.<span class="title function_">match</span>(<span class="variable constant_">URL_CONFIG</span>.<span class="property">home</span>), <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–logo</span></span><br><span class="line">    <span class="title function_">initLogo</span>();</span><br><span class="line">    <span class="comment">// é¡µé¢æç¤º</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥ä¸»é¡µé¢!&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line">    <span class="title function_">initThemeColor</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä»»åŠ¡é…ç½®</span></span><br><span class="line">    <span class="title function_">initTaskConfig</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    <span class="title function_">initSettings</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ä½“</span></span><br><span class="line">    <span class="title function_">initFontSize</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¡µé¢</span></span><br><span class="line">    <span class="title function_">initMainListener</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æç¤º</span></span><br><span class="line">    <span class="title function_">renderTip</span>();</span><br><span class="line">    <span class="comment">// æ¸²æŸ“é¢æ¿</span></span><br><span class="line">    <span class="title function_">renderPanel</span>();</span><br><span class="line">    <span class="comment">// æ¸²æŸ“çª—å£</span></span><br><span class="line">    <span class="title function_">renderFrame</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">load</span>(<span class="function">(<span class="params">href</span>) =&gt;</span> href === <span class="title function_">GM_getValue</span>(<span class="string">&#x27;readingUrl&#x27;</span>), <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// é¡µé¢æç¤º</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥æ–‡ç« é€‰è¯»é¡µé¢!&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line">    <span class="title function_">initThemeColor</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    <span class="title function_">initSettings</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ä½“</span></span><br><span class="line">    <span class="title function_">initFontSize</span>();</span><br><span class="line">    <span class="comment">// æœ€å¤§é˜…è¯»</span></span><br><span class="line">    <span class="title function_">initMaxRead</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å­é¡µé¢</span></span><br><span class="line">    <span class="title function_">initChildListener</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æç¤º</span></span><br><span class="line">    <span class="title function_">renderTip</span>();</span><br><span class="line">    <span class="comment">// å¤„ç†æ–‡ç« </span></span><br><span class="line">    <span class="title function_">handleNews</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">load</span>(<span class="function">(<span class="params">href</span>) =&gt;</span> href === <span class="title function_">GM_getValue</span>(<span class="string">&#x27;watchingUrl&#x27;</span>), <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// é¡µé¢æç¤º</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥è§†å¬å­¦ä¹ é¡µé¢!&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line">    <span class="title function_">initThemeColor</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    <span class="title function_">initSettings</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ä½“</span></span><br><span class="line">    <span class="title function_">initFontSize</span>();</span><br><span class="line">    <span class="comment">// æœ€å¤§è§†å¬</span></span><br><span class="line">    <span class="title function_">initMaxWatch</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å­é¡µé¢</span></span><br><span class="line">    <span class="title function_">initChildListener</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æç¤º</span></span><br><span class="line">    <span class="title function_">renderTip</span>();</span><br><span class="line">    <span class="comment">// å¤„ç†è§†é¢‘</span></span><br><span class="line">    <span class="title function_">handleVideo</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">load</span>(<span class="function">(<span class="params">href</span>) =&gt;</span> href === <span class="variable constant_">URL_CONFIG</span>.<span class="property">examPractice</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// é¡µé¢æç¤º</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥æ¯æ—¥ç­”é¢˜é¡µé¢!&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line">    <span class="title function_">initThemeColor</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    <span class="title function_">initSettings</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ä½“</span></span><br><span class="line">    <span class="title function_">initFontSize</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å­é¡µé¢</span></span><br><span class="line">    <span class="title function_">initChildListener</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æç¤º</span></span><br><span class="line">    <span class="title function_">renderTip</span>();</span><br><span class="line">    <span class="comment">// åˆ›å»ºç­”é¢˜æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">renderExamBtn</span>();</span><br><span class="line">    <span class="comment">// å¼€å§‹ç­”é¢˜</span></span><br><span class="line">    <span class="title function_">doingExam</span>(<span class="title class_">ExamType</span>.<span class="property">PRACTICE</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">load</span>(<span class="function">(<span class="params">href</span>) =&gt;</span> href.<span class="title function_">includes</span>(<span class="variable constant_">URL_CONFIG</span>.<span class="property">examPaper</span>), <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// é¡µé¢æç¤º</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥ä¸“é¡¹ç»ƒä¹ é¡µé¢!&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸»é¢˜</span></span><br><span class="line">    <span class="title function_">initThemeColor</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    <span class="title function_">initSettings</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ä½“</span></span><br><span class="line">    <span class="title function_">initFontSize</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å­é¡µé¢</span></span><br><span class="line">    <span class="title function_">initChildListener</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æç¤º</span></span><br><span class="line">    <span class="title function_">renderTip</span>();</span><br><span class="line">    <span class="comment">// åˆ›å»ºç­”é¢˜æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">renderExamBtn</span>();</span><br><span class="line">    <span class="comment">// å¼€å§‹ç­”é¢˜</span></span><br><span class="line">    <span class="title function_">doingExam</span>(<span class="title class_">ExamType</span>.<span class="property">PAPER</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–logo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initLogo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`%c tech-study.js %c <span class="subst">$&#123;version&#125;</span> `</span>, <span class="string">&#x27;background:dodgerblue;color:white;font-size:15px;border-radius:4px 0 0 4px;padding:2px 0;&#x27;</span>, <span class="string">&#x27;background:black;color:gold;font-size:15px;border-radius:0 4px 4px 0;padding:2px 0;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initTaskConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> configTemp = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title function_">GM_getValue</span>(<span class="string">&#x27;taskConfig&#x27;</span>));</span><br><span class="line">        <span class="keyword">if</span> (configTemp &amp;&amp; <span class="title class_">Array</span>.<span class="title function_">isArray</span>(configTemp)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (configTemp.<span class="property">length</span> === taskConfig.<span class="property">length</span>) &#123;</span><br><span class="line">                taskConfig.<span class="title function_">forEach</span>(<span class="function">(<span class="params">task, i</span>) =&gt;</span> &#123;</span><br><span class="line">                    task.<span class="property">active</span> = configTemp[i].<span class="property">active</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initSettings</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> settingsTemp = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title function_">GM_getValue</span>(<span class="string">&#x27;studySettings&#x27;</span>));</span><br><span class="line">        <span class="keyword">if</span> (settingsTemp &amp;&amp; <span class="title class_">Array</span>.<span class="title function_">isArray</span>(settingsTemp)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (settingsTemp.<span class="property">length</span> === settings.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> settingsTemp) &#123;</span><br><span class="line">                    settings[i] = settingsTemp[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initFontSize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ç§»åŠ¨ç«¯</span></span><br><span class="line">    <span class="keyword">const</span> moblie = <span class="title function_">hasMobile</span>();</span><br><span class="line">    <span class="keyword">if</span> (moblie) &#123;</span><br><span class="line">        <span class="comment">// æ¸…é™¤ç¼©æ”¾</span></span><br><span class="line">        <span class="keyword">const</span> meta = $$(<span class="string">&#x27;meta[name=viewport]&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (meta) &#123;</span><br><span class="line">            meta.<span class="property">content</span> = <span class="string">&#x27;initial-scale=0, user-scalable=yes&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">        <span class="keyword">const</span> scale = ~~(<span class="variable language_">window</span>.<span class="property">innerWidth</span> / <span class="variable language_">window</span>.<span class="property">outerWidth</span>) || <span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--scale&#x27;</span>, <span class="title class_">String</span>(scale));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–æœ€å¤§é˜…è¯»æ—¶é•¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initMaxRead</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> maxReadTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;maxRead&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (maxReadTemp) &#123;</span><br><span class="line">            maxRead.<span class="property">value</span> = maxReadTemp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–æœ€å¤§è§†å¬æ—¶é•¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initMaxWatch</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> maxWatchTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;maxWatch&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (maxWatchTemp) &#123;</span><br><span class="line">            maxWatch.<span class="property">value</span> = maxWatchTemp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–ä¸»é¢˜è‰²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initThemeColor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// ç›‘å¬ä¸»é¢˜å˜åŒ–</span></span><br><span class="line">        <span class="title function_">watch</span>(themeColor, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®ä¸»é¢˜</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--themeColor&#x27;</span>, themeColor.<span class="property">value</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// ä¸»é¢˜è‰²</span></span><br><span class="line">        <span class="keyword">const</span> themeColorTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;themeColor&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (themeColorTemp) &#123;</span><br><span class="line">            themeColor.<span class="property">value</span> = themeColorTemp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¸²æŸ“æç¤º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderTip</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> tipWrap = <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">&#x27;egg_tip_wrap&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">mountElement</span>(tipWrap);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¸²æŸ“ç­”é¢˜æŒ‰é’®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">renderExamBtn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> titles = <span class="keyword">await</span> $_(<span class="string">&#x27;.title&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (titles.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">        titles[<span class="number">0</span>].<span class="property">parentNode</span>?.<span class="title function_">insertBefore</span>(<span class="title class_">ExamBtn</span>().<span class="property">ele</span>, titles[<span class="number">0</span>].<span class="property">nextSibling</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¸²æŸ“é¢æ¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">renderPanel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// é¢æ¿</span></span><br><span class="line">    <span class="keyword">const</span> panel = <span class="title class_">Panel</span>();</span><br><span class="line">    <span class="comment">// æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">mountElement</span>(panel);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¸²æŸ“çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderFrame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// çª—å£</span></span><br><span class="line">    <span class="keyword">const</span> frame = <span class="title class_">Frame</span>();</span><br><span class="line">    <span class="comment">// æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">mountElement</span>(frame);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ç­”æ¡ˆ API */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAnswer</span>(<span class="params">question</span>) &#123;</span><br><span class="line">    <span class="comment">// æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">        <span class="attr">txt_name</span>: <span class="title function_">md5</span>(question),</span><br><span class="line">        <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(data);</span><br><span class="line">        <span class="comment">// è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">answerSearch</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">body</span>: params.<span class="title function_">toString</span>(),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> result = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">const</span> &#123; data, status &#125; = result;</span><br><span class="line">            <span class="keyword">if</span> (status !== <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// ç­”æ¡ˆåˆ—è¡¨</span></span><br><span class="line">                <span class="keyword">const</span> answerList = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data.<span class="property">txt_content</span>);</span><br><span class="line">                <span class="comment">// ç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">const</span> answers = answerList[<span class="number">0</span>].<span class="property">content</span>.<span class="title function_">split</span>(<span class="regexp">/[;\s]/</span>);</span><br><span class="line">                <span class="keyword">return</span> answers;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä¿å­˜ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">saveAnswer</span>(<span class="params">question, answer</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å†…å®¹</span></span><br><span class="line">        <span class="keyword">const</span> content = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([&#123; <span class="attr">title</span>: <span class="title function_">md5</span>(question), <span class="attr">content</span>: answer &#125;]);</span><br><span class="line">        <span class="comment">// æ•°æ®</span></span><br><span class="line">        <span class="keyword">const</span> data = &#123;</span><br><span class="line">            <span class="attr">txt_name</span>: <span class="title function_">md5</span>(question),</span><br><span class="line">            <span class="attr">txt_content</span>: content,</span><br><span class="line">            <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="attr">v_id</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(data);</span><br><span class="line">        <span class="comment">// è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">answerSave</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">body</span>: params.<span class="title function_">toString</span>(),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ•°æ® API */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–æ–°é—»æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getNewsList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// éšæœº</span></span><br><span class="line">    <span class="keyword">const</span> randNum = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable constant_">API_CONFIG</span>.<span class="property">todayNews</span>.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–é‡è¦æ–°é—»</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">todayNews</span>[randNum], &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–è§†é¢‘æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getVideoList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// éšæœº</span></span><br><span class="line">    <span class="keyword">const</span> randNum = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable constant_">API_CONFIG</span>.<span class="property">todayVideos</span>.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–é‡è¦æ–°é—»</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">todayVideos</span>[randNum], &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä¸“é¡¹ç»ƒä¹ æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getExamPaper</span>(<span class="params">pageNo</span>) &#123;</span><br><span class="line">    <span class="comment">// é“¾æ¥</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;API_CONFIG.paperList&#125;</span>?pageSize=50&amp;pageNo=<span class="subst">$&#123;pageNo&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¸“é¡¹ç»ƒä¹ </span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(url, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">const</span> paperJson = <span class="built_in">decodeURIComponent</span>(<span class="built_in">escape</span>(<span class="variable language_">window</span>.<span class="title function_">atob</span>(data.<span class="property">data_str</span>.<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&#x27;+&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/_/g</span>, <span class="string">&#x27;/&#x27;</span>))));</span><br><span class="line">            <span class="comment">// JSONæ ¼å¼åŒ–</span></span><br><span class="line">            <span class="keyword">const</span> paper = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(paperJson);</span><br><span class="line">            <span class="keyword">return</span> paper;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”ŸæˆäºŒç»´ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">generateQRCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ¨é€</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">generateQRCode</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">if</span> (data.<span class="property">success</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> data.<span class="property">result</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”¨äºŒç»´ç ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loginWithQRCode</span>(<span class="params">qrCode</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(&#123;</span><br><span class="line">            qrCode,</span><br><span class="line">            <span class="attr">goto</span>: <span class="string">&#x27;https://oa.xuexi.cn&#x27;</span>,</span><br><span class="line">            <span class="attr">pdmToken</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// æ¨é€</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">loginWithQRCode</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded;charset=UTF-8&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">body</span>: params.<span class="title function_">toString</span>(),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­¾å</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getSign</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ¨é€</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">sign</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">if</span> (data.<span class="property">ok</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> data.<span class="property">data</span>.<span class="property">sign</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å®‰å…¨æ£€æŸ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">data</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">secureCheck</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(data);</span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;API_CONFIG.secureCheck&#125;</span>?<span class="subst">$&#123;params&#125;</span>`</span>;</span><br><span class="line">        <span class="comment">// æ¨é€</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(url, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data.<span class="property">success</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ¨é€ API */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¨é€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">pushPlus</span>(<span class="params">token, title, content, template, toToken</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å‚æ•°ä½“</span></span><br><span class="line">        <span class="keyword">const</span> body = &#123;</span><br><span class="line">            token,</span><br><span class="line">            title,</span><br><span class="line">            content,</span><br><span class="line">            template,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// å¥½å‹ä»¤ç‰Œ</span></span><br><span class="line">        <span class="keyword">if</span> (toToken) &#123;</span><br><span class="line">            body.<span class="property">to</span> = toToken;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ¨é€</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">push</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(body),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ç”¨æˆ· API */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">userInfo</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–æ€»ç§¯åˆ†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getTotalScore</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">totalScore</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="comment">// æ€»åˆ†</span></span><br><span class="line">            <span class="keyword">const</span> &#123; score &#125; = data;</span><br><span class="line">            <span class="keyword">return</span> score;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–å½“å¤©æ€»ç§¯åˆ†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getTodayScore</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">todayScore</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="comment">// å½“å¤©æ€»åˆ†</span></span><br><span class="line">            <span class="keyword">const</span> &#123; score &#125; = data;</span><br><span class="line">            <span class="keyword">return</span> score;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getTaskList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">API_CONFIG</span>.<span class="property">taskList</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">            <span class="comment">// è¿›åº¦å’Œå½“å¤©æ€»åˆ†</span></span><br><span class="line">            <span class="keyword">const</span> &#123; taskProgress &#125; = data;</span><br><span class="line">            <span class="keyword">return</span> taskProgress;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (err) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* taskÂ·é…ç½® */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•æ¬¡æœ€å¤§æ–°é—»æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> maxNewsNum = <span class="number">6</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•æ¬¡æœ€å¤§è§†é¢‘æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> maxVideoNum = <span class="number">6</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> äºŒç»´ç æœ€å¤§åˆ·æ–°æ¬¡æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> maxRefreshCount = <span class="number">10</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> äºŒç»´ç è‡ªåŠ¨åˆ·æ–°é—´éš”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> autoRefreshQRCodeInterval = <span class="number">100000</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è§†é¢‘é™éŸ³</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> muted = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> urlé…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">URL_CONFIG</span> = &#123;</span><br><span class="line">    <span class="comment">// ä¸»é¡µæ­£åˆ™</span></span><br><span class="line">    <span class="attr">home</span>: <span class="regexp">/^https\:\/\/www\.xuexi\.cn(\/(index\.html)?)?$/</span>,</span><br><span class="line">    <span class="comment">// ä¸»é¡µ</span></span><br><span class="line">    <span class="attr">homeOrigin</span>: <span class="string">&#x27;https://www.xuexi.cn&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ¯æ—¥ç­”é¢˜é¡µé¢</span></span><br><span class="line">    <span class="attr">examPractice</span>: <span class="string">&#x27;https://pc.xuexi.cn/points/exam-practice.html&#x27;</span>,</span><br><span class="line">    <span class="comment">// ä¸“é¡¹ç»ƒä¹ é¡µé¢</span></span><br><span class="line">    <span class="attr">examPaper</span>: <span class="string">&#x27;https://pc.xuexi.cn/points/exam-paper-detail.html&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> apié…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">API_CONFIG</span> = &#123;</span><br><span class="line">    <span class="comment">// ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="attr">userInfo</span>: <span class="string">&#x27;https://pc-api.xuexi.cn/open/api/user/info&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ€»åˆ†</span></span><br><span class="line">    <span class="attr">totalScore</span>: <span class="string">&#x27;https://pc-proxy-api.xuexi.cn/delegate/score/get&#x27;</span>,</span><br><span class="line">    <span class="comment">// å½“å¤©åˆ†æ•°</span></span><br><span class="line">    <span class="attr">todayScore</span>: <span class="string">&#x27;https://pc-proxy-api.xuexi.cn/delegate/score/today/query&#x27;</span>,</span><br><span class="line">    <span class="comment">// ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line">    <span class="attr">taskList</span>: <span class="string">&#x27;https://pc-proxy-api.xuexi.cn/delegate/score/days/listScoreProgress?sence=score&amp;deviceType=2&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ–°é—»æ•°æ®</span></span><br><span class="line">    <span class="attr">todayNews</span>: [</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/35il6fpn0ohq.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/1ap1igfgdn2.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/vdppiu92n1.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/152mdtl3qn1.json&#x27;</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// è§†é¢‘æ•°æ®</span></span><br><span class="line">    <span class="attr">todayVideos</span>: [</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/525pi8vcj24p.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/11vku6vt6rgom.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/2qfjjjrprmdh.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/3o3ufqgl8rsn.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/591ht3bc22pi.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/1742g60067k.json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.xuexi.cn/lgdata/1novbsbi47k.json&#x27;</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// ä¸“é¡¹ç»ƒä¹ åˆ—è¡¨</span></span><br><span class="line">    <span class="attr">paperList</span>: <span class="string">&#x27;https://pc-proxy-api.xuexi.cn/api/exam/service/paper/pc/list&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ–‡æœ¬æœåŠ¡å™¨ä¿å­˜ç­”æ¡ˆ</span></span><br><span class="line">    <span class="attr">answerSave</span>: <span class="string">&#x27;https://a6.qikekeji.com/txt/data/save&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ–‡æœ¬æœåŠ¡å™¨è·å–ç­”æ¡ˆ</span></span><br><span class="line">    <span class="attr">answerSearch</span>: <span class="string">&#x27;https://a6.qikekeji.com/txt/data/detail&#x27;</span>,</span><br><span class="line">    <span class="comment">// æ¨é€</span></span><br><span class="line">    <span class="attr">push</span>: <span class="string">&#x27;https://www.pushplus.plus/send&#x27;</span>,</span><br><span class="line">    <span class="comment">// ç”ŸæˆäºŒç»´ç </span></span><br><span class="line">    <span class="attr">generateQRCode</span>: <span class="string">&#x27;https://login.xuexi.cn/user/qrcode/generate&#x27;</span>,</span><br><span class="line">    <span class="comment">//äºŒç»´ç ç™»å½•</span></span><br><span class="line">    <span class="attr">loginWithQRCode</span>: <span class="string">&#x27;https://login.xuexi.cn/login/login_with_qr&#x27;</span>,</span><br><span class="line">    <span class="comment">// ç­¾å</span></span><br><span class="line">    <span class="attr">sign</span>: <span class="string">&#x27;https://pc-api.xuexi.cn/open/api/sns/sign&#x27;</span>,</span><br><span class="line">    <span class="comment">// å®‰å…¨æ£€æŸ¥</span></span><br><span class="line">    <span class="attr">secureCheck</span>: <span class="string">&#x27;https://pc-api.xuexi.cn/login/secure_check&#x27;</span>,</span><br><span class="line">    <span class="comment">// äºŒç»´ç </span></span><br><span class="line">    <span class="attr">qrcode</span>: <span class="string">&#x27;https://api.qrserver.com/v1/create-qr-code&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> version = <span class="string">&#x27;1.7.0&#x27;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä»»åŠ¡ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">TaskType</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">TaskType</span>) &#123;</span><br><span class="line">    <span class="title class_">TaskType</span>[<span class="title class_">TaskType</span>[<span class="string">&quot;LOGIN&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;LOGIN&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskType</span>[<span class="title class_">TaskType</span>[<span class="string">&quot;READ&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;READ&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskType</span>[<span class="title class_">TaskType</span>[<span class="string">&quot;WATCH&quot;</span>] = <span class="number">2</span>] = <span class="string">&quot;WATCH&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskType</span>[<span class="title class_">TaskType</span>[<span class="string">&quot;PRACTICE&quot;</span>] = <span class="number">3</span>] = <span class="string">&quot;PRACTICE&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">TaskType</span> || (<span class="title class_">TaskType</span> = &#123;&#125;));</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">SettingType</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">SettingType</span>) &#123;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;AUTO_START&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;AUTO_START&quot;</span>;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;SAME_TAB&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;SAME_TAB&quot;</span>;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;SILENT_RUN&quot;</span>] = <span class="number">2</span>] = <span class="string">&quot;SILENT_RUN&quot;</span>;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;SCHEDULE_RUN&quot;</span>] = <span class="number">3</span>] = <span class="string">&quot;SCHEDULE_RUN&quot;</span>;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;RANDOM_EXAM&quot;</span>] = <span class="number">4</span>] = <span class="string">&quot;RANDOM_EXAM&quot;</span>;</span><br><span class="line">    <span class="title class_">SettingType</span>[<span class="title class_">SettingType</span>[<span class="string">&quot;REMOTE_PUSH&quot;</span>] = <span class="number">5</span>] = <span class="string">&quot;REMOTE_PUSH&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">SettingType</span> || (<span class="title class_">SettingType</span> = &#123;&#125;));</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¿›åº¦ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">TaskStatusType</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">TaskStatusType</span>) &#123;</span><br><span class="line">    <span class="title class_">TaskStatusType</span>[<span class="title class_">TaskStatusType</span>[<span class="string">&quot;LOADING&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;LOADING&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskStatusType</span>[<span class="title class_">TaskStatusType</span>[<span class="string">&quot;LOADED&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;LOADED&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskStatusType</span>[<span class="title class_">TaskStatusType</span>[<span class="string">&quot;START&quot;</span>] = <span class="number">2</span>] = <span class="string">&quot;START&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskStatusType</span>[<span class="title class_">TaskStatusType</span>[<span class="string">&quot;PAUSE&quot;</span>] = <span class="number">3</span>] = <span class="string">&quot;PAUSE&quot;</span>;</span><br><span class="line">    <span class="title class_">TaskStatusType</span>[<span class="title class_">TaskStatusType</span>[<span class="string">&quot;FINISH&quot;</span>] = <span class="number">4</span>] = <span class="string">&quot;FINISH&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">TaskStatusType</span> || (<span class="title class_">TaskStatusType</span> = &#123;&#125;));</span><br><span class="line"><span class="comment">// å½“å‰è®¢é˜…</span></span><br><span class="line"><span class="keyword">let</span> currentSub;</span><br><span class="line"><span class="comment">// è®¢é˜…</span></span><br><span class="line"><span class="keyword">const</span> subscription = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> Proxy Map</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> proxyMap = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ”¶é›† Ref ä¾èµ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">trackRef</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// å½“å‰è®¢é˜…</span></span><br><span class="line">    <span class="keyword">if</span> (!currentSub) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// target è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">let</span> subList = subscription.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="comment">// ä¸å­˜åœ¨è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> (!subList) &#123;</span><br><span class="line">        subList = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">        <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">        <span class="keyword">const</span> subkeyList = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">        subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">        subList.<span class="title function_">set</span>(<span class="string">&#x27;value&#x27;</span>, subkeyList);</span><br><span class="line">        subscription.<span class="title function_">set</span>(target, subList);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">    <span class="keyword">let</span> subkeyList = subList.<span class="title function_">get</span>(<span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!subkeyList) &#123;</span><br><span class="line">        <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">        subkeyList = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">        subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">        subList.<span class="title function_">set</span>(<span class="string">&#x27;value&#x27;</span>, subkeyList);</span><br><span class="line">        subscription.<span class="title function_">set</span>(target, subList);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">    subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é€šçŸ¥ Ref è®¢é˜…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">terget</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">triggerRef</span>(<span class="params">target, newVal, oldVal</span>) &#123;</span><br><span class="line">    <span class="comment">// target è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> subList = subscription.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (!subList) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">    <span class="keyword">let</span> subkeyList = subList.<span class="title function_">get</span>(<span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!subkeyList) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€šçŸ¥è®¢é˜…</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> fn <span class="keyword">of</span> subkeyList) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fn <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">            <span class="title function_">fn</span>(newVal, oldVal);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ”¶é›†ä¾èµ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">track</span> = (<span class="params">target, key</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// å½“å‰è®¢é˜…</span></span><br><span class="line">    <span class="keyword">if</span> (!currentSub) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// proxy</span></span><br><span class="line">    <span class="keyword">const</span> proxyTarget = proxyMap.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (!proxyTarget) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// target è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">let</span> subList = subscription.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="comment">// ä¸å­˜åœ¨è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> (!subList) &#123;</span><br><span class="line">        subList = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">        <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">        <span class="keyword">const</span> subkeyList = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">        subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">        subList.<span class="title function_">set</span>(key, subkeyList);</span><br><span class="line">        subscription.<span class="title function_">set</span>(target, subList);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">    <span class="keyword">let</span> subkeyList = subList.<span class="title function_">get</span>(key);</span><br><span class="line">    <span class="keyword">if</span> (!subkeyList) &#123;</span><br><span class="line">        <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">        subkeyList = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">        subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">        subList.<span class="title function_">set</span>(key, subkeyList);</span><br><span class="line">        subscription.<span class="title function_">set</span>(target, subList);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ·»åŠ è®¢é˜…</span></span><br><span class="line">    subkeyList.<span class="title function_">add</span>(currentSub);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é€šçŸ¥è®¢é˜…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">terget</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trigger</span>(<span class="params">target, key, newVal, oldVal</span>) &#123;</span><br><span class="line">    <span class="comment">// proxy</span></span><br><span class="line">    <span class="keyword">const</span> proxyTarget = proxyMap.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (!proxyTarget) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// proxyTarget è®¢é˜…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> subList = subscription.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (!subList) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é”®è®¢é˜…</span></span><br><span class="line">    <span class="keyword">let</span> subkeyList = subList.<span class="title function_">get</span>(key);</span><br><span class="line">    <span class="keyword">if</span> (!subkeyList) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€šçŸ¥è®¢é˜…</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> fn <span class="keyword">of</span> subkeyList) &#123;</span><br><span class="line">        <span class="title function_">fn</span>(newVal, oldVal);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åªè¯»é”®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactiveFlags</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">ReactiveFlags</span>) &#123;</span><br><span class="line">    <span class="title class_">ReactiveFlags</span>[<span class="string">&quot;IS_REF&quot;</span>] = <span class="string">&quot;_isRef&quot;</span>;</span><br><span class="line">    <span class="title class_">ReactiveFlags</span>[<span class="string">&quot;IS_SHALLOW&quot;</span>] = <span class="string">&quot;_isShallow&quot;</span>;</span><br><span class="line">    <span class="title class_">ReactiveFlags</span>[<span class="string">&quot;IS_REACTIVE&quot;</span>] = <span class="string">&quot;_isReactive&quot;</span>;</span><br><span class="line">    <span class="title class_">ReactiveFlags</span>[<span class="string">&quot;IS_READONLY&quot;</span>] = <span class="string">&quot;_isReadonly&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">ReactiveFlags</span> || (<span class="title class_">ReactiveFlags</span> = &#123;&#125;));</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">Ref</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ref</span> &#123;</span><br><span class="line">    _isShallow = <span class="literal">false</span>;</span><br><span class="line">    _isRef = <span class="literal">true</span>;</span><br><span class="line">    _value;</span><br><span class="line">    value;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">val, shallow = <span class="literal">false</span></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _this = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_isShallow</span> = shallow;</span><br><span class="line">        <span class="keyword">if</span> (val &amp;&amp; <span class="keyword">typeof</span> val === <span class="string">&#x27;object&#x27;</span> &amp;&amp; shallow) &#123;</span><br><span class="line">            <span class="keyword">const</span> reactiveVal = <span class="title function_">reactive</span>(val);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_value</span> = reactiveVal;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">value</span> = reactiveVal;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_value</span> = val;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">value</span> = val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å®šä¹‰å±æ€§</span></span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="variable language_">this</span>, <span class="string">&#x27;value&#x27;</span>, &#123;</span><br><span class="line">            <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">                <span class="title function_">trackRef</span>(<span class="variable language_">this</span>);</span><br><span class="line">                <span class="keyword">return</span> _this.<span class="property">_value</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">set</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">                <span class="comment">// æ—§æ•°æ®</span></span><br><span class="line">                <span class="keyword">const</span> oldVal = <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">                <span class="comment">// æ•°æ®å˜åŒ–</span></span><br><span class="line">                <span class="keyword">if</span> (oldVal !== newVal) &#123;</span><br><span class="line">                    <span class="comment">// è®¾ç½®æ–°æ•°æ®å€¼</span></span><br><span class="line">                    _this.<span class="property">_value</span> = newVal;</span><br><span class="line">                    <span class="comment">// é€šçŸ¥ä¾èµ–</span></span><br><span class="line">                    <span class="title function_">triggerRef</span>(<span class="variable language_">this</span>, newVal, oldVal);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">toJSON</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">ref</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">v</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isRef</span> = (<span class="params">v</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> !!(v &amp;&amp; v[<span class="title class_">ReactiveFlags</span>.<span class="property">IS_REF</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æµ…å±‚ shallow</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">v</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isShallow</span> = (<span class="params">v</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> !!(v &amp;&amp; v[<span class="title class_">ReactiveFlags</span>.<span class="property">IS_SHALLOW</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»º ref</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">v</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createRef</span> = (<span class="params">rawVal, shallow</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Ref</span>(rawVal, shallow);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è§£é™¤ ref</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">val</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">unref</span> = (<span class="params">val</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="title function_">isRef</span>(val) ? val.<span class="property">value</span> : val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é¡¶å±‚ ref</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">v</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ref</span> = (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">isRef</span>(value)</span><br><span class="line">        ? value</span><br><span class="line">        : <span class="title function_">createRef</span>(value, <span class="literal">true</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">ref</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">value</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">shallowRef</span> = (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">isRef</span>(value)</span><br><span class="line">        ? value</span><br><span class="line">        : <span class="title function_">createRef</span>(value, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºå¤„ç† reactive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">isReadonly</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">isShallow</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createReactiveHandlers</span> = (<span class="params">isReadonly, isShallow</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="title function_">createGetters</span>(isReadonly, isShallow),</span><br><span class="line">        <span class="attr">set</span>: <span class="title function_">createSetters</span>(isReadonly, isShallow),</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">getters</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">isReadonly</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">isShallow</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createGetters</span> = (<span class="params">isReadonly, isShallow</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params">target, key, receiver</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key === <span class="title class_">ReactiveFlags</span>.<span class="property">IS_REACTIVE</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> !isReadonly;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key === <span class="title class_">ReactiveFlags</span>.<span class="property">IS_READONLY</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> isReadonly;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key === <span class="title class_">ReactiveFlags</span>.<span class="property">IS_SHALLOW</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> isShallow;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»“æœ</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, key, receiver);</span><br><span class="line">        <span class="keyword">if</span> (!isReadonly) &#123;</span><br><span class="line">            <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">            <span class="title function_">track</span>(target, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isShallow) &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isRef</span>(res)) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="property">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (res &amp;&amp; <span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (res <span class="keyword">instanceof</span> <span class="title class_">Element</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> isReadonly ? <span class="title function_">readonly</span>(res) : <span class="title function_">reactive</span>(res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">setters</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">readonly</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">shallow</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createSetters</span> = (<span class="params">readonly, shallow</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">set</span>(<span class="params">target, key, newVal, receiver</span>) &#123;</span><br><span class="line">        <span class="comment">// åªè¯»</span></span><br><span class="line">        <span class="keyword">if</span> (readonly) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ—§å€¼</span></span><br><span class="line">        <span class="keyword">const</span> oldVal = target[key];</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isReadonly</span>(oldVal) &amp;&amp; <span class="title function_">isRef</span>(oldVal) &amp;&amp; !<span class="title function_">isRef</span>(newVal)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!shallow) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isRef</span>(oldVal) &amp;&amp; !<span class="title function_">isRef</span>(newVal)) &#123;</span><br><span class="line">                oldVal.<span class="property">value</span> = newVal;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, key, newVal, receiver);</span><br><span class="line">        <span class="comment">// length</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(target) &amp;&amp; key === <span class="string">&#x27;length&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// é€šçŸ¥ä¾èµ–</span></span><br><span class="line">            <span class="title function_">trigger</span>(target, key, newVal, oldVal);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ•°æ®å˜åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> (oldVal !== newVal) &#123;</span><br><span class="line">            <span class="comment">// é€šçŸ¥ä¾èµ–</span></span><br><span class="line">            <span class="title function_">trigger</span>(target, key, newVal, oldVal);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> reactive object</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createReactiveObj</span> = (<span class="params">target, isReadonly, shallow</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// å­˜åœ¨ Proxy</span></span><br><span class="line">    <span class="keyword">const</span> existingProxy = proxyMap.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (existingProxy) &#123;</span><br><span class="line">        <span class="keyword">return</span> existingProxy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ–°å»º</span></span><br><span class="line">    <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, <span class="title function_">createReactiveHandlers</span>(isReadonly, shallow));</span><br><span class="line">    proxyMap.<span class="title function_">set</span>(target, proxy);</span><br><span class="line">    <span class="keyword">return</span> proxy;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">reactive</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">val</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isReactive</span> = (<span class="params">val</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> !!(val &amp;&amp; val[<span class="title class_">ReactiveFlags</span>.<span class="property">IS_REACTIVE</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»º reactive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createReactive</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReactiveObj</span>(target, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é¡¶å±‚ reactive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">shallowReactive</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReactiveObj</span>(target, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">reactive</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">val</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isReadonly</span> = (<span class="params">val</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> !!(val &amp;&amp; val[<span class="title class_">ReactiveFlags</span>.<span class="property">IS_READONLY</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»º readonly</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createReadonly</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReactiveObj</span>(target, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é¡¶å±‚ readonly</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">shallowReadonly</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReactiveObj</span>(target, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">proxy</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">val</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isProxy</span> = (<span class="params">val</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">isReactive</span>(val) || <span class="title function_">isReadonly</span>(val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">reactive</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reactive</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReactive</span>(target);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> <span class="variable">readonly</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">readonly</span> = (<span class="params">target</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createReadonly</span>(target);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç›‘å¬æ•°æ®å˜åŒ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">source</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">watch</span> = (<span class="params">source, callback, immediate = <span class="literal">false</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// ç«‹åˆ»æ‰§è¡Œ</span></span><br><span class="line">    immediate &amp;&amp; <span class="title function_">callback</span>(<span class="title function_">unref</span>(source), <span class="title function_">unref</span>(source));</span><br><span class="line">    <span class="comment">// array</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(source) &amp;&amp; source.<span class="title function_">every</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> <span class="title function_">isRef</span>(s))) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> source) &#123;</span><br><span class="line">            <span class="comment">// Proxy</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isProxy</span>(source[i])) &#123;</span><br><span class="line">                <span class="title function_">watch</span>(source[i], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> res = source.<span class="title function_">map</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> <span class="title function_">unref</span>(s));</span><br><span class="line">                    <span class="title function_">callback</span>(res, res);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">watch</span>(<span class="function">() =&gt;</span> source.<span class="title function_">map</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> <span class="title function_">unref</span>(s)), callback);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// function</span></span><br><span class="line">    <span class="keyword">if</span> (source <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">        <span class="title function_">watch</span>(<span class="title function_">watchEffectRef</span>(source), <span class="function">(<span class="params">n, o</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">callback</span>(<span class="title function_">unref</span>(n), <span class="title function_">unref</span>(o));</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Proxy</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isProxy</span>(source)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">            currentSub = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">callback</span>(source, source);</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// sub source</span></span><br><span class="line">            <span class="keyword">const</span> subSource = source[key];</span><br><span class="line">            currentSub = <span class="literal">undefined</span>;</span><br><span class="line">            <span class="title function_">watch</span>(subSource, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">callback</span>(source, source);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Ref</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isRef</span>(source)) &#123;</span><br><span class="line">        <span class="comment">// Ref.value Proxy</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isProxy</span>(source.<span class="property">value</span>)) &#123;</span><br><span class="line">            <span class="title function_">watch</span>(source.<span class="property">value</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">callback</span>(<span class="title function_">unref</span>(source), <span class="title function_">unref</span>(source));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        currentSub = callback;</span><br><span class="line">        <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">        <span class="title function_">trackRef</span>(source);</span><br><span class="line">        currentSub = <span class="literal">undefined</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç›‘å¬æ•°æ®å˜åŒ–å½±å“</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">watchEffect</span> = (<span class="params">callback</span>) =&gt; &#123;</span><br><span class="line">    currentSub = callback;</span><br><span class="line">    <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">    <span class="title function_">callback</span>();</span><br><span class="line">    currentSub = <span class="literal">undefined</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç›‘å¬å½±å“ ref</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">refVal</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">watchRef</span> = (<span class="params">source, callback</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">    <span class="keyword">const</span> effectRes = <span class="title function_">shallowRef</span>(<span class="title function_">callback</span>());</span><br><span class="line">    <span class="comment">// ç›‘å¬</span></span><br><span class="line">    <span class="title function_">watch</span>(source, <span class="function">() =&gt;</span> (effectRes.<span class="property">value</span> = <span class="title function_">unref</span>(<span class="title function_">callback</span>())));</span><br><span class="line">    <span class="keyword">return</span> effectRes;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç›‘å¬å½±å“ ref</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">refVal</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">watchEffectRef</span> = (<span class="params">callback</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">    <span class="keyword">const</span> effectRes = <span class="title function_">shallowRef</span>(<span class="literal">undefined</span>);</span><br><span class="line">    <span class="comment">// ç›‘å¬</span></span><br><span class="line">    <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> (effectRes.<span class="property">value</span> = <span class="title function_">unref</span>(<span class="title function_">callback</span>())));</span><br><span class="line">    <span class="keyword">return</span> effectRes;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºå…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">eleName</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">props</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">attrs</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">children</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createElementNode</span>(<span class="params">tagName, props, attrs, children, options</span>) &#123;</span><br><span class="line">    <span class="comment">// æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">let</span> beforemount = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">let</span> mounted = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> &#123; onCreated, beforeCreat, onMounted, beforeMount &#125; = options || &#123;&#125;;</span><br><span class="line">    <span class="comment">// è®¢é˜…</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">subscribe</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; onMounted, beforeMount &#125; = e;</span><br><span class="line">        <span class="keyword">if</span> (beforeMount) &#123;</span><br><span class="line">            <span class="title function_">watch</span>(beforemount, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (beforemount.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="title function_">beforeMount</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (onMounted) &#123;</span><br><span class="line">            <span class="title function_">watch</span>(mounted, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (mounted.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="title function_">onMounted</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// å–æ¶ˆè®¢é˜…</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">unsubscribe</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">//æ‡’å¾—å†™</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å‰</span></span><br><span class="line">    beforeCreat &amp;&amp; <span class="title function_">beforeCreat</span>();</span><br><span class="line">    <span class="comment">// åˆ›å»ºæ™®é€šå…ƒç´ </span></span><br><span class="line">    <span class="keyword">const</span> ele = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(tagName);</span><br><span class="line">    <span class="comment">// å¤„ç†å±æ€§</span></span><br><span class="line">    <span class="title function_">handleProps</span>(ele, props);</span><br><span class="line">    <span class="comment">// å¤„ç†å±æ€§</span></span><br><span class="line">    <span class="title function_">handleAttributes</span>(ele, attrs, subscribe, unsubscribe);</span><br><span class="line">    <span class="comment">// å¤„ç†å­å…ƒç´ </span></span><br><span class="line">    <span class="title function_">handleChildren</span>(ele, children, subscribe, unsubscribe);</span><br><span class="line">    <span class="comment">// æ”¶é›†æŒ‚è½½å‰</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">collectBeforeMount</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        beforemount.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">        beforeMount &amp;&amp; <span class="title function_">beforeMount</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// æ”¶é›†æŒ‚è½½</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">collectOnMounted</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        mounted.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">        onMounted &amp;&amp; <span class="title function_">onMounted</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å</span></span><br><span class="line">    onCreated &amp;&amp; <span class="title function_">onCreated</span>();</span><br><span class="line">    <span class="keyword">return</span> &#123; ele, <span class="attr">beforeMount</span>: collectBeforeMount, <span class="attr">onMounted</span>: collectOnMounted &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºsvgå…ƒç´ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">tagName</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">props</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">attrs</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">children</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createNSElementNode</span>(<span class="params">tagName, props, attrs, children, options</span>) &#123;</span><br><span class="line">    <span class="comment">// æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">let</span> beforemount = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">let</span> mounted = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> &#123; onCreated, beforeCreat, onMounted, beforeMount &#125; = options || &#123;&#125;;</span><br><span class="line">    <span class="comment">// è®¢é˜…</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">subscribe</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; onMounted, beforeMount &#125; = e;</span><br><span class="line">        <span class="keyword">if</span> (beforeMount) &#123;</span><br><span class="line">            <span class="title function_">watch</span>(beforemount, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (beforemount.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="title function_">beforeMount</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (onMounted) &#123;</span><br><span class="line">            <span class="title function_">watch</span>(mounted, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (mounted.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="title function_">onMounted</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// å–æ¶ˆè®¢é˜…</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">unsubscribe</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">//æ‡’å¾—å†™</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å‰</span></span><br><span class="line">    beforeCreat &amp;&amp; <span class="title function_">beforeCreat</span>();</span><br><span class="line">    <span class="comment">// svgå…ƒç´ å‘½åç©ºé—´</span></span><br><span class="line">    <span class="keyword">const</span> ns = <span class="string">&#x27;http://www.w3.org/2000/svg&#x27;</span>;</span><br><span class="line">    <span class="comment">// åˆ›å»ºsvgå…ƒç´ </span></span><br><span class="line">    <span class="keyword">const</span> ele = <span class="variable language_">document</span>.<span class="title function_">createElementNS</span>(ns, tagName);</span><br><span class="line">    <span class="comment">// å¤„ç†å±æ€§</span></span><br><span class="line">    <span class="title function_">handleProps</span>(ele, props);</span><br><span class="line">    <span class="comment">// å¤„ç†å±æ€§</span></span><br><span class="line">    <span class="title function_">handleAttributes</span>(ele, attrs, subscribe, unsubscribe);</span><br><span class="line">    <span class="comment">// å¤„ç†å­å…ƒç´ </span></span><br><span class="line">    <span class="title function_">handleChildren</span>(ele, children, subscribe, unsubscribe);</span><br><span class="line">    <span class="comment">// æ”¶é›†æŒ‚è½½å‰</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">collectBeforeMount</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        beforemount.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">        beforeMount &amp;&amp; <span class="title function_">beforeMount</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// æ”¶é›†æŒ‚è½½</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">collectOnMounted</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        mounted.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">        onMounted &amp;&amp; <span class="title function_">onMounted</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å</span></span><br><span class="line">    onCreated &amp;&amp; <span class="title function_">onCreated</span>();</span><br><span class="line">    <span class="keyword">return</span> &#123; ele, <span class="attr">beforeMount</span>: collectBeforeMount, <span class="attr">onMounted</span>: collectOnMounted &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†å±æ€§</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">ele</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">props</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleProps</span>(<span class="params">ele, props</span>) &#123;</span><br><span class="line">    <span class="comment">// propså±æ€§è®¾ç½®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> props) &#123;</span><br><span class="line">        <span class="comment">// Ref å±æ€§</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isRef</span>(props[key])) &#123;</span><br><span class="line">            <span class="keyword">const</span> refVal = props[key];</span><br><span class="line">            <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> (ele[key] = refVal.<span class="property">value</span>));</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ele[key] = props[key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†svgå±æ€§</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">ele</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">attrs</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleAttributes</span>(<span class="params">ele, attrs, subscribe, unsubscribe</span>) &#123;</span><br><span class="line">    <span class="comment">// å±æ€§å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (attrs) &#123;</span><br><span class="line">        <span class="comment">// attrså±æ€§è®¾ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> attrs) &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†æ™®é€šå±æ€§</span></span><br><span class="line">            <span class="title function_">handleAttribute</span>(ele, key, attrs[key], subscribe, unsubscribe);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†äº‹ä»¶é€‰é¡¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleEventOptions</span>(<span class="params">option</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (option.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> options = &#123;</span><br><span class="line">            <span class="attr">capture</span>: option.<span class="title function_">includes</span>(<span class="string">&#x27;capture&#x27;</span>),</span><br><span class="line">            <span class="attr">once</span>: option.<span class="title function_">includes</span>(<span class="string">&#x27;once&#x27;</span>),</span><br><span class="line">            <span class="attr">passive</span>: option.<span class="title function_">includes</span>(<span class="string">&#x27;passive&#x27;</span>),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> options;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†å±æ€§</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">ele</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">value</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleAttribute</span>(<span class="params">ele, key, value, subscribe, unsubscribe</span>) &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†å®Œçš„key</span></span><br><span class="line">    <span class="keyword">const</span> formatKey = key.<span class="title function_">toLowerCase</span>();</span><br><span class="line">    <span class="comment">// äº‹ä»¶ç»‘å®š</span></span><br><span class="line">    <span class="keyword">if</span> (formatKey.<span class="title function_">startsWith</span>(<span class="string">&#x27;on&#x27;</span>)) &#123;</span><br><span class="line">        <span class="comment">// äº‹ä»¶ç›‘å¬</span></span><br><span class="line">        <span class="keyword">const</span> [event] = formatKey.<span class="title function_">match</span>(<span class="regexp">/(?&lt;=on).*/</span>);</span><br><span class="line">        <span class="comment">// äº‹ä»¶ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (event) &#123;</span><br><span class="line">            <span class="keyword">const</span> [eventType, ...option] = event.<span class="title function_">split</span>(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> options = <span class="title function_">handleEventOptions</span>(option);</span><br><span class="line">            <span class="comment">// Ref å‡½æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isRef</span>(value)) &#123;</span><br><span class="line">                <span class="keyword">const</span> refVal = value;</span><br><span class="line">                <span class="keyword">const</span> refListener = <span class="title function_">watchRef</span>(refVal, <span class="function">() =&gt;</span> refVal.<span class="property">value</span></span><br><span class="line">                    ? <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                        option.<span class="title function_">includes</span>(<span class="string">&#x27;prevent&#x27;</span>) &amp;&amp; e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                        option.<span class="title function_">includes</span>(<span class="string">&#x27;stop&#x27;</span>) &amp;&amp; e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                        <span class="keyword">const</span> callback = refVal.<span class="property">value</span>;</span><br><span class="line">                        <span class="title function_">callback</span>(e);</span><br><span class="line">                    &#125;</span><br><span class="line">                    : <span class="literal">undefined</span>);</span><br><span class="line">                <span class="comment">// è®¾ç½®äº‹ä»¶ç›‘å¬</span></span><br><span class="line">                refListener.<span class="property">value</span> &amp;&amp;</span><br><span class="line">                    ele.<span class="title function_">addEventListener</span>(eventType, refListener.<span class="property">value</span>, options);</span><br><span class="line">                <span class="comment">// ç›‘å¬äº‹ä»¶å˜åŒ–</span></span><br><span class="line">                <span class="title function_">watch</span>(refListener, <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// ç§»é™¤æ—§äº‹ä»¶ç›‘å¬</span></span><br><span class="line">                    oldVal &amp;&amp; ele.<span class="title function_">removeEventListener</span>(eventType, oldVal);</span><br><span class="line">                    <span class="comment">// è®¾ç½®æ–°äº‹ä»¶ç›‘å¬</span></span><br><span class="line">                    newVal &amp;&amp; ele.<span class="title function_">addEventListener</span>(eventType, newVal, options);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ™®é€šå‡½æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">                <span class="comment">// è®¾ç½®äº‹ä»¶ç›‘å¬</span></span><br><span class="line">                ele.<span class="title function_">addEventListener</span>(eventType, value, options);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç‰¹æ®Šå±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> specificAttrs = [<span class="string">&#x27;checked&#x27;</span>, <span class="string">&#x27;selected&#x27;</span>, <span class="string">&#x27;disabled&#x27;</span>, <span class="string">&#x27;enabled&#x27;</span>];</span><br><span class="line">    <span class="comment">// ç‰¹æ®Š key</span></span><br><span class="line">    <span class="keyword">if</span> (specificAttrs.<span class="title function_">includes</span>(formatKey)) &#123;</span><br><span class="line">        <span class="comment">// Ref</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isRef</span>(value)) &#123;</span><br><span class="line">            <span class="keyword">const</span> refVal = value;</span><br><span class="line">            <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (refVal.<span class="property">value</span>) &#123;</span><br><span class="line">                    ele.<span class="title function_">setAttribute</span>(formatKey, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    ele.<span class="title function_">removeAttribute</span>(formatKey);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ™®é€šå±æ€§å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (value) &#123;</span><br><span class="line">            ele.<span class="title function_">setAttribute</span>(formatKey, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ele.<span class="title function_">removeAttribute</span>(formatKey);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ref å±æ€§å</span></span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">&#x27;ref&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// Ref</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isRef</span>(value)) &#123;</span><br><span class="line">            <span class="keyword">const</span> refVal = value;</span><br><span class="line">            subscribe &amp;&amp;</span><br><span class="line">                <span class="title function_">subscribe</span>(&#123;</span><br><span class="line">                    <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                        refVal.<span class="property">value</span> = ele;</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Ref å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> refFn = value;</span><br><span class="line">            subscribe &amp;&amp;</span><br><span class="line">                <span class="title function_">subscribe</span>(&#123;</span><br><span class="line">                    <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                        <span class="title function_">refFn</span>(ele);</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// xlinkå‘½åç©ºé—´</span></span><br><span class="line">    <span class="keyword">if</span> (key.<span class="title function_">startsWith</span>(<span class="string">&#x27;xlink:&#x27;</span>)) &#123;</span><br><span class="line">        <span class="comment">// xlinkå±æ€§å‘½åç©ºé—´</span></span><br><span class="line">        <span class="keyword">const</span> attrNS = <span class="string">&#x27;http://www.w3.org/1999/xlink&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (value) &#123;</span><br><span class="line">            ele.<span class="title function_">setAttributeNS</span>(attrNS, key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ele.<span class="title function_">removeAttributeNS</span>(attrNS, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Ref å±æ€§å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (key &amp;&amp; <span class="title function_">isRef</span>(value)) &#123;</span><br><span class="line">        <span class="keyword">const</span> refVal = value;</span><br><span class="line">        <span class="comment">// ç›‘å¬å½±å“</span></span><br><span class="line">        <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            ele.<span class="title function_">setAttribute</span>(key, refVal.<span class="property">value</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ™®é€šå±æ€§</span></span><br><span class="line">    <span class="keyword">if</span> (key) &#123;</span><br><span class="line">        <span class="comment">// æ™®é€šå±æ€§</span></span><br><span class="line">        ele.<span class="title function_">setAttribute</span>(key, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†å­å…ƒç´ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">ele</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">children</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleChildren</span>(<span class="params">ele, children, subscribe, unsubscribe</span>) &#123;</span><br><span class="line">    <span class="comment">// Ref</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isRef</span>(children)) &#123;</span><br><span class="line">        <span class="comment">// æ³¨é‡Šå…ƒç´ </span></span><br><span class="line">        <span class="keyword">const</span> comment = <span class="variable language_">document</span>.<span class="title function_">createComment</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// ç›‘å¬å…ƒç´ å˜åŒ–</span></span><br><span class="line">        <span class="title function_">watch</span>(children, <span class="keyword">async</span> (newEle, oldEle) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (!newEle &amp;&amp; oldEle) &#123;</span><br><span class="line">                <span class="comment">// Promise</span></span><br><span class="line">                <span class="keyword">if</span> (oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> oldEleRes = <span class="keyword">await</span> oldEle;</span><br><span class="line">                    <span class="keyword">if</span> (oldEleRes) &#123;</span><br><span class="line">                        oldEleRes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">                            unsubscribe &amp;&amp; <span class="title function_">unsubscribe</span>(ele);</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// unPromise</span></span><br><span class="line">                <span class="keyword">if</span> (!(oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)) &#123;</span><br><span class="line">                    oldEle.<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">                        unsubscribe &amp;&amp; <span class="title function_">unsubscribe</span>(ele);</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                ele.<span class="title function_">replaceChildren</span>(comment);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (newEle) &#123;</span><br><span class="line">                <span class="keyword">if</span> (oldEle) &#123;</span><br><span class="line">                    <span class="comment">// Promise</span></span><br><span class="line">                    <span class="keyword">if</span> (oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> oldEleRes = <span class="keyword">await</span> oldEle;</span><br><span class="line">                        <span class="keyword">if</span> (oldEleRes) &#123;</span><br><span class="line">                            oldEleRes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">                                unsubscribe &amp;&amp; <span class="title function_">unsubscribe</span>(ele);</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// unPromise</span></span><br><span class="line">                    <span class="keyword">if</span> (!(oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)) &#123;</span><br><span class="line">                        oldEle.<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">                            unsubscribe &amp;&amp; <span class="title function_">unsubscribe</span>(ele);</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// Promise</span></span><br><span class="line">                <span class="keyword">if</span> (newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> newEleRes = <span class="keyword">await</span> newEle;</span><br><span class="line">                    <span class="keyword">if</span> (newEleRes) &#123;</span><br><span class="line">                        <span class="keyword">const</span> eles = newEleRes.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (v.<span class="property">beforeMount</span> || v.<span class="property">onMounted</span>) &#123;</span><br><span class="line">                                subscribe &amp;&amp; <span class="title function_">subscribe</span>(v);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span> v.<span class="property">ele</span>;</span><br><span class="line">                        &#125;);</span><br><span class="line">                        ele.<span class="title function_">replaceChildren</span>(<span class="title function_">createElementBlock</span>(eles));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// unPromise</span></span><br><span class="line">                <span class="keyword">const</span> eles = newEle.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (v.<span class="property">beforeMount</span> || v.<span class="property">onMounted</span>) &#123;</span><br><span class="line">                        subscribe &amp;&amp; <span class="title function_">subscribe</span>(v);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> v.<span class="property">ele</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                ele.<span class="title function_">replaceChildren</span>(<span class="title function_">createElementBlock</span>(eles));</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// Promise</span></span><br><span class="line">        <span class="keyword">if</span> (children.<span class="property">value</span> <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">            <span class="comment">// æ’å…¥æ³¨é‡Šå…ƒç´ </span></span><br><span class="line">            ele.<span class="title function_">appendChild</span>(comment);</span><br><span class="line">            children.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function">(<span class="params">childrenEle</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (childrenEle) &#123;</span><br><span class="line">                    <span class="keyword">const</span> eles = childrenEle.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (v.<span class="property">beforeMount</span> || v.<span class="property">onMounted</span>) &#123;</span><br><span class="line">                            subscribe &amp;&amp; <span class="title function_">subscribe</span>(v);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> v.<span class="property">ele</span>;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    ele.<span class="title function_">replaceChildren</span>(<span class="title function_">createElementBlock</span>(eles));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// unPromise</span></span><br><span class="line">        <span class="keyword">if</span> (children.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> eles = children.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (v.<span class="property">beforeMount</span> || v.<span class="property">onMounted</span>) &#123;</span><br><span class="line">                    subscribe &amp;&amp; <span class="title function_">subscribe</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> v.<span class="property">ele</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">            ele.<span class="title function_">appendChild</span>(<span class="title function_">createElementBlock</span>(eles));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ’å…¥å…ƒç´ </span></span><br><span class="line">        ele.<span class="title function_">appendChild</span>(comment);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Promise</span></span><br><span class="line">    <span class="keyword">if</span> (children <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">        <span class="comment">// æ³¨é‡Šå…ƒç´ </span></span><br><span class="line">        <span class="keyword">const</span> comment = <span class="variable language_">document</span>.<span class="title function_">createComment</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// æ’å…¥æ³¨é‡Šå…ƒç´ </span></span><br><span class="line">        ele.<span class="title function_">appendChild</span>(comment);</span><br><span class="line">        <span class="comment">// å¼‚æ­¥æ›¿æ¢å…ƒç´ </span></span><br><span class="line">        children.<span class="title function_">then</span>(<span class="function">(<span class="params">childEle</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (childEle) &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = childEle;</span><br><span class="line">                <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">                    subscribe &amp;&amp; <span class="title function_">subscribe</span>(childEle);</span><br><span class="line">                &#125;</span><br><span class="line">                comment.<span class="title function_">replaceWith</span>(childEle.<span class="property">ele</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Array</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(children)) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†è¿‡å</span></span><br><span class="line">        <span class="keyword">const</span> resChildren = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> children) &#123;</span><br><span class="line">            <span class="keyword">const</span> child = children[i];</span><br><span class="line">            <span class="comment">// Ref</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isRef</span>(child)) &#123;</span><br><span class="line">                <span class="comment">// æ³¨é‡Š</span></span><br><span class="line">                <span class="keyword">const</span> comment = <span class="variable language_">document</span>.<span class="title function_">createComment</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                <span class="comment">// ç›‘å¬å½±å“</span></span><br><span class="line">                <span class="title function_">watch</span>(child, <span class="keyword">async</span> (newEle, oldEle) =&gt; &#123;</span><br><span class="line">                    <span class="comment">// æ–°å…ƒç´ ä¸ºç©º</span></span><br><span class="line">                    <span class="keyword">if</span> (!newEle &amp;&amp; oldEle) &#123;</span><br><span class="line">                        <span class="comment">// Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> oldEleRes = <span class="keyword">await</span> oldEle;</span><br><span class="line">                            <span class="keyword">if</span> (oldEleRes) &#123;</span><br><span class="line">                                <span class="title function_">handleChangeElement</span>(newEle, oldEleRes, comment, subscribe, unsubscribe);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="title function_">handleChangeElement</span>(newEle, oldEle, comment, subscribe, unsubscribe);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// æ—§å…ƒç´ ä¸ºç©º</span></span><br><span class="line">                    <span class="keyword">if</span> (newEle &amp;&amp; !oldEle) &#123;</span><br><span class="line">                        <span class="comment">// Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> newEleRes = <span class="keyword">await</span> newEle;</span><br><span class="line">                            <span class="keyword">if</span> (newEleRes) &#123;</span><br><span class="line">                                <span class="title function_">handleChangeElement</span>(newEleRes, oldEle, comment, subscribe, unsubscribe);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="title function_">handleChangeElement</span>(newEle, oldEle, comment, subscribe, unsubscribe);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å­˜åœ¨</span></span><br><span class="line">                    <span class="keyword">if</span> (newEle &amp;&amp; oldEle) &#123;</span><br><span class="line">                        <span class="comment">// Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span> &amp;&amp; oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> newEleRes = <span class="keyword">await</span> newEle;</span><br><span class="line">                            <span class="keyword">const</span> oldEleRes = <span class="keyword">await</span> oldEle;</span><br><span class="line">                            <span class="comment">// å¤„ç†å…ƒç´ å˜åŒ–</span></span><br><span class="line">                            <span class="title function_">handleChangeElement</span>(newEleRes, oldEleRes, comment, subscribe, unsubscribe);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span> &amp;&amp; !(oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)) &#123;</span><br><span class="line">                            <span class="keyword">const</span> newEleRes = <span class="keyword">await</span> newEle;</span><br><span class="line">                            <span class="comment">// å¤„ç†å…ƒç´ å˜åŒ–</span></span><br><span class="line">                            <span class="title function_">handleChangeElement</span>(newEleRes, oldEle, comment, subscribe, unsubscribe);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (!(newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &amp;&amp; oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> oldEleRes = <span class="keyword">await</span> oldEle;</span><br><span class="line">                            <span class="comment">// å¤„ç†å…ƒç´ å˜åŒ–</span></span><br><span class="line">                            <span class="title function_">handleChangeElement</span>(newEle, oldEleRes, comment, subscribe, unsubscribe);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// é Promise</span></span><br><span class="line">                        <span class="keyword">if</span> (!(oldEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &amp;&amp; !(newEle <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)) &#123;</span><br><span class="line">                            <span class="comment">// å¤„ç†å…ƒç´ å˜åŒ–</span></span><br><span class="line">                            <span class="title function_">handleChangeElement</span>(newEle, oldEle, comment, subscribe, unsubscribe);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// Promise</span></span><br><span class="line">                <span class="keyword">if</span> (child.<span class="property">value</span> <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                    <span class="comment">// æ³¨é‡Š</span></span><br><span class="line">                    resChildren[i] = &#123; <span class="attr">ele</span>: comment &#125;;</span><br><span class="line">                    <span class="comment">// å¼‚æ­¥æ›¿æ¢</span></span><br><span class="line">                    child.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function">(<span class="params">childEle</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (childEle) &#123;</span><br><span class="line">                            <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = childEle;</span><br><span class="line">                            <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">                                subscribe &amp;&amp; <span class="title function_">subscribe</span>(childEle);</span><br><span class="line">                            &#125;</span><br><span class="line">                            comment.<span class="title function_">replaceWith</span>(childEle.<span class="property">ele</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// unPromise</span></span><br><span class="line">                <span class="keyword">if</span> (child.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> &#123; beforeMount, onMounted, ele &#125; = child.<span class="property">value</span>;</span><br><span class="line">                    resChildren[i] = &#123; ele, beforeMount, onMounted &#125;;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                resChildren[i] = &#123; <span class="attr">ele</span>: comment &#125;;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Promise</span></span><br><span class="line">            <span class="keyword">if</span> (child <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">                <span class="comment">// æ³¨é‡Š</span></span><br><span class="line">                <span class="keyword">const</span> comment = <span class="variable language_">document</span>.<span class="title function_">createComment</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                resChildren[i] = &#123; <span class="attr">ele</span>: comment &#125;;</span><br><span class="line">                <span class="comment">// å¼‚æ­¥æ›¿æ¢å…ƒç´ </span></span><br><span class="line">                child.<span class="title function_">then</span>(<span class="function">(<span class="params">childEle</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (childEle) &#123;</span><br><span class="line">                        <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = childEle;</span><br><span class="line">                        <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">                            subscribe &amp;&amp; <span class="title function_">subscribe</span>(childEle);</span><br><span class="line">                        &#125;</span><br><span class="line">                        comment.<span class="title function_">replaceWith</span>(childEle.<span class="property">ele</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ™®é€šå…ƒç´ </span></span><br><span class="line">            <span class="keyword">if</span> (child) &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123; beforeMount, onMounted, ele &#125; = child;</span><br><span class="line">                resChildren[i] = &#123; ele, beforeMount, onMounted &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> eles = resChildren.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (v.<span class="property">beforeMount</span> || v.<span class="property">onMounted</span>) &#123;</span><br><span class="line">                subscribe &amp;&amp; <span class="title function_">subscribe</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> v.<span class="property">ele</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// æ’å…¥å…ƒç´ </span></span><br><span class="line">        ele.<span class="title function_">appendChild</span>(<span class="title function_">createElementBlock</span>(eles));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ™®é€šå…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> (children) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = children;</span><br><span class="line">        <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">            subscribe &amp;&amp; <span class="title function_">subscribe</span>(children);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ’å…¥å…ƒç´ </span></span><br><span class="line">        ele.<span class="title function_">appendChild</span>(children.<span class="property">ele</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…ƒç´ å˜åŒ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">newEle</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">oldEle</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">comment</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleChangeElement</span>(<span class="params">newEle, oldEle, comment, subscribe, unsubscribe</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (newEle &amp;&amp; oldEle) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = newEle;</span><br><span class="line">        <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">            subscribe &amp;&amp; <span class="title function_">subscribe</span>(newEle);</span><br><span class="line">        &#125;</span><br><span class="line">        oldEle.<span class="property">ele</span>.<span class="title function_">replaceWith</span>(newEle.<span class="property">ele</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (newEle &amp;&amp; !oldEle) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; beforeMount, onMounted &#125; = newEle;</span><br><span class="line">        <span class="keyword">if</span> (beforeMount || onMounted) &#123;</span><br><span class="line">            subscribe &amp;&amp; <span class="title function_">subscribe</span>(newEle);</span><br><span class="line">        &#125;</span><br><span class="line">        comment.<span class="title function_">replaceWith</span>(newEle.<span class="property">ele</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!newEle &amp;&amp; oldEle) &#123;</span><br><span class="line">        unsubscribe &amp;&amp; <span class="title function_">unsubscribe</span>(oldEle);</span><br><span class="line">        oldEle.<span class="property">ele</span>.<span class="title function_">replaceWith</span>(comment);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºæ–‡å­—èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createTextNode</span>(<span class="params">text, options</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; onCreated, beforeCreat, onMounted, beforeMount &#125; = options || &#123;&#125;;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å‰</span></span><br><span class="line">    beforeCreat &amp;&amp; <span class="title function_">beforeCreat</span>();</span><br><span class="line">    <span class="comment">// Ref</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isRef</span>(text)) &#123;</span><br><span class="line">        <span class="comment">// ref</span></span><br><span class="line">        <span class="keyword">const</span> refVal = text;</span><br><span class="line">        <span class="comment">// å…ƒç´ </span></span><br><span class="line">        <span class="keyword">const</span> ele = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// è®¢é˜…å˜åŒ–</span></span><br><span class="line">        <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            ele.<span class="property">data</span> = refVal.<span class="property">value</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// åˆ›å»ºå…ƒç´ å</span></span><br><span class="line">        onCreated &amp;&amp; <span class="title function_">onCreated</span>();</span><br><span class="line">        <span class="keyword">return</span> &#123; ele, beforeMount, onMounted &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ å</span></span><br><span class="line">    onCreated &amp;&amp; <span class="title function_">onCreated</span>();</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">ele</span>: <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="title class_">String</span>(text)), beforeMount, onMounted &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æŒ‚è½½å…ƒç´ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">eleOptions</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">parent</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mountElement</span>(<span class="params">eleOptions, parent = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; ele, beforeMount, onMounted &#125; = eleOptions;</span><br><span class="line">    <span class="keyword">if</span> (ele) &#123;</span><br><span class="line">        <span class="comment">// è§¦å‘æŒ‚è½½å‰äº‹ä»¶</span></span><br><span class="line">        beforeMount &amp;&amp; <span class="title function_">beforeMount</span>();</span><br><span class="line">        parent.<span class="title function_">appendChild</span>(ele);</span><br><span class="line">        <span class="comment">// æŒ‚åœ¨å</span></span><br><span class="line">        onMounted &amp;&amp; <span class="title function_">onMounted</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é€‰æ‹©å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">selector</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">$$</span>(<span class="params">selector, parent = <span class="variable language_">document</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(parent.<span class="title function_">querySelectorAll</span>(selector));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¼‚æ­¥é€‰æ‹©å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">selector</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">$_</span>(<span class="params">selector, parent = <span class="variable language_">document</span>, timeout</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> selectors = <span class="title class_">Array</span>.<span class="title function_">from</span>(parent.<span class="title function_">querySelectorAll</span>(selector));</span><br><span class="line">            <span class="comment">// å­˜åœ¨å…ƒç´ </span></span><br><span class="line">            <span class="keyword">if</span> (selectors.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                <span class="title function_">resolve</span>(selectors);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">10</span>);</span><br><span class="line">        <span class="comment">// è¶…æ—¶</span></span><br><span class="line">        <span class="keyword">if</span> (timeout) &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                <span class="title function_">resolve</span>([]);</span><br><span class="line">            &#125;, timeout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºå…ƒç´ å—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">eles</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createElementBlock</span>(<span class="params">eles</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> eles) &#123;</span><br><span class="line">        fragment.<span class="title function_">appendChild</span>(eles[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fragment;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å°æ—¥å¿—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">...text</span>) &#123;</span><br><span class="line">    <span class="title function_">printColor</span>(<span class="string">&#x27;dodgerblue&#x27;</span>, ...text);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å°é”™è¯¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">error</span>(<span class="params">...text</span>) &#123;</span><br><span class="line">    <span class="title function_">printColor</span>(<span class="string">&#x27;red&#x27;</span>, ...text);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å°ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">info</span>(<span class="params">...text</span>) &#123;</span><br><span class="line">    <span class="title function_">printColor</span>(<span class="string">&#x27;yellow&#x27;</span>, ...text);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å°é¢œè‰²</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">color</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printColor</span>(<span class="params">color, ...text</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> textFormatted = text</span><br><span class="line">        .<span class="title function_">map</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> (<span class="keyword">typeof</span> t === <span class="string">&#x27;object&#x27;</span> ? <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(t) : <span class="title class_">String</span>(t)))</span><br><span class="line">        .<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`%c[<span class="subst">$&#123;formatDateTime()&#125;</span>] %c<span class="subst">$&#123;textFormatted&#125;</span>`</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">`color: <span class="subst">$&#123;color&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> htmlè¿›åº¦æ¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">title</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">percent</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getProgressHTML</span>(<span class="params">title, percent</span>) &#123;</span><br><span class="line">    <span class="comment">// html</span></span><br><span class="line">    <span class="keyword">const</span> progressHTML = <span class="string">`&lt;div</span></span><br><span class="line"><span class="string">    style=&quot;</span></span><br><span class="line"><span class="string">      display: flex;</span></span><br><span class="line"><span class="string">      align-items: center;</span></span><br><span class="line"><span class="string">      justify-content: space-between;</span></span><br><span class="line"><span class="string">      padding: 1px 0;</span></span><br><span class="line"><span class="string">    &quot;</span></span><br><span class="line"><span class="string">  &gt;</span></span><br><span class="line"><span class="string">    &lt;span&gt;<span class="subst">$&#123;title&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">    &lt;span&gt;<span class="subst">$&#123;getHighlightHTML(percent)&#125;</span> %&lt;/span&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;div</span></span><br><span class="line"><span class="string">    style=&quot;</span></span><br><span class="line"><span class="string">      background: white;</span></span><br><span class="line"><span class="string">      border-radius: 10px;</span></span><br><span class="line"><span class="string">      height: 10px;</span></span><br><span class="line"><span class="string">      border: 1px solid #eee;</span></span><br><span class="line"><span class="string">      flex-shrink: 1;</span></span><br><span class="line"><span class="string">    &quot;</span></span><br><span class="line"><span class="string">  &gt;</span></span><br><span class="line"><span class="string">    &lt;div</span></span><br><span class="line"><span class="string">      style=&quot;</span></span><br><span class="line"><span class="string">        background: linear-gradient(to left, #188fff80, #1890ff);</span></span><br><span class="line"><span class="string">        height: 100%;</span></span><br><span class="line"><span class="string">        width: <span class="subst">$&#123;percent&#125;</span>%;</span></span><br><span class="line"><span class="string">        border-radius: 10px;</span></span><br><span class="line"><span class="string">      &quot;</span></span><br><span class="line"><span class="string">    &gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;`</span>;</span><br><span class="line">    <span class="keyword">return</span> progressHTML;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> htmlé«˜äº®æ–‡æœ¬</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">text</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getHighlightHTML</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="comment">// html</span></span><br><span class="line">    <span class="keyword">const</span> highlightHTML = <span class="string">`&lt;span style=&quot;color: #1890ff&quot;&gt;<span class="subst">$&#123;text&#125;</span>&lt;/span&gt;`</span>;</span><br><span class="line">    <span class="keyword">return</span> highlightHTML;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> äºŒç»´ç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">src</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getImgHTML</span>(<span class="params">src</span>) &#123;</span><br><span class="line">    <span class="comment">// å›¾ç‰‡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">     &lt;div style=&quot;padding: 10px 0&quot;&gt;</span></span><br><span class="line"><span class="string">     &lt;div</span></span><br><span class="line"><span class="string">       style=&quot;</span></span><br><span class="line"><span class="string">         display: flex;</span></span><br><span class="line"><span class="string">         justify-content: center;</span></span><br><span class="line"><span class="string">         align-items: center;</span></span><br><span class="line"><span class="string">         padding: 20px;</span></span><br><span class="line"><span class="string">         background: #f7f7f7;</span></span><br><span class="line"><span class="string">         border-radius: 10px;</span></span><br><span class="line"><span class="string">       &quot;</span></span><br><span class="line"><span class="string">     &gt;</span></span><br><span class="line"><span class="string">         &lt;img src=&quot;<span class="subst">$&#123;src&#125;</span>&quot; style=&quot;width:200px;height:200px;&quot; /&gt;</span></span><br><span class="line"><span class="string">       &lt;/div&gt;</span></span><br><span class="line"><span class="string">     &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºæ¨¡æ€æ¡†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> options é€‰é¡¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createModal</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> &#123; title, subTitle = <span class="string">&#x27;&#x27;</span>, to = <span class="string">&#x27;ç”¨æˆ·&#x27;</span>, content, type, <span class="keyword">from</span> = <span class="string">&#x27;tech-study.js&#x27;</span>, &#125; = options;</span><br><span class="line">    <span class="comment">// å†…å®¹æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">let</span> contentText = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(content)) &#123;</span><br><span class="line">        contentText = content.<span class="title function_">map</span>(<span class="function">(<span class="params">ct</span>) =&gt;</span> <span class="string">`&lt;div&gt;<span class="subst">$&#123;ct&#125;</span>&lt;/div&gt;`</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        contentText = content;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">const</span> dateTime = <span class="title function_">formatDateTime</span>();</span><br><span class="line">    <span class="comment">// ç±»å‹html</span></span><br><span class="line">    <span class="keyword">let</span> typeHTML = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (type &amp;&amp; type.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (type === <span class="string">&#x27;info&#x27;</span>) &#123;</span><br><span class="line">            typeHTML = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;svg</span></span><br><span class="line"><span class="string">       viewBox=&quot;64 64 896 896&quot;</span></span><br><span class="line"><span class="string">       style=&quot;color: #1890ff; width: 18px; height: 18px&quot;</span></span><br><span class="line"><span class="string">       fill=&quot;currentColor&quot;</span></span><br><span class="line"><span class="string">       aria-hidden=&quot;true&quot;</span></span><br><span class="line"><span class="string">     &gt;</span></span><br><span class="line"><span class="string">       &lt;path</span></span><br><span class="line"><span class="string">         d=&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z&quot;</span></span><br><span class="line"><span class="string">       &gt;&lt;/path&gt;</span></span><br><span class="line"><span class="string">     &lt;/svg&gt;`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (type === <span class="string">&#x27;warn&#x27;</span>) &#123;</span><br><span class="line">            typeHTML = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;svg</span></span><br><span class="line"><span class="string">        viewBox=&quot;64 64 896 896&quot;</span></span><br><span class="line"><span class="string">        style=&quot;color: #faad14; width: 18px; height: 18px&quot;</span></span><br><span class="line"><span class="string">        fill=&quot;currentColor&quot;</span></span><br><span class="line"><span class="string">        aria-hidden=&quot;true&quot;</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">        &lt;path</span></span><br><span class="line"><span class="string">          d=&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z&quot;</span></span><br><span class="line"><span class="string">        &gt;&lt;/path&gt;</span></span><br><span class="line"><span class="string">      &lt;/svg&gt;</span></span><br><span class="line"><span class="string">      `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (type === <span class="string">&#x27;success&#x27;</span>) &#123;</span><br><span class="line">            typeHTML = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;svg</span></span><br><span class="line"><span class="string">        viewBox=&quot;64 64 896 896&quot;</span></span><br><span class="line"><span class="string">        style=&quot;color: #52c41a; width: 18px; height: 18px&quot;</span></span><br><span class="line"><span class="string">        fill=&quot;currentColor&quot;</span></span><br><span class="line"><span class="string">        aria-hidden=&quot;true&quot;</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">        &lt;path</span></span><br><span class="line"><span class="string">          d=&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z&quot;</span></span><br><span class="line"><span class="string">        &gt;&lt;/path&gt;</span></span><br><span class="line"><span class="string">      &lt;/svg&gt;</span></span><br><span class="line"><span class="string">      `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (type === <span class="string">&#x27;fail&#x27;</span>) &#123;</span><br><span class="line">            typeHTML = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;svg</span></span><br><span class="line"><span class="string">        viewBox=&quot;64 64 896 896&quot;</span></span><br><span class="line"><span class="string">        style=&quot;color: #ff4d4f; width: 18px; height: 18px&quot;</span></span><br><span class="line"><span class="string">        fill=&quot;currentColor&quot;</span></span><br><span class="line"><span class="string">        aria-hidden=&quot;true&quot;</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">        &lt;path</span></span><br><span class="line"><span class="string">          d=&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z&quot;</span></span><br><span class="line"><span class="string">        &gt;&lt;/path&gt;</span></span><br><span class="line"><span class="string">      &lt;/svg&gt;</span></span><br><span class="line"><span class="string">      `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç±»å‹</span></span><br><span class="line">    <span class="keyword">const</span> typeWrap = <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;span</span></span><br><span class="line"><span class="string">    style=&quot;</span></span><br><span class="line"><span class="string">      padding-right: 5px;</span></span><br><span class="line"><span class="string">      display: flex;</span></span><br><span class="line"><span class="string">      justify-content: center;</span></span><br><span class="line"><span class="string">      align-items: center;</span></span><br><span class="line"><span class="string">    &quot;</span></span><br><span class="line"><span class="string">  &gt;</span></span><br><span class="line"><span class="string">    <span class="subst">$&#123;typeHTML&#125;</span></span></span><br><span class="line"><span class="string">  &lt;/span&gt;</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line">    <span class="comment">// åŸºç¡€html</span></span><br><span class="line">    <span class="keyword">const</span> baseHTML = <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;div</span></span><br><span class="line"><span class="string">  style=&quot;</span></span><br><span class="line"><span class="string">    padding: 5px;</span></span><br><span class="line"><span class="string">    display: flex;</span></span><br><span class="line"><span class="string">    justify-content: center;</span></span><br><span class="line"><span class="string">    align-items: center;</span></span><br><span class="line"><span class="string">  &quot;</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">  &lt;div</span></span><br><span class="line"><span class="string">    style=&quot;</span></span><br><span class="line"><span class="string">      background: #ffffff;</span></span><br><span class="line"><span class="string">      box-shadow: 1px 1px 8px -1px #dadada;</span></span><br><span class="line"><span class="string">      padding: 5px 10px;</span></span><br><span class="line"><span class="string">      border-radius: 5px;</span></span><br><span class="line"><span class="string">      width: 100%;</span></span><br><span class="line"><span class="string">    &quot;</span></span><br><span class="line"><span class="string">  &gt;</span></span><br><span class="line"><span class="string">    &lt;div</span></span><br><span class="line"><span class="string">      style=&quot;</span></span><br><span class="line"><span class="string">        display: flex;</span></span><br><span class="line"><span class="string">        justify-content: space-between;</span></span><br><span class="line"><span class="string">        padding: 5px;</span></span><br><span class="line"><span class="string">        border-bottom: 1px solid #eee;</span></span><br><span class="line"><span class="string">      &quot;</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">      &lt;div style=&quot;display: flex; justify-content: center; align-items: center&quot;&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;typeWrap&#125;</span></span></span><br><span class="line"><span class="string">        &lt;span style=&quot;padding-left: 5px; font-size: 18px&quot;&gt;<span class="subst">$&#123;title&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;div style=&quot;font-size: 16px; color: #999&quot;&gt;<span class="subst">$&#123;subTitle&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div style=&quot;padding:10px 5px; font-size: 16px; min-height: 80px&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;getHighlightHTML(to)&#125;</span>, ä½ å¥½!</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;div style=&quot;line-height: 28px;&quot;&gt;<span class="subst">$&#123;contentText&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div</span></span><br><span class="line"><span class="string">      style=&quot;</span></span><br><span class="line"><span class="string">        font-size: 14px;</span></span><br><span class="line"><span class="string">        padding: 5px;</span></span><br><span class="line"><span class="string">        border-top: 1px solid #eee;</span></span><br><span class="line"><span class="string">        display: flex;</span></span><br><span class="line"><span class="string">        justify-content: space-between;</span></span><br><span class="line"><span class="string">        align-items: center;</span></span><br><span class="line"><span class="string">      &quot;</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">      &lt;div style=&quot;color: #999&quot;&gt;<span class="subst">$&#123;dateTime&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;span&gt;æ¥è‡ª&lt;/span&gt;</span></span><br><span class="line"><span class="string">        &lt;span style=&quot;color: #1890ff; padding-left: 1px&quot;&gt;<span class="subst">$&#123;<span class="keyword">from</span>&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line">    <span class="keyword">return</span> baseHTML;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¨é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">pushMessage</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// é€‰é¡¹</span></span><br><span class="line">    <span class="keyword">const</span> &#123; title, content, template, fromToken, toToken &#125; = options;</span><br><span class="line">    <span class="comment">// æ¨é€</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushPlus</span>(fromToken, title, content, template, toToken);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¨é€æ¨¡æ€æ¡†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">pushModal</span>(<span class="params">options, fromToken, toToken</span>) &#123;</span><br><span class="line">    <span class="comment">// html</span></span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">createModal</span>(options);</span><br><span class="line">    <span class="comment">// æ¨é€</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushMessage</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;æ¶ˆæ¯æç¤º&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: html,</span><br><span class="line">        fromToken,</span><br><span class="line">        toToken,</span><br><span class="line">        <span class="attr">template</span>: <span class="string">&#x27;html&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (res &amp;&amp; res.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºéšæœºç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> bounds èŒƒå›´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createRandomPoint</span>(<span class="params">bounds</span>) &#123;</span><br><span class="line">    <span class="comment">// èŒƒå›´</span></span><br><span class="line">    <span class="keyword">const</span> &#123; x, y, width, height &#125; = bounds;</span><br><span class="line">    <span class="comment">// æ¨ªåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> randX = x + <span class="title class_">Math</span>.<span class="title function_">random</span>() * width * <span class="number">0.5</span> + width * <span class="number">0.25</span>;</span><br><span class="line">    <span class="comment">// çºµåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> randY = y + <span class="title class_">Math</span>.<span class="title function_">random</span>() * height * <span class="number">0.5</span> + height * <span class="number">0.25</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">x</span>: randX,</span><br><span class="line">        <span class="attr">y</span>: randY,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”Ÿæˆéšæœºè·¯å¾„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">start</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">end</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">steps</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createRandomPath</span>(<span class="params">start, end, steps</span>) &#123;</span><br><span class="line">    <span class="comment">// æœ€å°æ°´å¹³å¢é‡</span></span><br><span class="line">    <span class="keyword">const</span> minDeltaX = (end.<span class="property">x</span> - start.<span class="property">x</span>) / steps;</span><br><span class="line">    <span class="comment">// æœ€å¤§å‚ç›´å¢é‡</span></span><br><span class="line">    <span class="keyword">const</span> maxDeltaY = (end.<span class="property">y</span> - start.<span class="property">y</span>) / steps;</span><br><span class="line">    <span class="keyword">const</span> path = [];</span><br><span class="line">    <span class="comment">// å¼€å§‹èŠ‚ç‚¹</span></span><br><span class="line">    path.<span class="title function_">push</span>(start);</span><br><span class="line">    <span class="comment">// æ’å…¥ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; steps; i++) &#123;</span><br><span class="line">        <span class="comment">// æ¨ªåæ ‡</span></span><br><span class="line">        <span class="keyword">const</span> x = path[i].<span class="property">x</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span> + minDeltaX;</span><br><span class="line">        <span class="comment">// çºµåæ ‡</span></span><br><span class="line">        <span class="keyword">const</span> y = path[i].<span class="property">y</span> +</span><br><span class="line">            <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>(-<span class="number">1</span>, ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">2</span> + <span class="number">1</span>)) +</span><br><span class="line">            maxDeltaY;</span><br><span class="line">        path.<span class="title function_">push</span>(&#123;</span><br><span class="line">            x,</span><br><span class="line">            y,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> path;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºæ•°å­—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateNumAsChar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>)).<span class="title function_">toString</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºå¤§å†™å­—æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateUpperAsChar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">26</span>) + <span class="number">65</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºå°å†™å­—æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateLowerAsChar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">26</span>) + <span class="number">97</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºæ··åˆå­—ç¬¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">length</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateMix</span>(<span class="params">length = <span class="number">6</span></span>) &#123;</span><br><span class="line">    <span class="comment">// éšæœºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">const</span> randomText = [];</span><br><span class="line">    <span class="comment">// ç”Ÿæˆå™¨</span></span><br><span class="line">    <span class="keyword">const</span> typeGenerator = [</span><br><span class="line">        generateNumAsChar,</span><br><span class="line">        generateUpperAsChar,</span><br><span class="line">        generateLowerAsChar,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">if</span> (length) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="comment">// éšæœºä½ç½®</span></span><br><span class="line">            <span class="keyword">const</span> randomIndex = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * typeGenerator.<span class="property">length</span>);</span><br><span class="line">            randomText.<span class="title function_">push</span>(typeGenerator[randomIndex]());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> randomText.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´æ•°å­—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">num</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatDateNum</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">10</span> ? <span class="string">`0<span class="subst">$&#123;num&#125;</span>`</span> : <span class="string">`<span class="subst">$&#123;num&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">time</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * formatDateTime() -&gt; &quot;2022-09-01 08:00:00&quot;</span></span><br><span class="line"><span class="comment"> * formatDateTime(new Date()) -&gt; &quot;2022-09-01 08:00:00&quot;</span></span><br><span class="line"><span class="comment"> * formatDateTime(Date.now()) -&gt; &quot;2022-09-01 08:00:00&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatDateTime</span>(<span class="params">time = <span class="built_in">Date</span>.now()</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(time);</span><br><span class="line">    <span class="keyword">const</span> s = date.<span class="title function_">getSeconds</span>();</span><br><span class="line">    <span class="keyword">const</span> min = date.<span class="title function_">getMinutes</span>();</span><br><span class="line">    <span class="keyword">const</span> h = date.<span class="title function_">getHours</span>();</span><br><span class="line">    <span class="keyword">const</span> d = date.<span class="title function_">getDate</span>();</span><br><span class="line">    <span class="keyword">const</span> m = date.<span class="title function_">getMonth</span>() + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> y = date.<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="comment">// æ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">const</span> dateText = [y, m, d].<span class="title function_">map</span>(formatDateNum).<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="comment">// æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> timeText = [h, min, s].<span class="title function_">map</span>(formatDateNum).<span class="title function_">join</span>(<span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">    <span class="comment">// æ—¥æœŸæ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> dateTimeText = <span class="string">`<span class="subst">$&#123;dateText&#125;</span> <span class="subst">$&#123;timeText&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">return</span> dateTimeText;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ ¼å¼åŒ–æ—¶é—´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">time</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * formatTime() -&gt; &quot;08:00:00&quot;</span></span><br><span class="line"><span class="comment"> * formatTime(new Date()) -&gt; &quot;08:00:00&quot;</span></span><br><span class="line"><span class="comment"> * formatTime(Date.now()) -&gt; &quot;08:00:00&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">formatTime</span> = (<span class="params">time = <span class="built_in">Date</span>.now()</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(time);</span><br><span class="line">    <span class="keyword">const</span> s = date.<span class="title function_">getSeconds</span>();</span><br><span class="line">    <span class="keyword">const</span> min = date.<span class="title function_">getMinutes</span>();</span><br><span class="line">    <span class="keyword">const</span> h = date.<span class="title function_">getHours</span>();</span><br><span class="line">    <span class="comment">// æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> timeText = [h, min, s].<span class="title function_">map</span>(formatDateNum).<span class="title function_">join</span>(<span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> timeText;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ—¶é—´å·²è¿‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">hour</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">minute</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isLate</span>(<span class="params">&#123; hour, minute &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> h = date.<span class="title function_">getHours</span>();</span><br><span class="line">    <span class="keyword">const</span> min = date.<span class="title function_">getMinutes</span>();</span><br><span class="line">    <span class="keyword">return</span> h &gt; hour || (h === hour &amp;&amp; min &gt;= minute);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ—¶é—´å·²è¿‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">hour</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">minute</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isNow</span>(<span class="params">&#123; hour, minute &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> h = date.<span class="title function_">getHours</span>();</span><br><span class="line">    <span class="keyword">const</span> min = date.<span class="title function_">getMinutes</span>();</span><br><span class="line">    <span class="keyword">const</span> s = date.<span class="title function_">getSeconds</span>();</span><br><span class="line">    <span class="keyword">return</span> h === hour &amp;&amp; min === minute &amp;&amp; s === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å·¥å…·å‡½æ•° */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®cookie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">value</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">expires</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">name, value, expires, domain</span>) &#123;</span><br><span class="line">    <span class="comment">// å½“å‰æ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="comment">// è¿‡æœŸæ—¥æœŸ</span></span><br><span class="line">    date.<span class="title function_">setTime</span>(date.<span class="title function_">getTime</span>() + expires);</span><br><span class="line">    <span class="comment">// è®¾ç½®cookie</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">`<span class="subst">$&#123;name&#125;</span>=<span class="subst">$&#123;value&#125;</span>;expires=<span class="subst">$&#123;date.toUTCString()&#125;</span>;path=/;domain=<span class="subst">$&#123;domain&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–cookie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCookie</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ‰€æœ‰cookie</span></span><br><span class="line">    <span class="keyword">const</span> strCookies = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br><span class="line">    <span class="comment">// æˆªå–å˜æˆcookieæ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> cookieText = strCookies.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="comment">// å¾ªç¯æ¯ä¸ªcookie</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> cookieText) &#123;</span><br><span class="line">        <span class="comment">// å°†cookieæˆªå–æˆä¸¤éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">const</span> item = cookieText[i].<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ¤æ–­cookieçš„name æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">if</span> (item[<span class="number">0</span>].<span class="title function_">trim</span>() === name) &#123;</span><br><span class="line">            <span class="keyword">return</span> item[<span class="number">1</span>].<span class="title function_">trim</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ é™¤cookie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delCookie</span>(<span class="params">name, domain</span>) &#123;</span><br><span class="line">    <span class="comment">// å­˜åœ¨cookie</span></span><br><span class="line">    <span class="keyword">const</span> value = <span class="title function_">getCookie</span>(name);</span><br><span class="line">    <span class="keyword">if</span> (value !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="title function_">setCookie</span>(name, <span class="string">&#x27;&#x27;</span>, -<span class="number">1</span>, domain);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é˜²æŠ–</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">delay</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">callback, delay</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timer = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (timer !== -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">        &#125;</span><br><span class="line">        timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            callback.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">        &#125;, delay);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ¤æ–­æ˜¯å¦ä¸ºç§»åŠ¨ç«¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hasMobile</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> isMobile = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (navigator.<span class="property">userAgent</span>.<span class="title function_">match</span>(<span class="regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>)) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;ç§»åŠ¨ç«¯&#x27;</span>);</span><br><span class="line">        isMobile = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &lt; <span class="number">800</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;å°å°ºå¯¸è®¾å¤‡ç«¯&#x27;</span>);</span><br><span class="line">        isMobile = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isMobile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­‰å¾…æ—¶é—´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">time</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="comment">// å»¶æ—¶</span></span><br><span class="line">    <span class="keyword">let</span> timeDelay = <span class="title class_">Number</span>(time);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(timeDelay)) &#123;</span><br><span class="line">        timeDelay = <span class="number">1000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    timeDelay += <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">500</span> - <span class="number">250</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="literal">undefined</span>);</span><br><span class="line">        &#125;, timeDelay);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æš‚åœå­¦ä¹ é”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">studyPauseLock</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">const</span> pauseStudy = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>) || <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (pauseStudy) &#123;</span><br><span class="line">            <span class="keyword">const</span> doing = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// æš‚åœ</span></span><br><span class="line">                <span class="keyword">const</span> pauseStudy = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>) || <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">if</span> (!pauseStudy) &#123;</span><br><span class="line">                    <span class="comment">// åœæ­¢å®šæ—¶å™¨</span></span><br><span class="line">                    <span class="built_in">clearInterval</span>(doing);</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;å­¦ä¹ ç­‰å¾…ç»“æŸ!&#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (callback &amp;&amp; callback <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">                        <span class="title function_">callback</span>(<span class="literal">true</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (callback &amp;&amp; callback <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">                    <span class="title function_">callback</span>(<span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;å­¦ä¹ ç­‰å¾…...&#x27;</span>);</span><br><span class="line">            &#125;, <span class="number">500</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åŠ è½½</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">match</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">load</span>(<span class="params">match, callback</span>) &#123;</span><br><span class="line">    <span class="comment">// é“¾æ¥</span></span><br><span class="line">    <span class="keyword">const</span> &#123; href &#125; = <span class="variable language_">window</span>.<span class="property">location</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (match <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">            <span class="title function_">match</span>(href) &amp;&amp; <span class="title function_">callback</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¸ƒå°”</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> match === <span class="string">&#x27;boolean&#x27;</span>) &#123;</span><br><span class="line">            match &amp;&amp; <span class="title function_">callback</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å­—ç¬¦æ­£åˆ™</span></span><br><span class="line">        <span class="keyword">if</span> (href.<span class="title function_">match</span>(match)) &#123;</span><br><span class="line">            <span class="title function_">callback</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å˜é‡ */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é“¾æ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> href = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä»»åŠ¡é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> taskConfig = <span class="title function_">reactive</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;ç™»å½•&#x27;</span>,</span><br><span class="line">        <span class="attr">currentScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">dayMaxScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">need</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">status</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">tip</span>: <span class="string">&#x27;æ¯æ—¥é¦–æ¬¡ç™»å½•ç§¯1åˆ†ã€‚&#x27;</span>,</span><br><span class="line">        <span class="attr">percent</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">immutable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">TaskType</span>.<span class="property">LOGIN</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;æ–‡ç« é€‰è¯»&#x27;</span>,</span><br><span class="line">        <span class="attr">currentScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">dayMaxScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">need</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">status</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">tip</span>: <span class="string">&#x27;æ¯æœ‰æ•ˆé˜…è¯»ä¸€ç¯‡æ–‡ç« ç§¯1åˆ†ï¼Œä¸Šé™6åˆ†ã€‚æœ‰æ•ˆé˜…è¯»æ–‡ç« ç´¯è®¡1åˆ†é’Ÿç§¯1åˆ†ï¼Œä¸Šé™6åˆ†ã€‚æ¯æ—¥ä¸Šé™ç§¯12åˆ†ã€‚&#x27;</span>,</span><br><span class="line">        <span class="attr">percent</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">immutable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">TaskType</span>.<span class="property">READ</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;è§†å¬å­¦ä¹ &#x27;</span>,</span><br><span class="line">        <span class="attr">currentScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">dayMaxScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">need</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">status</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">tip</span>: <span class="string">&#x27;æ¯æœ‰æ•ˆä¸€ä¸ªéŸ³é¢‘æˆ–è§‚çœ‹ä¸€ä¸ªè§†é¢‘ç§¯1åˆ†ï¼Œä¸Šé™6åˆ†ã€‚æœ‰æ•ˆæ”¶å¬éŸ³é¢‘æˆ–è§‚çœ‹è§†é¢‘ç´¯è®¡1åˆ†é’Ÿç§¯1åˆ†ï¼Œä¸Šé™6åˆ†ã€‚æ¯æ—¥ä¸Šé™ç§¯12åˆ†ã€‚&#x27;</span>,</span><br><span class="line">        <span class="attr">percent</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">immutable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">TaskType</span>.<span class="property">WATCH</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;æ¯æ—¥ç­”é¢˜&#x27;</span>,</span><br><span class="line">        <span class="attr">currentScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">dayMaxScore</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">need</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">status</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">tip</span>: <span class="string">&#x27;æ¯ç»„ç­”é¢˜æ¯ç­”å¯¹1é“ç§¯1åˆ†ã€‚æ¯æ—¥ä¸Šé™ç§¯5åˆ†ã€‚&#x27;</span>,</span><br><span class="line">        <span class="attr">percent</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">score</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">immutable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">]);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> settings = <span class="title function_">reactive</span>([<span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>]);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ€»åˆ†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> totalScore = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å½“å¤©åˆ†æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> todayScore = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> userinfo = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">nick</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">avatar</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¿›åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> taskStatus = <span class="title function_">ref</span>(<span class="title class_">TaskStatusType</span>.<span class="property">LOADING</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­”é¢˜æš‚åœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> examPause = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> login = <span class="title function_">ref</span>(!!<span class="title function_">getCookie</span>(<span class="string">&#x27;token&#x27;</span>));</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> çª—å£id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> id = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å®šæ—¶åˆ·æ–°åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> scheduleList = <span class="title function_">shallowReactive</span>([]);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¨é€token</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> pushToken = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°æ¬¡æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> refreshCount = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> çª—å£å…³é—­</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> frame = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">exist</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">closed</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">ele</span>: <span class="literal">undefined</span>,</span><br><span class="line">    <span class="attr">src</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é¡µé¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="title function_">ref</span>(<span class="literal">undefined</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¼€å§‹ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> loginQRCodeShow = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æœ€å¤§é€‰è¯»æ—¶é•¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> maxRead = <span class="title function_">ref</span>(<span class="number">100</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æœ€å¤§è§†å¬æ—¶é•¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> maxWatch = <span class="title function_">ref</span>(<span class="number">120</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¿è¡Œå…¶ä»–ä»»åŠ¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> running = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä¸»é¢˜è‰²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> themeColor = <span class="title function_">ref</span>(<span class="string">&#x27;#fa3333&#x27;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>  è€ƒè¯•ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ExamType</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">ExamType</span>) &#123;</span><br><span class="line">    <span class="title class_">ExamType</span>[<span class="title class_">ExamType</span>[<span class="string">&quot;PRACTICE&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;PRACTICE&quot;</span>;</span><br><span class="line">    <span class="title class_">ExamType</span>[<span class="title class_">ExamType</span>[<span class="string">&quot;PAPER&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;PAPER&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">ExamType</span> || (<span class="title class_">ExamType</span> = &#123;&#125;));</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–ç­”é¢˜æŒ‰é’®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getNextButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ç­”é¢˜æŒ‰é’®</span></span><br><span class="line">            <span class="keyword">const</span> nextAll = $$(<span class="string">&#x27;.ant-btn&#x27;</span>).<span class="title function_">filter</span>(<span class="function">(<span class="params">next</span>) =&gt;</span> next.<span class="property">innerText</span>);</span><br><span class="line">            <span class="keyword">if</span> (nextAll.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="comment">// åœæ­¢å®šæ—¶å™¨</span></span><br><span class="line">                <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                <span class="keyword">if</span> (nextAll.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="title function_">resolve</span>(nextAll[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">resolve</span>(nextAll[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†æ»‘åŠ¨éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleSlideVerify</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">async</span> (resolve) =&gt; &#123;</span><br><span class="line">        <span class="comment">// æ»‘åŠ¨éªŒè¯</span></span><br><span class="line">        <span class="keyword">const</span> mask = $$(<span class="string">&#x27;#nc_mask&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (mask &amp;&amp; <span class="title function_">getComputedStyle</span>(mask).<span class="property">display</span> !== <span class="string">&#x27;none&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">&#x27;ç­‰å¾…æ»‘åŠ¨éªŒè¯&#x27;</span>);</span><br><span class="line">            <span class="comment">// æé«˜å±‚çº§</span></span><br><span class="line">            mask.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="string">&#x27;999&#x27;</span>;</span><br><span class="line">            <span class="comment">// è½¨é“</span></span><br><span class="line">            <span class="keyword">const</span> track = (<span class="keyword">await</span> $_(<span class="string">&#x27;.nc_scale&#x27;</span>, <span class="literal">undefined</span>, <span class="number">3000</span>))[<span class="number">0</span>];</span><br><span class="line">            <span class="comment">// æ»‘å—</span></span><br><span class="line">            <span class="keyword">const</span> slide = (<span class="keyword">await</span> $_(<span class="string">&#x27;.btn_slide&#x27;</span>, <span class="literal">undefined</span>, <span class="number">3000</span>))[<span class="number">0</span>];</span><br><span class="line">            <span class="comment">// å»¶æ—¶</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">2000</span>);</span><br><span class="line">            <span class="comment">// çŸ©å½¢èŒƒå›´</span></span><br><span class="line">            <span class="keyword">const</span> rectTrack = track.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">            <span class="comment">// çŸ©å½¢èŒƒå›´</span></span><br><span class="line">            <span class="keyword">const</span> rectSlide = slide.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">            <span class="comment">// çª—å£</span></span><br><span class="line">            <span class="keyword">const</span> <span class="variable language_">window</span> = unsafeWindow;</span><br><span class="line">            <span class="comment">// èŒƒå›´å†…éšæœºèµ·ç‚¹</span></span><br><span class="line">            <span class="keyword">const</span> start = <span class="title function_">createRandomPoint</span>(rectSlide);</span><br><span class="line">            <span class="comment">// ç»ˆç‚¹</span></span><br><span class="line">            <span class="keyword">const</span> end = &#123;</span><br><span class="line">                <span class="attr">x</span>: rectTrack.<span class="property">x</span> + rectTrack.<span class="property">width</span>,</span><br><span class="line">                <span class="attr">y</span>: rectTrack.<span class="property">y</span> + rectTrack.<span class="property">height</span> / <span class="number">2</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// è·¯å¾„</span></span><br><span class="line">            <span class="keyword">const</span> path = <span class="title function_">createRandomPath</span>(start, end, <span class="number">10</span>);</span><br><span class="line">            <span class="comment">// ç§»åŠ¨ç«¯</span></span><br><span class="line">            <span class="keyword">const</span> mobile = <span class="title function_">hasMobile</span>();</span><br><span class="line">            <span class="keyword">if</span> (mobile) &#123;</span><br><span class="line">                slide.<span class="property">style</span>.<span class="property">touchAction</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">                <span class="keyword">const</span> touchstartTouch = <span class="keyword">new</span> <span class="title class_">Touch</span>(&#123;</span><br><span class="line">                    <span class="attr">identifier</span>: <span class="number">0</span>,</span><br><span class="line">                    <span class="attr">target</span>: slide,</span><br><span class="line">                    <span class="attr">clientX</span>: path[<span class="number">0</span>].<span class="property">x</span>,</span><br><span class="line">                    <span class="attr">clientY</span>: path[<span class="number">0</span>].<span class="property">y</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">const</span> touchstartList = [touchstartTouch];</span><br><span class="line">                <span class="comment">// å¼€å§‹è§¦æ‘¸</span></span><br><span class="line">                <span class="keyword">const</span> touchstart = <span class="keyword">new</span> <span class="title class_">TouchEvent</span>(<span class="string">&#x27;touchstart&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">targetTouches</span>: touchstartList,</span><br><span class="line">                    <span class="attr">touches</span>: touchstartList,</span><br><span class="line">                    <span class="attr">changedTouches</span>: touchstartList,</span><br><span class="line">                    <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                slide.<span class="title function_">dispatchEvent</span>(touchstart);</span><br><span class="line">                <span class="comment">// è§¦æ‘¸æ»‘åŠ¨</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> path) &#123;</span><br><span class="line">                    <span class="keyword">const</span> touchmoveTouch = <span class="keyword">new</span> <span class="title class_">Touch</span>(&#123;</span><br><span class="line">                        <span class="attr">identifier</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">target</span>: slide,</span><br><span class="line">                        <span class="attr">clientX</span>: path[i].<span class="property">x</span>,</span><br><span class="line">                        <span class="attr">clientY</span>: path[i].<span class="property">y</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">const</span> touchmoveList = [touchmoveTouch];</span><br><span class="line">                    <span class="keyword">const</span> touchmove = <span class="keyword">new</span> <span class="title class_">TouchEvent</span>(<span class="string">&#x27;touchmove&#x27;</span>, &#123;</span><br><span class="line">                        <span class="attr">targetTouches</span>: touchmoveList,</span><br><span class="line">                        <span class="attr">touches</span>: touchmoveList,</span><br><span class="line">                        <span class="attr">changedTouches</span>: touchmoveList,</span><br><span class="line">                        <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                        <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    slide.<span class="title function_">dispatchEvent</span>(touchmove);</span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">10</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">const</span> touchendTouch = <span class="keyword">new</span> <span class="title class_">Touch</span>(&#123;</span><br><span class="line">                    <span class="attr">identifier</span>: <span class="number">0</span>,</span><br><span class="line">                    <span class="attr">target</span>: slide,</span><br><span class="line">                    <span class="attr">clientX</span>: path[path.<span class="property">length</span> - <span class="number">1</span>].<span class="property">x</span>,</span><br><span class="line">                    <span class="attr">clientY</span>: path[path.<span class="property">length</span> - <span class="number">1</span>].<span class="property">y</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// è§¦æ‘¸ç»“æŸ</span></span><br><span class="line">                <span class="keyword">const</span> touchendList = [touchendTouch];</span><br><span class="line">                <span class="comment">// å¼€å§‹è§¦æ‘¸</span></span><br><span class="line">                <span class="keyword">const</span> touchend = <span class="keyword">new</span> <span class="title class_">TouchEvent</span>(<span class="string">&#x27;touchend&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">targetTouches</span>: [],</span><br><span class="line">                    <span class="attr">touches</span>: [],</span><br><span class="line">                    <span class="attr">changedTouches</span>: touchendList,</span><br><span class="line">                    <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                slide.<span class="title function_">dispatchEvent</span>(touchend);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// é¼ æ ‡æŒ‰ä¸‹</span></span><br><span class="line">                <span class="keyword">const</span> mousedown = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;mousedown&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">clientX</span>: path[<span class="number">0</span>].<span class="property">x</span>,</span><br><span class="line">                    <span class="attr">clientY</span>: path[<span class="number">0</span>].<span class="property">y</span>,</span><br><span class="line">                    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                slide.<span class="title function_">dispatchEvent</span>(mousedown);</span><br><span class="line">                <span class="comment">// é¼ æ ‡æ»‘åŠ¨</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> path) &#123;</span><br><span class="line">                    <span class="keyword">const</span> mousemove = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;mousemove&#x27;</span>, &#123;</span><br><span class="line">                        <span class="attr">clientX</span>: path[i].<span class="property">x</span>,</span><br><span class="line">                        <span class="attr">clientY</span>: path[i].<span class="property">y</span>,</span><br><span class="line">                        <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    slide.<span class="title function_">dispatchEvent</span>(mousemove);</span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">10</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// é¼ æ ‡æŠ¬èµ·</span></span><br><span class="line">                <span class="keyword">const</span> mouseup = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;mouseup&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">clientX</span>: path[path.<span class="property">length</span> - <span class="number">1</span>].<span class="property">x</span>,</span><br><span class="line">                    <span class="attr">clientY</span>: path[path.<span class="property">length</span> - <span class="number">1</span>].<span class="property">y</span>,</span><br><span class="line">                    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">view</span>: <span class="variable language_">window</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                slide.<span class="title function_">dispatchEvent</span>(mouseup);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">&#x27;æ»‘åŠ¨éªŒè¯å®Œæˆ!&#x27;</span>);</span><br><span class="line">            <span class="comment">// å®šæ—¶å™¨</span></span><br><span class="line">            <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// æ»‘åŠ¨éªŒè¯</span></span><br><span class="line">                <span class="keyword">const</span> mask = $$(<span class="string">&#x27;#nc_mask&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!mask || <span class="title function_">getComputedStyle</span>(mask).<span class="property">display</span> === <span class="string">&#x27;none&#x27;</span>) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;æ»‘åŠ¨éªŒè¯æˆåŠŸ!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;æ»‘åŠ¨éªŒè¯æˆåŠŸ!&#x27;</span>);</span><br><span class="line">                    <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                    <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="literal">false</span>);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;æ»‘åŠ¨éªŒè¯å¤±è´¥!&#x27;</span>);</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;æ»‘åŠ¨éªŒè¯å¤±è´¥!&#x27;</span>);</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†é€‰é¡¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleChoiceBtn</span>(<span class="params">answers</span>) &#123;</span><br><span class="line">    <span class="comment">// é€‰é¡¹æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">const</span> allBtns = $$(<span class="string">&#x27;.q-answer&#x27;</span>);</span><br><span class="line">    <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (answers.<span class="property">length</span> &amp;&amp; allBtns.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// ä½œç­”</span></span><br><span class="line">        <span class="keyword">return</span> answers.<span class="title function_">every</span>(<span class="function">(<span class="params">answer</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (answer &amp;&amp; answer.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="comment">// åŒ…å«ç­”æ¡ˆæœ€çŸ­é•¿åº¦é€‰é¡¹</span></span><br><span class="line">                <span class="keyword">let</span> minLengthChoice;</span><br><span class="line">                <span class="comment">// éå†</span></span><br><span class="line">                allBtns.<span class="title function_">forEach</span>(<span class="function">(<span class="params">choice</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// é€‰é¡¹æ–‡æœ¬</span></span><br><span class="line">                    <span class="keyword">const</span> choiceText = choice.<span class="property">innerText</span>.<span class="title function_">trim</span>();</span><br><span class="line">                    <span class="comment">// æ— ç¬¦å·é€‰é¡¹æ–‡æœ¬</span></span><br><span class="line">                    <span class="keyword">const</span> unsignedChoiceText = choiceText.<span class="title function_">replaceAll</span>(<span class="regexp">/[ã€ï¼Œ,ã€‚ ]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                    <span class="comment">// æ— ç¬¦å·ç­”æ¡ˆ</span></span><br><span class="line">                    <span class="keyword">const</span> unsignedAnswer = answer.<span class="title function_">replaceAll</span>(<span class="regexp">/[ã€ï¼Œ,ã€‚ ]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åŒ…å«ç­”æ¡ˆ</span></span><br><span class="line">                    <span class="keyword">if</span> (choiceText === answer ||</span><br><span class="line">                        choiceText.<span class="title function_">includes</span>(answer) ||</span><br><span class="line">                        answer.<span class="title function_">includes</span>(choiceText) ||</span><br><span class="line">                        unsignedChoiceText.<span class="title function_">includes</span>(unsignedAnswer)) &#123;</span><br><span class="line">                        <span class="comment">// æœ€å°é•¿åº¦é€‰é¡¹æœ‰å€¼</span></span><br><span class="line">                        <span class="keyword">if</span> (minLengthChoice) &#123;</span><br><span class="line">                            <span class="comment">// æœ€çŸ­é•¿åº¦é€‰é¡¹ä¸å½“å‰é€‰é¡¹æ¯”è¾ƒé•¿åº¦</span></span><br><span class="line">                            <span class="keyword">if</span> (minLengthChoice.<span class="property">innerText</span>.<span class="property">length</span> &gt; choiceText.<span class="property">length</span>) &#123;</span><br><span class="line">                                minLengthChoice = choice;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="comment">// æœ€å°é•¿åº¦é€‰é¡¹èµ‹å€¼</span></span><br><span class="line">                            minLengthChoice = choice;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// å­˜åœ¨é€‰é¡¹</span></span><br><span class="line">                <span class="keyword">if</span> (minLengthChoice) &#123;</span><br><span class="line">                    <span class="comment">// é€‰æ‹©</span></span><br><span class="line">                    <span class="keyword">if</span> (!minLengthChoice.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;chosen&#x27;</span>)) &#123;</span><br><span class="line">                        minLengthChoice.<span class="title function_">click</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºå¤„ç†å•é€‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleSingleChoiceRand</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// é€‰é¡¹æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">const</span> allBtns = $$(<span class="string">&#x27;.q-answer&#x27;</span>);</span><br><span class="line">    <span class="comment">// æŒ‰é’®å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (allBtns.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> index = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * allBtns.<span class="property">length</span>);</span><br><span class="line">        <span class="keyword">const</span> randBtn = allBtns[index];</span><br><span class="line">        <span class="comment">// é€‰æ‹©</span></span><br><span class="line">        <span class="keyword">if</span> (!randBtn.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;chosen&#x27;</span>)) &#123;</span><br><span class="line">            randBtn.<span class="title function_">click</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éšæœºå¤„ç†å¤šé€‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleMutiplyChoiceRand</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// é€‰é¡¹æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">const</span> allBtns = $$(<span class="string">&#x27;.q-answer&#x27;</span>);</span><br><span class="line">    <span class="comment">// æŒ‰é’®å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (allBtns.<span class="property">length</span>) &#123;</span><br><span class="line">        allBtns.<span class="title function_">forEach</span>(<span class="function">(<span class="params">allBtn</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// é€‰æ‹©</span></span><br><span class="line">            <span class="keyword">if</span> (!allBtn.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;chosen&#x27;</span>)) &#123;</span><br><span class="line">                allBtn.<span class="title function_">click</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†å¡«ç©º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleBlankInput</span> = (<span class="params">answers</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// æ‰€æœ‰å¡«ç©º</span></span><br><span class="line">    <span class="keyword">const</span> blanks = $$(<span class="string">&#x27;.blank&#x27;</span>);</span><br><span class="line">    <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (blanks.<span class="property">length</span> &amp;&amp; answers.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// å¡«ç©ºæ•°é‡å’Œç­”æ¡ˆæ•°é‡ä¸€è‡´</span></span><br><span class="line">        <span class="keyword">if</span> (answers.<span class="property">length</span> === blanks.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> answers.<span class="title function_">every</span>(<span class="function">(<span class="params">answer, i</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">                <span class="keyword">if</span> (answer &amp;&amp; answer.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="comment">// è¾“å…¥äº‹ä»¶</span></span><br><span class="line">                    <span class="keyword">const</span> inputEvent = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123;</span><br><span class="line">                        <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">// è®¾ç½®ç­”æ¡ˆ</span></span><br><span class="line">                    blanks[i].<span class="title function_">setAttribute</span>(<span class="string">&#x27;value&#x27;</span>, answer);</span><br><span class="line">                    <span class="comment">// è§¦å‘è¾“å…¥input</span></span><br><span class="line">                    blanks[i].<span class="title function_">dispatchEvent</span>(inputEvent);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¡«ç©ºæ•°é‡ä¸º1å’Œæç¤ºæ•°é‡å¤§äº1</span></span><br><span class="line">        <span class="keyword">if</span> (blanks.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; answers.<span class="property">length</span> &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// ç›´æ¥å°†æ‰€æœ‰ç­”æ¡ˆæ•´åˆå¡«è¿›å»</span></span><br><span class="line">            <span class="keyword">const</span> answer = answers.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">            <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (answer &amp;&amp; answer.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="comment">// è¾“å…¥äº‹ä»¶</span></span><br><span class="line">                <span class="keyword">const</span> inputEvent = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123;</span><br><span class="line">                    <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// è®¾ç½®ç­”æ¡ˆ</span></span><br><span class="line">                blanks[<span class="number">0</span>].<span class="title function_">setAttribute</span>(<span class="string">&#x27;value&#x27;</span>, answer);</span><br><span class="line">                <span class="comment">// è§¦å‘è¾“å…¥input</span></span><br><span class="line">                blanks[<span class="number">0</span>].<span class="title function_">dispatchEvent</span>(inputEvent);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†å¡«ç©ºéšæœº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleBlankInputRand</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ‰€æœ‰å¡«ç©º</span></span><br><span class="line">    <span class="keyword">const</span> blanks = $$(<span class="string">&#x27;.blank&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (blanks.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// è¾“å…¥äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">const</span> inputEvent = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        blanks.<span class="title function_">forEach</span>(<span class="function">(<span class="params">blank</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®ç­”æ¡ˆ</span></span><br><span class="line">            blank.<span class="title function_">setAttribute</span>(<span class="string">&#x27;value&#x27;</span>, <span class="string">&#x27;ç­”æ¡ˆ&#x27;</span>);</span><br><span class="line">            <span class="comment">// è§¦å‘è¾“å…¥input</span></span><br><span class="line">            blank.<span class="title function_">dispatchEvent</span>(inputEvent);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æš‚åœé”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">examPauseLock</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// å­¦ä¹ æš‚åœ</span></span><br><span class="line">        <span class="keyword">const</span> pauseStudy = (<span class="title function_">GM_getValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>) || <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// å…¨å±€æš‚åœ</span></span><br><span class="line">        <span class="keyword">if</span> (pauseStudy) &#123;</span><br><span class="line">            examPause.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">if</span> (examPause.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">&#x27;å·²æš‚åœ, æ‰‹åŠ¨å¼€å¯è‡ªåŠ¨ç­”é¢˜! &#x27;</span>, <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">const</span> doing = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!examPause.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="comment">// åœæ­¢å®šæ—¶å™¨</span></span><br><span class="line">                    <span class="built_in">clearInterval</span>(doing);</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ç­”é¢˜ç­‰å¾…ç»“æŸ!&#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (callback &amp;&amp; callback <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">                        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                        <span class="title function_">createTip</span>(<span class="string">&#x27;å·²å¼€å¯, è‡ªåŠ¨ç­”é¢˜!&#x27;</span>);</span><br><span class="line">                        <span class="title function_">callback</span>(<span class="literal">true</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (callback &amp;&amp; callback <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">                    <span class="title function_">callback</span>(<span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;ç­”é¢˜ç­‰å¾…...&#x27;</span>);</span><br><span class="line">            &#125;, <span class="number">500</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­”é¢˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">doingExam</span>(<span class="params">type</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸‹ä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line">    <span class="keyword">let</span> nextButton;</span><br><span class="line">    <span class="comment">// ä¸‹ä¸€ä¸ªæ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">let</span> nextText;</span><br><span class="line">    <span class="comment">// ä¿å­˜ç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">let</span> shouldSaveAnswer = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// å…ˆç­‰ç­‰å†å¼€å§‹åšé¢˜</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">2500</span>);</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">examPauseLock</span>();</span><br><span class="line">        <span class="comment">// è·å–ä¸‹ä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line">        nextButton = <span class="keyword">await</span> <span class="title function_">getNextButton</span>();</span><br><span class="line">        <span class="comment">// ä¸‹ä¸€ä¸ªæ–‡æœ¬</span></span><br><span class="line">        nextText = nextButton.<span class="property">innerText</span>.<span class="title function_">replaceAll</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// ç»“æŸ</span></span><br><span class="line">        <span class="keyword">const</span> finish = [<span class="string">&#x27;å†ç»ƒä¸€æ¬¡&#x27;</span>, <span class="string">&#x27;å†æ¥ä¸€ç»„&#x27;</span>, <span class="string">&#x27;æŸ¥çœ‹è§£æ&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (finish.<span class="title function_">includes</span>(nextButton.<span class="property">innerText</span>)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç‚¹å‡»æç¤º</span></span><br><span class="line">        $$(<span class="string">&#x27;.tips&#x27;</span>)[<span class="number">0</span>]?.<span class="title function_">click</span>();</span><br><span class="line">        <span class="comment">// æ‰€æœ‰æç¤º</span></span><br><span class="line">        <span class="keyword">const</span> allTips = $$(<span class="string">&#x27;.line-feed font[color]&#x27;</span>);</span><br><span class="line">        <span class="comment">// ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">const</span> answers = allTips.<span class="title function_">map</span>(<span class="function">(<span class="params">tip</span>) =&gt;</span> tip.<span class="property">innerText</span>.<span class="title function_">trim</span>());</span><br><span class="line">        <span class="comment">// è·å–é¢˜ç›®çš„æ–‡æœ¬å†…å®¹</span></span><br><span class="line">        <span class="keyword">const</span> question = $$(<span class="string">&#x27;.q-body&#x27;</span>)[<span class="number">0</span>].<span class="property">innerText</span>;</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1500</span>);</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">examPauseLock</span>();</span><br><span class="line">        <span class="comment">// é€‰é¡¹æŒ‰é’®</span></span><br><span class="line">        <span class="keyword">const</span> allBtns = $$(<span class="string">&#x27;.q-answer&#x27;</span>);</span><br><span class="line">        <span class="comment">// æ‰€æœ‰å¡«ç©º</span></span><br><span class="line">        <span class="keyword">const</span> blanks = $$(<span class="string">&#x27;input[type=text][class=blank]&#x27;</span>);</span><br><span class="line">        <span class="comment">// é—®é¢˜ç±»å‹</span></span><br><span class="line">        <span class="keyword">const</span> questionType = ($$(<span class="string">&#x27;.q-header&#x27;</span>)[<span class="number">0</span>].<span class="property">innerText</span>.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">examPauseLock</span>();</span><br><span class="line">        <span class="comment">// é¢˜å‹åˆ†ç±»ä½œç­”</span></span><br><span class="line">        <span class="keyword">switch</span> (questionType) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;å¡«ç©ºé¢˜&#x27;</span>: &#123;</span><br><span class="line">                <span class="comment">// æ ¹æ®æç¤ºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (answers.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> res = <span class="title function_">handleBlankInput</span>(answers);</span><br><span class="line">                    <span class="comment">// æˆåŠŸ</span></span><br><span class="line">                    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆå¼‚å¸¸, å°è¯•ç½‘ç»œé¢˜åº“è·å–!&#x27;</span>);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨è·å–ç­”æ¡ˆ...&#x27;</span>);</span><br><span class="line">                <span class="comment">// å°è¯•é¢˜åº“è·å–</span></span><br><span class="line">                <span class="keyword">const</span> answersNetwork = <span class="keyword">await</span> <span class="title function_">getAnswer</span>(question);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">`è·å–ç­”æ¡ˆ<span class="subst">$&#123;answersNetwork.length ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>, &#123;</span><br><span class="line">                    question,</span><br><span class="line">                    answersNetwork,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// æ ¹æ®é¢˜åº“ä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (answersNetwork.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> res = <span class="title function_">handleBlankInput</span>(answersNetwork);</span><br><span class="line">                    <span class="comment">// æˆåŠŸ</span></span><br><span class="line">                    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éšæœºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (type === <span class="title class_">ExamType</span>.<span class="property">PRACTICE</span> || settings[<span class="title class_">SettingType</span>.<span class="property">RANDOM_EXAM</span>]) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">handleBlankInputRand</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// æ¨é€</span></span><br><span class="line">                    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;å­¦ä¹ æ¨é€&#x27;</span>,</span><br><span class="line">                        <span class="attr">to</span>: userinfo.<span class="property">nick</span>,</span><br><span class="line">                        <span class="attr">content</span>: <span class="string">&#x27;ç­”é¢˜å­˜åœ¨å¼‚å¸¸, å·²æš‚åœç­”é¢˜!&#x27;</span>,</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;fail&#x27;</span>,</span><br><span class="line">                    &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">`å­¦ä¹ æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    examPause.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// æäº¤ç­”æ¡ˆ</span></span><br><span class="line">                    shouldSaveAnswer = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;å¤šé€‰é¢˜&#x27;</span>: &#123;</span><br><span class="line">                <span class="comment">// æ ¹æ®æç¤ºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (answers.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="comment">// é€‰é¡¹æ–‡æœ¬</span></span><br><span class="line">                    <span class="keyword">const</span> choicesText = allBtns.<span class="title function_">map</span>(<span class="function">(<span class="params">btn</span>) =&gt;</span> btn.<span class="property">innerText</span>);</span><br><span class="line">                    <span class="comment">// é€‰é¡¹å†…å®¹</span></span><br><span class="line">                    <span class="keyword">const</span> choicesContent = choicesText</span><br><span class="line">                        .<span class="title function_">map</span>(<span class="function">(<span class="params">choiceText</span>) =&gt;</span> choiceText.<span class="title function_">split</span>(<span class="regexp">/[A-Z]./</span>)[<span class="number">1</span>].<span class="title function_">trim</span>())</span><br><span class="line">                        .<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                    <span class="comment">// ç©ºæ ¼</span></span><br><span class="line">                    <span class="keyword">const</span> blanks = question.<span class="title function_">match</span>(<span class="regexp">/ï¼ˆï¼‰/g</span>);</span><br><span class="line">                    <span class="comment">// å¡«ç©ºæ•°é‡ã€é€‰é¡¹æ•°é‡ã€ç­”æ¡ˆæ•°é‡ç›¸åŒ | é€‰é¡¹å…¨æ–‡ç­‰äºç­”æ¡ˆå…¨æ–‡</span></span><br><span class="line">                    <span class="keyword">if</span> ((blanks &amp;&amp; allBtns.<span class="property">length</span> === blanks.<span class="property">length</span>) ||</span><br><span class="line">                        question === choicesContent ||</span><br><span class="line">                        allBtns.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="comment">// å…¨é€‰</span></span><br><span class="line">                        allBtns.<span class="title function_">forEach</span>(<span class="function">(<span class="params">choice</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (!choice.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;chosen&#x27;</span>)) &#123;</span><br><span class="line">                                choice.<span class="title function_">click</span>();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// é€‰é¡¹æ•°é‡å¤§äºç­‰äºç­”æ¡ˆ</span></span><br><span class="line">                    <span class="keyword">if</span> (allBtns.<span class="property">length</span> &gt;= answers.<span class="property">length</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> res = <span class="title function_">handleChoiceBtn</span>(answers);</span><br><span class="line">                        <span class="comment">// æˆåŠŸ</span></span><br><span class="line">                        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆå¼‚å¸¸, å°è¯•ç½‘ç»œé¢˜åº“è·å–!&#x27;</span>);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨è·å–ç­”æ¡ˆ...&#x27;</span>);</span><br><span class="line">                <span class="comment">// å°è¯•é¢˜åº“è·å–</span></span><br><span class="line">                <span class="keyword">const</span> answersNetwork = <span class="keyword">await</span> <span class="title function_">getAnswer</span>(question);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">`è·å–ç­”æ¡ˆ<span class="subst">$&#123;answersNetwork.length ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>, &#123;</span><br><span class="line">                    question,</span><br><span class="line">                    answersNetwork,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">                <span class="keyword">if</span> (answersNetwork.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> res = <span class="title function_">handleChoiceBtn</span>(answersNetwork);</span><br><span class="line">                    <span class="comment">// æˆåŠŸ</span></span><br><span class="line">                    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éšæœºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (type === <span class="title class_">ExamType</span>.<span class="property">PRACTICE</span> || settings[<span class="title class_">SettingType</span>.<span class="property">RANDOM_EXAM</span>]) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">handleMutiplyChoiceRand</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// æ¨é€</span></span><br><span class="line">                    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;å­¦ä¹ æ¨é€&#x27;</span>,</span><br><span class="line">                        <span class="attr">to</span>: userinfo.<span class="property">nick</span>,</span><br><span class="line">                        <span class="attr">content</span>: <span class="string">&#x27;ç­”é¢˜å­˜åœ¨å¼‚å¸¸, å·²æš‚åœç­”é¢˜!&#x27;</span>,</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;fail&#x27;</span>,</span><br><span class="line">                    &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">`å­¦ä¹ æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    examPause.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// æäº¤ç­”æ¡ˆ</span></span><br><span class="line">                    shouldSaveAnswer = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;å•é€‰é¢˜&#x27;</span>: &#123;</span><br><span class="line">                <span class="comment">// æ ¹æ®æç¤ºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (answers.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤ºä¸º1</span></span><br><span class="line">                    <span class="keyword">if</span> (answers.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> res = <span class="title function_">handleChoiceBtn</span>(answers);</span><br><span class="line">                        <span class="comment">// æˆåŠŸ</span></span><br><span class="line">                        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// å¯èƒ½çš„åˆ†éš”ç¬¦</span></span><br><span class="line">                        <span class="keyword">const</span> seperator = [</span><br><span class="line">                            <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27; &#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;ã€&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;|&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">                        ];</span><br><span class="line">                        <span class="comment">// å¯èƒ½çš„ç­”æ¡ˆ</span></span><br><span class="line">                        <span class="keyword">const</span> answersLike = seperator</span><br><span class="line">                            .<span class="title function_">map</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> answers.<span class="title function_">join</span>(s).<span class="title function_">trim</span>())</span><br><span class="line">                            .<span class="title function_">filter</span>(<span class="function">(<span class="params">answer</span>) =&gt;</span> answer.<span class="property">length</span>);</span><br><span class="line">                        <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">                        <span class="keyword">if</span> (answersLike.<span class="property">length</span>) &#123;</span><br><span class="line">                            <span class="comment">// å¯èƒ½ç­”æ¡ˆæ˜¯å¦æ­£ç¡®</span></span><br><span class="line">                            <span class="keyword">const</span> res = answersLike.<span class="title function_">some</span>(<span class="function">(<span class="params">answer</span>) =&gt;</span> &#123;</span><br><span class="line">                                <span class="comment">// å°è¯•æŸ¥æ‰¾ç‚¹å‡»</span></span><br><span class="line">                                <span class="keyword">return</span> <span class="title function_">handleChoiceBtn</span>([answer]);</span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆå¼‚å¸¸, å°è¯•ç½‘ç»œé¢˜åº“è·å–!&#x27;</span>);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨è·å–ç­”æ¡ˆ...&#x27;</span>);</span><br><span class="line">                <span class="comment">// å°è¯•é¢˜åº“è·å–</span></span><br><span class="line">                <span class="keyword">const</span> answersNetwork = <span class="keyword">await</span> <span class="title function_">getAnswer</span>(question);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">`è·å–ç­”æ¡ˆ<span class="subst">$&#123;answersNetwork.length ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>, &#123;</span><br><span class="line">                    question,</span><br><span class="line">                    answersNetwork,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// å­˜åœ¨ç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">if</span> (answersNetwork.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="comment">// å•ç­”æ¡ˆå•é€‰é¡¹</span></span><br><span class="line">                    <span class="keyword">if</span> (answersNetwork.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="comment">// å°è¯•æŸ¥æ‰¾ç‚¹å‡»</span></span><br><span class="line">                        <span class="keyword">const</span> res = <span class="title function_">handleChoiceBtn</span>(answersNetwork);</span><br><span class="line">                        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// å¤šç­”æ¡ˆå•é€‰é¡¹ é€‰é¡¹æ„å¤–æ‹†åˆ†</span></span><br><span class="line">                        <span class="comment">// å¯èƒ½åˆ†éš”ç¬¦</span></span><br><span class="line">                        <span class="keyword">const</span> seperator = [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27; &#x27;</span>];</span><br><span class="line">                        <span class="comment">// å¯èƒ½ç­”æ¡ˆ</span></span><br><span class="line">                        <span class="keyword">const</span> answersLike = seperator.<span class="title function_">map</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> answers.<span class="title function_">join</span>(s));</span><br><span class="line">                        <span class="comment">// ç­”æ¡ˆå­˜åœ¨</span></span><br><span class="line">                        <span class="keyword">if</span> (answersLike.<span class="title function_">every</span>(<span class="function">(<span class="params">answer</span>) =&gt;</span> answer.<span class="property">length</span>)) &#123;</span><br><span class="line">                            <span class="comment">// å¯èƒ½ç­”æ¡ˆæ˜¯å¦æ­£ç¡®</span></span><br><span class="line">                            <span class="keyword">const</span> res = answersLike.<span class="title function_">some</span>(<span class="function">(<span class="params">answer</span>) =&gt;</span> &#123;</span><br><span class="line">                                <span class="comment">// å°è¯•æŸ¥æ‰¾ç‚¹å‡»</span></span><br><span class="line">                                <span class="keyword">return</span> <span class="title function_">handleChoiceBtn</span>([answer]);</span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="keyword">if</span> (res) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éšæœºä½œç­”</span></span><br><span class="line">                <span class="keyword">if</span> (type === <span class="title class_">ExamType</span>.<span class="property">PRACTICE</span> || settings[<span class="title class_">SettingType</span>.<span class="property">RANDOM_EXAM</span>]) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ç­”æ¡ˆä¸å­˜åœ¨, éšæœºä½œç­”!&#x27;</span>);</span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">handleSingleChoiceRand</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// æ¨é€</span></span><br><span class="line">                    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;å­¦ä¹ æ¨é€&#x27;</span>,</span><br><span class="line">                        <span class="attr">to</span>: userinfo.<span class="property">nick</span>,</span><br><span class="line">                        <span class="attr">content</span>: <span class="string">&#x27;ç­”é¢˜å­˜åœ¨å¼‚å¸¸, å·²æš‚åœç­”é¢˜!&#x27;</span>,</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;fail&#x27;</span>,</span><br><span class="line">                    &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">`å­¦ä¹ æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    examPause.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// æäº¤ç­”æ¡ˆ</span></span><br><span class="line">                    shouldSaveAnswer = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">examPauseLock</span>();</span><br><span class="line">        <span class="comment">// è·å–ä¸‹ä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line">        nextButton = <span class="keyword">await</span> <span class="title function_">getNextButton</span>();</span><br><span class="line">        <span class="comment">// ä¸‹ä¸€ä¸ªæ–‡æœ¬</span></span><br><span class="line">        nextText = nextButton.<span class="property">innerText</span>.<span class="title function_">replaceAll</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// éœ€è¦æäº¤ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">if</span> (shouldSaveAnswer) &#123;</span><br><span class="line">            <span class="comment">// ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">const</span> answers = [];</span><br><span class="line">            <span class="keyword">if</span> (questionType === <span class="string">&#x27;å¡«ç©ºé¢˜&#x27;</span>) &#123;</span><br><span class="line">                blanks.<span class="title function_">forEach</span>(<span class="function">(<span class="params">blank</span>) =&gt;</span> &#123;</span><br><span class="line">                    answers.<span class="title function_">push</span>(blank.<span class="property">value</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (questionType === <span class="string">&#x27;å•é€‰é¢˜&#x27;</span> || questionType === <span class="string">&#x27;å¤šé€‰é¢˜&#x27;</span>) &#123;</span><br><span class="line">                allBtns.<span class="title function_">forEach</span>(<span class="function">(<span class="params">choice</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (choice.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;chosen&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="comment">// å¸¦å­—æ¯çš„é€‰é¡¹</span></span><br><span class="line">                        <span class="keyword">const</span> answerTemp = choice.<span class="property">innerText</span>;</span><br><span class="line">                        <span class="comment">// ä»å­—ç¬¦ä¸²ä¸­æ‹¿å‡ºç­”æ¡ˆ</span></span><br><span class="line">                        <span class="keyword">const</span> [, answer] = answerTemp.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (answer &amp;&amp; answer.<span class="property">length</span>) &#123;</span><br><span class="line">                            answers.<span class="title function_">push</span>(answer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">const</span> answer = answers.<span class="title function_">join</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">            <span class="comment">// å­˜åœ¨ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">if</span> (answer.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨ä¸Šä¼ ç­”æ¡ˆ...&#x27;</span>);</span><br><span class="line">                <span class="comment">// ä¸Šä¼ ç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">saveAnswer</span>(question, answer);</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">`ä¸Šä¼ ç­”æ¡ˆ<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>, &#123; question, answer &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// é‡ç½®</span></span><br><span class="line">            shouldSaveAnswer = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¡®å®š</span></span><br><span class="line">        <span class="keyword">if</span> (nextText === <span class="string">&#x27;ç¡®å®š&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// ç¡®è®¤</span></span><br><span class="line">            nextButton.<span class="title function_">click</span>();</span><br><span class="line">            <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">2000</span>);</span><br><span class="line">            <span class="comment">// æš‚åœ</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">examPauseLock</span>();</span><br><span class="line">            <span class="comment">// ç­”æ¡ˆè§£æ</span></span><br><span class="line">            <span class="keyword">const</span> answerBox = $$(<span class="string">&#x27;.answer&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="comment">// ç­”é¢˜é”™è¯¯</span></span><br><span class="line">            <span class="keyword">if</span> (answerBox) &#123;</span><br><span class="line">                <span class="keyword">const</span> answerTemp = answerBox.<span class="property">innerText</span>;</span><br><span class="line">                <span class="comment">// ä»å­—ç¬¦ä¸²ä¸­æ‹¿å‡ºç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">const</span> [, answerText] = answerTemp.<span class="title function_">split</span>(<span class="string">&#x27;ï¼š&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> (answerText &amp;&amp; answerText.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> answer = answerText.<span class="title function_">replaceAll</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨ä¸Šä¼ ç­”æ¡ˆ...&#x27;</span>);</span><br><span class="line">                    <span class="comment">// ä¸Šä¼ ç­”æ¡ˆ</span></span><br><span class="line">                    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">saveAnswer</span>(question, answer);</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">`ä¸Šä¼ ç­”æ¡ˆ<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>, &#123; question, answer &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–æŒ‰é’®</span></span><br><span class="line">        nextButton = <span class="keyword">await</span> <span class="title function_">getNextButton</span>();</span><br><span class="line">        <span class="comment">// ä¸‹ä¸€ä¸ªæ–‡æœ¬</span></span><br><span class="line">        nextText = nextButton.<span class="property">innerText</span>.<span class="title function_">replaceAll</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (nextText === <span class="string">&#x27;ä¸‹ä¸€é¢˜&#x27;</span> || nextText === <span class="string">&#x27;å®Œæˆ&#x27;</span> || nextText === <span class="string">&#x27;äº¤å·&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">2500</span>);</span><br><span class="line">            <span class="comment">// ä¸‹ä¸€é¢˜</span></span><br><span class="line">            nextButton.<span class="title function_">click</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ»‘åŠ¨éªŒè¯</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">handleSlideVerify</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å…³é—­ä»»åŠ¡çª—å£</span></span><br><span class="line">    <span class="title function_">handleCloseTaskWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¯æ—¥ç­”é¢˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">doExamPractice</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æš‚åœ</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨æ¯æ—¥ç­”é¢˜...&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">&#x27;æ­£åœ¨æ¯æ—¥ç­”é¢˜&#x27;</span>);</span><br><span class="line">    <span class="comment">// é“¾æ¥</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="variable constant_">URL_CONFIG</span>.<span class="property">examPractice</span>;</span><br><span class="line">    <span class="comment">// ç­‰å¾…ä»»åŠ¡çª—å£</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">waitTaskWin</span>(url, <span class="string">&#x27;æ¯æ—¥ç­”é¢˜&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">&#x27;å®Œæˆæ¯æ—¥ç­”é¢˜!&#x27;</span>);</span><br><span class="line">    <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1500</span>);</span><br><span class="line">    <span class="comment">// åˆ·æ–°åˆ†æ•°æ•°æ®</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">refreshScoreInfo</span>();</span><br><span class="line">    <span class="comment">// åˆ·æ–°ä»»åŠ¡æ•°æ®</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">refreshTaskList</span>();</span><br><span class="line">    <span class="comment">// ä»»åŠ¡å®ŒæˆçŠ¶å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">active</span> &amp;&amp;</span><br><span class="line">        !taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­æ¯æ—¥ç­”é¢˜!&#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­æ¯æ—¥ç­”é¢˜!&#x27;</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">doExamPractice</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä¸“é¡¹ç»ƒä¹ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">doExamPaper</span>(<span class="params"></span>) &#123;</span><br><span class="line">    running.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨ä¸“é¡¹ç»ƒä¹ ...&#x27;</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">&#x27;æ­£åœ¨ä¸“é¡¹ç»ƒä¹ &#x27;</span>);</span><br><span class="line">    <span class="comment">// id</span></span><br><span class="line">    <span class="keyword">const</span> examPaperId = <span class="keyword">await</span> <span class="title function_">findExamPaper</span>();</span><br><span class="line">    <span class="keyword">if</span> (examPaperId) &#123;</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;URL_CONFIG.examPaper&#125;</span>?id=<span class="subst">$&#123;examPaperId&#125;</span>`</span>;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">`é“¾æ¥: <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">        <span class="comment">// ç­‰å¾…çª—å£ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">waitTaskWin</span>(url, <span class="string">&#x27;ä¸“é¡¹ç»ƒä¹ &#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">&#x27;å®Œæˆä¸“é¡¹ç»ƒä¹ !&#x27;</span>);</span><br><span class="line">        running.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]) &#123;</span><br><span class="line">            <span class="comment">// çª—å£ä¸å­˜åœ¨</span></span><br><span class="line">            frame.<span class="property">exist</span> = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    running.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">&#x27;ä¸“é¡¹ç»ƒä¹ å‡å·²å®Œæˆ!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–æ€»é¡µæ•°å±æ€§</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">initExam</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤ä»ç¬¬ä¸€é¡µè·å–å…¨éƒ¨é¡µå±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getExamPaper</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="comment">// ç­‰å¾…</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">3000</span>);</span><br><span class="line">        <span class="keyword">return</span> data.<span class="property">totalPageCount</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æŸ¥è¯¢ä¸“é¡¹ç»ƒä¹ åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">findExamPaper</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è·å–æ€»é¡µæ•°</span></span><br><span class="line">    <span class="keyword">const</span> total = <span class="keyword">await</span> <span class="title function_">initExam</span>();</span><br><span class="line">    <span class="comment">// å½“å‰é¡µæ•°</span></span><br><span class="line">    <span class="keyword">let</span> current = <span class="number">1</span>;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">`æ­£åœ¨å¯»æ‰¾çš„ä¸“é¡¹ç»ƒä¹ ...`</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">`æ­£åœ¨å¯»æ‰¾çš„ä¸“é¡¹ç»ƒä¹ ...`</span>);</span><br><span class="line">    <span class="keyword">while</span> (current &lt;= total &amp;&amp; current) &#123;</span><br><span class="line">        <span class="comment">// è¯·æ±‚æ•°æ®</span></span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getExamPaper</span>(current);</span><br><span class="line">        <span class="keyword">if</span> (data) &#123;</span><br><span class="line">            <span class="comment">// è·å–ä¸“é¡¹ç»ƒä¹ çš„åˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">const</span> examPapers = data.<span class="property">list</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> examPapers) &#123;</span><br><span class="line">                <span class="comment">// éå†æŸ¥è¯¢æœ‰æ²¡æœ‰æ²¡åšè¿‡çš„</span></span><br><span class="line">                <span class="keyword">if</span> (examPapers[i].<span class="property">status</span> !== <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="comment">// statusï¼š 1 å¼€å§‹ç­”é¢˜, 2 å·²æ»¡åˆ†/é‡æ–°ç­”é¢˜, 3 ç»§ç»­ç­”é¢˜</span></span><br><span class="line">                    <span class="keyword">return</span> examPapers[i].<span class="property">id</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¢åŠ é¡µç </span></span><br><span class="line">            current += <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// ç­‰å¾…</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">3000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–ä¸»é¡µé¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initMainListener</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬å…³é—­</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = msg;</span><br><span class="line">        <span class="keyword">if</span> (data.<span class="property">id</span> === id.<span class="property">value</span> &amp;&amp; data.<span class="property">closed</span>) &#123;</span><br><span class="line">            <span class="comment">// å…³é—­çª—å£</span></span><br><span class="line">            <span class="title function_">closeFrame</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆå§‹åŒ–å­é¡µé¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initChildListener</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = msg;</span><br><span class="line">        <span class="keyword">if</span> (data.<span class="property">id</span> &amp;&amp; !data.<span class="property">closed</span>) &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®çª—å£id</span></span><br><span class="line">            id.<span class="property">value</span> = data.<span class="property">id</span>;</span><br><span class="line">            <span class="title function_">log</span>(<span class="string">`åˆå§‹åŒ–çª—å£ ID: <span class="subst">$&#123;id.value&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å¼€çª—å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">url</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">openFrame</span>(<span class="params">url, title</span>) &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½® URL</span></span><br><span class="line">    frame.<span class="property">src</span> = url;</span><br><span class="line">    <span class="comment">// ç­‰å¾…å…ƒç´ </span></span><br><span class="line">    <span class="keyword">await</span> $_(<span class="string">&#x27;.egg_frame&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (frame.<span class="property">ele</span>) &#123;</span><br><span class="line">        <span class="comment">// id</span></span><br><span class="line">        id.<span class="property">value</span> = <span class="title function_">generateMix</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">// æ‰“å¼€</span></span><br><span class="line">        frame.<span class="property">closed</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// è®¾ç½®æ ‡é¢˜</span></span><br><span class="line">        frame.<span class="property">title</span> = title || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="comment">// ç­‰å¾…é¡µé¢åŠ è½½</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">waitFrameLoaded</span>(frame.<span class="property">ele</span>);</span><br><span class="line">        <span class="comment">// å‘é€çª—å£ ID</span></span><br><span class="line">        frame.<span class="property">ele</span>.<span class="property">contentWindow</span>?.<span class="title function_">postMessage</span>(&#123; <span class="attr">id</span>: id.<span class="property">value</span>, <span class="attr">closed</span>: <span class="literal">false</span> &#125;, url);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">closeFrame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">`å…³é—­çª—å£ ID: <span class="subst">$&#123;id.value&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// çª—å£æ˜¾ç¤º</span></span><br><span class="line">    frame.<span class="property">show</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// å…³é—­</span></span><br><span class="line">    frame.<span class="property">closed</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// æ ‡é¢˜</span></span><br><span class="line">    frame.<span class="property">title</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// src</span></span><br><span class="line">    frame.<span class="property">src</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­ frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleCloseFrame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(&#123; <span class="attr">id</span>: id.<span class="property">value</span>, <span class="attr">closed</span>: <span class="literal">true</span> &#125;, <span class="variable constant_">URL_CONFIG</span>.<span class="property">homeOrigin</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­‰å¾…çª—å£ä»»åŠ¡ç»“æŸ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">id</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">waitFrameClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// çª—å£å…³é—­</span></span><br><span class="line">            <span class="keyword">if</span> (frame.<span class="property">closed</span>) &#123;</span><br><span class="line">                <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç­‰å¾…çª—å£åŠ è½½</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">waitFrameLoaded</span>(<span class="params">iframe</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        iframe.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å¼€æ–°çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">openWin</span>(<span class="params">url</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">GM_openInTab</span>(url, &#123;</span><br><span class="line">        <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">insert</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">setParent</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">closeWin</span>(<span class="params"></span>) &#123;</span><br><span class="line">    page.<span class="property">value</span> &amp;&amp; page.<span class="property">value</span>.<span class="title function_">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­å­çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleCloseWin</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">opener</span> = <span class="variable language_">window</span>;</span><br><span class="line">        <span class="keyword">const</span> win = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;_self&#x27;</span>);</span><br><span class="line">        win?.<span class="title function_">close</span>();</span><br><span class="line">        top?.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­‰å¾…çª—å£å…³é—­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">newPage</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">waitWinClose</span>(<span class="params">newPage</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        newPage.<span class="property">onclose</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="literal">undefined</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­ä»»åŠ¡çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">closeTaskWin</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>] &amp;&amp; id.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="title function_">closeFrame</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éåŒå±ä»»åŠ¡</span></span><br><span class="line">    <span class="title function_">closeWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…³é—­ä»»åŠ¡çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleCloseTaskWin</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>] &amp;&amp; id.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="title function_">handleCloseFrame</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­çª—å£</span></span><br><span class="line">    <span class="title function_">handleCloseWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ‰“å¼€å¹¶ç­‰å¾…ä»»åŠ¡ç»“æŸ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">waitTaskWin</span>(<span class="params">url, title</span>) &#123;</span><br><span class="line">    <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]) &#123;</span><br><span class="line">        <span class="comment">// çª—å£å­˜åœ¨</span></span><br><span class="line">        frame.<span class="property">exist</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// æ˜¾ç¤ºçª—ä½“</span></span><br><span class="line">        frame.<span class="property">show</span> = !settings[<span class="title class_">SettingType</span>.<span class="property">SILENT_RUN</span>];</span><br><span class="line">        <span class="comment">// æ–°çª—å£</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">openFrame</span>(url, title);</span><br><span class="line">        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">            <span class="comment">// ç­‰å¾…çª—å£å…³é—­</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">waitFrameClose</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­é¡µé¢ä»»åŠ¡</span></span><br><span class="line">    page.<span class="property">value</span> = <span class="title function_">openWin</span>(url);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">waitWinClose</span>(page.<span class="property">value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> äºŒç»´ç åˆ·æ–°å®šæ—¶å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> refreshTimer = -<span class="number">1</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å°è¯•ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> tryLoginTimer = -<span class="number">1</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”ŸæˆäºŒç»´ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getQRCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨ç”Ÿæˆç™»å½•äºŒç»´ç ...&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> qrCode = <span class="keyword">await</span> <span class="title function_">generateQRCode</span>();</span><br><span class="line">    <span class="keyword">if</span> (qrCode) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;ç”Ÿæˆç™»å½•äºŒç»´ç æˆåŠŸ!&#x27;</span>);</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">`https://login.xuexi.cn/login/qrcommit?showmenu=false&amp;code=<span class="subst">$&#123;qrCode&#125;</span>&amp;appId=dingoankubyrfkttorhpou`</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">code</span>: qrCode,</span><br><span class="line">            <span class="attr">src</span>: <span class="string">`<span class="subst">$&#123;API_CONFIG.qrcode&#125;</span>?data=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(url)&#125;</span>`</span>,</span><br><span class="line">            url,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;ç”Ÿæˆç™»å½•äºŒç»´ç å¤±è´¥!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> éªŒè¯ç™»å½•äºŒç»´ç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">code</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">checkQRCode</span>(<span class="params">code</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;å°è¯•ç”¨äºŒç»´ç ç™»å½•...&#x27;</span>);</span><br><span class="line">    <span class="comment">// äºŒç»´ç ç™»å½•</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">loginWithQRCode</span>(code);</span><br><span class="line">    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data, code, success &#125; = res;</span><br><span class="line">        <span class="comment">// ä¸´æ—¶ç™»å½•éªŒè¯ç </span></span><br><span class="line">        <span class="keyword">if</span> (success &amp;&amp; data) &#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// äºŒç»´ç å¤±æ•ˆ</span></span><br><span class="line">        <span class="keyword">if</span> (code === <span class="string">&#x27;11019&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// æ¸…é™¤å®šæ—¶</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(tryLoginTimer);</span><br><span class="line">        <span class="comment">// è®¾ç½®å®šæ—¶</span></span><br><span class="line">        tryLoginTimer = <span class="built_in">setTimeout</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="keyword">await</span> <span class="title function_">checkQRCode</span>(code));</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å°è¯•äºŒç»´ç ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">tryLogin</span>(<span class="params">checkCode</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨è·å–ç­¾å...&#x27;</span>);</span><br><span class="line">    <span class="comment">// è·å–ç­¾å</span></span><br><span class="line">    <span class="keyword">const</span> sign = <span class="keyword">await</span> <span class="title function_">getSign</span>();</span><br><span class="line">    <span class="keyword">if</span> (sign) &#123;</span><br><span class="line">        <span class="comment">// ç”Ÿæˆuuid</span></span><br><span class="line">        <span class="keyword">const</span> uuid = crypto.<span class="title function_">randomUUID</span>();</span><br><span class="line">        <span class="keyword">const</span> [, code] = checkCode.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> state = <span class="string">`<span class="subst">$&#123;sign&#125;</span><span class="subst">$&#123;uuid&#125;</span>`</span>;</span><br><span class="line">        <span class="comment">// å®‰å…¨æ£€æŸ¥</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">secureCheck</span>(&#123; code, state &#125;);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°ç™»å½•äºŒç»´ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleLogin</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ¸…é™¤åˆ·æ–°</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(refreshTimer);</span><br><span class="line">    <span class="comment">// æ¯éš”ä¸€æ®µæ—¶é—´åˆ·æ–°</span></span><br><span class="line">    refreshTimer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ·æ–°äºŒç»´ç </span></span><br><span class="line">        <span class="title function_">handleLogin</span>();</span><br><span class="line">    &#125;, autoRefreshQRCodeInterval);</span><br><span class="line">    <span class="comment">// æ˜¯å¦è¶…å‡ºæ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (refreshCount.<span class="property">value</span> &gt;= maxRefreshCount) &#123;</span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">&#x27;è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°, ç™»å½•å¤±è´¥!&#x27;</span>);</span><br><span class="line">        <span class="comment">// é‡ç½®åˆ·æ–°æ•°</span></span><br><span class="line">        refreshCount.<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// éšè—äºŒç»´ç </span></span><br><span class="line">        loginQRCodeShow.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// è¿œç¨‹æ¨é€</span></span><br><span class="line">        <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]) &#123;</span><br><span class="line">            <span class="comment">// æ¨é€</span></span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;ç™»å½•æ¨é€&#x27;</span>,</span><br><span class="line">                <span class="attr">content</span>: <span class="string">&#x27;è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°, ç™»å½•å¤±è´¥!&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;fail&#x27;</span>,</span><br><span class="line">            &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">`ç™»å½•æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> imgWrap = $$(<span class="string">&#x27;.egg_login_img_wrap&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// å›¾ç‰‡</span></span><br><span class="line">    <span class="keyword">const</span> img = $$(<span class="string">&#x27;.egg_login_img&#x27;</span>, imgWrap)[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (imgWrap &amp;&amp; img) &#123;</span><br><span class="line">        <span class="comment">// åˆ·æ–°äºŒç»´ç </span></span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;åˆ·æ–°ç™»å½•äºŒç»´ç !&#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ·æ–°æ¬¡æ•°ç´¯åŠ </span></span><br><span class="line">        refreshCount.<span class="property">value</span>++;</span><br><span class="line">        <span class="comment">// è·å–äºŒç»´ç </span></span><br><span class="line">        <span class="keyword">const</span> qrCode = <span class="keyword">await</span> <span class="title function_">getQRCode</span>();</span><br><span class="line">        <span class="keyword">if</span> (qrCode) &#123;</span><br><span class="line">            <span class="comment">// è·å–è¿æ¥</span></span><br><span class="line">            <span class="keyword">const</span> &#123; src, code, url &#125; = qrCode;</span><br><span class="line">            <span class="comment">// src</span></span><br><span class="line">            img.<span class="property">src</span> = src;</span><br><span class="line">            <span class="comment">// å¼€å§‹ç™»å½•</span></span><br><span class="line">            loginQRCodeShow.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// è¿œç¨‹æ¨é€</span></span><br><span class="line">            <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]) &#123;</span><br><span class="line">                <span class="comment">// img html</span></span><br><span class="line">                <span class="keyword">const</span> imgWrap = <span class="title function_">getImgHTML</span>(src);</span><br><span class="line">                <span class="comment">// è·³è½¬é“¾æ¥</span></span><br><span class="line">                <span class="keyword">const</span> aWrap = <span class="string">`</span></span><br><span class="line"><span class="string">   &lt;div&gt;</span></span><br><span class="line"><span class="string">      æˆ–åœ¨æµè§ˆå™¨</span></span><br><span class="line"><span class="string">      &lt;a</span></span><br><span class="line"><span class="string">        href=&quot;dtxuexi://appclient/page/study_feeds?url=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(url)&#125;</span>&quot;</span></span><br><span class="line"><span class="string">        style=&quot;text-decoration: none&quot;</span></span><br><span class="line"><span class="string">        &gt;<span class="subst">$&#123;getHighlightHTML(<span class="string">&#x27;æ‰“å¼€å­¦ä¹ å¼ºå›½APP&#x27;</span>)&#125;</span>&lt;/a</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line">                <span class="comment">// æ¨é€</span></span><br><span class="line">                <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;ç™»å½•æ¨é€&#x27;</span>,</span><br><span class="line">                    <span class="attr">content</span>: [<span class="string">&#x27;æ‰«ä¸€æ‰«, ç™»å½•å­¦ä¹ å¼ºå›½!&#x27;</span>, aWrap, imgWrap],</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">                &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">`ç™»å½•æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è·å–éªŒè¯ç </span></span><br><span class="line">            <span class="keyword">const</span> checkCode = <span class="keyword">await</span> <span class="title function_">checkQRCode</span>(code);</span><br><span class="line">            <span class="comment">// éªŒè¯æˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span> (checkCode) &#123;</span><br><span class="line">                <span class="comment">// å°è¯•ç™»å½•</span></span><br><span class="line">                <span class="keyword">const</span> loginRes = <span class="keyword">await</span> <span class="title function_">tryLogin</span>(checkCode);</span><br><span class="line">                <span class="keyword">if</span> (loginRes) &#123;</span><br><span class="line">                    <span class="comment">// æ¸…é™¤åˆ·æ–°</span></span><br><span class="line">                    <span class="built_in">clearInterval</span>(refreshTimer);</span><br><span class="line">                    <span class="comment">// äºŒç»´ç æ˜¾ç¤º</span></span><br><span class="line">                    loginQRCodeShow.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">                    <span class="comment">// ç™»å½•æˆåŠŸ</span></span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ç™»å½•æˆåŠŸ!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ç™»å½•æˆåŠŸ!&#x27;</span>);</span><br><span class="line">                    <span class="comment">// ç™»å½•æˆåŠŸ</span></span><br><span class="line">                    login.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="comment">// åˆ·æ–°ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">refreshUserInfo</span>();</span><br><span class="line">                    <span class="comment">// åˆ·æ–°åˆ†æ•°ä¿¡æ¯</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">refreshScoreInfo</span>();</span><br><span class="line">                    <span class="comment">// åˆ·æ–°ä»»åŠ¡ä¿¡æ¯</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">refreshTaskList</span>();</span><br><span class="line">                    <span class="comment">// è¿œç¨‹æ¨é€</span></span><br><span class="line">                    <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]) &#123;</span><br><span class="line">                        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&#x27;ç™»å½•æ¨é€&#x27;</span>,</span><br><span class="line">                            <span class="attr">to</span>: userinfo.<span class="property">nick</span>,</span><br><span class="line">                            <span class="attr">content</span>: [</span><br><span class="line">                                <span class="string">&#x27;å­¦ä¹ å¼ºå›½, ç™»å½•æˆåŠŸ!&#x27;</span>,</span><br><span class="line">                                <span class="string">`å½“å¤©ç§¯åˆ†:  <span class="subst">$&#123;getHighlightHTML(todayScore.value)&#125;</span> åˆ†`</span>,</span><br><span class="line">                                <span class="string">`æ€»ç§¯åˆ†: <span class="subst">$&#123;getHighlightHTML(totalScore.value)&#125;</span> åˆ†`</span>,</span><br><span class="line">                                ...taskConfig.<span class="title function_">map</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> <span class="title function_">getProgressHTML</span>(task.<span class="property">title</span>, task.<span class="property">percent</span>)),</span><br><span class="line">                            ],</span><br><span class="line">                            <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">                        &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                        <span class="title function_">createTip</span>(<span class="string">`ç™»å½•æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// äºŒç»´ç å¤±æ•ˆ</span></span><br><span class="line">            <span class="title function_">log</span>(<span class="string">&#x27;ç™»å½•äºŒç»´ç å¤±æ•ˆ!&#x27;</span>);</span><br><span class="line">            <span class="comment">// äºŒç»´ç å¤±æ•ˆåˆ·æ–°</span></span><br><span class="line">            <span class="title function_">handleLogin</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é€€å‡ºç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleLogout</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// åˆ é™¤token</span></span><br><span class="line">    <span class="title function_">delCookie</span>(<span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;.xuexi.cn&#x27;</span>);</span><br><span class="line">    <span class="comment">// å…³é—­çª—å£</span></span><br><span class="line">    <span class="title function_">closeFrame</span>();</span><br><span class="line">    frame.<span class="property">exist</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// é€€å‡ºç™»å½•</span></span><br><span class="line">    login.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// æ¸…é™¤ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    userinfo.<span class="property">nick</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    userinfo.<span class="property">avatar</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// æ€»åˆ†</span></span><br><span class="line">    totalScore.<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å½“å¤©åˆ†æ•°</span></span><br><span class="line">    todayScore.<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡è¿›åº¦é‡ç½®</span></span><br><span class="line">    taskConfig.<span class="title function_">forEach</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> &#123;</span><br><span class="line">        task.<span class="property">percent</span> = <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">LOADING</span>;</span><br><span class="line">    <span class="comment">// é€€å‡ºç™»å½•</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;é€€å‡ºç™»å½•&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ–°é—»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> news = [];</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è§†é¢‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> videos = [];</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†æ–‡ç« </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleNews</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// section</span></span><br><span class="line">    <span class="keyword">const</span> sections = <span class="keyword">await</span> $_(<span class="string">&#x27;section&#x27;</span>, <span class="literal">undefined</span>, <span class="number">5000</span>);</span><br><span class="line">    <span class="keyword">const</span> section = sections[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (!(section &amp;&amp; section.<span class="property">innerText</span>.<span class="title function_">includes</span>(<span class="string">&#x27;ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ä¸­&#x27;</span>))) &#123;</span><br><span class="line">        <span class="comment">// æ–‡ç« é€‰è¯»</span></span><br><span class="line">        <span class="title function_">reading</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æœªæ‰¾åˆ°æ–‡ç« !&#x27;</span>);</span><br><span class="line">    <span class="comment">// æç¤º</span></span><br><span class="line">    <span class="title function_">createTip</span>(<span class="string">&#x27;æœªæ‰¾åˆ°æ–‡ç« !&#x27;</span>);</span><br><span class="line">    <span class="comment">// å…³é—­é¡µé¢</span></span><br><span class="line">    <span class="title function_">handleCloseTaskWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¤„ç†è§†é¢‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleVideo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// videos</span></span><br><span class="line">    <span class="keyword">const</span> videos = <span class="keyword">await</span> $_(<span class="string">&#x27;video&#x27;</span>, <span class="literal">undefined</span>, <span class="number">10000</span>);</span><br><span class="line">    <span class="comment">// è§†é¢‘</span></span><br><span class="line">    <span class="keyword">const</span> video = videos[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// æ’­æ”¾æŒ‰é”®</span></span><br><span class="line">    <span class="keyword">const</span> playBtn = $$(<span class="string">&#x27;.prism-play-btn&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (video &amp;&amp; playBtn) &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®æ˜¯å¦é™éŸ³</span></span><br><span class="line">        video.<span class="property">muted</span> = muted;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨å°è¯•æ’­æ”¾è§†é¢‘...&#x27;</span>);</span><br><span class="line">        <span class="comment">// æ’­æ”¾è¶…æ—¶</span></span><br><span class="line">        <span class="keyword">const</span> timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">log</span>(<span class="string">&#x27;è§†é¢‘æ’­æ”¾è¶…æ—¶!&#x27;</span>);</span><br><span class="line">            <span class="comment">// æç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">&#x27;è§†é¢‘æ’­æ”¾è¶…æ—¶!&#x27;</span>);</span><br><span class="line">            <span class="comment">// å…³é—­é¡µé¢</span></span><br><span class="line">            <span class="title function_">handleCloseTaskWin</span>();</span><br><span class="line">        &#125;, <span class="number">20000</span>);</span><br><span class="line">        <span class="comment">// èƒ½æ’­æ”¾</span></span><br><span class="line">        video.<span class="title function_">addEventListener</span>(<span class="string">&#x27;canplay&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">log</span>(<span class="string">&#x27;æ­£åœ¨å°è¯•æ’­æ”¾è§†é¢‘...&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (video.<span class="property">paused</span>) &#123;</span><br><span class="line">                <span class="comment">// å°è¯•ä½¿ç”¨jsçš„æ–¹å¼æ’­æ”¾</span></span><br><span class="line">                video.<span class="title function_">play</span>();</span><br><span class="line">                <span class="keyword">if</span> (video.<span class="property">paused</span>) &#123;</span><br><span class="line">                    <span class="comment">// å°è¯•ç‚¹å‡»æ’­æ”¾æŒ‰é’®æ’­æ”¾</span></span><br><span class="line">                    playBtn.<span class="title function_">click</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å·²ç»æ’­æ”¾</span></span><br><span class="line">            <span class="keyword">if</span> (!video.<span class="property">paused</span>) &#123;</span><br><span class="line">                <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">                <span class="comment">// è§†å¬å­¦ä¹ </span></span><br><span class="line">                <span class="title function_">reading</span>(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;æœªæ‰¾åˆ°è§†é¢‘!&#x27;</span>);</span><br><span class="line">    <span class="comment">// å…³é—­é¡µé¢</span></span><br><span class="line">    <span class="title function_">handleCloseTaskWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯»æ–°é—»æˆ–è€…çœ‹è§†é¢‘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> type :0ä¸ºæ–°é—»,1ä¸ºè§†é¢‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">reading</span>(<span class="params">type</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> time = <span class="number">30</span>;</span><br><span class="line">    <span class="comment">// æ–‡ç« é€‰è¯»</span></span><br><span class="line">    <span class="keyword">if</span> (type === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// ç« èŠ‚</span></span><br><span class="line">        <span class="keyword">const</span> sections = $$(<span class="string">&#x27;section&#x27;</span>);</span><br><span class="line">        <span class="comment">// æœ€å¤§å­—æ•°</span></span><br><span class="line">        <span class="keyword">const</span> maxTextCount = <span class="title class_">Math</span>.<span class="title function_">max</span>(...sections.<span class="title function_">map</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> s.<span class="property">innerText</span>.<span class="property">length</span>), <span class="number">200</span>);</span><br><span class="line">        <span class="comment">// é¢„è®¡æ—¶é—´</span></span><br><span class="line">        <span class="keyword">const</span> predictTime = ~~((<span class="number">60</span> * maxTextCount) / <span class="number">1000</span>);</span><br><span class="line">        <span class="comment">// min(predictTime,  maxWatch.value) ç§’åå…³é—­é¡µé¢</span></span><br><span class="line">        time = <span class="title class_">Math</span>.<span class="title function_">min</span>(predictTime, maxRead.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è§†å¬å­¦ä¹ </span></span><br><span class="line">    <span class="keyword">if</span> (type === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// è§†é¢‘</span></span><br><span class="line">        <span class="keyword">const</span> video = $$(<span class="string">&#x27;video&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// é¢„è®¡æ—¶é—´</span></span><br><span class="line">        <span class="keyword">const</span> predictTime = ~~video.<span class="property">duration</span>;</span><br><span class="line">        <span class="comment">// min(predictTime,  maxWatch.value) ç§’åå…³é—­é¡µé¢</span></span><br><span class="line">        time = <span class="title class_">Math</span>.<span class="title function_">min</span>(predictTime, maxWatch.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éšæœº</span></span><br><span class="line">    time = time - ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€æ¬¡æ»šåŠ¨æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> firstTime = time - (~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>) + <span class="number">4</span>);</span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡æ»šåŠ¨æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> secendTime = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>) + <span class="number">8</span>;</span><br><span class="line">    <span class="comment">// çª—å£</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable language_">window</span> = unsafeWindow;</span><br><span class="line">    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">    <span class="keyword">const</span> tip = <span class="title function_">createTip</span>(<span class="string">&#x27;è·ç¦»å…³é—­é¡µé¢è¿˜å‰©&#x27;</span>, time, <span class="literal">true</span>, <span class="keyword">async</span> (time) =&gt; &#123;</span><br><span class="line">        <span class="comment">// æš‚åœé”</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>(<span class="function">(<span class="params">flag</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (type === <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// è§†é¢‘</span></span><br><span class="line">                <span class="keyword">const</span> video = $$(<span class="string">&#x27;video&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">                <span class="comment">// æ’é™¤åå¤è®¾ç½®</span></span><br><span class="line">                <span class="keyword">if</span> (video.<span class="property">paused</span> === !flag) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è®¾ç½®æ’­æ”¾çŠ¶æ€</span></span><br><span class="line">                video[flag ? <span class="string">&#x27;play&#x27;</span> : <span class="string">&#x27;pause&#x27;</span>]();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡æ»šåŠ¨</span></span><br><span class="line">        <span class="keyword">if</span> (time === firstTime) &#123;</span><br><span class="line">            <span class="comment">// æ»šåŠ¨</span></span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, <span class="number">400</span>);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿæ»šåŠ¨</span></span><br><span class="line">            <span class="keyword">const</span> scroll = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;scroll&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(scroll);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿæ»‘åŠ¨</span></span><br><span class="line">            <span class="keyword">const</span> mousemove = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;mousemove&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(mousemove);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿç‚¹å‡»</span></span><br><span class="line">            <span class="keyword">const</span> click = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;click&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(click);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¬¬äºŒæ¬¡æ»šåŠ¨</span></span><br><span class="line">        <span class="keyword">if</span> (time === secendTime) &#123;</span><br><span class="line">            <span class="comment">// æ»šåŠ¨é•¿åº¦</span></span><br><span class="line">            <span class="keyword">const</span> scrollLength = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span> / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// æ»šåŠ¨</span></span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, scrollLength);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿæ»šåŠ¨</span></span><br><span class="line">            <span class="keyword">const</span> scroll = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;scroll&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(scroll);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿæ»‘åŠ¨</span></span><br><span class="line">            <span class="keyword">const</span> mousemove = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;mousemove&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(mousemove);</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿç‚¹å‡»</span></span><br><span class="line">            <span class="keyword">const</span> click = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;click&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(click);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// å€’è®¡æ—¶ç»“æŸ</span></span><br><span class="line">    <span class="keyword">await</span> tip.<span class="title function_">waitCountDown</span>();</span><br><span class="line">    <span class="comment">// å…³é—­ä»»åŠ¡çª—å£</span></span><br><span class="line">    <span class="title function_">handleCloseTaskWin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–æ–°é—»åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getNews</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// éœ€è¦å­¦ä¹ çš„æ–°é—»æ•°é‡</span></span><br><span class="line">    <span class="keyword">const</span> need = taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">need</span> &lt; maxNewsNum</span><br><span class="line">        ? taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">need</span></span><br><span class="line">        : maxNewsNum;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">`å‰©ä½™ <span class="subst">$&#123;need&#125;</span> ä¸ªæ–°é—»`</span>);</span><br><span class="line">    <span class="comment">// è·å–æ–°é—»</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getNewsList</span>();</span><br><span class="line">    <span class="keyword">if</span> (data &amp;&amp; data.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// æœ€æ–°æ–°é—»</span></span><br><span class="line">        <span class="keyword">const</span> latestItems = data.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">        <span class="comment">// å½“å‰å¹´ä»½</span></span><br><span class="line">        <span class="keyword">const</span> currentYear = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>().<span class="title function_">toString</span>();</span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾ä»Šå¹´æ–°é—»</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; need) &#123;</span><br><span class="line">            <span class="keyword">const</span> randomIndex = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * latestItems.<span class="property">length</span>);</span><br><span class="line">            <span class="comment">// æ–°é—»</span></span><br><span class="line">            <span class="keyword">const</span> item = latestItems[randomIndex];</span><br><span class="line">            <span class="comment">// æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (item.<span class="property">publishTime</span>.<span class="title function_">startsWith</span>(currentYear) &amp;&amp; item.<span class="property">type</span> === <span class="string">&#x27;tuwen&#x27;</span>) &#123;</span><br><span class="line">                news[i] = item;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        news = [];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è·å–è§†é¢‘åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getVideos</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// éœ€è¦å­¦ä¹ çš„è§†é¢‘æ•°é‡</span></span><br><span class="line">    <span class="keyword">const</span> need = taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">need</span> &lt; maxVideoNum</span><br><span class="line">        ? taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">need</span></span><br><span class="line">        : maxVideoNum;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">`å‰©ä½™ <span class="subst">$&#123;need&#125;</span> ä¸ªè§†é¢‘`</span>);</span><br><span class="line">    <span class="comment">// è·å–è§†é¢‘</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getVideoList</span>();</span><br><span class="line">    <span class="keyword">if</span> (data &amp;&amp; data.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// æœ€æ–°è§†é¢‘</span></span><br><span class="line">        <span class="keyword">const</span> latestItems = data.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">        <span class="comment">// å½“å‰å¹´ä»½</span></span><br><span class="line">        <span class="keyword">const</span> currentYear = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>().<span class="title function_">toString</span>();</span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾ä»Šå¹´è§†é¢‘</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; need) &#123;</span><br><span class="line">            <span class="keyword">const</span> randomIndex = ~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * latestItems.<span class="property">length</span>);</span><br><span class="line">            <span class="comment">// æ–°é—»</span></span><br><span class="line">            <span class="keyword">const</span> item = latestItems[randomIndex];</span><br><span class="line">            <span class="comment">// æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (item.<span class="property">publishTime</span>.<span class="title function_">startsWith</span>(currentYear) &amp;&amp;</span><br><span class="line">                (item.<span class="property">type</span> === <span class="string">&#x27;shipin&#x27;</span> || item.<span class="property">type</span> === <span class="string">&#x27;juji&#x27;</span>)) &#123;</span><br><span class="line">                videos[i] = item;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        videos = [];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é˜…è¯»æ–‡ç« </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">readNews</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è·å–æ–‡ç« </span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">getNews</span>();</span><br><span class="line">    <span class="comment">// è§‚çœ‹æ–‡ç« </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> news) &#123;</span><br><span class="line">        <span class="comment">// ä»»åŠ¡å…³é—­è·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (!taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">active</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">`æ­£åœ¨é˜…è¯»ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªæ–°é—»...`</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">`æ­£åœ¨é˜…è¯»ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªæ–°é—»`</span>);</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="keyword">const</span> &#123; url &#125; = news[i];</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="title function_">GM_setValue</span>(<span class="string">&#x27;readingUrl&#x27;</span>, url);</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä»»åŠ¡çª—å£</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">waitTaskWin</span>(url, <span class="string">&#x27;æ–‡ç« é€‰è¯»&#x27;</span>);</span><br><span class="line">        <span class="comment">// æ¸…ç©ºé“¾æ¥</span></span><br><span class="line">        <span class="title function_">GM_setValue</span>(<span class="string">&#x27;readingUrl&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">`å®Œæˆé˜…è¯»ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªæ–°é—»!`</span>);</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1500</span>);</span><br><span class="line">        <span class="comment">// åˆ·æ–°åˆ†æ•°æ•°æ®</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">refreshScoreInfo</span>();</span><br><span class="line">        <span class="comment">// åˆ·æ–°ä»»åŠ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">refreshTaskList</span>();</span><br><span class="line">        <span class="comment">// ä»»åŠ¡å®Œæˆè·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">active</span> &amp;&amp; taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">status</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡å…³é—­è·³å‡ºå¾ªç¯</span></span><br><span class="line">    <span class="keyword">if</span> (!taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">active</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡å®ŒæˆçŠ¶å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">active</span> &amp;&amp; !taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­é˜…è¯»æ–°é—»!&#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­é˜…è¯»æ–°é—»!&#x27;</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">readNews</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è§‚çœ‹è§†é¢‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">watchVideo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è·å–è§†é¢‘</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">getVideos</span>();</span><br><span class="line">    <span class="comment">// è§‚çœ‹è§†é¢‘</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> videos) &#123;</span><br><span class="line">        <span class="comment">// ä»»åŠ¡å…³é—­è·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (!taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">active</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æš‚åœ</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">`æ­£åœ¨è§‚çœ‹ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªè§†é¢‘...`</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">`æ­£åœ¨è§‚çœ‹ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªè§†é¢‘`</span>);</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="keyword">const</span> &#123; url &#125; = videos[i];</span><br><span class="line">        <span class="comment">// é“¾æ¥</span></span><br><span class="line">        <span class="title function_">GM_setValue</span>(<span class="string">&#x27;watchingUrl&#x27;</span>, url);</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä»»åŠ¡çª—å£</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">waitTaskWin</span>(url, <span class="string">&#x27;è§†å¬å­¦ä¹ &#x27;</span>);</span><br><span class="line">        <span class="comment">// æ¸…ç©ºé“¾æ¥</span></span><br><span class="line">        <span class="title function_">GM_setValue</span>(<span class="string">&#x27;watchingUrl&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">`å®Œæˆè§‚çœ‹ç¬¬ <span class="subst">$&#123;<span class="built_in">Number</span>(i) + <span class="number">1</span>&#125;</span> ä¸ªè§†é¢‘!`</span>);</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1500</span>);</span><br><span class="line">        <span class="comment">// åˆ·æ–°åˆ†æ•°æ•°æ®</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">refreshScoreInfo</span>();</span><br><span class="line">        <span class="comment">// åˆ·æ–°ä»»åŠ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">refreshTaskList</span>();</span><br><span class="line">        <span class="comment">// ä»»åŠ¡å®Œæˆè·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">active</span> &amp;&amp;</span><br><span class="line">            taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">status</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡å…³é—­è·³å‡ºå¾ªç¯</span></span><br><span class="line">    <span class="keyword">if</span> (!taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">active</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡å®ŒæˆçŠ¶å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">active</span> &amp;&amp; !taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­è§‚çœ‹è§†é¢‘!&#x27;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">        <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡æœªå®Œæˆ, ç»§ç»­è§‚çœ‹çœ‹è§†é¢‘!&#x27;</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">watchVideo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å®šæ—¶åˆ·æ–°å®šæ—¶å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> scheduleTimer = -<span class="number">1</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">refreshScheduleTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ¸…é™¤å®šæ—¶åˆ·æ–°</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(scheduleTimer);</span><br><span class="line">    <span class="comment">// æœªç™»å½•</span></span><br><span class="line">    <span class="keyword">if</span> (!login.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="comment">// å‰©ä½™å®šæ—¶ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">const</span> restList = scheduleList.<span class="title function_">filter</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> !<span class="title function_">isLate</span>(s));</span><br><span class="line">        <span class="comment">// å­˜åœ¨å‰©ä½™ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">if</span> (restList.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> rest = restList[<span class="number">0</span>];</span><br><span class="line">            <span class="title function_">log</span>(<span class="string">`å·²è®¾ç½® <span class="subst">$&#123;rest.time&#125;</span> çš„å®šæ—¶ä»»åŠ¡!`</span>);</span><br><span class="line">            <span class="comment">// æç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">`å·²è®¾ç½® <span class="subst">$&#123;rest.time&#125;</span> çš„å®šæ—¶ä»»åŠ¡!`</span>);</span><br><span class="line">            <span class="comment">// æ—¶é—´</span></span><br><span class="line">            <span class="keyword">let</span> time = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// åˆ·æ–°é—´éš”</span></span><br><span class="line">            <span class="keyword">const</span> interval = <span class="number">10</span>;</span><br><span class="line">            scheduleTimer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(time++ % interval)) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;å®šæ—¶åˆ·æ–°æ­£åœ¨è¿è¡Œ...&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ°è¾¾å®šæ—¶</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_">isNow</span>(rest)) &#123;</span><br><span class="line">                    <span class="built_in">clearInterval</span>(scheduleTimer);</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">`æ‰§è¡Œ <span class="subst">$&#123;rest.time&#125;</span> çš„å®šæ—¶ä»»åŠ¡!`</span>);</span><br><span class="line">                    <span class="comment">// æç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">`æ‰§è¡Œ <span class="subst">$&#123;rest.time&#125;</span> çš„å®šæ—¶ä»»åŠ¡!`</span>);</span><br><span class="line">                    <span class="comment">// ç™»å½•</span></span><br><span class="line">                    <span class="title function_">handleLogin</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ¸…é™¤å®šæ—¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearScheduleTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(scheduleTimer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ›å»ºå­¦ä¹ æç¤º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createTip</span>(<span class="params">text, delay = <span class="number">2</span>, countShow = <span class="literal">false</span>, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> tipWrap = $$(<span class="string">&#x27;.egg_tip_wrap&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// æå‰å»é™¤</span></span><br><span class="line">    <span class="keyword">const</span> tips = $$(<span class="string">&#x27;.egg_tip&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (tips.<span class="property">length</span>) &#123;</span><br><span class="line">        tips.<span class="title function_">forEach</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> t.<span class="title function_">delay</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">    <span class="keyword">const</span> delayCount = <span class="title function_">ref</span>(delay);</span><br><span class="line">    <span class="comment">// æ–‡å­—</span></span><br><span class="line">    <span class="keyword">const</span> textContent = <span class="title function_">ref</span>(text);</span><br><span class="line">    <span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">    <span class="keyword">const</span> show = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// å»¶è¿Ÿæ˜¾ç¤º</span></span><br><span class="line">    <span class="keyword">const</span> delayShow = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// é”€æ¯</span></span><br><span class="line">    <span class="keyword">let</span> destroyed = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// å€’è®¡æ—¶ç»“æŸ</span></span><br><span class="line">    <span class="keyword">let</span> done = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// æç¤º</span></span><br><span class="line">    <span class="keyword">const</span> tip = <span class="title class_">Tip</span>(&#123;</span><br><span class="line">        <span class="attr">text</span>: textContent,</span><br><span class="line">        <span class="attr">count</span>: delayCount,</span><br><span class="line">        show,</span><br><span class="line">        delayShow,</span><br><span class="line">        <span class="attr">countShow</span>: <span class="title function_">ref</span>(countShow),</span><br><span class="line">        <span class="attr">callback</span>: <span class="keyword">async</span> (count) =&gt; &#123;</span><br><span class="line">            callback &amp;&amp; (<span class="keyword">await</span> <span class="title function_">callback</span>(count));</span><br><span class="line">            <span class="comment">// æ¢å¤æ˜¾ç¤º</span></span><br><span class="line">            <span class="keyword">if</span> (delayShow.<span class="property">value</span> &amp;&amp; count === delay) &#123;</span><br><span class="line">                delayShow.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å€’è®¡æ—¶ç»“æŸ</span></span><br><span class="line">            <span class="keyword">if</span> (count &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                done = <span class="literal">true</span>;</span><br><span class="line">                operate.<span class="title function_">destroy</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// æ“ä½œ</span></span><br><span class="line">    <span class="keyword">const</span> operate = &#123;</span><br><span class="line">        <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!destroyed) &#123;</span><br><span class="line">                <span class="comment">// éšè—</span></span><br><span class="line">                operate.<span class="title function_">hide</span>();</span><br><span class="line">                <span class="comment">// é”€æ¯</span></span><br><span class="line">                destroyed = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        tip.<span class="property">ele</span>.<span class="title function_">remove</span>();</span><br><span class="line">                        <span class="title function_">resolve</span>(<span class="literal">undefined</span>);</span><br><span class="line">                    &#125;, <span class="number">300</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">hide</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!destroyed) &#123;</span><br><span class="line">                show.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!destroyed) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        show.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                        <span class="title function_">resolve</span>(<span class="literal">undefined</span>);</span><br><span class="line">                    &#125;, <span class="number">300</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">setText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!destroyed) &#123;</span><br><span class="line">                textContent.<span class="property">value</span> = text;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">waitCountDown</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// è®¡æ—¶å™¨</span></span><br><span class="line">                <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// ç»“æŸ</span></span><br><span class="line">                    <span class="keyword">if</span> (done) &#123;</span><br><span class="line">                        <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">                        <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, <span class="number">100</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">delay</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!destroyed) &#123;</span><br><span class="line">                delayShow.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                delayCount.<span class="property">value</span> += <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(tip.<span class="property">ele</span>, operate);</span><br><span class="line">    <span class="comment">// æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">mountElement</span>(tip, tipWrap);</span><br><span class="line">    <span class="comment">// æ˜¾ç¤º</span></span><br><span class="line">    operate.<span class="title function_">show</span>();</span><br><span class="line">    <span class="keyword">return</span> operate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">refreshUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æœªç™»å½•</span></span><br><span class="line">    <span class="keyword">if</span> (!login.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç”¨æˆ·æœªç™»å½•!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å·²å­˜åœ¨ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">if</span> (userinfo.<span class="property">nick</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;åŠ è½½ç”¨æˆ·ä¿¡æ¯...&#x27;</span>);</span><br><span class="line">    <span class="comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>();</span><br><span class="line">    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; avatarMediaUrl = <span class="string">&#x27;&#x27;</span>, <span class="attr">nick</span>: nickRes &#125; = res;</span><br><span class="line">        <span class="keyword">if</span> (nickRes) &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®æ˜µç§°</span></span><br><span class="line">            userinfo.<span class="property">nick</span> = nickRes;</span><br><span class="line">            <span class="comment">// è®¾ç½®å¤´åƒ</span></span><br><span class="line">            userinfo.<span class="property">avatar</span> = avatarMediaUrl;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°åˆ†æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">refreshScoreInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æœªç™»å½•</span></span><br><span class="line">    <span class="keyword">if</span> (!login.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç”¨æˆ·æœªç™»å½•!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;åŠ è½½åˆ†æ•°ä¿¡æ¯...&#x27;</span>);</span><br><span class="line">    <span class="comment">// è·å–æ€»åˆ†</span></span><br><span class="line">    <span class="keyword">const</span> totalScoreRes = <span class="keyword">await</span> <span class="title function_">getTotalScore</span>();</span><br><span class="line">    <span class="comment">// è·å–å½“å¤©æ€»åˆ†</span></span><br><span class="line">    <span class="keyword">const</span> todayScoreRes = <span class="keyword">await</span> <span class="title function_">getTodayScore</span>();</span><br><span class="line">    <span class="comment">// æ•´æ•°å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(totalScoreRes) &amp;&amp; <span class="title class_">Number</span>.<span class="title function_">isInteger</span>(todayScoreRes)) &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®åˆ†æ•°</span></span><br><span class="line">        totalScore.<span class="property">value</span> = totalScoreRes;</span><br><span class="line">        todayScore.<span class="property">value</span> = todayScoreRes;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;åŠ è½½åˆ†æ•°ä¿¡æ¯å¤±è´¥!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ·æ–°ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">refreshTaskList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æœªç™»å½•</span></span><br><span class="line">    <span class="keyword">if</span> (!login.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç”¨æˆ·æœªç™»å½•!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;åŠ è½½ä»»åŠ¡è¿›åº¦...&#x27;</span>);</span><br><span class="line">    <span class="comment">// åŸå§‹ä»»åŠ¡è¿›åº¦</span></span><br><span class="line">    <span class="keyword">const</span> taskProgress = <span class="keyword">await</span> <span class="title function_">getTaskList</span>();</span><br><span class="line">    <span class="keyword">if</span> (taskProgress) &#123;</span><br><span class="line">        <span class="comment">// ç™»å½•</span></span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">LOGIN</span>].<span class="property">currentScore</span> = taskProgress[<span class="number">2</span>].<span class="property">currentScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">LOGIN</span>].<span class="property">dayMaxScore</span> = taskProgress[<span class="number">2</span>].<span class="property">dayMaxScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">LOGIN</span>].<span class="property">need</span> =</span><br><span class="line">            taskProgress[<span class="number">2</span>].<span class="property">dayMaxScore</span> - taskProgress[<span class="number">2</span>].<span class="property">currentScore</span>;</span><br><span class="line">        <span class="comment">// æ–‡ç« é€‰è¯»</span></span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">currentScore</span> = taskProgress[<span class="number">0</span>].<span class="property">currentScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">dayMaxScore</span> = taskProgress[<span class="number">0</span>].<span class="property">dayMaxScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">need</span> =</span><br><span class="line">            taskProgress[<span class="number">0</span>].<span class="property">dayMaxScore</span> - taskProgress[<span class="number">0</span>].<span class="property">currentScore</span>;</span><br><span class="line">        <span class="comment">// è§†å¬å­¦ä¹ </span></span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">currentScore</span> = taskProgress[<span class="number">1</span>].<span class="property">currentScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">dayMaxScore</span> = taskProgress[<span class="number">1</span>].<span class="property">dayMaxScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">need</span> =</span><br><span class="line">            taskProgress[<span class="number">1</span>].<span class="property">dayMaxScore</span> - taskProgress[<span class="number">1</span>].<span class="property">currentScore</span>;</span><br><span class="line">        <span class="comment">// æ¯æ—¥ç­”é¢˜</span></span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">currentScore</span> = taskProgress[<span class="number">3</span>].<span class="property">currentScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">dayMaxScore</span> = taskProgress[<span class="number">3</span>].<span class="property">dayMaxScore</span>;</span><br><span class="line">        taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">need</span> = taskProgress[<span class="number">3</span>].<span class="property">dayMaxScore</span>;</span><br><span class="line">        <span class="comment">// æ›´æ–°æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> taskConfig) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; currentScore, dayMaxScore &#125; = taskConfig[i];</span><br><span class="line">            <span class="comment">// è¿›åº¦</span></span><br><span class="line">            <span class="keyword">const</span> rate = <span class="title class_">Number</span>(((<span class="number">100</span> * currentScore) / dayMaxScore).<span class="title function_">toFixed</span>(<span class="number">1</span>));</span><br><span class="line">            <span class="comment">// ç™¾åˆ†æ¯”</span></span><br><span class="line">            taskConfig[i].<span class="property">percent</span> = rate;</span><br><span class="line">            <span class="comment">// åˆ†æ•°</span></span><br><span class="line">            taskConfig[i].<span class="property">score</span> = currentScore;</span><br><span class="line">            <span class="comment">// å®ŒæˆçŠ¶æ€</span></span><br><span class="line">            taskConfig[i].<span class="property">status</span> = rate === <span class="number">100</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é‡è¯•</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">2000</span>);</span><br><span class="line">    <span class="title function_">refreshTaskList</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Tip</span>(<span class="params">&#123; text, count, show, delayShow, countShow, callback, &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="title function_">watchRef</span>([show, delayShow], <span class="function">() =&gt;</span> <span class="string">`egg_tip<span class="subst">$&#123;show.value ? (delayShow.value ? <span class="string">&#x27; active delay&#x27;</span> : <span class="string">&#x27; active&#x27;</span>) : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_text&#x27;</span>,</span><br><span class="line">        &#125;, <span class="title function_">createTextNode</span>(text)),</span><br><span class="line">        <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> countShow.<span class="property">value</span></span><br><span class="line">            ? <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_countdown&#x27;</span>,</span><br><span class="line">            &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`<span class="subst">$&#123;count.value&#125;</span>s`</span>)))</span><br><span class="line">            : <span class="literal">undefined</span>),</span><br><span class="line">    ], &#123;</span><br><span class="line">        <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// å€’è®¡æ—¶</span></span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">countDown</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="comment">// å€’è®¡æ—¶å›è°ƒ</span></span><br><span class="line">                <span class="keyword">await</span> <span class="title function_">callback</span>(count.<span class="property">value</span>);</span><br><span class="line">                <span class="comment">// å€’è®¡æ—¶ç»“æŸ</span></span><br><span class="line">                <span class="keyword">if</span> (!count.<span class="property">value</span>) &#123;</span><br><span class="line">                    show.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                count.<span class="property">value</span>--;</span><br><span class="line">                <span class="built_in">setTimeout</span>(countDown, <span class="number">1000</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="title function_">countDown</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ†éš”ç¬¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Hr</span>(<span class="params">&#123; text &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">&#x27;egg_hr_wrap&#x27;</span>,</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_hr&#x27;</span> &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_hr_title&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(text)),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_hr&#x27;</span> &#125;),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Select</span>(<span class="params">&#123; data, maxlength, placeholder = <span class="string">&#x27;&#x27;</span>, onchange, onblur, value, keep, &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> selectData = <span class="title function_">reactive</span>(data.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123; <span class="attr">selected</span>: <span class="literal">false</span>, <span class="attr">active</span>: <span class="literal">false</span>, <span class="attr">ele</span>: <span class="literal">undefined</span>, ...v &#125;)));</span><br><span class="line">    <span class="keyword">const</span> focus = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> input = <span class="title function_">shallowRef</span>(<span class="literal">undefined</span>);</span><br><span class="line">    <span class="keyword">const</span> list = <span class="title function_">shallowRef</span>(<span class="literal">undefined</span>);</span><br><span class="line">    <span class="keyword">const</span> valueRef = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    value &amp;&amp;</span><br><span class="line">        <span class="title function_">watch</span>(value, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> item = selectData.<span class="title function_">find</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">value</span> === value.<span class="property">value</span>);</span><br><span class="line">            valueRef.<span class="property">value</span> = item ? item.<span class="property">label</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (!item) &#123;</span><br><span class="line">                selectData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (v.<span class="property">selected</span> = <span class="literal">false</span>));</span><br><span class="line">                list.<span class="property">value</span> &amp;&amp; (list.<span class="property">value</span>.<span class="property">scrollTop</span> = <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">&#x27;egg_select&#x27;</span>,</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">value</span>: valueRef &#125;, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_select_input&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">            placeholder,</span><br><span class="line">            maxlength,</span><br><span class="line">            <span class="attr">ref</span>: input,</span><br><span class="line">            <span class="title function_">onfocus</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (list.<span class="property">value</span> &amp;&amp; input.<span class="property">value</span>) &#123;</span><br><span class="line">                    focus.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span> (input.<span class="property">value</span>.<span class="property">value</span> &amp;&amp; valueRef.<span class="property">value</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> index = selectData.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">label</span> === valueRef.<span class="property">value</span>);</span><br><span class="line">                        <span class="keyword">if</span> (index + <span class="number">1</span>) &#123;</span><br><span class="line">                            list.<span class="property">value</span>.<span class="property">scrollTop</span> = selectData[index].<span class="property">ele</span>?.<span class="property">offsetTop</span> || <span class="number">0</span>;</span><br><span class="line">                            selectData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> (v.<span class="property">selected</span> = i === index));</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">oninput</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (list.<span class="property">value</span> &amp;&amp; input.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> &#123; value &#125; = input.<span class="property">value</span>;</span><br><span class="line">                    <span class="comment">// æ–‡æœ¬å­˜åœ¨</span></span><br><span class="line">                    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">                        <span class="keyword">const</span> index = selectData.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">label</span>.<span class="title function_">includes</span>(value));</span><br><span class="line">                        <span class="comment">// å­˜åœ¨åŒ¹é…</span></span><br><span class="line">                        <span class="keyword">if</span> (index + <span class="number">1</span>) &#123;</span><br><span class="line">                            list.<span class="property">value</span>.<span class="property">scrollTop</span> = selectData[index].<span class="property">ele</span>?.<span class="property">offsetTop</span> || <span class="number">0</span>;</span><br><span class="line">                            selectData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123;</span><br><span class="line">                                v.<span class="property">active</span> = i === index;</span><br><span class="line">                                v.<span class="property">active</span> &amp;&amp;</span><br><span class="line">                                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                        v.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">                                    &#125;, <span class="number">300</span>);</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// æ¸…é™¤</span></span><br><span class="line">                    selectData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (v.<span class="property">active</span> = v.<span class="property">selected</span> = <span class="literal">false</span>));</span><br><span class="line">                    list.<span class="property">value</span>.<span class="property">scrollTop</span> = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onblur</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (list.<span class="property">value</span> &amp;&amp; input.<span class="property">value</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> item = selectData.<span class="title function_">find</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">selected</span>);</span><br><span class="line">                    <span class="comment">// å…³é—­é€‰é¡¹</span></span><br><span class="line">                    <span class="keyword">if</span> (item || !input.<span class="property">value</span>.<span class="property">value</span>) &#123;</span><br><span class="line">                        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            focus.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">                        &#125;, <span class="number">100</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// æ¢å¤æ–‡æœ¬</span></span><br><span class="line">                    <span class="keyword">if</span> (item &amp;&amp; input.<span class="property">value</span>.<span class="property">value</span> !== item.<span class="property">label</span>) &#123;</span><br><span class="line">                        input.<span class="property">value</span>.<span class="property">value</span> = item.<span class="property">label</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// ä¿ç•™æ–‡æœ¬</span></span><br><span class="line">                    <span class="keyword">if</span> (!item &amp;&amp; keep) &#123;</span><br><span class="line">                        input.<span class="property">value</span>.<span class="property">value</span> = valueRef.<span class="property">value</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    onblur &amp;&amp;</span><br><span class="line">                        <span class="title function_">onblur</span>(item ? &#123; <span class="attr">label</span>: item.<span class="property">label</span>, <span class="attr">value</span>: item.<span class="property">value</span> &#125; : <span class="literal">undefined</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_select_list<span class="subst">$&#123;focus.value ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27; hide&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">            <span class="attr">ref</span>: list,</span><br><span class="line">        &#125;, selectData.<span class="title function_">map</span>(<span class="function">(<span class="params">v, index</span>) =&gt;</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="title function_">watchRef</span>(<span class="function">() =&gt;</span> [v.<span class="property">selected</span>, v.<span class="property">active</span>], <span class="function">() =&gt;</span> <span class="string">`egg_select_item<span class="subst">$&#123;v.selected ? <span class="string">&#x27; selected&#x27;</span> : v.active ? <span class="string">&#x27; active&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">            <span class="attr">ref</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> (v.<span class="property">ele</span> = e),</span><br><span class="line">            <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (valueRef.<span class="property">value</span> !== v.<span class="property">label</span>) &#123;</span><br><span class="line">                    onchange &amp;&amp; <span class="title function_">onchange</span>(&#123; <span class="attr">label</span>: v.<span class="property">label</span>, <span class="attr">value</span>: v.<span class="property">value</span> &#125;);</span><br><span class="line">                    selectData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123;</span><br><span class="line">                        v.<span class="property">selected</span> = i === index;</span><br><span class="line">                        v.<span class="property">selected</span> &amp;&amp; (valueRef.<span class="property">value</span> = v.<span class="property">label</span>);</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                focus.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">            &#125;, <span class="number">300</span>),</span><br><span class="line">        &#125;, <span class="title function_">createTextNode</span>(v.<span class="property">label</span>)))),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç­”é¢˜æŒ‰é’®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ExamBtn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_exam_btn<span class="subst">$&#123;examPause.value ? <span class="string">&#x27; manual&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">        <span class="attr">onclick</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            examPause.<span class="property">value</span> = !examPause.<span class="property">value</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`<span class="subst">$&#123;examPause.value ? <span class="string">&#x27;å¼€å¯è‡ªåŠ¨ç­”é¢˜&#x27;</span> : <span class="string">&#x27;å…³é—­è‡ªåŠ¨ç­”é¢˜&#x27;</span>&#125;</span>`</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä»»åŠ¡çª—å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Frame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æœ€å¤§åŒ–</span></span><br><span class="line">    <span class="keyword">const</span> max = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// å®¹å™¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_frame_wrap<span class="subst">$&#123;frame.show ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27; hide&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">    &#125;, <span class="title function_">watchRef</span>(<span class="function">() =&gt;</span> [login.<span class="property">value</span>, settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">if</span> (login.<span class="property">value</span> &amp;&amp; settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="comment">// é®ç½©</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_frame_mask&#x27;</span> &#125;),</span><br><span class="line">                <span class="comment">// çª—å£å†…å®¹</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_frame_content_wrap <span class="subst">$&#123;max.value ? <span class="string">&#x27; max&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                &#125;, [</span><br><span class="line">                    <span class="comment">// çª—å£æ§åˆ¶</span></span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_frame_controls_wrap&#x27;</span> &#125;, [</span><br><span class="line">                        <span class="comment">// æ ‡é¢˜</span></span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">class</span>: <span class="string">&#x27;egg_frame_title&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">class</span>: <span class="string">&#x27;egg_frame_controls&#x27;</span>,</span><br><span class="line">                        &#125;, [</span><br><span class="line">                            <span class="comment">// éšè—</span></span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_frame_btn&#x27;</span>,</span><br><span class="line">                                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&#x27;éšè—&#x27;</span>,</span><br><span class="line">                                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                    <span class="comment">// éšè—çª—å£</span></span><br><span class="line">                                    frame.<span class="property">show</span> = <span class="literal">false</span>;</span><br><span class="line">                                &#125;, <span class="number">300</span>),</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">d</span>: <span class="string">&#x27;M863.7 552.5H160.3c-10.6 0-19.2-8.6-19.2-19.2v-41.7c0-10.6 8.6-19.2 19.2-19.2h703.3c10.6 0 19.2 8.6 19.2 19.2v41.7c0 10.6-8.5 19.2-19.1 19.2z&#x27;</span>,</span><br><span class="line">                            &#125;))),</span><br><span class="line">                            <span class="comment">// æ”¹å˜å¤§å°</span></span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_frame_btn&#x27;</span>,</span><br><span class="line">                                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&#x27;ç¼©æ”¾&#x27;</span>,</span><br><span class="line">                                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                    max.<span class="property">value</span> = !max.<span class="property">value</span>;</span><br><span class="line">                                &#125;, <span class="number">300</span>),</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">d</span>: <span class="string">&#x27;M609.52 584.92a35.309 35.309 0 0 1 24.98-10.36c9.37 0 18.36 3.73 24.98 10.36l189.29 189.22-0.07-114.3 0.57-6.35c3.25-17.98 19.7-30.5 37.9-28.85 18.2 1.65 32.12 16.92 32.09 35.2v200.23c-0.05 1.49-0.19 2.97-0.42 4.45l-0.21 1.13c-0.22 1.44-0.55 2.85-0.99 4.24l-0.57 1.62-0.56 1.41a34.163 34.163 0 0 1-7.62 11.36l2.12-2.4-0.14 0.14-0.92 1.06-1.06 1.2-0.57 0.57-0.56 0.57a36.378 36.378 0 0 1-16.23 8.39l-3.53 0.5-4.02 0.35h-199.6l-6.35-0.63c-16.73-3.06-28.9-17.63-28.93-34.64l0.56-6.35c3.07-16.76 17.67-28.93 34.71-28.92l114.29-0.14-189.07-189.1-4.09-4.94c-9.71-14.01-8.01-32.95 4.02-45.02z m-162.06 0c12.06 12.05 13.78 30.99 4.09 45.01l-4.09 4.94-189.15 189.08 114.3 0.14c17.04-0.01 31.65 12.17 34.71 28.92l0.57 6.35c-0.03 17.01-12.19 31.58-28.92 34.64l-6.35 0.63H173.09l-4.23-0.42-3.39-0.49a36.38 36.38 0 0 1-17.36-9.52l-1.06-1.13-0.98-1.13 0.98 1.06-1.97-2.26 0.85 1.06-0.42-0.56a35.137 35.137 0 0 1-3.74-5.64l-1.13-2.68a34.71 34.71 0 0 1-2.11-7.33l-0.28-1.13c-0.21-1.47-0.33-2.96-0.36-4.45V659.78c-0.03-18.28 13.89-33.55 32.09-35.2 18.2-1.65 34.65 10.87 37.9 28.85l0.57 6.35-0.07 114.36 189.29-189.22c13.77-13.77 36.11-13.77 49.88 0h-0.09z m-74.71-471.71l6.35 0.57c16.76 3.06 28.93 17.67 28.92 34.71l-0.63 6.35c-3.07 16.76-17.67 28.93-34.71 28.92l-114.3 0.14 189.15 189.08 4.09 4.94c10.26 15.02 7.42 35.37-6.55 47.01-13.98 11.63-34.51 10.74-47.42-2.07L208.29 233.71l0.07 114.3-0.57 6.35c-3.25 17.98-19.7 30.5-37.9 28.85-18.2-1.65-32.12-16.92-32.09-35.2V147.78c0-1.55 0.14-3.03 0.35-4.51l0.21-1.13c0.24-1.44 0.59-2.85 1.06-4.23a34.97 34.97 0 0 1 8.68-14.39l-2.12 2.4-0.42 0.57 1.55-1.84-0.99 1.06 0.92-0.98 2.26-2.33c3.04-2.73 6.52-4.92 10.3-6.49l2.82-1.06c3.45-1.07 7.04-1.62 10.65-1.62l-3.6 0.14h0.49l1.48-0.14h201.31z m512.91 0l1.41 0.14h0.42c2.43 0.29 4.84 0.79 7.19 1.48l2.82 1.06 2.61 1.2 3.04 1.76c2.09 1.33 4.03 2.89 5.78 4.66l1.13 1.2 0.78 0.98 0.21 0.14 0.49 0.64 2.33 3.17c2.35 3.83 3.98 8.07 4.8 12.49l0.21 1.13c0.21 1.48 0.35 2.96 0.35 4.44v200.37c-0.16 18.13-14.03 33.19-32.08 34.83-18.06 1.64-34.42-10.67-37.83-28.48l-0.57-6.35V233.65L659.54 422.87c-12.9 12.95-33.56 13.91-47.59 2.2-14.04-11.71-16.81-32.2-6.38-47.22l4.02-4.86 189.22-189.08-114.29-0.14c-17.06 0.04-31.71-12.14-34.78-28.92l-0.63-6.35c-0.01-17.04 12.16-31.65 28.93-34.71l6.35-0.57h201.27z m0 0&#x27;</span>,</span><br><span class="line">                            &#125;))),</span><br><span class="line">                            <span class="comment">// å…³é—­</span></span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_frame_btn&#x27;</span>,</span><br><span class="line">                                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&#x27;å…³é—­&#x27;</span>,</span><br><span class="line">                                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                    <span class="comment">// å…³é—­çª—å£</span></span><br><span class="line">                                    <span class="title function_">closeFrame</span>();</span><br><span class="line">                                &#125;, <span class="number">300</span>),</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">d</span>: <span class="string">&#x27;M453.44 512L161.472 220.032a41.408 41.408 0 0 1 58.56-58.56L512 453.44 803.968 161.472a41.408 41.408 0 0 1 58.56 58.56L570.56 512l291.968 291.968a41.408 41.408 0 0 1-58.56 58.56L512 570.56 220.032 862.528a41.408 41.408 0 0 1-58.56-58.56L453.44 512z&#x27;</span>,</span><br><span class="line">                            &#125;))),</span><br><span class="line">                        ]),</span><br><span class="line">                    ]),</span><br><span class="line">                    <span class="comment">// çª—å£å†…å®¹</span></span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_frame_content&#x27;</span>,</span><br><span class="line">                    &#125;, <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> frame.<span class="property">src</span></span><br><span class="line">                        ? [</span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;iframe&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_frame&#x27;</span>,</span><br><span class="line">                                <span class="attr">src</span>: frame.<span class="property">src</span>,</span><br><span class="line">                                <span class="title function_">ref</span>(<span class="params">ele</span>) &#123;</span><br><span class="line">                                    frame.<span class="property">ele</span> = ele;</span><br><span class="line">                                &#125;,</span><br><span class="line">                            &#125;, <span class="literal">undefined</span>),</span><br><span class="line">                        ]</span><br><span class="line">                        : <span class="literal">undefined</span>)),</span><br><span class="line">                ], &#123;</span><br><span class="line">                    <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                        <span class="comment">// éšè—çª—å£</span></span><br><span class="line">                        <span class="title function_">watch</span>(<span class="function">() =&gt;</span> [</span><br><span class="line">                            taskStatus.<span class="property">value</span>,</span><br><span class="line">                            running.<span class="property">value</span>,</span><br><span class="line">                            settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>],</span><br><span class="line">                            settings[<span class="title class_">SettingType</span>.<span class="property">SILENT_RUN</span>],</span><br><span class="line">                        ], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">                            <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>] &amp;&amp;</span><br><span class="line">                                (taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">START</span> ||</span><br><span class="line">                                    taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">PAUSE</span> ||</span><br><span class="line">                                    running.<span class="property">value</span>)) &#123;</span><br><span class="line">                                <span class="comment">// è®¾ç½®çª—å£æ˜¾ç¤º</span></span><br><span class="line">                                frame.<span class="property">show</span> = !settings[<span class="title class_">SettingType</span>.<span class="property">SILENT_RUN</span>];</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;),</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;), &#123;</span><br><span class="line">        <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// å…³é—­çª—å£</span></span><br><span class="line">            <span class="title function_">watch</span>(<span class="function">() =&gt;</span> [login.<span class="property">value</span>, settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]], <span class="function">() =&gt;</span> login.<span class="property">value</span> &amp;&amp;</span><br><span class="line">                (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>] ? <span class="title function_">closeWin</span>() : <span class="title function_">closeFrame</span>()));</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç™»å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LoginItem</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> login.<span class="property">value</span></span><br><span class="line">            ? <span class="literal">undefined</span></span><br><span class="line">            : <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_login_item&#x27;</span>,</span><br><span class="line">            &#125;, [</span><br><span class="line">                <span class="comment">// ç™»å½•æŒ‰é’®</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_login_btn&#x27;</span>,</span><br><span class="line">                    <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                        <span class="comment">// å¼€å§‹ç™»å½•</span></span><br><span class="line">                        <span class="title function_">handleLogin</span>();</span><br><span class="line">                    &#125;, <span class="number">300</span>),</span><br><span class="line">                &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;æ‰«ç ç™»å½•&#x27;</span>)),</span><br><span class="line">                <span class="comment">// çª—å£</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_login_img_wrap<span class="subst">$&#123;loginQRCodeShow.value ? <span class="string">&#x27; active&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;img&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_login_img&#x27;</span>,</span><br><span class="line">                &#125;)),</span><br><span class="line">            ], &#123;</span><br><span class="line">                <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="title function_">watch</span>(<span class="function">() =&gt;</span> settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// æœªå¼€å¯å®šæ—¶å±•ç¤ºäºŒç»´ç </span></span><br><span class="line">                        <span class="keyword">if</span> (!settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>]) &#123;</span><br><span class="line">                            <span class="comment">// å¼€å§‹ç™»å½•</span></span><br><span class="line">                            <span class="title function_">handleLogin</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="literal">true</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">InfoItem</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (login.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_info_item&#x27;</span>,</span><br><span class="line">            &#125;, [</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_userinfo&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="comment">// å¤´åƒ</span></span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_avatar&#x27;</span> &#125;, <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> [</span><br><span class="line">                            userinfo.<span class="property">avatar</span></span><br><span class="line">                                ? <span class="title function_">createElementNode</span>(<span class="string">&#x27;img&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                    <span class="attr">src</span>: userinfo.<span class="property">avatar</span>,</span><br><span class="line">                                    <span class="attr">class</span>: <span class="string">&#x27;egg_avatar_img&#x27;</span>,</span><br><span class="line">                                &#125;)</span><br><span class="line">                                : <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                    <span class="attr">class</span>: <span class="string">&#x27;egg_avatar_nick&#x27;</span>,</span><br><span class="line">                                &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> userinfo.<span class="property">nick</span>.<span class="title function_">substring</span>(<span class="number">1</span>, <span class="number">3</span>)))),</span><br><span class="line">                        ];</span><br><span class="line">                    &#125;)),</span><br><span class="line">                    <span class="comment">// æ˜µç§°</span></span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_nick&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> userinfo.<span class="property">nick</span>))),</span><br><span class="line">                ]),</span><br><span class="line">                <span class="comment">// é€€å‡ºæŒ‰é’®</span></span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_login_btn&#x27;</span>,</span><br><span class="line">                    <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// é€€å‡ºç™»å½•</span></span><br><span class="line">                        <span class="title function_">handleLogout</span>();</span><br><span class="line">                    &#125;, <span class="number">300</span>),</span><br><span class="line">                &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;é€€å‡º&#x27;</span>)),</span><br><span class="line">            ], &#123;</span><br><span class="line">                <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="comment">// åˆ·æ–°ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                    <span class="title function_">refreshUserInfo</span>();</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ†æ•°è¯¦æƒ…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ScoreItem</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (login.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ†æ•°æ˜¾ç¤º</span></span><br><span class="line">            <span class="keyword">const</span> scoreShow = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">            <span class="comment">// åˆ†æ•°ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_score_item&#x27;</span>,</span><br><span class="line">            &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_scoreinfo&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_totalscore&#x27;</span>,</span><br><span class="line">                &#125;, [</span><br><span class="line">                    <span class="title function_">createTextNode</span>(<span class="string">&#x27;æ€»ç§¯åˆ†&#x27;</span>),</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="title function_">createTextNode</span>(totalScore)),</span><br><span class="line">                ]),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_todayscore&#x27;</span>,</span><br><span class="line">                &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_todayscore_btn&#x27;</span>,</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;æŸ¥çœ‹åˆ†æ•°è¯¦æƒ…&#x27;</span>,</span><br><span class="line">                        <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            scoreShow.<span class="property">value</span> = !scoreShow.<span class="property">value</span>;</span><br><span class="line">                        &#125;, <span class="number">300</span>),</span><br><span class="line">                        <span class="attr">onblur</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            scoreShow.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;, [</span><br><span class="line">                        <span class="title function_">createTextNode</span>(<span class="string">&#x27;å½“å¤©åˆ†æ•°&#x27;</span>),</span><br><span class="line">                        <span class="comment">// å½“å¤©åˆ†æ•°</span></span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="title function_">createTextNode</span>(todayScore)),</span><br><span class="line">                        <span class="comment">// icon</span></span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                            <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                        &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z&#x27;</span>,</span><br><span class="line">                        &#125;)),</span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_score_details<span class="subst">$&#123;scoreShow.value ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27; hide&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                        &#125;, [</span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_score_title&#x27;</span> &#125;, [</span><br><span class="line">                                <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                    <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                                    <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                                &#125;, [</span><br><span class="line">                                    <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                        <span class="attr">d</span>: <span class="string">&#x27;M314.81 304.01h415.86v58.91H314.81zM314.81 440.24h415.86v58.91H314.81z&#x27;</span>,</span><br><span class="line">                                    &#125;),</span><br><span class="line">                                    <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                        <span class="attr">d</span>: <span class="string">&#x27;M814.8 892.74h-8.64l-283.51-182-283.51 182h-8.64A69.85 69.85 0 0 1 160.72 823V188.22a69.85 69.85 0 0 1 69.77-69.77H814.8a69.85 69.85 0 0 1 69.77 69.77V823a69.85 69.85 0 0 1-69.77 69.74zM230.5 177.35a10.87 10.87 0 0 0-10.86 10.86V823a10.86 10.86 0 0 0 5 9.11l298.01-191.42 298.06 191.38a10.86 10.86 0 0 0 5-9.11V188.22a10.87 10.87 0 0 0-10.86-10.86z&#x27;</span>,</span><br><span class="line">                                    &#125;),</span><br><span class="line">                                ]),</span><br><span class="line">                                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                    <span class="attr">class</span>: <span class="string">&#x27;egg_score_title_text&#x27;</span>,</span><br><span class="line">                                &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;ç§¯åˆ†è¯¦æƒ…&#x27;</span>)),</span><br><span class="line">                            ]),</span><br><span class="line">                            ...taskConfig.<span class="title function_">map</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_score_item&#x27;</span> &#125;, [</span><br><span class="line">                                <span class="title function_">createTextNode</span>(task.<span class="property">title</span>),</span><br><span class="line">                                <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                    <span class="attr">class</span>: <span class="string">&#x27;egg_score_detail&#x27;</span>,</span><br><span class="line">                                &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> task.<span class="property">score</span>))),</span><br><span class="line">                            ])),</span><br><span class="line">                        ]),</span><br><span class="line">                    ]),</span><br><span class="line">                ]),</span><br><span class="line">            ]), &#123;</span><br><span class="line">                <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="comment">// åˆ·æ–°åˆ†æ•°ä¿¡æ¯</span></span><br><span class="line">                    <span class="title function_">refreshScoreInfo</span>();</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®æ™®é€šé¡¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">NomalItem</span>(<span class="params">&#123; title, tip, checked, onchange, &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_setting_item&#x27;</span> &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_label_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;label&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_task_title&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createTextNode</span>(title),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_detail&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: tip,</span><br><span class="line">                &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;i&#x27;</span>)),</span><br><span class="line">            ]),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;input&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">title</span>: tip,</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_switch&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;checkbox&#x27;</span>,</span><br><span class="line">            checked,</span><br><span class="line">            onchange,</span><br><span class="line">        &#125;),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®ä»»åŠ¡é¡¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TaskItem</span>(<span class="params">&#123; title, tip, checked, percent, currentScore, dayMaxScore, onchange, immutable, &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">&#x27;egg_task_item&#x27;</span>,</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_label_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_task_title_wrap&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_task_title&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(title)),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_task_progress_wrap&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_task_current&#x27;</span>,</span><br><span class="line">                    &#125;, <span class="title function_">createTextNode</span>(currentScore)),</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_task_max&#x27;</span>,</span><br><span class="line">                    &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`/<span class="subst">$&#123;dayMaxScore.value&#125;</span>`</span>))),</span><br><span class="line">                ]),</span><br><span class="line">            ]),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_progress&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_track&#x27;</span> &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_bar&#x27;</span>,</span><br><span class="line">                    <span class="attr">style</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`width: <span class="subst">$&#123;percent.value&#125;</span>%;`</span>),</span><br><span class="line">                &#125;)),</span><br><span class="line">            ]),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;input&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">title</span>: tip,</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_switch&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;checkbox&#x27;</span>,</span><br><span class="line">            checked,</span><br><span class="line">            onchange,</span><br><span class="line">            <span class="attr">disabled</span>: immutable,</span><br><span class="line">        &#125;),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä»»åŠ¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TaskList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†ä»»åŠ¡è®¾ç½®å˜åŒ–</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleTaskChange</span> = (<span class="params">e, type, title</span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// å¼€å…³</span></span><br><span class="line">        <span class="keyword">const</span> &#123; checked &#125; = e.<span class="property">target</span>;</span><br><span class="line">        <span class="keyword">if</span> (taskConfig[type].<span class="property">active</span> !== checked) &#123;</span><br><span class="line">            taskConfig[type].<span class="property">active</span> = checked;</span><br><span class="line">            <span class="comment">// è®¾ç½®</span></span><br><span class="line">            <span class="title function_">GM_setValue</span>(<span class="string">&#x27;taskConfig&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(taskConfig));</span><br><span class="line">            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">`<span class="subst">$&#123;title&#125;</span> <span class="subst">$&#123;checked ? <span class="string">&#x27;æ‰“å¼€&#x27;</span> : <span class="string">&#x27;å…³é—­&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// ç™»å½•åŠ è½½</span></span><br><span class="line">    <span class="title function_">watch</span>(login, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (login.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="comment">// åŠ è½½ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">refreshTaskList</span>();</span><br><span class="line">            <span class="comment">// æœªå®Œæˆä»»åŠ¡</span></span><br><span class="line">            <span class="keyword">if</span> (taskConfig.<span class="title function_">some</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> task.<span class="property">active</span> &amp;&amp; !task.<span class="property">status</span>)) &#123;</span><br><span class="line">                <span class="comment">// å…¨å±€æš‚åœ</span></span><br><span class="line">                <span class="title function_">GM_setValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">                <span class="comment">// åŠ è½½å®Œæ¯•</span></span><br><span class="line">                taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">LOADED</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä»»åŠ¡å®Œæ¯•</span></span><br><span class="line">            taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">FINISH</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">&#x27;egg_task_list&#x27;</span>,</span><br><span class="line">    &#125;, taskConfig.<span class="title function_">map</span>(<span class="function">(<span class="params">label</span>) =&gt;</span> label.<span class="property">immutable</span></span><br><span class="line">        ? <span class="title class_">TaskItem</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: label.<span class="property">title</span>,</span><br><span class="line">            <span class="attr">tip</span>: label.<span class="property">tip</span>,</span><br><span class="line">            <span class="attr">checked</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">active</span>),</span><br><span class="line">            <span class="attr">percent</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">percent</span>),</span><br><span class="line">            <span class="attr">currentScore</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">currentScore</span>),</span><br><span class="line">            <span class="attr">dayMaxScore</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">dayMaxScore</span>),</span><br><span class="line">            <span class="attr">onchange</span>: <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">handleTaskChange</span>(e, label.<span class="property">type</span>, label.<span class="property">title</span>);</span><br><span class="line">            &#125;, <span class="number">300</span>),</span><br><span class="line">            <span class="attr">immutable</span>: label.<span class="property">immutable</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        : <span class="title class_">TaskItem</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: label.<span class="property">title</span>,</span><br><span class="line">            <span class="attr">tip</span>: label.<span class="property">tip</span>,</span><br><span class="line">            <span class="attr">checked</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">active</span>),</span><br><span class="line">            <span class="attr">percent</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">percent</span>),</span><br><span class="line">            <span class="attr">currentScore</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">currentScore</span>),</span><br><span class="line">            <span class="attr">dayMaxScore</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> label.<span class="property">dayMaxScore</span>),</span><br><span class="line">            <span class="attr">onchange</span>: <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">handleTaskChange</span>(e, label.<span class="property">type</span>, label.<span class="property">title</span>);</span><br><span class="line">            &#125;, <span class="number">300</span>),</span><br><span class="line">            <span class="attr">immutable</span>: label.<span class="property">immutable</span>,</span><br><span class="line">        &#125;)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ä»»åŠ¡æŒ‰é’®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TaskBtn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (login.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@description</span> å­¦ä¹ </span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">study</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;å¼€å§‹å­¦ä¹ !&#x27;</span>);</span><br><span class="line">                <span class="comment">// æš‚åœ</span></span><br><span class="line">                <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">                <span class="comment">// æ–‡ç« é€‰è¯»</span></span><br><span class="line">                <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">active</span> &amp;&amp;</span><br><span class="line">                    !taskConfig[<span class="title class_">TaskType</span>.<span class="property">READ</span>].<span class="property">status</span>) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡ä¸€: æ–‡ç« é€‰è¯»&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡ä¸€: æ–‡ç« é€‰è¯»&#x27;</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">                    <span class="comment">// çœ‹æ–°é—»</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">readNews</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡ä¸€: æ–‡ç« é€‰è¯»å·²å®Œæˆ!&#x27;</span>);</span><br><span class="line">                <span class="comment">// è§†å¬å­¦ä¹ </span></span><br><span class="line">                <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">active</span> &amp;&amp;</span><br><span class="line">                    !taskConfig[<span class="title class_">TaskType</span>.<span class="property">WATCH</span>].<span class="property">status</span>) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡äºŒ: è§†å¬å­¦ä¹ &#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡äºŒ: è§†å¬å­¦ä¹ &#x27;</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">                    <span class="comment">// çœ‹è§†é¢‘</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">watchVideo</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡äºŒ: è§†å¬å­¦ä¹ å·²å®Œæˆ!&#x27;</span>);</span><br><span class="line">                <span class="comment">// æ¯æ—¥ç­”é¢˜</span></span><br><span class="line">                <span class="keyword">if</span> (taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">active</span> &amp;&amp;</span><br><span class="line">                    !taskConfig[<span class="title class_">TaskType</span>.<span class="property">PRACTICE</span>].<span class="property">status</span>) &#123;</span><br><span class="line">                    <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡ä¸‰: æ¯æ—¥ç­”é¢˜&#x27;</span>);</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;ä»»åŠ¡ä¸‰: æ¯æ—¥ç­”é¢˜&#x27;</span>);</span><br><span class="line">                    <span class="comment">// æš‚åœ</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">studyPauseLock</span>();</span><br><span class="line">                    <span class="comment">// åšæ¯æ—¥ç­”é¢˜</span></span><br><span class="line">                    <span class="keyword">await</span> <span class="title function_">doExamPractice</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;ä»»åŠ¡ä¸‰: æ¯æ—¥ç­”é¢˜å·²å®Œæˆ!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@description</span> æš‚åœä»»åŠ¡</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">pauseTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// å…¨å±€æš‚åœ</span></span><br><span class="line">                <span class="title function_">GM_setValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">                taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">PAUSE</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@description</span> ç»§ç»­ä»»åŠ¡</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">continueTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// å…¨å±€æš‚åœ</span></span><br><span class="line">                <span class="title function_">GM_setValue</span>(<span class="string">&#x27;pauseStudy&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">                taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">START</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@description</span> å¼€å§‹ä»»åŠ¡</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">startTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// æœªå®Œæˆä»»åŠ¡</span></span><br><span class="line">                <span class="keyword">if</span> (taskConfig.<span class="title function_">some</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> task.<span class="property">active</span> &amp;&amp; !task.<span class="property">status</span>)) &#123;</span><br><span class="line">                    <span class="comment">// å¼€å§‹ä»»åŠ¡</span></span><br><span class="line">                    taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">START</span>;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="comment">// å­¦ä¹ </span></span><br><span class="line">                        <span class="keyword">await</span> <span class="title function_">study</span>();</span><br><span class="line">                        <span class="comment">// åŒå±ä»»åŠ¡</span></span><br><span class="line">                        <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>]) &#123;</span><br><span class="line">                            <span class="comment">// å…³é—­çª—å£</span></span><br><span class="line">                            <span class="title function_">closeFrame</span>();</span><br><span class="line">                            <span class="comment">// çª—å£ä¸å­˜åœ¨</span></span><br><span class="line">                            frame.<span class="property">exist</span> = <span class="literal">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (err <span class="keyword">instanceof</span> <span class="title class_">Error</span>) &#123;</span><br><span class="line">                            <span class="comment">// æç¤º</span></span><br><span class="line">                            <span class="title function_">createTip</span>(err.<span class="property">message</span>);</span><br><span class="line">                            <span class="comment">// é”™è¯¯</span></span><br><span class="line">                            <span class="title function_">error</span>(err.<span class="property">message</span>);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// æç¤º</span></span><br><span class="line">                        <span class="title function_">createTip</span>(err);</span><br><span class="line">                        <span class="comment">// é”™è¯¯</span></span><br><span class="line">                        <span class="title function_">error</span>(err);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ·æ–°ä»»åŠ¡</span></span><br><span class="line">                taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">FINISH</span>;</span><br><span class="line">                <span class="title function_">log</span>(<span class="string">&#x27;å·²å®Œæˆ&#x27;</span>);</span><br><span class="line">                <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                <span class="title function_">createTip</span>(<span class="string">&#x27;å®Œæˆå­¦ä¹ !&#x27;</span>);</span><br><span class="line">                <span class="comment">// è¿œç¨‹æ¨é€</span></span><br><span class="line">                <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]) &#123;</span><br><span class="line">                    <span class="comment">// æ¨é€</span></span><br><span class="line">                    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">pushModal</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;å­¦ä¹ æ¨é€&#x27;</span>,</span><br><span class="line">                        <span class="attr">to</span>: userinfo.<span class="property">nick</span>,</span><br><span class="line">                        <span class="attr">content</span>: [</span><br><span class="line">                            <span class="string">&#x27;å­¦ä¹ å¼ºå›½, å­¦ä¹ å®Œæˆ!&#x27;</span>,</span><br><span class="line">                            <span class="string">`å½“å¤©ç§¯åˆ†:  <span class="subst">$&#123;getHighlightHTML(todayScore.value)&#125;</span> åˆ†`</span>,</span><br><span class="line">                            <span class="string">`æ€»ç§¯åˆ†: <span class="subst">$&#123;getHighlightHTML(totalScore.value)&#125;</span> åˆ†`</span>,</span><br><span class="line">                            ...taskConfig.<span class="title function_">map</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> <span class="title function_">getProgressHTML</span>(task.<span class="property">title</span>, task.<span class="property">percent</span>)),</span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">                    &#125;, pushToken.<span class="property">value</span>);</span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">`å­¦ä¹ æ¨é€<span class="subst">$&#123;res ? <span class="string">&#x27;æˆåŠŸ&#x27;</span> : <span class="string">&#x27;å¤±è´¥&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å·²åœ¨ç­‰å¾…</span></span><br><span class="line">            <span class="keyword">let</span> flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// è‡ªåŠ¨ç­”é¢˜</span></span><br><span class="line">            <span class="title function_">watch</span>(<span class="function">() =&gt;</span> [taskStatus.<span class="property">value</span>, settings[<span class="title class_">SettingType</span>.<span class="property">AUTO_START</span>]], <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                <span class="comment">// åŠ è½½å®Œæ¯•</span></span><br><span class="line">                <span class="keyword">if</span> (!flag &amp;&amp; taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">LOADED</span>) &#123;</span><br><span class="line">                    <span class="comment">// è‡ªåŠ¨ç­”é¢˜</span></span><br><span class="line">                    <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">AUTO_START</span>]) &#123;</span><br><span class="line">                        <span class="comment">// ç­‰å¾…ä¸­</span></span><br><span class="line">                        flag = <span class="literal">true</span>;</span><br><span class="line">                        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                        <span class="keyword">const</span> tip = <span class="title function_">createTip</span>(<span class="string">&#x27;å³å°†è‡ªåŠ¨å¼€å§‹ä»»åŠ¡&#x27;</span>, <span class="number">5</span>, <span class="literal">true</span>);</span><br><span class="line">                        <span class="comment">// ç­‰å¾…å€’è®¡æ—¶ç»“æŸ</span></span><br><span class="line">                        <span class="keyword">await</span> tip.<span class="title function_">waitCountDown</span>();</span><br><span class="line">                        <span class="comment">// å†æ¬¡æŸ¥çœ‹æ˜¯å¦å¼€å¯</span></span><br><span class="line">                        <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">AUTO_START</span>] &amp;&amp;</span><br><span class="line">                            taskStatus.<span class="property">value</span> !== <span class="title class_">TaskStatusType</span>.<span class="property">START</span>) &#123;</span><br><span class="line">                            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                            <span class="title function_">createTip</span>(<span class="string">&#x27;è‡ªåŠ¨å¼€å§‹ä»»åŠ¡&#x27;</span>);</span><br><span class="line">                            <span class="comment">// å¼€å§‹ä»»åŠ¡</span></span><br><span class="line">                            <span class="title function_">startTask</span>();</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// å–æ¶ˆç­‰å¾…</span></span><br><span class="line">                        flag = <span class="literal">false</span>;</span><br><span class="line">                        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                        <span class="title function_">createTip</span>(<span class="string">&#x27;å·²å–æ¶ˆè‡ªåŠ¨å¼€å§‹ä»»åŠ¡!&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// åˆ‡æ¢å¼€å…³ä»»åŠ¡æœªå®Œæˆ</span></span><br><span class="line">            taskConfig.<span class="title function_">forEach</span>(<span class="function">(<span class="params">task</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">watch</span>(<span class="function">() =&gt;</span> [task.<span class="property">active</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">FINISH</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (task.<span class="property">active</span> &amp;&amp; !task.<span class="property">status</span>) &#123;</span><br><span class="line">                            taskStatus.<span class="property">value</span> = <span class="title class_">TaskStatusType</span>.<span class="property">LOADED</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_study_item&#x27;</span> &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_study_btn<span class="subst">$&#123;taskStatus.value === TaskStatusType.START ? <span class="string">&#x27; loading&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">disabled</span>: <span class="title function_">watchRef</span>(<span class="function">() =&gt;</span> [running.<span class="property">value</span>, taskStatus.<span class="property">value</span>], <span class="function">() =&gt;</span> running.<span class="property">value</span> ||</span><br><span class="line">                    taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">LOADING</span> ||</span><br><span class="line">                    taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">FINISH</span>),</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">LOADED</span></span><br><span class="line">                    ? <span class="title function_">debounce</span>(startTask, <span class="number">300</span>)</span><br><span class="line">                    : taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">START</span></span><br><span class="line">                        ? <span class="title function_">debounce</span>(pauseTask, <span class="number">300</span>)</span><br><span class="line">                        : taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">PAUSE</span></span><br><span class="line">                            ? <span class="title function_">debounce</span>(continueTask, <span class="number">300</span>)</span><br><span class="line">                            : <span class="literal">undefined</span>),</span><br><span class="line">            &#125;, <span class="title function_">createTextNode</span>(<span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`<span class="subst">$&#123;taskStatus.value === TaskStatusType.LOADING</span></span></span><br><span class="line"><span class="subst"><span class="string">                ? <span class="string">&#x27;ç­‰å¾…ä¸­&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                : taskStatus.value === TaskStatusType.LOADED</span></span></span><br><span class="line"><span class="subst"><span class="string">                    ? <span class="string">&#x27;å¼€å§‹å­¦ä¹ &#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                    : taskStatus.value === TaskStatusType.START</span></span></span><br><span class="line"><span class="subst"><span class="string">                        ? <span class="string">&#x27;æ­£åœ¨å­¦ä¹ , ç‚¹å‡»æš‚åœ&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                        : taskStatus.value === TaskStatusType.PAUSE</span></span></span><br><span class="line"><span class="subst"><span class="string">                            ? <span class="string">&#x27;ç»§ç»­å­¦ä¹ &#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                            : taskStatus.value === TaskStatusType.FINISH</span></span></span><br><span class="line"><span class="subst"><span class="string">                                ? <span class="string">&#x27;å·²å®Œæˆ&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                                : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>))));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å®šæ—¶é¡¹ç›®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ScheduleList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_list&#x27;</span> &#125;, <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> scheduleList.<span class="property">length</span></span><br><span class="line">            ? scheduleList.<span class="title function_">map</span>(<span class="function">(<span class="params">schedule</span>) =&gt;</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_item&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">`egg_schedule_detail_time_wrap<span class="subst">$&#123;isLate(schedule) ? <span class="string">&#x27; inactive&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>,</span><br><span class="line">                &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_detail_icon&#x27;</span>,</span><br><span class="line">                    &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                    &#125;, [</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M810.137703 213.860762c-164.388001-164.4187-431.887404-164.4187-596.277452 0-164.417677 164.388001-164.417677 431.889451 0 596.278475 164.390048 164.417677 431.890474 164.417677 596.277452 0C974.557426 645.750213 974.557426 378.248763 810.137703 213.860762zM767.347131 767.345596c-140.797723 140.829446-369.927237 140.797723-510.693238 0-140.828422-140.797723-140.828422-369.895515 0-510.708588 140.767024-140.783397 369.896538-140.813073 510.693238 0C908.14383 397.420405 908.14383 626.578572 767.347131 767.345596z&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M721.450824 521.495258 515.404028 521.495258l0.028653-227.948619c0-15.124466-12.362562-27.458375-27.501354-27.458375s-27.443026 12.33391-27.443026 27.458375l0 235.115855c0 0.835018-1.013073 20.48659 12.094456 34.459836 8.331759 8.809643 20.038382 13.288654 35.148521 13.288654l213.720569 0.031722c15.140839 0 27.472702-12.304234 27.472702-27.474748C748.922503 533.887496 736.620315 521.584286 721.450824 521.495258z&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                    ])),</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_detail_time&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(schedule.<span class="property">time</span>)),</span><br><span class="line">                ]),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_detail_del_wrap&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_del_btn&#x27;</span>,</span><br><span class="line">                        <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            <span class="comment">// å®šæ—¶åˆ·æ–°</span></span><br><span class="line">                            <span class="keyword">if</span> (!settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>]) &#123;</span><br><span class="line">                                <span class="title function_">createTip</span>(<span class="string">&#x27;æœªå¼€å¯å®šæ—¶åˆ·æ–°!&#x27;</span>);</span><br><span class="line">                                <span class="keyword">return</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="comment">// ç´¢å¼•</span></span><br><span class="line">                            <span class="keyword">const</span> index = scheduleList.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">s</span>) =&gt;</span> s === schedule);</span><br><span class="line">                            <span class="comment">// åˆ é™¤å…ƒç´ </span></span><br><span class="line">                            scheduleList.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">                            <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                            <span class="title function_">GM_setValue</span>(<span class="string">&#x27;scheduleList&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(scheduleList));</span><br><span class="line">                            <span class="comment">// åˆ·æ–°ä»»åŠ¡</span></span><br><span class="line">                            <span class="title function_">refreshScheduleTask</span>();</span><br><span class="line">                        &#125;, <span class="number">300</span>),</span><br><span class="line">                    &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                    &#125;, [</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M896.22 896.22c14.262-14.263 11.263-40.449-6.583-58.295L230.473 178.76c-17.847-17.847-44.105-20.846-58.295-6.583-14.263 14.19-11.264 40.448 6.583 58.295l659.164 659.164c17.846 17.846 44.032 20.845 58.294 6.582&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M172.178 896.22c-14.263-14.263-11.264-40.449 6.583-58.295L837.925 178.76c17.846-17.847 44.032-20.846 58.294-6.583 14.263 14.19 11.264 40.448-6.582 58.295L230.4 889.637c-17.847 17.846-44.105 20.845-58.295 6.582&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                    ])),</span><br><span class="line">                ]),</span><br><span class="line">            ]))</span><br><span class="line">            : [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_list_none&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                    &#125;, [</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M238.1 520.5c-17.6 0-31.9-14.3-31.9-31.9 0-17.6 14.3-31.9 31.9-31.9h293c17.6 0 31.9 14.3 31.9 31.9 0 17.6-14.3 31.9-31.9 31.9h-293zM238.1 733.6c-17.6 0-31.9-14.3-31.9-31.9s14.3-31.9 31.9-31.9h186.5c17.6 0 31.9 14.3 31.9 31.9s-14.3 31.9-31.9 31.9H238.1zM241.6 314.9c-17.6 0-31.9-14.3-31.9-31.9s14.3-31.9 31.9-31.9h426.1c17.6 0 31.9 14.3 31.9 31.9 0 17.5-14.3 31.7-31.8 31.9H241.6z&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M160 926.6c-46.9 0-85.1-38.2-85.1-85.1V149.1c0-46.9 38.2-85.1 85.1-85.1h586c46.9 0 85.1 38.2 85.1 85.1v297.4c0 17.6-14.3 31.9-31.9 31.9-17.6 0-31.9-14.3-31.9-31.9V149.1c0-11.8-9.6-21.4-21.4-21.4H160c-11.8 0-21.4 9.6-21.4 21.4v692.4c0 11.8 9.6 21.4 21.4 21.4h304.5c17.5 0 31.8 14.2 31.9 31.8 0 17.6-14.3 31.8-31.9 31.8H160z&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                        <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                            <span class="attr">d</span>: <span class="string">&#x27;M917.2 959.9c-8.5 0-16.5-3.3-22.5-9.3l-78.5-78.5-5.3-0.5-0.6 0.4c-31.7 21.6-68.7 33-107 33-105.2 0-190.8-85.6-190.8-190.8s85.6-190.8 190.8-190.8c105.2 0 190.8 85.6 190.8 190.8 0 38.2-11.4 75.2-33 107l-0.4 0.6 0.5 5.3 78.5 78.5c6 6 9.3 14 9.3 22.5s-3.4 16.5-9.4 22.5c-5.9 6-13.9 9.3-22.4 9.3zM703.4 587c-70.1 0-127.2 57.1-127.2 127.2s57.1 127.2 127.2 127.2 127.2-57.1 127.2-127.2S773.6 587 703.4 587z&#x27;</span>,</span><br><span class="line">                        &#125;),</span><br><span class="line">                    ]),</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_list_none_text&#x27;</span>,</span><br><span class="line">                    &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;æš‚æ— å®šæ—¶ä»»åŠ¡&#x27;</span>)),</span><br><span class="line">                ]),</span><br><span class="line">            ];</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ—¶é—´è¾“å…¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TimeInput</span>(<span class="params">&#123; hour, minute, onchange, &#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// å°æ—¶</span></span><br><span class="line">    <span class="keyword">const</span> hours = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">24</span>).<span class="title function_">fill</span>(<span class="literal">undefined</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">value</span>: i,</span><br><span class="line">        <span class="attr">label</span>: <span class="title function_">formatDateNum</span>(i),</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="comment">// åˆ†é’Ÿ</span></span><br><span class="line">    <span class="keyword">const</span> minutes = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">60</span>).<span class="title function_">fill</span>(<span class="literal">undefined</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">v, i</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">value</span>: i,</span><br><span class="line">        <span class="attr">label</span>: <span class="title function_">formatDateNum</span>(i),</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="keyword">const</span> valueRef = <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> h = hours.<span class="title function_">find</span>(<span class="function">(<span class="params">h</span>) =&gt;</span> h.<span class="property">value</span> === hour.<span class="property">value</span>);</span><br><span class="line">        <span class="keyword">const</span> min = minutes.<span class="title function_">find</span>(<span class="function">(<span class="params">min</span>) =&gt;</span> min.<span class="property">value</span> === minute.<span class="property">value</span>);</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">hour</span>: h ? h.<span class="property">value</span> : -<span class="number">1</span>,</span><br><span class="line">            <span class="attr">minute</span>: min ? min.<span class="property">value</span> : -<span class="number">1</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_time_input&#x27;</span> &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_hour_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title class_">Select</span>(&#123;</span><br><span class="line">                <span class="attr">data</span>: hours,</span><br><span class="line">                <span class="attr">placeholder</span>: <span class="string">&#x27;00&#x27;</span>,</span><br><span class="line">                <span class="attr">maxlength</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="attr">value</span>: hour,</span><br><span class="line">                <span class="title function_">onchange</span>(<span class="params">&#123; value &#125;</span>) &#123;</span><br><span class="line">                    valueRef.<span class="property">value</span>.<span class="property">hour</span> = value;</span><br><span class="line">                    onchange &amp;&amp; <span class="title function_">onchange</span>(valueRef.<span class="property">value</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">onblur</span>(<span class="params">res</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">                        valueRef.<span class="property">value</span>.<span class="property">hour</span> = -<span class="number">1</span>;</span><br><span class="line">                        onchange &amp;&amp; <span class="title function_">onchange</span>(valueRef.<span class="property">value</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;span&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_separator&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;:&#x27;</span>)),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_minute_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title class_">Select</span>(&#123;</span><br><span class="line">                <span class="attr">data</span>: minutes,</span><br><span class="line">                <span class="attr">placeholder</span>: <span class="string">&#x27;00&#x27;</span>,</span><br><span class="line">                <span class="attr">maxlength</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="attr">value</span>: minute,</span><br><span class="line">                <span class="title function_">onchange</span>(<span class="params">&#123; value &#125;</span>) &#123;</span><br><span class="line">                    valueRef.<span class="property">value</span>.<span class="property">minute</span> = value;</span><br><span class="line">                    onchange &amp;&amp; <span class="title function_">onchange</span>(valueRef.<span class="property">value</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">onblur</span>(<span class="params">res</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">                        valueRef.<span class="property">value</span>.<span class="property">minute</span> = -<span class="number">1</span>;</span><br><span class="line">                        onchange &amp;&amp; <span class="title function_">onchange</span>(valueRef.<span class="property">value</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;),</span><br><span class="line">        ]),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è®¾ç½®é¢æ¿ç»„ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SettingsPanel</span>(<span class="params">&#123; show &#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// token</span></span><br><span class="line">    <span class="keyword">let</span> token = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// å°æ—¶</span></span><br><span class="line">    <span class="keyword">let</span> hour = <span class="title function_">ref</span>(-<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// åˆ†é’Ÿ</span></span><br><span class="line">    <span class="keyword">let</span> minute = <span class="title function_">ref</span>(-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_settings<span class="subst">$&#123;show.value ? <span class="string">&#x27; active&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_version_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;ç‰ˆæœ¬ä¿¡æ¯&#x27;</span>)),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_settings_version&#x27;</span>,</span><br><span class="line">            &#125;, [</span><br><span class="line">                <span class="title function_">createTextNode</span>(<span class="string">`v<span class="subst">$&#123;version&#125;</span>`</span>),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;a&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_settings_version_detail&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;GitHub Xu22Web/tech-study-js&#x27;</span>,</span><br><span class="line">                    <span class="attr">href</span>: <span class="string">&#x27;https://github.com/Xu22Web/tech-study-js&#x27;</span>,</span><br><span class="line">                &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 16 16&#x27;</span>,</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">d</span>: <span class="string">&#x27;M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z&#x27;</span>,</span><br><span class="line">                &#125;))),</span><br><span class="line">            ]),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_theme_wrap&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;ä¸»é¢˜é¢„è®¾&#x27;</span>)),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_theme_colors&#x27;</span> &#125;, [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#fa3333&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;å¼ºå›½çº¢&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;XueXi Red&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#bb2649&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;éå‡¡æ´‹çº¢&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Viva Magenta&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;18-1750&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#35548a&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;ç»å…¸è“&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Classic Blue&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;19-4052&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#f36f63&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;æ´»çŠç‘šæ©˜&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Living Coral&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;16-1546&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#6d5b97&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;ç´«å¤–å…‰è‰²&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Ultra Violet&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;18-3838&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#86af49&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;è‰æœ¨ç»¿&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Greenery&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;15-0343&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#fc8bab&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;Bç«™ç²‰&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Bilibili Pink&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">value</span>: <span class="string">&#x27;#056de8&#x27;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;çŸ¥ä¹è“&#x27;</span>,</span><br><span class="line">                    <span class="attr">detail</span>: <span class="string">&#x27;Zhihu Blue&#x27;</span>,</span><br><span class="line">                    <span class="attr">code</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">            ].<span class="title function_">map</span>(<span class="function">(<span class="params">color</span>) =&gt;</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_settings_theme_color_wrap&#x27;</span>,</span><br><span class="line">            &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_settings_theme_color&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">style</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`color: <span class="subst">$&#123;color.value&#125;</span>;<span class="subst">$&#123;themeColor.value === color.value</span></span></span><br><span class="line"><span class="subst"><span class="string">                    ? <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">                    : <span class="string">` box-shadow: 0rem 0.4rem 0.1rem 0.1rem <span class="subst">$&#123;color.value&#125;</span>30;`</span>&#125;</span>`</span>),</span><br><span class="line">                <span class="attr">title</span>: color.<span class="property">title</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (themeColor.<span class="property">value</span> !== color.<span class="property">value</span>) &#123;</span><br><span class="line">                        themeColor.<span class="property">value</span> = color.<span class="property">value</span>;</span><br><span class="line">                        <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                        <span class="title function_">GM_setValue</span>(<span class="string">&#x27;themeColor&#x27;</span>, themeColor.<span class="property">value</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;)))),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_settings_read_time_wrap&#x27;</span>,</span><br><span class="line">        &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;æœ€å¤§æ–‡ç« æ—¶é•¿&#x27;</span>)),</span><br><span class="line">            <span class="title class_">Select</span>(&#123;</span><br><span class="line">                <span class="attr">data</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;40s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">40</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;60s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">60</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;80s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">80</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;100s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">100</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">value</span>: maxRead,</span><br><span class="line">                <span class="attr">placeholder</span>: <span class="string">&#x27;100s&#x27;</span>,</span><br><span class="line">                <span class="attr">maxlength</span>: <span class="number">4</span>,</span><br><span class="line">                <span class="attr">keep</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="title function_">onchange</span>(<span class="params">&#123; value &#125;</span>) &#123;</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;æœ€å¤§æ–‡ç« æ—¶é•¿ å·²ä¿å­˜!&#x27;</span>);</span><br><span class="line">                    maxRead.<span class="property">value</span> = value;</span><br><span class="line">                    <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;maxRead&#x27;</span>, value);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;),</span><br><span class="line">        ], &#123;</span><br><span class="line">            <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> maxReadTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;maxRead&#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (maxReadTemp) &#123;</span><br><span class="line">                        maxRead.<span class="property">value</span> = maxReadTemp;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_settings_watch_time_wrap&#x27;</span>,</span><br><span class="line">        &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;æœ€å¤§è§†å¬æ—¶é•¿&#x27;</span>)),</span><br><span class="line">            <span class="title class_">Select</span>(&#123;</span><br><span class="line">                <span class="attr">data</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;40s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">40</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;60s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">60</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;80s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">80</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;100s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">100</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">label</span>: <span class="string">&#x27;120s&#x27;</span>,</span><br><span class="line">                        <span class="attr">value</span>: <span class="number">120</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">value</span>: maxWatch,</span><br><span class="line">                <span class="attr">placeholder</span>: <span class="string">&#x27;120s&#x27;</span>,</span><br><span class="line">                <span class="attr">maxlength</span>: <span class="number">4</span>,</span><br><span class="line">                <span class="attr">keep</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="title function_">onchange</span>(<span class="params">&#123; value &#125;</span>) &#123;</span><br><span class="line">                    <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                    <span class="title function_">createTip</span>(<span class="string">&#x27;æœ€å¤§è§†å¬æ—¶é•¿ å·²ä¿å­˜!&#x27;</span>);</span><br><span class="line">                    maxWatch.<span class="property">value</span> = value;</span><br><span class="line">                    <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;maxWatch&#x27;</span>, value);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;),</span><br><span class="line">        ], &#123;</span><br><span class="line">            <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> maxWatchTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;maxWatch&#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (maxWatchTemp) &#123;</span><br><span class="line">                        maxWatch.<span class="property">value</span> = maxWatchTemp;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]</span><br><span class="line">            ? <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_token_wrap&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_token&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;æˆ‘çš„ token&#x27;</span>)),</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;input&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                        <span class="attr">class</span>: <span class="string">&#x27;egg_settings_token_input&#x27;</span>,</span><br><span class="line">                        <span class="attr">placeholder</span>: <span class="string">&#x27;ç”¨æˆ· token&#x27;</span>,</span><br><span class="line">                        <span class="attr">maxlength</span>: <span class="number">32</span>,</span><br><span class="line">                        <span class="attr">value</span>: pushToken.<span class="property">value</span>,</span><br><span class="line">                        <span class="attr">onfocus</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">const</span> input = e.<span class="property">target</span>;</span><br><span class="line">                            input.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">                            <span class="keyword">const</span> btnWrap = $$(<span class="string">&#x27;.egg_settings_submit_btn_wrap&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">                            btnWrap.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">onblur</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">const</span> input = e.<span class="property">target</span>;</span><br><span class="line">                            <span class="comment">// å»é™¤ç©ºæ ¼</span></span><br><span class="line">                            <span class="keyword">const</span> value = input.<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line">                            <span class="keyword">if</span> (<span class="regexp">/^[0-9a-z]&#123;32&#125;$/</span>.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">                                token = value;</span><br><span class="line">                                input.<span class="property">value</span> = value;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> &#123;</span><br><span class="line">                                token = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            input.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">                            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                <span class="keyword">const</span> btnWrap = $$(<span class="string">&#x27;.egg_settings_submit_btn_wrap&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">                                btnWrap.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">                                input.<span class="property">value</span> = pushToken.<span class="property">value</span>;</span><br><span class="line">                            &#125;, <span class="number">200</span>);</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;),</span><br><span class="line">                ]),</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_submit_btn_wrap&#x27;</span> &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">class</span>: <span class="string">&#x27;egg_settings_submit_btn&#x27;</span>,</span><br><span class="line">                    <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">                        <span class="title function_">createTip</span>(<span class="string">&#x27;ç”¨æˆ· token å·²ä¿å­˜!&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (token !== pushToken.<span class="property">value</span>) &#123;</span><br><span class="line">                            pushToken.<span class="property">value</span> = token;</span><br><span class="line">                            <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                            <span class="title function_">GM_setValue</span>(<span class="string">&#x27;pushToken&#x27;</span>, token);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="number">300</span>),</span><br><span class="line">                &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;ä¿å­˜&#x27;</span>))),</span><br><span class="line">            ])</span><br><span class="line">            : <span class="literal">undefined</span>),</span><br><span class="line">        <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>]</span><br><span class="line">            ? <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule&#x27;</span> &#125;, [</span><br><span class="line">                <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_time_wrap&#x27;</span> &#125;, [</span><br><span class="line">                    <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_time&#x27;</span> &#125;, [</span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_label&#x27;</span> &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;è®¾ç½®æ—¶é—´&#x27;</span>)),</span><br><span class="line">                        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_time_input_wrap&#x27;</span> &#125;, [</span><br><span class="line">                            <span class="title class_">TimeInput</span>(&#123;</span><br><span class="line">                                hour,</span><br><span class="line">                                minute,</span><br><span class="line">                                <span class="title function_">onchange</span>(<span class="params">&#123; hour: h, minute: min &#125;</span>) &#123;</span><br><span class="line">                                    hour.<span class="property">value</span> = h;</span><br><span class="line">                                    minute.<span class="property">value</span> = min;</span><br><span class="line">                                &#125;,</span><br><span class="line">                            &#125;),</span><br><span class="line">                            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_schedule_add_btn&#x27;</span>,</span><br><span class="line">                                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                    <span class="comment">// å®šæ—¶åˆ·æ–°</span></span><br><span class="line">                                    <span class="keyword">if</span> (!settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>]) &#123;</span><br><span class="line">                                        <span class="title function_">createTip</span>(<span class="string">&#x27;æœªå¼€å¯å®šæ—¶åˆ·æ–°!&#x27;</span>);</span><br><span class="line">                                        <span class="keyword">return</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="keyword">if</span> (hour.<span class="property">value</span> === -<span class="number">1</span> || minute.<span class="property">value</span> === -<span class="number">1</span>) &#123;</span><br><span class="line">                                        <span class="title function_">createTip</span>(<span class="string">&#x27;æ—¶é—´æ ¼å¼ä¸ç¬¦åˆè¦æ±‚!&#x27;</span>);</span><br><span class="line">                                        <span class="keyword">return</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="comment">// é‡å¤å®šæ—¶å­˜åœ¨</span></span><br><span class="line">                                    <span class="keyword">const</span> exists = scheduleList.<span class="title function_">find</span>(<span class="function">(<span class="params">schedule</span>) =&gt;</span> schedule.<span class="property">hour</span> === hour.<span class="property">value</span> &amp;&amp;</span><br><span class="line">                                        schedule.<span class="property">minute</span> === minute.<span class="property">value</span>);</span><br><span class="line">                                    <span class="keyword">if</span> (exists) &#123;</span><br><span class="line">                                        <span class="title function_">createTip</span>(<span class="string">&#x27;è®¾ç½®å®šæ—¶ä»»åŠ¡é‡å¤!&#x27;</span>);</span><br><span class="line">                                        <span class="keyword">return</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="title function_">createTip</span>(<span class="string">&#x27;è®¾ç½®å®šæ—¶ä»»åŠ¡æˆåŠŸ!&#x27;</span>);</span><br><span class="line">                                    <span class="comment">// æ·»åŠ </span></span><br><span class="line">                                    scheduleList.<span class="title function_">push</span>(&#123;</span><br><span class="line">                                        <span class="attr">hour</span>: hour.<span class="property">value</span>,</span><br><span class="line">                                        <span class="attr">minute</span>: minute.<span class="property">value</span>,</span><br><span class="line">                                        <span class="attr">time</span>: <span class="string">`<span class="subst">$&#123;formatDateNum(hour.value)&#125;</span>:<span class="subst">$&#123;formatDateNum(minute.value)&#125;</span>`</span>,</span><br><span class="line">                                    &#125;);</span><br><span class="line">                                    <span class="comment">// æ’åº</span></span><br><span class="line">                                    scheduleList.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">hour</span> === b.<span class="property">hour</span></span><br><span class="line">                                        ? a.<span class="property">minute</span> - b.<span class="property">minute</span></span><br><span class="line">                                        : a.<span class="property">hour</span> - b.<span class="property">hour</span>);</span><br><span class="line">                                    <span class="comment">// å­˜å‚¨</span></span><br><span class="line">                                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;scheduleList&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(scheduleList));</span><br><span class="line">                                    <span class="comment">// æ¸…ç©º</span></span><br><span class="line">                                    hour.<span class="property">value</span> = -<span class="number">1</span>;</span><br><span class="line">                                    minute.<span class="property">value</span> = -<span class="number">1</span>;</span><br><span class="line">                                    <span class="keyword">const</span> inputs = $$(<span class="string">&#x27;.egg_time_input input&#x27;</span>);</span><br><span class="line">                                    inputs.<span class="title function_">forEach</span>(<span class="function">(<span class="params">i</span>) =&gt;</span> (i.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>));</span><br><span class="line">                                    <span class="comment">// åˆ·æ–°ä»»åŠ¡</span></span><br><span class="line">                                    <span class="title function_">refreshScheduleTask</span>();</span><br><span class="line">                                &#125;, <span class="number">300</span>),</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">                            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                                <span class="attr">d</span>: <span class="string">&#x27;M801.171 483.589H544V226.418c0-17.673-14.327-32-32-32s-32 14.327-32 32v257.171H222.83c-17.673 0-32 14.327-32 32s14.327 32 32 32H480v257.17c0 17.673 14.327 32 32 32s32-14.327 32-32v-257.17h257.171c17.673 0 32-14.327 32-32s-14.327-32-32-32z&#x27;</span>,</span><br><span class="line">                            &#125;))),</span><br><span class="line">                        ]),</span><br><span class="line">                    ]),</span><br><span class="line">                ]),</span><br><span class="line">                <span class="title class_">ScheduleList</span>(),</span><br><span class="line">            ])</span><br><span class="line">            : <span class="literal">undefined</span>),</span><br><span class="line">    ], &#123;</span><br><span class="line">        <span class="title function_">onMounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ·æ–°token</span></span><br><span class="line">            <span class="title function_">watch</span>(<span class="function">() =&gt;</span> settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// è¿œç¨‹æ¨é€</span></span><br><span class="line">                <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>]) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">const</span> tokenTemp = <span class="title function_">GM_getValue</span>(<span class="string">&#x27;pushToken&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (tokenTemp) &#123;</span><br><span class="line">                            pushToken.<span class="property">value</span> = tokenTemp;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// åˆ·æ–°å®šæ—¶ä»»åŠ¡</span></span><br><span class="line">            <span class="title function_">watch</span>(<span class="function">() =&gt;</span> settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// å®šæ—¶ä»»åŠ¡æ‰“å¼€</span></span><br><span class="line">                <span class="keyword">if</span> (settings[<span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>]) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">const</span> scheduleTemp = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title function_">GM_getValue</span>(<span class="string">&#x27;scheduleList&#x27;</span>));</span><br><span class="line">                        <span class="keyword">if</span> (scheduleTemp &amp;&amp; <span class="title class_">Array</span>.<span class="title function_">isArray</span>(scheduleTemp)) &#123;</span><br><span class="line">                            <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> scheduleTemp) &#123;</span><br><span class="line">                                scheduleList[i] = scheduleTemp[i];</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line">                    <span class="comment">// åˆ·æ–°å®šæ—¶ä»»åŠ¡</span></span><br><span class="line">                    <span class="title function_">refreshScheduleTask</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// æ¸…é™¤ä»»åŠ¡</span></span><br><span class="line">                <span class="title function_">clearScheduleTask</span>();</span><br><span class="line">            &#125;, <span class="literal">true</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é¢æ¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Panel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è¿è¡Œè®¾ç½®æ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">const</span> runLabels = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;è‡ªåŠ¨å¼€å§‹&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;å¯åŠ¨æ—¶, è‡ªåŠ¨å¼€å§‹ä»»åŠ¡, åœ¨å€’è®¡æ—¶ç»“æŸå‰è‡ªåŠ¨å¼€å§‹å¯éšæ—¶å–æ¶ˆ; å¦‚æœåœ¨è‡ªåŠ¨å¼€å§‹å‰æ‰‹åŠ¨å¼€å§‹ä»»åŠ¡, æ­¤æ¬¡è‡ªåŠ¨å¼€å§‹å°†å–æ¶ˆ&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">AUTO_START</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;åŒå±ä»»åŠ¡&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;è¿è¡Œä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰ä»»åŠ¡å‡åœ¨å½“å‰é¡µé¢ä»¥å¼¹çª—æ–¹å¼è¿è¡Œ&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">SAME_TAB</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;é™é»˜è¿è¡Œ&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;åŒå±ä»»åŠ¡æ—¶, ä¸æ˜¾ç¤ºä»»åŠ¡å¼¹çª—é™é»˜è¿è¡Œ&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">SILENT_RUN</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;å®šæ—¶åˆ·æ–°&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;å®šæ—¶åˆ·æ–°é¡µé¢ï¼Œé‡æ–°è¿›è¡Œä»»åŠ¡ï¼Œæ­¤åŠŸèƒ½éœ€è¦é•¿æ—¶é—´å ç”¨æµè§ˆå™¨&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">SCHEDULE_RUN</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">// è¿è¡Œè®¾ç½®æ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">const</span> examLabels = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;éšæœºä½œç­”&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;æ— ç­”æ¡ˆæ—¶, éšæœºé€‰æ‹©æˆ–è€…å¡«å…¥ç­”æ¡ˆ, ä¸ä¿è¯æ­£ç¡®&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">RANDOM_EXAM</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">// æ¨é€è®¾ç½®æ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">const</span> pushLabels = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;è¿œç¨‹æ¨é€&#x27;</span>,</span><br><span class="line">            <span class="attr">tip</span>: <span class="string">&#x27;åˆ©ç”¨ pushplus æ¨é€, å°†ç™»å½•äºŒç»´ç ç›´æ¥æ¨é€åˆ°å¾®ä¿¡å…¬ä¼—å·&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">SettingType</span>.<span class="property">REMOTE_PUSH</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">// å¤„ç†è®¾ç½®å˜åŒ–</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleSettingsChange</span> = (<span class="params">e, type, title</span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// å¼€å…³</span></span><br><span class="line">        <span class="keyword">const</span> &#123; checked &#125; = e.<span class="property">target</span>;</span><br><span class="line">        <span class="keyword">if</span> (settings[type] !== checked) &#123;</span><br><span class="line">            settings[type] = checked;</span><br><span class="line">            <span class="comment">// è®¾ç½®</span></span><br><span class="line">            <span class="title function_">GM_setValue</span>(<span class="string">&#x27;studySettings&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(settings));</span><br><span class="line">            <span class="comment">// åˆ›å»ºæç¤º</span></span><br><span class="line">            <span class="title function_">createTip</span>(<span class="string">`<span class="subst">$&#123;title&#125;</span> <span class="subst">$&#123;checked ? <span class="string">&#x27;æ‰“å¼€&#x27;</span> : <span class="string">&#x27;å…³é—­&#x27;</span>&#125;</span>!`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡æ˜¾ç¤º</span></span><br><span class="line">    <span class="keyword">const</span> scheduleShow = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// é¢æ¿æ˜¾ç¤º</span></span><br><span class="line">    <span class="keyword">const</span> panelShow = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="string">`egg_panel_wrap<span class="subst">$&#123;hasMobile() ? <span class="string">&#x27; mobile&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>,</span><br><span class="line">    &#125;, <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">        <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_panel<span class="subst">$&#123;panelShow.value ? <span class="string">&#x27; hide&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">    &#125;, [</span><br><span class="line">        <span class="comment">// ç™»å½•</span></span><br><span class="line">        <span class="title class_">LoginItem</span>(),</span><br><span class="line">        <span class="comment">// ä¿¡æ¯</span></span><br><span class="line">        <span class="title class_">InfoItem</span>(),</span><br><span class="line">        <span class="comment">// åˆ†æ•°</span></span><br><span class="line">        <span class="title class_">ScoreItem</span>(),</span><br><span class="line">        <span class="comment">// ä»»åŠ¡éƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Hr</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;ä»»åŠ¡&#x27;</span> &#125;),</span><br><span class="line">        <span class="title class_">TaskList</span>(),</span><br><span class="line">        <span class="comment">// è¿è¡Œéƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Hr</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;è¿è¡Œ&#x27;</span> &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_run_list&#x27;</span> &#125;, runLabels.<span class="title function_">map</span>(<span class="function">(<span class="params">label</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">NomalItem</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: label.<span class="property">title</span>,</span><br><span class="line">                <span class="attr">tip</span>: label.<span class="property">tip</span>,</span><br><span class="line">                <span class="attr">checked</span>: settings[label.<span class="property">type</span>],</span><br><span class="line">                <span class="attr">onchange</span>: <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">handleSettingsChange</span>(e, label.<span class="property">type</span>, label.<span class="property">title</span>);</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)),</span><br><span class="line">        <span class="comment">// ç­”é¢˜éƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Hr</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;ç­”é¢˜&#x27;</span> &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_exam_list&#x27;</span> &#125;, examLabels.<span class="title function_">map</span>(<span class="function">(<span class="params">label</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">NomalItem</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: label.<span class="property">title</span>,</span><br><span class="line">                <span class="attr">tip</span>: label.<span class="property">tip</span>,</span><br><span class="line">                <span class="attr">checked</span>: settings[label.<span class="property">type</span>],</span><br><span class="line">                <span class="attr">onchange</span>: <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">handleSettingsChange</span>(e, label.<span class="property">type</span>, label.<span class="property">title</span>);</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)),</span><br><span class="line">        <span class="comment">// æ¨é€éƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Hr</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;æ¨é€&#x27;</span> &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_push_list&#x27;</span> &#125;, pushLabels.<span class="title function_">map</span>(<span class="function">(<span class="params">label</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">NomalItem</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: label.<span class="property">title</span>,</span><br><span class="line">                <span class="attr">tip</span>: label.<span class="property">tip</span>,</span><br><span class="line">                <span class="attr">checked</span>: settings[label.<span class="property">type</span>],</span><br><span class="line">                <span class="attr">onchange</span>: <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">handleSettingsChange</span>(e, label.<span class="property">type</span>, label.<span class="property">title</span>);</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)),</span><br><span class="line">        <span class="comment">// æç¤ºéƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Hr</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;æç¤º&#x27;</span> &#125;),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_tip_list&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title function_">createTextNode</span>(<span class="string">&#x27;ä¸“é¡¹ç»ƒä¹ å·²è¢«ç§»é™¤, å¦‚éœ€ä½¿ç”¨, è¯·ç‚¹å‡»&#x27;</span>),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_tip_btn&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(doExamPaper, <span class="number">300</span>),</span><br><span class="line">                <span class="attr">disabled</span>: <span class="title function_">watchRef</span>(<span class="function">() =&gt;</span> [running.<span class="property">value</span>, taskStatus.<span class="property">value</span>], <span class="function">() =&gt;</span> running.<span class="property">value</span> ||</span><br><span class="line">                    taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">START</span> ||</span><br><span class="line">                    taskStatus.<span class="property">value</span> === <span class="title class_">TaskStatusType</span>.<span class="property">PAUSE</span>),</span><br><span class="line">            &#125;, <span class="title function_">createTextNode</span>(<span class="string">&#x27;å»å®Œæˆ&#x27;</span>)),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="comment">// æŒ‰é’®é›†åˆ</span></span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&#x27;egg_btns_wrap&#x27;</span>,</span><br><span class="line">        &#125;, [</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="title function_">watchRef</span>(<span class="function">() =&gt;</span> [frame.<span class="property">exist</span>, frame.<span class="property">show</span>], <span class="function">() =&gt;</span> <span class="string">`egg_frame_show_btn<span class="subst">$&#123;!frame.exist || frame.show ? <span class="string">&#x27; hide&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;çª—å£&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// çª—å£æ˜¾ç¤º</span></span><br><span class="line">                    frame.<span class="property">show</span> = <span class="literal">true</span>;</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">d</span>: <span class="string">&#x27;M836.224 106.666667h-490.666667a85.589333 85.589333 0 0 0-85.333333 85.333333V256h-64a85.589333 85.589333 0 0 0-85.333333 85.333333v490.666667a85.589333 85.589333 0 0 0 85.333333 85.333333h490.666667a85.589333 85.589333 0 0 0 85.333333-85.333333V768h64a85.589333 85.589333 0 0 0 85.333333-85.333333V192a85.589333 85.589333 0 0 0-85.333333-85.333333z m-132.266667 725.333333a20.138667 20.138667 0 0 1-21.333333 21.333333h-490.666667a20.138667 20.138667 0 0 1-21.333333-21.333333V341.333333a20.138667 20.138667 0 0 1 21.333333-21.333333h494.933334a20.138667 20.138667 0 0 1 21.333333 21.333333v490.666667z m153.6-149.333333a20.138667 20.138667 0 0 1-21.333333 21.333333h-64V341.333333a85.589333 85.589333 0 0 0-85.333333-85.333333h-362.666667V192a20.138667 20.138667 0 0 1 21.333333-21.333333h490.666667a20.138667 20.138667 0 0 1 21.333333 21.333333z&#x27;</span>,</span><br><span class="line">            &#125;))),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_panel_show_btn&#x27;</span>,</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;é¢æ¿&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    panelShow.<span class="property">value</span> = !panelShow.<span class="property">value</span>;</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">d</span>: <span class="string">&#x27;M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z&#x27;</span>,</span><br><span class="line">            &#125;))),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="title function_">watchEffectRef</span>(<span class="function">() =&gt;</span> <span class="string">`egg_settings_show_btn<span class="subst">$&#123;scheduleShow.value ? <span class="string">&#x27; active&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>),</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;è®¾ç½®&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    scheduleShow.<span class="property">value</span> = !scheduleShow.<span class="property">value</span>;</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">            &#125;, [</span><br><span class="line">                <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">d</span>: <span class="string">&#x27;M7.25325 705.466473a503.508932 503.508932 0 0 0 75.26742 121.391295 95.499302 95.499302 0 0 0 93.211173 31.07039 168.59902 168.59902 0 0 1 114.526906 16.257763 148.487566 148.487566 0 0 1 71.052444 83.456515 91.163899 91.163899 0 0 0 75.989987 61.538643 578.053784 578.053784 0 0 0 148.969278 0A91.163899 91.163899 0 0 0 662.380873 957.642436a148.487566 148.487566 0 0 1 72.256723-83.456515 168.59902 168.59902 0 0 1 114.406478-16.257763 95.61973 95.61973 0 0 0 93.331601-31.07039 503.508932 503.508932 0 0 0 75.267419-121.391295 84.29951 84.29951 0 0 0-18.545892-94.897163 138.251197 138.251197 0 0 1 0-197.140426 84.29951 84.29951 0 0 0 18.545892-94.897163 503.508932 503.508932 0 0 0-75.869559-121.391295 95.499302 95.499302 0 0 0-93.211173-31.070391A168.59902 168.59902 0 0 1 734.637596 149.812272a148.848849 148.848849 0 0 1-72.256723-83.456515A91.163899 91.163899 0 0 0 586.631741 4.817115a581.907476 581.907476 0 0 0-148.969277 0A91.163899 91.163899 0 0 0 361.311193 66.355757a148.848849 148.848849 0 0 1-71.413728 83.456515 168.59902 168.59902 0 0 1-114.406478 16.257763 95.378874 95.378874 0 0 0-93.3316 31.070391A503.508932 503.508932 0 0 0 7.25325 318.531721a84.29951 84.29951 0 0 0 18.545893 94.897163 140.057615 140.057615 0 0 1 41.30676 98.509999 140.057615 140.057615 0 0 1-41.30676 98.630427A84.29951 84.29951 0 0 0 7.25325 705.466473z m929.462315-349.240828a219.901294 219.901294 0 0 0 0 312.028615c0.842995 0.842995 2.649413 3.010697 1.806418 5.057971a427.398517 427.398517 0 0 1-63.104205 101.520696 9.513802 9.513802 0 0 1-9.032091 2.167702 255.547944 255.547944 0 0 0-173.777418 24.928569 231.823653 231.823653 0 0 0-111.275354 130.302957 6.984817 6.984817 0 0 1-6.021394 4.937543 492.790851 492.790851 0 0 1-126.328837 0 6.984817 6.984817 0 0 1-6.021394-4.937543 231.823653 231.823653 0 0 0-111.275353-130.302957 255.668372 255.668372 0 0 0-120.427872-30.468252 258.919924 258.919924 0 0 0-52.747408 5.539683 9.513802 9.513802 0 0 1-9.03209-2.167702 427.398517 427.398517 0 0 1-63.104205-101.520696c-0.842995-2.047274 0.963423-4.214976 1.806418-5.057971a221.82814 221.82814 0 0 0 64.910623-156.556233 221.707712 221.707712 0 0 0-65.512762-155.713238c-0.842995-0.842995-2.649413-3.010697-1.806418-5.057971a427.398517 427.398517 0 0 1 63.104205-101.520696 9.393374 9.393374 0 0 1 8.911662-2.167701 255.7888 255.7888 0 0 0 173.897847-24.92857 231.823653 231.823653 0 0 0 111.275353-130.302957 6.984817 6.984817 0 0 1 6.021394-4.937543 492.790851 492.790851 0 0 1 126.328837 0 6.984817 6.984817 0 0 1 6.021394 4.937543 231.823653 231.823653 0 0 0 111.275354 130.302957 255.547944 255.547944 0 0 0 173.777418 24.92857 9.513802 9.513802 0 0 1 9.032091 2.167701 423.063113 423.063113 0 0 1 62.983777 101.520696c0.963423 2.047274-0.842995 4.214976-1.68599 5.057971z&#x27;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">                <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">d</span>: <span class="string">&#x27;M512.086889 305.766366a206.292944 206.292944 0 1 0 206.172516 206.172517 206.413372 206.413372 0 0 0-206.172516-206.172517z m123.197713 206.172517a123.197713 123.197713 0 1 1-123.197713-123.077285 123.318141 123.318141 0 0 1 123.197713 123.077285z&#x27;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">            ])),</span><br><span class="line">            <span class="title function_">createElementNode</span>(<span class="string">&#x27;button&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_settings_reset_btn&#x27;</span>,</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;é‡ç½®&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;button&#x27;</span>,</span><br><span class="line">                <span class="attr">onclick</span>: <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// ä»»åŠ¡é…ç½®</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;taskConfig&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// è®¾ç½®</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;studySettings&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// æœ€å¤§é˜…è¯»</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;maxRead&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// æœ€å¤§è§‚çœ‹</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;maxWatch&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// ä¸»é¢˜è‰²</span></span><br><span class="line">                    <span class="title function_">GM_setValue</span>(<span class="string">&#x27;themeColor&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// åˆ·æ–°é¡µé¢</span></span><br><span class="line">                    location.<span class="title function_">reload</span>();</span><br><span class="line">                &#125;, <span class="number">300</span>),</span><br><span class="line">            &#125;, <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;svg&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                <span class="attr">viewBox</span>: <span class="string">&#x27;0 0 1024 1024&#x27;</span>,</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;egg_icon&#x27;</span>,</span><br><span class="line">            &#125;, [</span><br><span class="line">                <span class="title function_">createNSElementNode</span>(<span class="string">&#x27;path&#x27;</span>, <span class="literal">undefined</span>, &#123;</span><br><span class="line">                    <span class="attr">d</span>: <span class="string">&#x27;M943.8 484.1c-17.5-13.7-42.8-10.7-56.6 6.8-5.7 7.3-8.5 15.8-8.6 24.4h-0.4c-0.6 78.3-26.1 157-78 223.3-124.9 159.2-356 187.1-515.2 62.3-31.7-24.9-58.2-54-79.3-85.9h77.1c22.4 0 40.7-18.3 40.7-40.7v-3c0-22.4-18.3-40.7-40.7-40.7H105.5c-22.4 0-40.7 18.3-40.7 40.7v177.3c0 22.4 18.3 40.7 40.7 40.7h3c22.4 0 40.7-18.3 40.7-40.7v-73.1c24.2 33.3 53 63.1 86 89 47.6 37.3 101 64.2 158.9 79.9 55.9 15.2 113.5 19.3 171.2 12.3 57.7-7 112.7-24.7 163.3-52.8 52.5-29 98-67.9 135.3-115.4 37.3-47.6 64.2-101 79.9-158.9 10.2-37.6 15.4-76 15.6-114.6h-0.1c-0.3-11.6-5.5-23.1-15.5-30.9zM918.7 135.2h-3c-22.4 0-40.7 18.3-40.7 40.7V249c-24.2-33.3-53-63.1-86-89-47.6-37.3-101-64.2-158.9-79.9-55.9-15.2-113.5-19.3-171.2-12.3-57.7 7-112.7 24.7-163.3 52.8-52.5 29-98 67.9-135.3 115.4-37.3 47.5-64.2 101-79.9 158.8-10.2 37.6-15.4 76-15.6 114.6h0.1c0.2 11.7 5.5 23.2 15.4 30.9 17.5 13.7 42.8 10.7 56.6-6.8 5.7-7.3 8.5-15.8 8.6-24.4h0.4c0.6-78.3 26.1-157 78-223.3 124.9-159.2 356-187.1 515.2-62.3 31.7 24.9 58.2 54 79.3 85.9h-77.1c-22.4 0-40.7 18.3-40.7 40.7v3c0 22.4 18.3 40.7 40.7 40.7h177.3c22.4 0 40.7-18.3 40.7-40.7V175.8c0.1-22.3-18.2-40.6-40.6-40.6z&#x27;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">            ])),</span><br><span class="line">        ]),</span><br><span class="line">        <span class="comment">// ä»»åŠ¡æŒ‰é’®</span></span><br><span class="line">        <span class="title class_">TaskBtn</span>(),</span><br><span class="line">        <span class="title function_">createElementNode</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">undefined</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;egg_settings_item&#x27;</span> &#125;, [</span><br><span class="line">            <span class="title class_">SettingsPanel</span>(&#123; <span class="attr">show</span>: scheduleShow &#125;),</span><br><span class="line">        ]),</span><br><span class="line">    ]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ å·¥å…· </tag>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java API</title>
      <link href="/posts/13799.html"/>
      <url>/posts/13799.html</url>
      
        <content type="html"><![CDATA[<h1>Java API</h1><h2 id="Streamæµ">Streamæµ</h2><h3 id="æµæ”¶é›†åˆ">æµæ”¶é›†åˆ</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æµè½¬åŒ–ä¸ºé›†åˆ</span></span><br><span class="line">Stream&lt;String&gt; stream = Stream.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>);</span><br><span class="line">stream.collect(Collectors.toList())</span><br><span class="line">stream.collect(Collectors.toSet())</span><br><span class="line">stream.collect(Collectors.toCollection(ArraysList::<span class="keyword">new</span>))</span><br><span class="line"><span class="comment">//æµè½¬åŒ–ä¸ºæ•°ç»„</span></span><br><span class="line">stream.toArray()</span><br><span class="line">stream.toArray(<span class="type">int</span>[]::<span class="keyword">new</span>)</span><br><span class="line"><span class="comment">//èšåˆè®¡ç®—</span></span><br><span class="line">stream.collect(Collectors.maxBy())</span><br><span class="line">stream.collect(Collectors.minBy())</span><br><span class="line">stream.collect(Collectors.counting())</span><br><span class="line">stream.collect(Collectors.summingInt())</span><br><span class="line">stream.collect(Collectors.averagingInt())</span><br><span class="line"><span class="comment">//åˆ†ç»„  åˆ†ç»„å‡½æ•°  å€¼æ”¶é›†å™¨é»˜è®¤ä¸ºList</span></span><br><span class="line">stream.collect(Collectors.groupingBy())</span><br><span class="line"><span class="comment">//åˆ†åŒº</span></span><br><span class="line">stream.collcet(Collectors.partitionBy())</span><br><span class="line"><span class="comment">//æ‹¼æ¥</span></span><br><span class="line">stream.collect(Collectors.joining())</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>é«˜æ•ˆæœç´¢</title>
      <link href="/posts/43428.html"/>
      <url>/posts/43428.html</url>
      
        <content type="html"><![CDATA[<h1>é«˜æ•ˆæœç´¢</h1><h2 id="ä¿¡æ¯åˆ†ç±»">ä¿¡æ¯åˆ†ç±»</h2><ul><li>ä¿¡æ¯</li><li>å­¦ä¹ </li><li>ç´ æ</li><li>å·¥å…·</li></ul><h2 id="ä¿¡æ¯">ä¿¡æ¯</h2><h3 id="ä¿¡æ¯æ¸ é“æ•ˆç‡">ä¿¡æ¯æ¸ é“æ•ˆç‡</h3><p>è°·æ­Œ &gt; å¾®ä¿¡çŸ¥é“ &gt; çŸ­è§†é¢‘ &gt; ç™¾åº¦</p><h3 id="é«˜æ•ˆæœç´¢å‘½ä»¤">é«˜æ•ˆæœç´¢å‘½ä»¤</h3><p><code>&quot;å…³é”®è¯&quot;  </code>  åŒå¼•å·  é™å®šå…³é”®è¯</p><p><code>intitle:æ ‡é¢˜</code> é™å®šæ ‡é¢˜</p><p><code>allintitle: æ ‡é¢˜1 æ ‡é¢˜2 </code></p><p><code>intext: æ–‡ç« å†…å®¹</code> æ–‡ç« å†…å®¹å¿…å®šåŒ…å«æ–‡ç« å†…å®¹</p><p><code>inurl é™å®šç½‘å€</code></p><p><code>site: é™å®šåŸŸå</code></p><p><code>imagesize: 2560 x  1440</code></p><p><code>filetype: ppt</code></p><p>å¯ç»„åˆä½¿ç”¨</p><h3 id="ç›´å¥”ä¿¡æ¯æºå¤´">ç›´å¥”ä¿¡æ¯æºå¤´</h3><p>äº†è§£è¡Œä¸š   <code>filetype: pdf</code></p><p>äº†è§£åŒ»è¯   å¤‡æ¡ˆç½‘ç«™</p><p>äº†è§£äº§å“    ç”µå•†ç½‘ç«™</p><p>äº†è§£åŠ¨æ€    X(Tiwwer, Youtube)</p><p>â€¦</p><h2 id="çŸ¥è¯†">çŸ¥è¯†</h2><p>å­˜åœ¨å½¢å¼</p><ul><li>ç½‘é¡µ</li><li>ç”µå­ä¹¦</li><li>ç”µå­æ–‡æ¡£</li><li>å­¦æœ¯è®ºæ–‡</li><li>ç¬”è®°</li><li>åªæ˜¯å¹³å°</li><li>è§†é¢‘ç½‘ç«™</li><li>AIç”µè„‘</li></ul><p>å…è´¹å®Œå…¨å…¬å¼€</p><p>å…è´¹ç§åŸŸ</p><p>æ”¶è´¹ç§åŸŸ</p><p>å›½å†…</p><p>éƒ½å·®ä¸å¤šçŸ¥é“,ä¸å†™äº†</p><p>å›½å¤–</p><ul><li>è°·æ­Œå›¾ä¹¦ è°·æ­Œå­¦æœ¯ ç»´åŸºç™¾ç§‘</li><li>Udemy</li><li>EDX</li><li>coursera</li><li>wolfram</li><li>å¯æ±—å­¦é™¢</li><li>YouTube</li><li>Doulingo</li></ul><h3 id="å›½å†…">å›½å†…</h3><p>å›½å†…å¼€å§‹æœ‰å¾ˆå¤šç”¨çˆ±å‘ç”µçš„å¤§ç¥, è€Œéšç€å†…å®¹ç”µå•†å’Œè‡ªåª’ä½“çš„å…´èµ·, å¤§å®¶éƒ½æµ®èºäº†, çŸ¥è¯†0æˆæœ¬çš„æŠ„è¢­å’ŒçŸ­è§†é¢‘é›¶ç¢çš„äº¤ä»˜,å¯¼è‡´ç½‘ç»œä¸Šä¼ æ’­çš„éƒ½æ˜¯<code>åŒè´¨åŒ–</code>, <code>ä½è´¨é‡</code>, <code>åå…«æ‰‹çš„</code>, é›¶ç¢çš„çŸ¥è¯†åƒåœ¾</p><ul><li>bç«™</li><li>å¾—åˆ°</li><li>çŸ¥ä¹</li></ul><p>ç®—æ˜¯æœ€åçš„å¸Œæœ›</p><p>15å¹´å‰çš„çŸ¥è¯†æ²‰æ·€ä¸»è¦åœ¨  ç™¾åº¦ç³»åˆ—å’Œä¸€äº›è®ºå›ä¸­</p><p>10å¹´å‰                       çŸ¥ä¹, å…¬ä¼—å·</p><p>5å¹´å‰                          çŸ­è§†é¢‘å¹³å° , bilibilié•¿è§†é¢‘, å¾—åˆ°éŸ³é¢‘APP</p><ul><li>pcåˆ°ç§»åŠ¨</li><li>æ–‡å­—åˆ°è§†é¢‘</li><li>éŸ³é¢‘äº¤ä»˜çŸ¥è¯†</li></ul><p>å›½å¤–</p><p>è®¤å‡† Google  Youtube</p><p>é€‰æ‹©è§’åº¦</p><ul><li>æƒ³è¦çš„çŸ¥è¯†æŠ€èƒ½æœ€å¯èƒ½é™„ç€åœ¨é‚£ç±»å‹è½½ä½“ä¸Š</li><li>çœ‹æœç´¢çŸ¥è¯†æŠ€èƒ½çš„ç›®çš„ (æŸæŸè¡Œä¸šå¯¼èˆªç½‘å€) (SimilarSites(åŒç±»ç½‘ç«™æœç´¢) Sci-hub Google Scholar,  ç½‘ç›˜æœç´¢å¼•æ“  å­¦æœæœ, ç›˜æœæœ, äº‘ç›˜ç‹—)</li></ul><p><a href="https://www.youtube.com/watch?v=tiN6T1LewmQ">https://www.youtube.com/watch?v=tiN6T1LewmQ</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AQSæºç è§£æ</title>
      <link href="/posts/31851.html"/>
      <url>/posts/31851.html</url>
      
        <content type="html"><![CDATA[<h1><code>AQS</code>æºç è§£æ</h1><p>â€‹<code>AQS</code>æ˜¯Javaé‡Œçš„ä¸€ä¸ª<code>åŒæ­¥å·¥å…·ç±»</code>ï¼Œå…¨ç§°ä¸º<code>AbstractQueuedSynchronizer</code>ã€‚å®ƒæ˜¯<code>JUC</code>åŒ…ä¸­ä¸­å®ç°é”å’ŒåŒæ­¥æœºåˆ¶çš„åŸºç¡€ã€‚</p><p>â€‹å®ƒå¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§æ¡†æ¶æˆ–æ¨¡æ¿ï¼Œç”¨äºå®ç°å¤šç§åŒæ­¥å™¨ï¼Œæ¯”å¦‚<code>ReentrantLock</code>ã€<code>CountDownLatch</code>ã€<code>Semaphore</code> ã€<code>ReentrantReadWriteLock</code>ç­‰ã€‚</p><p>ä½œä¸ºæœ¬ç³»åˆ—ç¬¬ä¸€èŠ‚ï¼Œ æˆ‘ä»¬å…ˆäº†è§£è¿™äº›åŒæ­¥å·¥å…·çš„å…±åŒçš„ç¥–å…ˆ(è™½ç„¶å®é™…ä¸Šæ˜¯èšåˆå…³ç³»)   ----<code>AQS</code></p><p>åœ¨äº†è§£<code>AQS</code>ä¹‹å‰, æˆ‘ä»¬è¦çŸ¥é“:</p><p><code>AQS</code>æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå®ƒæ˜¯å°†ç­‰å¾…é”æˆ–èµ„æºçš„çº¿ç¨‹æ’é˜Ÿï¼Œå¹¶åœ¨é”æˆ–èµ„æºå¯ç”¨æ—¶å°†å…¶å”¤é†’ã€‚</p><p>å»ºç«‹åœ¨è¿™ä¸ªåŸºç¡€ä¸Š, æ–¹ä¾¿ç†è§£ååºè®²è§£</p><p>æˆ‘ä»¬ä»¥å¹³å¸¸æœ€å¸¸ç”¨çš„<code>ReentrantLock</code>ä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ReentrantLock lock= <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è·å–é”</span></span><br><span class="line">lock.lock(); </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åŒæ­¥ä»£ç å—å—</span></span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    </span><br><span class="line">     <span class="comment">// ç¬¬ä¸€æ¬¡é‡Šæ”¾é”</span></span><br><span class="line">    lock.unlock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç‚¹è¿›<code>lock()</code>æ–¹æ³•, ä¼šå‘ç°è°ƒç”¨çš„æ˜¯<code>sync.lock();</code></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span> &#123;</span><br><span class="line">       sync.lock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>sync</code>æ˜¯ä»€ä¹ˆå‘¢? è¿™å…¶å®æ˜¯<code>ReentrantLock</code>ä¸€ä¸ªå†…éƒ¨ç±»<code>Sync</code>çš„å®ä¾‹</p><p><strong>Sync</strong>ï¼šæ˜¯æä¾›<code>AQS</code>å®ç°çš„å·¥å…·ï¼Œç±»ä¼¼äºé€‚é…å™¨ï¼Œæä¾›äº†æŠ½è±¡çš„lock()ï¼Œä¾¿äºå¿«é€Ÿåˆ›å»ºéå…¬å¹³é”ã€‚</p><p>è€Œ<code>Sync</code>ç»§æ‰¿è‡ª<code>AQS(AbstractQueuedSynchronizer)</code>, äº‹å®ä¸Š, ä¸Šè¿°å‡ ä¹æ¯ä¸ªåŒæ­¥å·¥å…·éƒ½åˆä¸€ä¸ª<code>Sync</code>çš„å®ç°å­ç±», è€Œä¸”å‡ç»§æ‰¿è‡ª<code>AQS</code>, è¿™ä¸‹å°±æ˜ç™½ä¸ºä»€ä¹ˆè¯´ <code>AQS</code>æ˜¯ä¸€ç§æ¡†æ¶æˆ–æ¨¡æ¿, å¦‚æœä½ æƒ³å®šä¹‰ä¸€ä¸ªåŒæ­¥å·¥å…·, ä¹Ÿå®Œå…¨å¯ä»¥é€šè¿‡ç»§æ‰¿<code>AQS</code>è¿™ä¸ªæŠ½è±¡ç±»æ¥å®ç°, æ–‡æœ«æˆ‘ä»¬ä¼šç»™å‡ºä¸€ä¸ªé€šè¿‡<code>AQS</code>ç®€å•è‡ªå®šä¹‰çš„äº’æ–¥é”</p><p>è€Œè¿™ä¸ªå†…éƒ¨ç±»ä¹Ÿå¼•å‡ºäº†æˆ‘ä»¬æœ¬ç¯‡è®²è§£çš„é‡ç‚¹  <code>AQS</code></p><p>è¿™æ˜¯</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.AbstractQueuedSynchronizer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äº’æ–¥é” Mutex çš„å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mutex</span> &#123;</span><br><span class="line">    <span class="comment">// å†…éƒ¨ç±» Sync ç»§æ‰¿ AbstractQueuedSynchronizer</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Sync</span> <span class="keyword">extends</span> <span class="title class_">AbstractQueuedSynchronizer</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°è¯•è·å–äº’æ–¥é”</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> arg è·å–é”çš„å‚æ•°</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> å¦‚æœè·å–é”æˆåŠŸè¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, <span class="number">1</span>)) &#123; <span class="comment">// å°è¯•å°†çŠ¶æ€ä» 0 è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºæˆåŠŸè·å–é”</span></span><br><span class="line">                setExclusiveOwnerThread(Thread.currentThread()); <span class="comment">// è®¾ç½®å½“å‰çº¿ç¨‹ä¸ºç‹¬å çº¿ç¨‹</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// è·å–é”æˆåŠŸ</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è·å–é”å¤±è´¥</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°è¯•é‡Šæ”¾äº’æ–¥é”</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> arg é‡Šæ”¾é”çš„å‚æ•°</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> å¦‚æœé‡Šæ”¾é”æˆåŠŸè¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">tryRelease</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getState() == <span class="number">0</span>) &#123; <span class="comment">// çŠ¶æ€ä¸º 0 è¡¨ç¤ºé”æ²¡æœ‰è¢«æŒæœ‰</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalMonitorStateException</span>(); <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            &#125;</span><br><span class="line">            setExclusiveOwnerThread(<span class="literal">null</span>); <span class="comment">// å°†ç‹¬å çº¿ç¨‹è®¾ç½®ä¸º null</span></span><br><span class="line">            setState(<span class="number">0</span>); <span class="comment">// é‡Šæ”¾é”ï¼Œå°†çŠ¶æ€è®¾ç½®ä¸º 0</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// é‡Šæ”¾é”æˆåŠŸ</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åˆ¤æ–­æ˜¯å¦ä¸ºç‹¬å çº¿ç¨‹æŒæœ‰äº’æ–¥é”</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> å¦‚æœå½“å‰çº¿ç¨‹ç‹¬å æŒæœ‰é”è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">isHeldExclusively</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> getState() == <span class="number">1</span>; <span class="comment">// çŠ¶æ€ä¸º 1ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹ç‹¬å æŒæœ‰é”</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Sync</span> <span class="variable">sync</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Sync</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–äº’æ–¥é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span> &#123;</span><br><span class="line">        sync.acquire(<span class="number">1</span>); <span class="comment">// è·å–é”ï¼Œå¦‚æœé”å·²è¢«æŒæœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡Šæ”¾äº’æ–¥é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unlock</span><span class="params">()</span> &#123;</span><br><span class="line">        sync.release(<span class="number">1</span>); <span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­äº’æ–¥é”æ˜¯å¦è¢«ç‹¬å æŒæœ‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¦‚æœé”è¢«ç‹¬å æŒæœ‰è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isLocked</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sync.isHeldExclusively();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨å†…éƒ¨ç±»å’Œ <code>AQS </code>å®ç°çš„äº’æ–¥é”ï¼ˆ<code>Mutex</code>ï¼‰ç±»ã€‚</p><ul><li><code>tryAcquire</code>ï¼šå°è¯•è·å–èµ„æºã€‚å¦‚æœå½“å‰çŠ¶æ€ä¸º0ï¼ˆæœªé”å®šï¼‰ï¼Œé‚£ä¹ˆè®¾ç½®ä¸º1ï¼ˆé”å®šï¼‰ï¼Œå¹¶è®¾ ç½®å½“å‰çº¿ç¨‹ä¸ºç‹¬å èµ„æºçš„çº¿ç¨‹ã€‚</li><li><code>tryRelease</code>ï¼šå°è¯•é‡Šæ”¾èµ„æºã€‚è®¾ç½®çŠ¶æ€ä¸º0å¹¶æ¸…é™¤æŒæœ‰èµ„æºçš„çº¿ç¨‹ã€‚</li><li><code>isHeldExclusively</code>ï¼šåˆ¤æ–­å½“å‰èµ„æºæ˜¯å¦è¢«ç‹¬å ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> JUC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AQS </tag>
            
            <tag> JUC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CountDownLatch</title>
      <link href="/posts/39998.html"/>
      <url>/posts/39998.html</url>
      
        <content type="html"><![CDATA[<h1>CountDownLatch</h1><p><code>CountDownLatch</code>æ˜¯ä¸€ä¸ª<code>JUC</code>åŒ…ä¸‹çš„åŒæ­¥å·¥å…·   è®¡æ•°å™¨</p><p>ä½œç”¨æ˜¯:  ä½¿ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆåå†æ‰§è¡Œ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ„é€ ä¸€ä¸ªç”¨ç»™å®šè®¡æ•°åˆå§‹åŒ–çš„ CountDownLatchã€‚</span></span><br><span class="line">CountDownLatch(<span class="type">int</span> count)</span><br><span class="line"><span class="comment">// ä½¿å½“å‰çº¿ç¨‹åœ¨é”å­˜å™¨å€’è®¡æ•°è‡³é›¶ä¹‹å‰ä¸€ç›´ç­‰å¾…ï¼Œé™¤éçº¿ç¨‹è¢«ä¸­æ–­ã€‚</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">await</span><span class="params">()</span></span><br><span class="line"><span class="comment">// ä½¿å½“å‰çº¿ç¨‹åœ¨é”å­˜å™¨å€’è®¡æ•°è‡³é›¶ä¹‹å‰ä¸€ç›´ç­‰å¾…ï¼Œé™¤éçº¿ç¨‹è¢«ä¸­æ–­æˆ–è¶…å‡ºäº†æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">await</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line"><span class="comment">// é€’å‡é”å­˜å™¨çš„è®¡æ•°ï¼Œå¦‚æœè®¡æ•°åˆ°è¾¾é›¶ï¼Œåˆ™é‡Šæ”¾æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">countDown</span><span class="params">()</span></span><br><span class="line"><span class="comment">// è¿”å›å½“å‰è®¡æ•°ã€‚</span></span><br><span class="line"><span class="type">long</span> <span class="title function_">getCount</span><span class="params">()</span></span><br><span class="line"><span class="comment">// è¿”å›æ ‡è¯†æ­¤é”å­˜å™¨åŠå…¶çŠ¶æ€çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">String <span class="title function_">toString</span><span class="params">()</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountDownLathTest</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ¯ä¸ªçº¿ç¨‹å»æ”¶é›† 1 é¢—é¾™ç </span></span><br><span class="line">    <span class="comment">// å®šä¹‰éœ€è¦æ”¶é›†é¾™ç çš„ç›®æ ‡æ•°é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DRAGON_BALL_TOTAL_NUM</span> <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å®šä¹‰éœ€è¦ç­‰å¾…çš„çº¿ç¨‹æ•°é‡</span></span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">countDownLatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(DRAGON_BALL_TOTAL_NUM);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="comment">// æ¯ä¸ªçº¿ç¨‹æ”¶é›†å®Œä¸€é¢—é¾™ç å, countDownlatch(å‡æ•°æ¿) - 1</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ”¶é›†åˆ°ç¬¬ &quot;</span> + index + <span class="string">&quot;å·é¾™ç !&quot;</span>);</span><br><span class="line">                countDownLatch.countDown();</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åªæœ‰å½“countDownlatch(å‡æ•°æ¿)æ•°é‡å‡å°‘ä¸º 0 æ—¶, ä¸»çº¿ç¨‹æ‰ä¼šè¢«å”¤é†’, ä¹Ÿå°±æ˜¯ 7 é¢—é¾™ç æ”¶é›†å®Œæ¯•</span></span><br><span class="line">            countDownLatch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;é¾™ç æ”¶é›†å®Œæ¯•!!! \n&quot;</span> +   <span class="string">&quot;å¬å”¤ç¥é¾™!!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”±ä¸Šè¿°ä»£ç å¯è§, <code>CountDownLatch</code> é€šè¿‡è®¡æ•°å®šä¹‰äº†çº¿ç¨‹ä¹‹é—´çš„åŒæ­¥å…³ç³»</p><p><code>JUC</code>åŒ…ä¸‹æ‰€æœ‰åŒæ­¥å·¥å…·ç¦»ä¸å¼€<code>ASQ</code>çš„æ¡†æ¶(ä¸å¾—ä¸æ„Ÿå¹Doug Leaæ•™æˆå¼ºå¤§çš„æŠ½è±¡å’Œè®¾è®¡)</p>]]></content>
      
      
      <categories>
          
          <category> JUC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JUC </tag>
            
            <tag> CountDownLatch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker</title>
      <link href="/posts/40992.html"/>
      <url>/posts/40992.html</url>
      
        <content type="html"><![CDATA[<h1>Docker</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p><img src="Docker.assets/image-20231217101955797.png" alt="image-20231217101955797"></p><p><code>docker</code>å°±å¥½æ¯”ä¼ ç»Ÿè´§è¿é›†è£…ç®±, ç»Ÿä¸€äº†åº”ç”¨æ‰“åŒ…ä¸Šäº‘çš„æ–¹å¼</p><p>Docker æ˜¯ç®¡ç†å®¹å™¨çš„å¼•æ“</p><p>Docker ä¸ºåº”ç”¨ã€éƒ¨ç½²å¹³å°ï¼Œ æä¾›äº†è™šæ‹ŸåŒ–æŠ€æœ¯</p><h3 id="VM-VS-Container">VM   VS  Container</h3><p><img src="Docker.assets/image-20231217102250527.png" alt="image-20231217102250527"></p><p>VM ç›¸å¯¹ç¬¨é‡ï¼Œ <code>guestOS</code> ç‹¬ç«‹æ“ä½œç³»ç»Ÿå¯¹CPU, å†…å­˜ç­‰èµ„æºæ¶ˆè€—è¾ƒå¤§</p><p>å…±äº«Linuxå†…æ ¸ï¼Œä½¿ç”¨ <code>namespace</code> å’Œ <code>cgroup</code> æ¥å®ç°å®¹å™¨åŒ–çš„éš”ç¦»å’Œèµ„æºé™åˆ¶ã€‚</p><p><img src="Docker.assets/image-20231217102643263.png" alt="image-20231217102643263"></p><p>æ¯ç§æŠ€æœ¯éƒ½æœ‰è‡ªå·±çš„è¿è¡Œåœºæ™¯</p><h3 id="Dockerä¼˜åŠ¿">Dockerä¼˜åŠ¿</h3><p>å¯¹äºå¼€å‘è€…è€Œè¨€ ï¼šBuild once, Run anywhereã€‚</p><p>å¯¹è¿ç»´äººå‘˜è€Œè¨€ :    Configure onceã€Run anythingã€‚</p><h4 id="å®¹å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„">å®¹å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„</h4><p><img src="Docker.assets/image-20231217103113202.png" alt="image-20231217103113202"></p><p>Docker run</p><p><img src="Docker.assets/image-20231217121828276.png" alt="image-20231217121828276"></p><h3 id="å®‰è£…Docker">å®‰è£…Docker</h3><p>Dockeråªèƒ½å®‰è£…åœ¨Linuxä¸Šæ¬§, å› ä¸ºdockerçš„container model æ˜¯åŸºäºlinuxå†…æ ¸çš„(WSL(Windows Sub Linux)ä¹Ÿå¯ä»¥)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// å®‰è£…</span><br><span class="line">yum install docker</span><br><span class="line">// æ£€éªŒå®‰è£…æ˜¯å¦æˆåŠŸ</span><br><span class="line">docker --version</span><br><span class="line">// å¯åŠ¨</span><br><span class="line">systemctl start docker</span><br><span class="line">// æ¢é•œåƒæº</span><br><span class="line">sudo vim /etc/docker/daemon.json</span><br><span class="line">å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line">&#123;</span><br><span class="line">&quot;registry-mirrors&quot;:[&quot;https://m9r2r2uj.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">// ä¿å­˜é€€å‡º</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">// é‡å¯docker</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="Dockerçš„å¸¸ç”¨å‘½ä»¤">Dockerçš„å¸¸ç”¨å‘½ä»¤</h2><h3 id="å¸®åŠ©å‘½ä»¤">å¸®åŠ©å‘½ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker version  // æ˜¾ç¤ºdockerçš„ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">docker info// dockerè¯¦ç»†ä¿¡æ¯ï¼Œ å¦‚ é•œåƒï¼Œå®¹å™¨çš„æ•°é‡</span><br><span class="line">docker å‘½ä»¤ --help // å¸®åŠ©å‘½ä»¤</span><br></pre></td></tr></table></figure><p>å¸®åŠ©æ–‡æ¡£håœ°å€ï¼š <a href="https://docs.docker.com/engine/reference/commandline/">https://docs.docker.com/engine/reference/commandline/</a></p><h3 id="é•œåƒå‘½ä»¤">é•œåƒå‘½ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker images  // æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°é•œåƒ</span><br><span class="line"></span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE                       busybox      latest    f5fb98afcf9f   12 days ago   4.26MB  </span><br><span class="line"></span><br><span class="line">// é•œåƒä»“åº“æº</span><br><span class="line">REPOSITORY</span><br><span class="line">// é•œåƒçš„æ ‡ç­¾</span><br><span class="line">TAG</span><br><span class="line">// é•œåƒçš„id</span><br><span class="line">IMAGE ID   </span><br><span class="line">// é•œåƒçš„åˆ›å»ºæ—¶é—´</span><br><span class="line">CREATED</span><br><span class="line">// é•œåƒçš„å¤§å°</span><br><span class="line">SIZE</span><br><span class="line"></span><br><span class="line">// å¯é€‰é¡¹</span><br><span class="line"></span><br><span class="line">// åˆ—å‡ºæ‰€æœ‰id</span><br><span class="line">-a, --all</span><br><span class="line">//  åªæ˜¾ç¤ºé•œåƒçš„id</span><br><span class="line">-q, --quiet</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker search  // dockerhub æœç´¢é•œåƒå</span><br><span class="line"></span><br><span class="line">// æ ·ä¾‹</span><br><span class="line">docker search mysql</span><br><span class="line">// è¾“å‡º</span><br><span class="line">NAME                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                           MySQL is a widely used, open-source relationâ€¦   14709     [OK]</span><br><span class="line">mariadb                         MariaDB Server is a high performing open souâ€¦   5614      [OK]</span><br><span class="line"></span><br><span class="line">// å¯é€‰é¡¹</span><br><span class="line">// è¿‡æ»¤ï¼Œ åªè¾“å‡ºstar&gt;=3000çš„é•œåƒ</span><br><span class="line">--fliter=STARS=3000</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull é•œåƒå[:tag] // ä¸‹è½½é•œåƒ, ä¸å†™tagï¼Œé»˜è®¤æ˜¯latest</span><br><span class="line"></span><br><span class="line">#ä¸‹è½½é•œåƒdocker pu11é•œåƒå[ï¼štag]</span><br><span class="line">docker pull mysql</span><br><span class="line"></span><br><span class="line">Using default tag:1 atest // å¦‚æœä¸å†™tag,é»˜è®¤å°±æ˜¯latest</span><br><span class="line">latest:Pulling from library/mysql</span><br><span class="line">5b54d594fba7:Pu11comp1ete // åˆ†å±‚ä¸‹è½½ï¼Œdocker iamgeçš„æ ¸å¿ƒ è”åˆæ–‡ä»¶ç³»ç»Ÿ(å¯é‡ç”¨åˆ†å±‚)</span><br><span class="line">07e7d6a8a868:Pull complete</span><br><span class="line">abd946892310:Pu11 complete</span><br><span class="line">dd8f4d07efa5:Pull complete</span><br><span class="line">076d396a6205:PullTcomplete</span><br><span class="line">cf6b2b93048f:Pul1 complete</span><br><span class="line">530904b4a8b7:Pu11 complete</span><br><span class="line">fble55059a95:Pull complete</span><br><span class="line">4bd29a0dcde8:Pull complete</span><br><span class="line">b94a001c6ec7:Pul1 complete</span><br><span class="line">cb77cbeb422b:Pull complete</span><br><span class="line">2a35cdbd42cc:Pul1 complete</span><br><span class="line">Digest:sha256:dc255ca50a42b3589197000b1f9bab2b4e010158d1a9f56c3db6ee145506f625</span><br><span class="line">Status Down loaded newer image for mysql:latest</span><br><span class="line">docker.io/1 ibrary/mys q1:latest  // çœŸå®åœ°å€</span><br><span class="line"></span><br><span class="line">// ä¸¤è€…ç­‰ä»·</span><br><span class="line">docker pul1 mysql</span><br><span class="line">docker pull docker.io/library/mysq1:latest</span><br><span class="line"></span><br><span class="line">// æŒ‡å®šç‰ˆæœ¬ä¸‹è½½</span><br><span class="line">docker pull mysq1:5.7</span><br><span class="line">5.7:Pulling from library/mysql</span><br><span class="line">5b54d594fba7:Already exists  // è”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œ é‡ç”¨ä¸Šæ¬¡çš„åˆ†å±‚</span><br><span class="line">07e7d6a8a868:Already exists</span><br><span class="line">abd946892310:Already exists</span><br><span class="line">dd8f4d07efa5:Already exists</span><br><span class="line">076d396a6205:Already exists</span><br><span class="line">cf6b2b93048f:Already exists</span><br><span class="line">530904b4a8b7:Already exists</span><br><span class="line">a37958cbebcf:Pull complete</span><br><span class="line">04960017f638:Pu11comp1ete</span><br><span class="line">e1285defOd2a:Pull complete</span><br><span class="line">670cb3a9678e:Pull complete</span><br><span class="line">Digest:sha256:e4d39b85118358ffef6adc5e8c7d00e49d20b25597e6ffdc994696f10e3dc8e2</span><br><span class="line">Status:Downloaded newer image for mysq1:5.7</span><br><span class="line">docker.io/library/mysq1:5.7</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker rmi -f å®¹å™¨id // åˆ é™¤æŒ‡å®šçš„å®¹å™¨</span><br><span class="line">docker rmi -f å®¹å™¨id å®¹å™¨id å®¹å™¨id å®¹å™¨id // åˆ é™¤å¤šä¸ªå®¹å™¨</span><br><span class="line">docker rmi -f $(docker images -aq) // åˆ é™¤å…¨éƒ¨çš„å®¹å™¨ </span><br></pre></td></tr></table></figure><h3 id="å®¹å™¨å‘½ä»¤">å®¹å™¨å‘½ä»¤</h3><p>é€šè¿‡é•œåƒåˆ›å»ºå®¹å™¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure><p>æ–°å®¹å™¨å¹¶å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run [å¯é€‰å‚æ•°] image</span><br><span class="line"></span><br><span class="line">// å‚æ•°è¯´æ˜</span><br><span class="line">--name=&quot;Name&quot;   // å®¹å™¨åå­— tomcat01 tomcat02  ç”¨æ¥åŒºåˆ†å®¹å™¨</span><br><span class="line">-d// åå°æ–¹å¼è¿è¡Œ</span><br><span class="line">-it // ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œ, è¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹</span><br><span class="line">-p// æŒ‡å®šå®¹å™¨çš„ç«¯å£  -p  8080:8080</span><br><span class="line">-p IP:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£</span><br><span class="line">-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£</span><br><span class="line">-p å®¹å™¨ç«¯å£</span><br><span class="line"></span><br><span class="line">-P// æŒ‡å®šéšæœºç«¯å£</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æµ‹è¯•ï¼Œå¯åŠ¨å¹¶è¿›å…¥å®¹å™¨</span><br><span class="line">[root@ZS /]docker run -it centos /bin/bash</span><br><span class="line">[root@e4eccc01b495 /]1s // æŸ¥çœ‹å®¹å™¨å†…çš„centos,åŸºç¡€ç‰ˆæœ¬ï¼Œå¾ˆå¤šå‘½ä»¤éƒ½æ˜¯ä¸å®Œå–„çš„ï¼</span><br><span class="line">bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr</span><br><span class="line">var</span><br><span class="line">// ä»å®¹å™¨ä¸­é€€å›ä¸»æœº</span><br><span class="line">[root@e4eccc01b495 /]exit</span><br><span class="line">exit</span><br><span class="line">[root@ZS /]1s</span><br><span class="line">bin dev home kuangshen lib64</span><br><span class="line">media opt proc run share sys usr www</span><br><span class="line">boot etc</span><br><span class="line">hpt lib</span><br><span class="line">lost+found mnt</span><br><span class="line">patch root sbin srv</span><br><span class="line">tmp var</span><br></pre></td></tr></table></figure><h4 id="åˆ—å‡ºæ‰€æœ‰è¿è¡Œå®¹å™¨">åˆ—å‡ºæ‰€æœ‰è¿è¡Œå®¹å™¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// docker ps å‘½ä»¤</span><br><span class="line"></span><br><span class="line">-a  // åˆ—å‡ºå½“å‰è¿è¡Œå’Œä¹‹å‰è¿è¡Œè¿‡çš„å®¹å™¨</span><br><span class="line">-n=?  // åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨</span><br><span class="line">-p  // åªåˆ—å‡ºid</span><br></pre></td></tr></table></figure><h4 id="é€€å‡ºå®¹å™¨">é€€å‡ºå®¹å™¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit  // å®¹å™¨åœæ­¢è¿è¡Œå¹¶é€€å‡º</span><br><span class="line">Ctrl + P + Q  // å®¹å™¨ä¸åœæ­¢é€€å‡º</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤å®¹å™¨">åˆ é™¤å®¹å™¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker rm å®¹å™¨id// åˆ é™¤è¯¥é•œåƒ</span><br><span class="line"></span><br><span class="line">docker rm $(docker ps -ap)   // åˆ é™¤æ‰€æœ‰å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker ps -aq | xargs docker rm</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨å’Œåœæ­¢å®¹å™¨çš„æ“ä½œ">å¯åŠ¨å’Œåœæ­¢å®¹å™¨çš„æ“ä½œ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker start å®¹å™¨id</span><br><span class="line"></span><br><span class="line">docker restart å®¹å™¨id</span><br><span class="line"></span><br><span class="line">docker stop å®¹å™¨id</span><br><span class="line"></span><br><span class="line">docker kill å®¹å™¨id</span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨å…¶ä»–å‘½ä»¤">å¸¸ç”¨å…¶ä»–å‘½ä»¤</h4><p>åå°å¯åŠ¨å®¹å™¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d é•œåƒå</span><br><span class="line"></span><br><span class="line">// docker ps å‘ç° åœæ­¢äº†</span><br><span class="line"></span><br><span class="line">// docker å®¹å™¨ä½¿ç”¨åå°è¿è¡Œ, å°±å¿…é¡»è¦æœ‰ä¸€ä¸ªå‰å°ç¨‹åº, dockerå‘ç°æ²¡æœ‰åº”ç”¨, å°±ä¼šè‡ªåŠ¨</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shio Jottings</title>
      <link href="/posts/31848.html"/>
      <url>/posts/31848.html</url>
      
        <content type="html"><![CDATA[<h1>Jotting</h1><p>â€‹æ¯ä¸ªäººéƒ½ä¼šç»è¿‡è¿™ä¸ªé˜¶æ®µ, å–œæ¬¢æ ‡æ–°ç«‹æ„çš„æ¦‚å¿µ, è‹¥æ˜¯æœ‰äººå‡ºæ¥åå¯¹ä¸»æµè§‚å¿µ, åå¯¹å®¶åº­,å·¥ä½œ,è´£ä»»çš„æŸç¼š, å¹¶ä¸”æŠ€å·§åˆå¾ˆå‡ºè‰², å¾€å¾€å°±èƒ½ä¿˜è·å¾ˆå¤šæ‹¥æŠ¤, ä½ ä¼šè§‰å¾—åæŠ—æ¯”ä»€ä¹ˆéƒ½éš¾å¾—å¯è´µ</p><p>â€‹å¯åœ¨å°è¯•è¿‡ååˆå‘ç°ä¸»æµèƒ½æˆä¸ºä¸»æµæ˜¯æœ‰é“ç†çš„, è¿™æ˜¯å±äºå¤§å¤šæ•°äººçš„æœ€ç®€å•çš„è·¯å¾„, é€†æµè€Œä¸Šå¤ªç—›è‹¦äº†</p><p>â€‹äºæ˜¯ä½ å­¦ä¼šäº†æ¬£èµä¸»æµç”Ÿæ´»,å¥‡æ€ªçš„æ˜¯, å½“ä½ å¼€å§‹çƒ­çˆ±ä¸»æµçš„ä¸œè¥¿, åè€Œé€æ¸ç§¯ç´¯èµ·é€†æµè€Œä¸Šçš„å‹‡æ°”,å› ä¸ºä½ ä¸æ˜¯ä¸ºäº†é€ƒé¿è€Œé€†è¡Œ, ä½ ä¸æ€•å›åˆ°èŠ¸èŠ¸ä¼—ç”Ÿå½“ä¸­, è€Œè¿™ä¼šç»™äºˆä½ çœŸæ­£çš„å‹‡æ°”</p>]]></content>
      
      
      <categories>
          
          <category> Jottings </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jottings </tag>
            
            <tag> ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é¢˜æ€è·¯</title>
      <link href="/posts/39628.html"/>
      <url>/posts/39628.html</url>
      
        <content type="html"><![CDATA[<h1>çº¿ç¨‹ä¸å®‰å…¨çš„æœ¬è´¨:</h1><p>çº¿ç¨‹å†…å­˜å­˜å‰¯æœ¬</p><ul><li>æ›´æ”¹å‰¯æœ¬ä¸å¯è§,äº’ç›¸è¦†ç›–(å¯è§æ€§)</li><li>çº¿ç¨‹åˆ‡æ¢, æ›´æ”¹æ“ä½œä¸å…·æœ‰åŸå­æ€§(åŸå­æ€§)</li><li>æœ‰åºæ€§</li></ul><p>ç±»æ²¡æœ‰çŠ¶æ€, æˆå‘˜å˜é‡ä¸€å®šçº¿ç¨‹å®‰å…¨</p><p>æˆå‘˜å˜é‡åªæ˜¯å¯è¯»ä¹Ÿä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„</p><p>ä¿®æ”¹æˆå‘˜å˜é‡æ—¶åŠ äº’æ–¥é”ä¹Ÿä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„</p><h2 id="Stringä¸ºä»€ä¹ˆçº¿ç¨‹å®‰å…¨">Stringä¸ºä»€ä¹ˆçº¿ç¨‹å®‰å…¨</h2><p>final åªè¯» å…‰è¿™ä¸€ç‚¹ä¸å¤Ÿ, è¿˜å› ä¸ºæ˜¯private æ— æ³•æ›´æ”¹æ•°ç»„æŸä¸€å…ƒç´ </p><p>å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åœ¨å®ƒåˆ›å»ºçš„æ—¶å€™HashCodeå°±è¢«ç¼“å­˜äº†ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—ã€‚è¿™å°±ä½¿å¾—å­—ç¬¦ä¸²å¾ˆé€‚åˆä½œä¸ºMapä¸­çš„é”®ï¼Œå­—ç¬¦ä¸²çš„å¤„ç†é€Ÿåº¦è¦å¿«è¿‡å…¶å®ƒçš„é”®å¯¹è±¡ã€‚è¿™å°±æ˜¯HashMapä¸­çš„é”®å¾€å¾€éƒ½ä½¿ç”¨å­—ç¬¦ä¸²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
